(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function d$(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hn={exports:{}},on={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qy=Symbol.for("react.element"),p$=Symbol.for("react.portal"),f$=Symbol.for("react.fragment"),m$=Symbol.for("react.strict_mode"),v$=Symbol.for("react.profiler"),g$=Symbol.for("react.provider"),_$=Symbol.for("react.context"),y$=Symbol.for("react.forward_ref"),x$=Symbol.for("react.suspense"),b$=Symbol.for("react.memo"),w$=Symbol.for("react.lazy"),q5=Symbol.iterator;function S$(n){return n===null||typeof n!="object"?null:(n=q5&&n[q5]||n["@@iterator"],typeof n=="function"?n:null)}var a9={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},l9=Object.assign,u9={};function hg(n,e,t){this.props=n,this.context=e,this.refs=u9,this.updater=t||a9}hg.prototype.isReactComponent={};hg.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};hg.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function c9(){}c9.prototype=hg.prototype;function R4(n,e,t){this.props=n,this.context=e,this.refs=u9,this.updater=t||a9}var O4=R4.prototype=new c9;O4.constructor=R4;l9(O4,hg.prototype);O4.isPureReactComponent=!0;var Y5=Array.isArray,h9=Object.prototype.hasOwnProperty,k4={current:null},d9={key:!0,ref:!0,__self:!0,__source:!0};function p9(n,e,t){var i,r={},o=null,s=null;if(e!=null)for(i in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)h9.call(e,i)&&!d9.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Qy,type:n,key:o,ref:s,props:r,_owner:k4.current}}function M$(n,e){return{$$typeof:Qy,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function I4(n){return typeof n=="object"&&n!==null&&n.$$typeof===Qy}function C$(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var K5=/\/+/g;function ZT(n,e){return typeof n=="object"&&n!==null&&n.key!=null?C$(""+n.key):e.toString(36)}function eM(n,e,t,i,r){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var s=!1;if(n===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(n.$$typeof){case Qy:case p$:s=!0}}if(s)return s=n,r=r(s),n=i===""?"."+ZT(s,0):i,Y5(r)?(t="",n!=null&&(t=n.replace(K5,"$&/")+"/"),eM(r,e,t,"",function(u){return u})):r!=null&&(I4(r)&&(r=M$(r,t+(!r.key||s&&s.key===r.key?"":(""+r.key).replace(K5,"$&/")+"/")+n)),e.push(r)),1;if(s=0,i=i===""?".":i+":",Y5(n))for(var a=0;a<n.length;a++){o=n[a];var l=i+ZT(o,a);s+=eM(o,e,t,l,r)}else if(l=S$(n),typeof l=="function")for(n=l.call(n),a=0;!(o=n.next()).done;)o=o.value,l=i+ZT(o,a++),s+=eM(o,e,t,l,r);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Db(n,e,t){if(n==null)return n;var i=[],r=0;return eM(n,i,"","",function(o){return e.call(t,o,r++)}),i}function E$(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Do={current:null},tM={transition:null},T$={ReactCurrentDispatcher:Do,ReactCurrentBatchConfig:tM,ReactCurrentOwner:k4};on.Children={map:Db,forEach:function(n,e,t){Db(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Db(n,function(){e++}),e},toArray:function(n){return Db(n,function(e){return e})||[]},only:function(n){if(!I4(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};on.Component=hg;on.Fragment=f$;on.Profiler=v$;on.PureComponent=R4;on.StrictMode=m$;on.Suspense=x$;on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T$;on.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=l9({},n.props),r=n.key,o=n.ref,s=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=k4.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)h9.call(e,l)&&!d9.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:Qy,type:n.type,key:r,ref:o,props:i,_owner:s}};on.createContext=function(n){return n={$$typeof:_$,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:g$,_context:n},n.Consumer=n};on.createElement=p9;on.createFactory=function(n){var e=p9.bind(null,n);return e.type=n,e};on.createRef=function(){return{current:null}};on.forwardRef=function(n){return{$$typeof:y$,render:n}};on.isValidElement=I4;on.lazy=function(n){return{$$typeof:w$,_payload:{_status:-1,_result:n},_init:E$}};on.memo=function(n,e){return{$$typeof:b$,type:n,compare:e===void 0?null:e}};on.startTransition=function(n){var e=tM.transition;tM.transition={};try{n()}finally{tM.transition=e}};on.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};on.useCallback=function(n,e){return Do.current.useCallback(n,e)};on.useContext=function(n){return Do.current.useContext(n)};on.useDebugValue=function(){};on.useDeferredValue=function(n){return Do.current.useDeferredValue(n)};on.useEffect=function(n,e){return Do.current.useEffect(n,e)};on.useId=function(){return Do.current.useId()};on.useImperativeHandle=function(n,e,t){return Do.current.useImperativeHandle(n,e,t)};on.useInsertionEffect=function(n,e){return Do.current.useInsertionEffect(n,e)};on.useLayoutEffect=function(n,e){return Do.current.useLayoutEffect(n,e)};on.useMemo=function(n,e){return Do.current.useMemo(n,e)};on.useReducer=function(n,e,t){return Do.current.useReducer(n,e,t)};on.useRef=function(n){return Do.current.useRef(n)};on.useState=function(n){return Do.current.useState(n)};on.useSyncExternalStore=function(n,e,t){return Do.current.useSyncExternalStore(n,e,t)};on.useTransition=function(){return Do.current.useTransition()};on.version="18.2.0";(function(n){n.exports=on})(hn);const _t=d$(hn.exports);var GL={},f9={exports:{}},Ps={},m9={exports:{}},v9={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(X,B){var U=X.length;X.push(B);e:for(;0<U;){var le=U-1>>>1,ne=X[le];if(0<r(ne,B))X[le]=B,X[U]=ne,U=le;else break e}}function t(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var B=X[0],U=X.pop();if(U!==B){X[0]=U;e:for(var le=0,ne=X.length,fe=ne>>>1;le<fe;){var we=2*(le+1)-1,Be=X[we],oe=we+1,tt=X[oe];if(0>r(Be,U))oe<ne&&0>r(tt,Be)?(X[le]=tt,X[oe]=U,le=oe):(X[le]=Be,X[we]=U,le=we);else if(oe<ne&&0>r(tt,U))X[le]=tt,X[oe]=U,le=oe;else break e}}return B}function r(X,B){var U=X.sortIndex-B.sortIndex;return U!==0?U:X.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();n.unstable_now=function(){return s.now()-a}}var l=[],u=[],c=1,h=null,p=3,m=!1,y=!1,_=!1,g=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(X){for(var B=t(u);B!==null;){if(B.callback===null)i(u);else if(B.startTime<=X)i(u),B.sortIndex=B.expirationTime,e(l,B);else break;B=t(u)}}function C(X){if(_=!1,M(X),!y)if(t(l)!==null)y=!0,Z(P);else{var B=t(u);B!==null&&de(C,B.startTime-X)}}function P(X,B){y=!1,_&&(_=!1,b(E),E=-1),m=!0;var U=p;try{for(M(B),h=t(l);h!==null&&(!(h.expirationTime>B)||X&&!j());){var le=h.callback;if(typeof le=="function"){h.callback=null,p=h.priorityLevel;var ne=le(h.expirationTime<=B);B=n.unstable_now(),typeof ne=="function"?h.callback=ne:h===t(l)&&i(l),M(B)}else i(l);h=t(l)}if(h!==null)var fe=!0;else{var we=t(u);we!==null&&de(C,we.startTime-B),fe=!1}return fe}finally{h=null,p=U,m=!1}}var L=!1,R=null,E=-1,D=5,N=-1;function j(){return!(n.unstable_now()-N<D)}function te(){if(R!==null){var X=n.unstable_now();N=X;var B=!0;try{B=R(!0,X)}finally{B?ee():(L=!1,R=null)}}else L=!1}var ee;if(typeof w=="function")ee=function(){w(te)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,Q=H.port2;H.port1.onmessage=te,ee=function(){Q.postMessage(null)}}else ee=function(){g(te,0)};function Z(X){R=X,L||(L=!0,ee())}function de(X,B){E=g(function(){X(n.unstable_now())},B)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,Z(P))},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(X){switch(p){case 1:case 2:case 3:var B=3;break;default:B=p}var U=p;p=B;try{return X()}finally{p=U}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(X,B){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var U=p;p=X;try{return B()}finally{p=U}},n.unstable_scheduleCallback=function(X,B,U){var le=n.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?le+U:le):U=le,X){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=U+ne,X={id:c++,callback:B,priorityLevel:X,startTime:U,expirationTime:ne,sortIndex:-1},U>le?(X.sortIndex=U,e(u,X),t(l)===null&&X===t(u)&&(_?(b(E),E=-1):_=!0,de(C,U-le))):(X.sortIndex=ne,e(l,X),y||m||(y=!0,Z(P))),X},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(X){var B=p;return function(){var U=p;p=B;try{return X.apply(this,arguments)}finally{p=U}}}})(v9);(function(n){n.exports=v9})(m9);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g9=hn.exports,Ms=m9.exports;function Ze(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _9=new Set,uy={};function Vp(n,e){Sv(n,e),Sv(n+"Capture",e)}function Sv(n,e){for(uy[n]=e,n=0;n<e.length;n++)_9.add(e[n])}var Yu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),XL=Object.prototype.hasOwnProperty,P$=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Z5={},J5={};function A$(n){return XL.call(J5,n)?!0:XL.call(Z5,n)?!1:P$.test(n)?J5[n]=!0:(Z5[n]=!0,!1)}function L$(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function D$(n,e,t,i){if(e===null||typeof e>"u"||L$(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ro(n,e,t,i,r,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var jr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){jr[n]=new Ro(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];jr[e]=new Ro(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){jr[n]=new Ro(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){jr[n]=new Ro(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){jr[n]=new Ro(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){jr[n]=new Ro(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){jr[n]=new Ro(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){jr[n]=new Ro(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){jr[n]=new Ro(n,5,!1,n.toLowerCase(),null,!1,!1)});var N4=/[\-:]([a-z])/g;function z4(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(N4,z4);jr[e]=new Ro(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(N4,z4);jr[e]=new Ro(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(N4,z4);jr[e]=new Ro(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){jr[n]=new Ro(n,1,!1,n.toLowerCase(),null,!1,!1)});jr.xlinkHref=new Ro("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){jr[n]=new Ro(n,1,!1,n.toLowerCase(),null,!0,!0)});function V4(n,e,t,i){var r=jr.hasOwnProperty(e)?jr[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(D$(e,t,r,i)&&(t=null),i||r===null?A$(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var tc=g9.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rb=Symbol.for("react.element"),Am=Symbol.for("react.portal"),Lm=Symbol.for("react.fragment"),F4=Symbol.for("react.strict_mode"),qL=Symbol.for("react.profiler"),y9=Symbol.for("react.provider"),x9=Symbol.for("react.context"),B4=Symbol.for("react.forward_ref"),YL=Symbol.for("react.suspense"),KL=Symbol.for("react.suspense_list"),U4=Symbol.for("react.memo"),Jc=Symbol.for("react.lazy"),b9=Symbol.for("react.offscreen"),Q5=Symbol.iterator;function P0(n){return n===null||typeof n!="object"?null:(n=Q5&&n[Q5]||n["@@iterator"],typeof n=="function"?n:null)}var pi=Object.assign,JT;function d_(n){if(JT===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);JT=e&&e[1]||""}return`
`+JT+n}var QT=!1;function $T(n,e){if(!n||QT)return"";QT=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){i=u}n.call(e.prototype)}else{try{throw Error()}catch(u){i=u}n()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),o=i.stack.split(`
`),s=r.length-1,a=o.length-1;1<=s&&0<=a&&r[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||r[s]!==o[a]){var l=`
`+r[s].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=s&&0<=a);break}}}finally{QT=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?d_(n):""}function R$(n){switch(n.tag){case 5:return d_(n.type);case 16:return d_("Lazy");case 13:return d_("Suspense");case 19:return d_("SuspenseList");case 0:case 2:case 15:return n=$T(n.type,!1),n;case 11:return n=$T(n.type.render,!1),n;case 1:return n=$T(n.type,!0),n;default:return""}}function ZL(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Lm:return"Fragment";case Am:return"Portal";case qL:return"Profiler";case F4:return"StrictMode";case YL:return"Suspense";case KL:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case x9:return(n.displayName||"Context")+".Consumer";case y9:return(n._context.displayName||"Context")+".Provider";case B4:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case U4:return e=n.displayName||null,e!==null?e:ZL(n.type)||"Memo";case Jc:e=n._payload,n=n._init;try{return ZL(n(e))}catch{}}return null}function O$(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ZL(e);case 8:return e===F4?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Th(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function w9(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function k$(n){var e=w9(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(s){i=""+s,o.call(this,s)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(s){i=""+s},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Ob(n){n._valueTracker||(n._valueTracker=k$(n))}function S9(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=w9(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function BM(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function JL(n,e){var t=e.checked;return pi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t!=null?t:n._wrapperState.initialChecked})}function $5(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Th(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function M9(n,e){e=e.checked,e!=null&&V4(n,"checked",e,!1)}function QL(n,e){M9(n,e);var t=Th(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?$L(n,e.type,t):e.hasOwnProperty("defaultValue")&&$L(n,e.type,Th(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function eN(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function $L(n,e,t){(e!=="number"||BM(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var p_=Array.isArray;function Km(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Th(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function eD(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ze(91));return pi({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function tN(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Ze(92));if(p_(t)){if(1<t.length)throw Error(Ze(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Th(t)}}function C9(n,e){var t=Th(e.value),i=Th(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function nN(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function E9(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tD(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?E9(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var kb,T9=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(kb=kb||document.createElement("div"),kb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=kb.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function cy(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var L_={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},I$=["Webkit","ms","Moz","O"];Object.keys(L_).forEach(function(n){I$.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),L_[e]=L_[n]})});function P9(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||L_.hasOwnProperty(n)&&L_[n]?(""+e).trim():e+"px"}function A9(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=P9(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var N$=pi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nD(n,e){if(e){if(N$[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ze(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ze(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ze(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ze(62))}}function iD(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rD=null;function j4(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var oD=null,Zm=null,Jm=null;function iN(n){if(n=tx(n)){if(typeof oD!="function")throw Error(Ze(280));var e=n.stateNode;e&&(e=oC(e),oD(n.stateNode,n.type,e))}}function L9(n){Zm?Jm?Jm.push(n):Jm=[n]:Zm=n}function D9(){if(Zm){var n=Zm,e=Jm;if(Jm=Zm=null,iN(n),e)for(n=0;n<e.length;n++)iN(e[n])}}function R9(n,e){return n(e)}function O9(){}var eP=!1;function k9(n,e,t){if(eP)return n(e,t);eP=!0;try{return R9(n,e,t)}finally{eP=!1,(Zm!==null||Jm!==null)&&(O9(),D9())}}function hy(n,e){var t=n.stateNode;if(t===null)return null;var i=oC(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(Ze(231,e,typeof t));return t}var sD=!1;if(Yu)try{var A0={};Object.defineProperty(A0,"passive",{get:function(){sD=!0}}),window.addEventListener("test",A0,A0),window.removeEventListener("test",A0,A0)}catch{sD=!1}function z$(n,e,t,i,r,o,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var D_=!1,UM=null,jM=!1,aD=null,V$={onError:function(n){D_=!0,UM=n}};function F$(n,e,t,i,r,o,s,a,l){D_=!1,UM=null,z$.apply(V$,arguments)}function B$(n,e,t,i,r,o,s,a,l){if(F$.apply(this,arguments),D_){if(D_){var u=UM;D_=!1,UM=null}else throw Error(Ze(198));jM||(jM=!0,aD=u)}}function Fp(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,(e.flags&4098)!==0&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function I9(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function rN(n){if(Fp(n)!==n)throw Error(Ze(188))}function U$(n){var e=n.alternate;if(!e){if(e=Fp(n),e===null)throw Error(Ze(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var o=r.alternate;if(o===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===t)return rN(r),n;if(o===i)return rN(r),e;o=o.sibling}throw Error(Ze(188))}if(t.return!==i.return)t=r,i=o;else{for(var s=!1,a=r.child;a;){if(a===t){s=!0,t=r,i=o;break}if(a===i){s=!0,i=r,t=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===t){s=!0,t=o,i=r;break}if(a===i){s=!0,i=o,t=r;break}a=a.sibling}if(!s)throw Error(Ze(189))}}if(t.alternate!==i)throw Error(Ze(190))}if(t.tag!==3)throw Error(Ze(188));return t.stateNode.current===t?n:e}function N9(n){return n=U$(n),n!==null?z9(n):null}function z9(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=z9(n);if(e!==null)return e;n=n.sibling}return null}var V9=Ms.unstable_scheduleCallback,oN=Ms.unstable_cancelCallback,j$=Ms.unstable_shouldYield,H$=Ms.unstable_requestPaint,Oi=Ms.unstable_now,W$=Ms.unstable_getCurrentPriorityLevel,H4=Ms.unstable_ImmediatePriority,F9=Ms.unstable_UserBlockingPriority,HM=Ms.unstable_NormalPriority,G$=Ms.unstable_LowPriority,B9=Ms.unstable_IdlePriority,tC=null,Sl=null;function X$(n){if(Sl&&typeof Sl.onCommitFiberRoot=="function")try{Sl.onCommitFiberRoot(tC,n,void 0,(n.current.flags&128)===128)}catch{}}var za=Math.clz32?Math.clz32:K$,q$=Math.log,Y$=Math.LN2;function K$(n){return n>>>=0,n===0?32:31-(q$(n)/Y$|0)|0}var Ib=64,Nb=4194304;function f_(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function WM(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,o=n.pingedLanes,s=t&268435455;if(s!==0){var a=s&~r;a!==0?i=f_(a):(o&=s,o!==0&&(i=f_(o)))}else s=t&~r,s!==0?i=f_(s):o!==0&&(i=f_(o));if(i===0)return 0;if(e!==0&&e!==i&&(e&r)===0&&(r=i&-i,o=e&-e,r>=o||r===16&&(o&4194240)!==0))return e;if((i&4)!==0&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-za(e),r=1<<t,i|=n[t],e&=~r;return i}function Z$(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function J$(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,o=n.pendingLanes;0<o;){var s=31-za(o),a=1<<s,l=r[s];l===-1?((a&t)===0||(a&i)!==0)&&(r[s]=Z$(a,e)):l<=e&&(n.expiredLanes|=a),o&=~a}}function lD(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function U9(){var n=Ib;return Ib<<=1,(Ib&4194240)===0&&(Ib=64),n}function tP(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function $y(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-za(e),n[e]=t}function Q$(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-za(t),o=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~o}}function W4(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-za(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var On=0;function j9(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var H9,G4,W9,G9,X9,uD=!1,zb=[],ph=null,fh=null,mh=null,dy=new Map,py=new Map,nh=[],$$="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sN(n,e){switch(n){case"focusin":case"focusout":ph=null;break;case"dragenter":case"dragleave":fh=null;break;case"mouseover":case"mouseout":mh=null;break;case"pointerover":case"pointerout":dy.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":py.delete(e.pointerId)}}function L0(n,e,t,i,r,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},e!==null&&(e=tx(e),e!==null&&G4(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function eee(n,e,t,i,r){switch(e){case"focusin":return ph=L0(ph,n,e,t,i,r),!0;case"dragenter":return fh=L0(fh,n,e,t,i,r),!0;case"mouseover":return mh=L0(mh,n,e,t,i,r),!0;case"pointerover":var o=r.pointerId;return dy.set(o,L0(dy.get(o)||null,n,e,t,i,r)),!0;case"gotpointercapture":return o=r.pointerId,py.set(o,L0(py.get(o)||null,n,e,t,i,r)),!0}return!1}function q9(n){var e=ip(n.target);if(e!==null){var t=Fp(e);if(t!==null){if(e=t.tag,e===13){if(e=I9(t),e!==null){n.blockedOn=e,X9(n.priority,function(){W9(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function nM(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=cD(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);rD=i,t.target.dispatchEvent(i),rD=null}else return e=tx(t),e!==null&&G4(e),n.blockedOn=t,!1;e.shift()}return!0}function aN(n,e,t){nM(n)&&t.delete(e)}function tee(){uD=!1,ph!==null&&nM(ph)&&(ph=null),fh!==null&&nM(fh)&&(fh=null),mh!==null&&nM(mh)&&(mh=null),dy.forEach(aN),py.forEach(aN)}function D0(n,e){n.blockedOn===e&&(n.blockedOn=null,uD||(uD=!0,Ms.unstable_scheduleCallback(Ms.unstable_NormalPriority,tee)))}function fy(n){function e(r){return D0(r,n)}if(0<zb.length){D0(zb[0],n);for(var t=1;t<zb.length;t++){var i=zb[t];i.blockedOn===n&&(i.blockedOn=null)}}for(ph!==null&&D0(ph,n),fh!==null&&D0(fh,n),mh!==null&&D0(mh,n),dy.forEach(e),py.forEach(e),t=0;t<nh.length;t++)i=nh[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<nh.length&&(t=nh[0],t.blockedOn===null);)q9(t),t.blockedOn===null&&nh.shift()}var Qm=tc.ReactCurrentBatchConfig,GM=!0;function nee(n,e,t,i){var r=On,o=Qm.transition;Qm.transition=null;try{On=1,X4(n,e,t,i)}finally{On=r,Qm.transition=o}}function iee(n,e,t,i){var r=On,o=Qm.transition;Qm.transition=null;try{On=4,X4(n,e,t,i)}finally{On=r,Qm.transition=o}}function X4(n,e,t,i){if(GM){var r=cD(n,e,t,i);if(r===null)hP(n,e,i,XM,t),sN(n,i);else if(eee(r,n,e,t,i))i.stopPropagation();else if(sN(n,i),e&4&&-1<$$.indexOf(n)){for(;r!==null;){var o=tx(r);if(o!==null&&H9(o),o=cD(n,e,t,i),o===null&&hP(n,e,i,XM,t),o===r)break;r=o}r!==null&&i.stopPropagation()}else hP(n,e,i,null,t)}}var XM=null;function cD(n,e,t,i){if(XM=null,n=j4(i),n=ip(n),n!==null)if(e=Fp(n),e===null)n=null;else if(t=e.tag,t===13){if(n=I9(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return XM=n,null}function Y9(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(W$()){case H4:return 1;case F9:return 4;case HM:case G$:return 16;case B9:return 536870912;default:return 16}default:return 16}}var lh=null,q4=null,iM=null;function K9(){if(iM)return iM;var n,e=q4,t=e.length,i,r="value"in lh?lh.value:lh.textContent,o=r.length;for(n=0;n<t&&e[n]===r[n];n++);var s=t-n;for(i=1;i<=s&&e[t-i]===r[o-i];i++);return iM=r.slice(n,1<i?1-i:void 0)}function rM(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Vb(){return!0}function lN(){return!1}function As(n){function e(t,i,r,o,s){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Vb:lN,this.isPropagationStopped=lN,this}return pi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Vb)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Vb)},persist:function(){},isPersistent:Vb}),e}var dg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Y4=As(dg),ex=pi({},dg,{view:0,detail:0}),ree=As(ex),nP,iP,R0,nC=pi({},ex,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:K4,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==R0&&(R0&&n.type==="mousemove"?(nP=n.screenX-R0.screenX,iP=n.screenY-R0.screenY):iP=nP=0,R0=n),nP)},movementY:function(n){return"movementY"in n?n.movementY:iP}}),uN=As(nC),oee=pi({},nC,{dataTransfer:0}),see=As(oee),aee=pi({},ex,{relatedTarget:0}),rP=As(aee),lee=pi({},dg,{animationName:0,elapsedTime:0,pseudoElement:0}),uee=As(lee),cee=pi({},dg,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),hee=As(cee),dee=pi({},dg,{data:0}),cN=As(dee),pee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vee(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=mee[n])?!!e[n]:!1}function K4(){return vee}var gee=pi({},ex,{key:function(n){if(n.key){var e=pee[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=rM(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?fee[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:K4,charCode:function(n){return n.type==="keypress"?rM(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?rM(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),_ee=As(gee),yee=pi({},nC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hN=As(yee),xee=pi({},ex,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:K4}),bee=As(xee),wee=pi({},dg,{propertyName:0,elapsedTime:0,pseudoElement:0}),See=As(wee),Mee=pi({},nC,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Cee=As(Mee),Eee=[9,13,27,32],Z4=Yu&&"CompositionEvent"in window,R_=null;Yu&&"documentMode"in document&&(R_=document.documentMode);var Tee=Yu&&"TextEvent"in window&&!R_,Z9=Yu&&(!Z4||R_&&8<R_&&11>=R_),dN=String.fromCharCode(32),pN=!1;function J9(n,e){switch(n){case"keyup":return Eee.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Q9(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Dm=!1;function Pee(n,e){switch(n){case"compositionend":return Q9(e);case"keypress":return e.which!==32?null:(pN=!0,dN);case"textInput":return n=e.data,n===dN&&pN?null:n;default:return null}}function Aee(n,e){if(Dm)return n==="compositionend"||!Z4&&J9(n,e)?(n=K9(),iM=q4=lh=null,Dm=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Z9&&e.locale!=="ko"?null:e.data;default:return null}}var Lee={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fN(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Lee[n.type]:e==="textarea"}function $9(n,e,t,i){L9(i),e=qM(e,"onChange"),0<e.length&&(t=new Y4("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var O_=null,my=null;function Dee(n){c7(n,0)}function iC(n){var e=km(n);if(S9(e))return n}function Ree(n,e){if(n==="change")return e}var e7=!1;if(Yu){var oP;if(Yu){var sP="oninput"in document;if(!sP){var mN=document.createElement("div");mN.setAttribute("oninput","return;"),sP=typeof mN.oninput=="function"}oP=sP}else oP=!1;e7=oP&&(!document.documentMode||9<document.documentMode)}function vN(){O_&&(O_.detachEvent("onpropertychange",t7),my=O_=null)}function t7(n){if(n.propertyName==="value"&&iC(my)){var e=[];$9(e,my,n,j4(n)),k9(Dee,e)}}function Oee(n,e,t){n==="focusin"?(vN(),O_=e,my=t,O_.attachEvent("onpropertychange",t7)):n==="focusout"&&vN()}function kee(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return iC(my)}function Iee(n,e){if(n==="click")return iC(e)}function Nee(n,e){if(n==="input"||n==="change")return iC(e)}function zee(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ha=typeof Object.is=="function"?Object.is:zee;function vy(n,e){if(Ha(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!XL.call(e,r)||!Ha(n[r],e[r]))return!1}return!0}function gN(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function _N(n,e){var t=gN(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=gN(t)}}function n7(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?n7(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function i7(){for(var n=window,e=BM();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=BM(n.document)}return e}function J4(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Vee(n){var e=i7(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&n7(t.ownerDocument.documentElement,t)){if(i!==null&&J4(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,o=Math.min(i.start,r);i=i.end===void 0?o:Math.min(i.end,r),!n.extend&&o>i&&(r=i,i=o,o=r),r=_N(t,o);var s=_N(t,i);r&&s&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==s.node||n.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),o>i?(n.addRange(e),n.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Fee=Yu&&"documentMode"in document&&11>=document.documentMode,Rm=null,hD=null,k_=null,dD=!1;function yN(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;dD||Rm==null||Rm!==BM(i)||(i=Rm,"selectionStart"in i&&J4(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),k_&&vy(k_,i)||(k_=i,i=qM(hD,"onSelect"),0<i.length&&(e=new Y4("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=Rm)))}function Fb(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Om={animationend:Fb("Animation","AnimationEnd"),animationiteration:Fb("Animation","AnimationIteration"),animationstart:Fb("Animation","AnimationStart"),transitionend:Fb("Transition","TransitionEnd")},aP={},r7={};Yu&&(r7=document.createElement("div").style,"AnimationEvent"in window||(delete Om.animationend.animation,delete Om.animationiteration.animation,delete Om.animationstart.animation),"TransitionEvent"in window||delete Om.transitionend.transition);function rC(n){if(aP[n])return aP[n];if(!Om[n])return n;var e=Om[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in r7)return aP[n]=e[t];return n}var o7=rC("animationend"),s7=rC("animationiteration"),a7=rC("animationstart"),l7=rC("transitionend"),u7=new Map,xN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vh(n,e){u7.set(n,e),Vp(e,[n])}for(var lP=0;lP<xN.length;lP++){var uP=xN[lP],Bee=uP.toLowerCase(),Uee=uP[0].toUpperCase()+uP.slice(1);Vh(Bee,"on"+Uee)}Vh(o7,"onAnimationEnd");Vh(s7,"onAnimationIteration");Vh(a7,"onAnimationStart");Vh("dblclick","onDoubleClick");Vh("focusin","onFocus");Vh("focusout","onBlur");Vh(l7,"onTransitionEnd");Sv("onMouseEnter",["mouseout","mouseover"]);Sv("onMouseLeave",["mouseout","mouseover"]);Sv("onPointerEnter",["pointerout","pointerover"]);Sv("onPointerLeave",["pointerout","pointerover"]);Vp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vp("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var m_="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jee=new Set("cancel close invalid load scroll toggle".split(" ").concat(m_));function bN(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,B$(i,e,void 0,n),n.currentTarget=null}function c7(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var o=void 0;if(e)for(var s=i.length-1;0<=s;s--){var a=i[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break e;bN(r,a,u),o=l}else for(s=0;s<i.length;s++){if(a=i[s],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break e;bN(r,a,u),o=l}}}if(jM)throw n=aD,jM=!1,aD=null,n}function Jn(n,e){var t=e[gD];t===void 0&&(t=e[gD]=new Set);var i=n+"__bubble";t.has(i)||(h7(e,n,2,!1),t.add(i))}function cP(n,e,t){var i=0;e&&(i|=4),h7(t,n,i,e)}var Bb="_reactListening"+Math.random().toString(36).slice(2);function gy(n){if(!n[Bb]){n[Bb]=!0,_9.forEach(function(t){t!=="selectionchange"&&(jee.has(t)||cP(t,!1,n),cP(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Bb]||(e[Bb]=!0,cP("selectionchange",!1,e))}}function h7(n,e,t,i){switch(Y9(e)){case 1:var r=nee;break;case 4:r=iee;break;default:r=X4}t=r.bind(null,e,t,n),r=void 0,!sD||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function hP(n,e,t,i,r){var o=i;if((e&1)===0&&(e&2)===0&&i!==null)e:for(;;){if(i===null)return;var s=i.tag;if(s===3||s===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(s===4)for(s=i.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;s=s.return}for(;a!==null;){if(s=ip(a),s===null)return;if(l=s.tag,l===5||l===6){i=o=s;continue e}a=a.parentNode}}i=i.return}k9(function(){var u=o,c=j4(t),h=[];e:{var p=u7.get(n);if(p!==void 0){var m=Y4,y=n;switch(n){case"keypress":if(rM(t)===0)break e;case"keydown":case"keyup":m=_ee;break;case"focusin":y="focus",m=rP;break;case"focusout":y="blur",m=rP;break;case"beforeblur":case"afterblur":m=rP;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=uN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=see;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=bee;break;case o7:case s7:case a7:m=uee;break;case l7:m=See;break;case"scroll":m=ree;break;case"wheel":m=Cee;break;case"copy":case"cut":case"paste":m=hee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=hN}var _=(e&4)!==0,g=!_&&n==="scroll",b=_?p!==null?p+"Capture":null:p;_=[];for(var w=u,M;w!==null;){M=w;var C=M.stateNode;if(M.tag===5&&C!==null&&(M=C,b!==null&&(C=hy(w,b),C!=null&&_.push(_y(w,C,M)))),g)break;w=w.return}0<_.length&&(p=new m(p,y,null,t,c),h.push({event:p,listeners:_}))}}if((e&7)===0){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==rD&&(y=t.relatedTarget||t.fromElement)&&(ip(y)||y[Ku]))break e;if((m||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=t.relatedTarget||t.toElement,m=u,y=y?ip(y):null,y!==null&&(g=Fp(y),y!==g||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(_=uN,C="onMouseLeave",b="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(_=hN,C="onPointerLeave",b="onPointerEnter",w="pointer"),g=m==null?p:km(m),M=y==null?p:km(y),p=new _(C,w+"leave",m,t,c),p.target=g,p.relatedTarget=M,C=null,ip(c)===u&&(_=new _(b,w+"enter",y,t,c),_.target=M,_.relatedTarget=g,C=_),g=C,m&&y)t:{for(_=m,b=y,w=0,M=_;M;M=zf(M))w++;for(M=0,C=b;C;C=zf(C))M++;for(;0<w-M;)_=zf(_),w--;for(;0<M-w;)b=zf(b),M--;for(;w--;){if(_===b||b!==null&&_===b.alternate)break t;_=zf(_),b=zf(b)}_=null}else _=null;m!==null&&wN(h,p,m,_,!1),y!==null&&g!==null&&wN(h,g,y,_,!0)}}e:{if(p=u?km(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var P=Ree;else if(fN(p))if(e7)P=Nee;else{P=kee;var L=Oee}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(P=Iee);if(P&&(P=P(n,u))){$9(h,P,t,c);break e}L&&L(n,p,u),n==="focusout"&&(L=p._wrapperState)&&L.controlled&&p.type==="number"&&$L(p,"number",p.value)}switch(L=u?km(u):window,n){case"focusin":(fN(L)||L.contentEditable==="true")&&(Rm=L,hD=u,k_=null);break;case"focusout":k_=hD=Rm=null;break;case"mousedown":dD=!0;break;case"contextmenu":case"mouseup":case"dragend":dD=!1,yN(h,t,c);break;case"selectionchange":if(Fee)break;case"keydown":case"keyup":yN(h,t,c)}var R;if(Z4)e:{switch(n){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Dm?J9(n,t)&&(E="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(E="onCompositionStart");E&&(Z9&&t.locale!=="ko"&&(Dm||E!=="onCompositionStart"?E==="onCompositionEnd"&&Dm&&(R=K9()):(lh=c,q4="value"in lh?lh.value:lh.textContent,Dm=!0)),L=qM(u,E),0<L.length&&(E=new cN(E,n,null,t,c),h.push({event:E,listeners:L}),R?E.data=R:(R=Q9(t),R!==null&&(E.data=R)))),(R=Tee?Pee(n,t):Aee(n,t))&&(u=qM(u,"onBeforeInput"),0<u.length&&(c=new cN("onBeforeInput","beforeinput",null,t,c),h.push({event:c,listeners:u}),c.data=R))}c7(h,e)})}function _y(n,e,t){return{instance:n,listener:e,currentTarget:t}}function qM(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=hy(n,t),o!=null&&i.unshift(_y(n,o,r)),o=hy(n,e),o!=null&&i.push(_y(n,o,r))),n=n.return}return i}function zf(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function wN(n,e,t,i,r){for(var o=e._reactName,s=[];t!==null&&t!==i;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=hy(t,o),l!=null&&s.unshift(_y(t,l,a))):r||(l=hy(t,o),l!=null&&s.push(_y(t,l,a)))),t=t.return}s.length!==0&&n.push({event:e,listeners:s})}var Hee=/\r\n?/g,Wee=/\u0000|\uFFFD/g;function SN(n){return(typeof n=="string"?n:""+n).replace(Hee,`
`).replace(Wee,"")}function Ub(n,e,t){if(e=SN(e),SN(n)!==e&&t)throw Error(Ze(425))}function YM(){}var pD=null,fD=null;function mD(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vD=typeof setTimeout=="function"?setTimeout:void 0,Gee=typeof clearTimeout=="function"?clearTimeout:void 0,MN=typeof Promise=="function"?Promise:void 0,Xee=typeof queueMicrotask=="function"?queueMicrotask:typeof MN<"u"?function(n){return MN.resolve(null).then(n).catch(qee)}:vD;function qee(n){setTimeout(function(){throw n})}function dP(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),fy(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);fy(e)}function vh(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function CN(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var pg=Math.random().toString(36).slice(2),gl="__reactFiber$"+pg,yy="__reactProps$"+pg,Ku="__reactContainer$"+pg,gD="__reactEvents$"+pg,Yee="__reactListeners$"+pg,Kee="__reactHandles$"+pg;function ip(n){var e=n[gl];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ku]||t[gl]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=CN(n);n!==null;){if(t=n[gl])return t;n=CN(n)}return e}n=t,t=n.parentNode}return null}function tx(n){return n=n[gl]||n[Ku],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function km(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Ze(33))}function oC(n){return n[yy]||null}var _D=[],Im=-1;function Fh(n){return{current:n}}function $n(n){0>Im||(n.current=_D[Im],_D[Im]=null,Im--)}function Xn(n,e){Im++,_D[Im]=n.current,n.current=e}var Ph={},oo=Fh(Ph),qo=Fh(!1),bp=Ph;function Mv(n,e){var t=n.type.contextTypes;if(!t)return Ph;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in t)r[o]=e[o];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Yo(n){return n=n.childContextTypes,n!=null}function KM(){$n(qo),$n(oo)}function EN(n,e,t){if(oo.current!==Ph)throw Error(Ze(168));Xn(oo,e),Xn(qo,t)}function d7(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(Ze(108,O$(n)||"Unknown",r));return pi({},t,i)}function ZM(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ph,bp=oo.current,Xn(oo,n),Xn(qo,qo.current),!0}function TN(n,e,t){var i=n.stateNode;if(!i)throw Error(Ze(169));t?(n=d7(n,e,bp),i.__reactInternalMemoizedMergedChildContext=n,$n(qo),$n(oo),Xn(oo,n)):$n(qo),Xn(qo,t)}var Ru=null,sC=!1,pP=!1;function p7(n){Ru===null?Ru=[n]:Ru.push(n)}function Zee(n){sC=!0,p7(n)}function Bh(){if(!pP&&Ru!==null){pP=!0;var n=0,e=On;try{var t=Ru;for(On=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Ru=null,sC=!1}catch(r){throw Ru!==null&&(Ru=Ru.slice(n+1)),V9(H4,Bh),r}finally{On=e,pP=!1}}return null}var Nm=[],zm=0,JM=null,QM=0,Hs=[],Ws=0,wp=null,Vu=1,Fu="";function Yd(n,e){Nm[zm++]=QM,Nm[zm++]=JM,JM=n,QM=e}function f7(n,e,t){Hs[Ws++]=Vu,Hs[Ws++]=Fu,Hs[Ws++]=wp,wp=n;var i=Vu;n=Fu;var r=32-za(i)-1;i&=~(1<<r),t+=1;var o=32-za(e)+r;if(30<o){var s=r-r%5;o=(i&(1<<s)-1).toString(32),i>>=s,r-=s,Vu=1<<32-za(e)+r|t<<r|i,Fu=o+n}else Vu=1<<o|t<<r|i,Fu=n}function Q4(n){n.return!==null&&(Yd(n,1),f7(n,1,0))}function $4(n){for(;n===JM;)JM=Nm[--zm],Nm[zm]=null,QM=Nm[--zm],Nm[zm]=null;for(;n===wp;)wp=Hs[--Ws],Hs[Ws]=null,Fu=Hs[--Ws],Hs[Ws]=null,Vu=Hs[--Ws],Hs[Ws]=null}var bs=null,_s=null,ni=!1,Ra=null;function m7(n,e){var t=qs(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function PN(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,bs=n,_s=vh(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,bs=n,_s=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=wp!==null?{id:Vu,overflow:Fu}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=qs(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,bs=n,_s=null,!0):!1;default:return!1}}function yD(n){return(n.mode&1)!==0&&(n.flags&128)===0}function xD(n){if(ni){var e=_s;if(e){var t=e;if(!PN(n,e)){if(yD(n))throw Error(Ze(418));e=vh(t.nextSibling);var i=bs;e&&PN(n,e)?m7(i,t):(n.flags=n.flags&-4097|2,ni=!1,bs=n)}}else{if(yD(n))throw Error(Ze(418));n.flags=n.flags&-4097|2,ni=!1,bs=n}}}function AN(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;bs=n}function jb(n){if(n!==bs)return!1;if(!ni)return AN(n),ni=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!mD(n.type,n.memoizedProps)),e&&(e=_s)){if(yD(n))throw v7(),Error(Ze(418));for(;e;)m7(n,e),e=vh(e.nextSibling)}if(AN(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Ze(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){_s=vh(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}_s=null}}else _s=bs?vh(n.stateNode.nextSibling):null;return!0}function v7(){for(var n=_s;n;)n=vh(n.nextSibling)}function Cv(){_s=bs=null,ni=!1}function eO(n){Ra===null?Ra=[n]:Ra.push(n)}var Jee=tc.ReactCurrentBatchConfig;function Aa(n,e){if(n&&n.defaultProps){e=pi({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var $M=Fh(null),e2=null,Vm=null,tO=null;function nO(){tO=Vm=e2=null}function iO(n){var e=$M.current;$n($M),n._currentValue=e}function bD(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function $m(n,e){e2=n,tO=Vm=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&e)!==0&&(Go=!0),n.firstContext=null)}function $s(n){var e=n._currentValue;if(tO!==n)if(n={context:n,memoizedValue:e,next:null},Vm===null){if(e2===null)throw Error(Ze(308));Vm=n,e2.dependencies={lanes:0,firstContext:n}}else Vm=Vm.next=n;return e}var rp=null;function rO(n){rp===null?rp=[n]:rp.push(n)}function g7(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,rO(e)):(t.next=r.next,r.next=t),e.interleaved=t,Zu(n,i)}function Zu(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Qc=!1;function oO(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _7(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ju(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function gh(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,(mn&2)!==0){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Zu(n,t)}return r=i.interleaved,r===null?(e.next=e,rO(i)):(e.next=r.next,r.next=e),i.interleaved=e,Zu(n,t)}function oM(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,W4(n,t)}}function LN(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var s={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?r=o=s:o=o.next=s,t=t.next}while(t!==null);o===null?r=o=e:o=o.next=e}else r=o=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function t2(n,e,t,i){var r=n.updateQueue;Qc=!1;var o=r.firstBaseUpdate,s=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,s===null?o=u:s.next=u,s=l;var c=n.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==s&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var h=r.baseState;s=0,c=u=l=null,a=o;do{var p=a.lane,m=a.eventTime;if((i&p)===p){c!==null&&(c=c.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,_=a;switch(p=e,m=t,_.tag){case 1:if(y=_.payload,typeof y=="function"){h=y.call(m,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=_.payload,p=typeof y=="function"?y.call(m,h,p):y,p==null)break e;h=pi({},h,p);break e;case 2:Qc=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=r.effects,p===null?r.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=m,l=h):c=c.next=m,s|=p;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;p=a,a=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(1);if(c===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,e=r.shared.interleaved,e!==null){r=e;do s|=r.lane,r=r.next;while(r!==e)}else o===null&&(r.shared.lanes=0);Mp|=s,n.lanes=s,n.memoizedState=h}}function DN(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(Ze(191,r));r.call(i)}}}var y7=new g9.Component().refs;function wD(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:pi({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var aC={isMounted:function(n){return(n=n._reactInternals)?Fp(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=So(),r=yh(n),o=ju(i,r);o.payload=e,t!=null&&(o.callback=t),e=gh(n,o,r),e!==null&&(Va(e,n,r,i),oM(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=So(),r=yh(n),o=ju(i,r);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=gh(n,o,r),e!==null&&(Va(e,n,r,i),oM(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=So(),i=yh(n),r=ju(t,i);r.tag=2,e!=null&&(r.callback=e),e=gh(n,r,i),e!==null&&(Va(e,n,i,t),oM(e,n,i))}};function RN(n,e,t,i,r,o,s){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,o,s):e.prototype&&e.prototype.isPureReactComponent?!vy(t,i)||!vy(r,o):!0}function x7(n,e,t){var i=!1,r=Ph,o=e.contextType;return typeof o=="object"&&o!==null?o=$s(o):(r=Yo(e)?bp:oo.current,i=e.contextTypes,o=(i=i!=null)?Mv(n,r):Ph),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=aC,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=o),e}function ON(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&aC.enqueueReplaceState(e,e.state,null)}function SD(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs=y7,oO(n);var o=e.contextType;typeof o=="object"&&o!==null?r.context=$s(o):(o=Yo(e)?bp:oo.current,r.context=Mv(n,o)),r.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(wD(n,e,o,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&aC.enqueueReplaceState(r,r.state,null),t2(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function O0(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Ze(309));var i=t.stateNode}if(!i)throw Error(Ze(147,n));var r=i,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=r.refs;a===y7&&(a=r.refs={}),s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof n!="string")throw Error(Ze(284));if(!t._owner)throw Error(Ze(290,n))}return n}function Hb(n,e){throw n=Object.prototype.toString.call(e),Error(Ze(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function kN(n){var e=n._init;return e(n._payload)}function b7(n){function e(b,w){if(n){var M=b.deletions;M===null?(b.deletions=[w],b.flags|=16):M.push(w)}}function t(b,w){if(!n)return null;for(;w!==null;)e(b,w),w=w.sibling;return null}function i(b,w){for(b=new Map;w!==null;)w.key!==null?b.set(w.key,w):b.set(w.index,w),w=w.sibling;return b}function r(b,w){return b=xh(b,w),b.index=0,b.sibling=null,b}function o(b,w,M){return b.index=M,n?(M=b.alternate,M!==null?(M=M.index,M<w?(b.flags|=2,w):M):(b.flags|=2,w)):(b.flags|=1048576,w)}function s(b){return n&&b.alternate===null&&(b.flags|=2),b}function a(b,w,M,C){return w===null||w.tag!==6?(w=xP(M,b.mode,C),w.return=b,w):(w=r(w,M),w.return=b,w)}function l(b,w,M,C){var P=M.type;return P===Lm?c(b,w,M.props.children,C,M.key):w!==null&&(w.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Jc&&kN(P)===w.type)?(C=r(w,M.props),C.ref=O0(b,w,M),C.return=b,C):(C=hM(M.type,M.key,M.props,null,b.mode,C),C.ref=O0(b,w,M),C.return=b,C)}function u(b,w,M,C){return w===null||w.tag!==4||w.stateNode.containerInfo!==M.containerInfo||w.stateNode.implementation!==M.implementation?(w=bP(M,b.mode,C),w.return=b,w):(w=r(w,M.children||[]),w.return=b,w)}function c(b,w,M,C,P){return w===null||w.tag!==7?(w=pp(M,b.mode,C,P),w.return=b,w):(w=r(w,M),w.return=b,w)}function h(b,w,M){if(typeof w=="string"&&w!==""||typeof w=="number")return w=xP(""+w,b.mode,M),w.return=b,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Rb:return M=hM(w.type,w.key,w.props,null,b.mode,M),M.ref=O0(b,null,w),M.return=b,M;case Am:return w=bP(w,b.mode,M),w.return=b,w;case Jc:var C=w._init;return h(b,C(w._payload),M)}if(p_(w)||P0(w))return w=pp(w,b.mode,M,null),w.return=b,w;Hb(b,w)}return null}function p(b,w,M,C){var P=w!==null?w.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return P!==null?null:a(b,w,""+M,C);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Rb:return M.key===P?l(b,w,M,C):null;case Am:return M.key===P?u(b,w,M,C):null;case Jc:return P=M._init,p(b,w,P(M._payload),C)}if(p_(M)||P0(M))return P!==null?null:c(b,w,M,C,null);Hb(b,M)}return null}function m(b,w,M,C,P){if(typeof C=="string"&&C!==""||typeof C=="number")return b=b.get(M)||null,a(w,b,""+C,P);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Rb:return b=b.get(C.key===null?M:C.key)||null,l(w,b,C,P);case Am:return b=b.get(C.key===null?M:C.key)||null,u(w,b,C,P);case Jc:var L=C._init;return m(b,w,M,L(C._payload),P)}if(p_(C)||P0(C))return b=b.get(M)||null,c(w,b,C,P,null);Hb(w,C)}return null}function y(b,w,M,C){for(var P=null,L=null,R=w,E=w=0,D=null;R!==null&&E<M.length;E++){R.index>E?(D=R,R=null):D=R.sibling;var N=p(b,R,M[E],C);if(N===null){R===null&&(R=D);break}n&&R&&N.alternate===null&&e(b,R),w=o(N,w,E),L===null?P=N:L.sibling=N,L=N,R=D}if(E===M.length)return t(b,R),ni&&Yd(b,E),P;if(R===null){for(;E<M.length;E++)R=h(b,M[E],C),R!==null&&(w=o(R,w,E),L===null?P=R:L.sibling=R,L=R);return ni&&Yd(b,E),P}for(R=i(b,R);E<M.length;E++)D=m(R,b,E,M[E],C),D!==null&&(n&&D.alternate!==null&&R.delete(D.key===null?E:D.key),w=o(D,w,E),L===null?P=D:L.sibling=D,L=D);return n&&R.forEach(function(j){return e(b,j)}),ni&&Yd(b,E),P}function _(b,w,M,C){var P=P0(M);if(typeof P!="function")throw Error(Ze(150));if(M=P.call(M),M==null)throw Error(Ze(151));for(var L=P=null,R=w,E=w=0,D=null,N=M.next();R!==null&&!N.done;E++,N=M.next()){R.index>E?(D=R,R=null):D=R.sibling;var j=p(b,R,N.value,C);if(j===null){R===null&&(R=D);break}n&&R&&j.alternate===null&&e(b,R),w=o(j,w,E),L===null?P=j:L.sibling=j,L=j,R=D}if(N.done)return t(b,R),ni&&Yd(b,E),P;if(R===null){for(;!N.done;E++,N=M.next())N=h(b,N.value,C),N!==null&&(w=o(N,w,E),L===null?P=N:L.sibling=N,L=N);return ni&&Yd(b,E),P}for(R=i(b,R);!N.done;E++,N=M.next())N=m(R,b,E,N.value,C),N!==null&&(n&&N.alternate!==null&&R.delete(N.key===null?E:N.key),w=o(N,w,E),L===null?P=N:L.sibling=N,L=N);return n&&R.forEach(function(te){return e(b,te)}),ni&&Yd(b,E),P}function g(b,w,M,C){if(typeof M=="object"&&M!==null&&M.type===Lm&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case Rb:e:{for(var P=M.key,L=w;L!==null;){if(L.key===P){if(P=M.type,P===Lm){if(L.tag===7){t(b,L.sibling),w=r(L,M.props.children),w.return=b,b=w;break e}}else if(L.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Jc&&kN(P)===L.type){t(b,L.sibling),w=r(L,M.props),w.ref=O0(b,L,M),w.return=b,b=w;break e}t(b,L);break}else e(b,L);L=L.sibling}M.type===Lm?(w=pp(M.props.children,b.mode,C,M.key),w.return=b,b=w):(C=hM(M.type,M.key,M.props,null,b.mode,C),C.ref=O0(b,w,M),C.return=b,b=C)}return s(b);case Am:e:{for(L=M.key;w!==null;){if(w.key===L)if(w.tag===4&&w.stateNode.containerInfo===M.containerInfo&&w.stateNode.implementation===M.implementation){t(b,w.sibling),w=r(w,M.children||[]),w.return=b,b=w;break e}else{t(b,w);break}else e(b,w);w=w.sibling}w=bP(M,b.mode,C),w.return=b,b=w}return s(b);case Jc:return L=M._init,g(b,w,L(M._payload),C)}if(p_(M))return y(b,w,M,C);if(P0(M))return _(b,w,M,C);Hb(b,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,w!==null&&w.tag===6?(t(b,w.sibling),w=r(w,M),w.return=b,b=w):(t(b,w),w=xP(M,b.mode,C),w.return=b,b=w),s(b)):t(b,w)}return g}var Ev=b7(!0),w7=b7(!1),nx={},Ml=Fh(nx),xy=Fh(nx),by=Fh(nx);function op(n){if(n===nx)throw Error(Ze(174));return n}function sO(n,e){switch(Xn(by,e),Xn(xy,n),Xn(Ml,nx),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:tD(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=tD(e,n)}$n(Ml),Xn(Ml,e)}function Tv(){$n(Ml),$n(xy),$n(by)}function S7(n){op(by.current);var e=op(Ml.current),t=tD(e,n.type);e!==t&&(Xn(xy,n),Xn(Ml,t))}function aO(n){xy.current===n&&($n(Ml),$n(xy))}var li=Fh(0);function n2(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var fP=[];function lO(){for(var n=0;n<fP.length;n++)fP[n]._workInProgressVersionPrimary=null;fP.length=0}var sM=tc.ReactCurrentDispatcher,mP=tc.ReactCurrentBatchConfig,Sp=0,hi=null,nr=null,_r=null,i2=!1,I_=!1,wy=0,Qee=0;function Yr(){throw Error(Ze(321))}function uO(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ha(n[t],e[t]))return!1;return!0}function cO(n,e,t,i,r,o){if(Sp=o,hi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sM.current=n===null||n.memoizedState===null?nte:ite,n=t(i,r),I_){o=0;do{if(I_=!1,wy=0,25<=o)throw Error(Ze(301));o+=1,_r=nr=null,e.updateQueue=null,sM.current=rte,n=t(i,r)}while(I_)}if(sM.current=r2,e=nr!==null&&nr.next!==null,Sp=0,_r=nr=hi=null,i2=!1,e)throw Error(Ze(300));return n}function hO(){var n=wy!==0;return wy=0,n}function ul(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _r===null?hi.memoizedState=_r=n:_r=_r.next=n,_r}function ea(){if(nr===null){var n=hi.alternate;n=n!==null?n.memoizedState:null}else n=nr.next;var e=_r===null?hi.memoizedState:_r.next;if(e!==null)_r=e,nr=n;else{if(n===null)throw Error(Ze(310));nr=n,n={memoizedState:nr.memoizedState,baseState:nr.baseState,baseQueue:nr.baseQueue,queue:nr.queue,next:null},_r===null?hi.memoizedState=_r=n:_r=_r.next=n}return _r}function Sy(n,e){return typeof e=="function"?e(n):e}function vP(n){var e=ea(),t=e.queue;if(t===null)throw Error(Ze(311));t.lastRenderedReducer=n;var i=nr,r=i.baseQueue,o=t.pending;if(o!==null){if(r!==null){var s=r.next;r.next=o.next,o.next=s}i.baseQueue=r=o,t.pending=null}if(r!==null){o=r.next,i=i.baseState;var a=s=null,l=null,u=o;do{var c=u.lane;if((Sp&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:n(i,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,s=i):l=l.next=h,hi.lanes|=c,Mp|=c}u=u.next}while(u!==null&&u!==o);l===null?s=i:l.next=a,Ha(i,e.memoizedState)||(Go=!0),e.memoizedState=i,e.baseState=s,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do o=r.lane,hi.lanes|=o,Mp|=o,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function gP(n){var e=ea(),t=e.queue;if(t===null)throw Error(Ze(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,o=e.memoizedState;if(r!==null){t.pending=null;var s=r=r.next;do o=n(o,s.action),s=s.next;while(s!==r);Ha(o,e.memoizedState)||(Go=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,i]}function M7(){}function C7(n,e){var t=hi,i=ea(),r=e(),o=!Ha(i.memoizedState,r);if(o&&(i.memoizedState=r,Go=!0),i=i.queue,dO(P7.bind(null,t,i,n),[n]),i.getSnapshot!==e||o||_r!==null&&_r.memoizedState.tag&1){if(t.flags|=2048,My(9,T7.bind(null,t,i,r,e),void 0,null),Cr===null)throw Error(Ze(349));(Sp&30)!==0||E7(t,e,r)}return r}function E7(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=hi.updateQueue,e===null?(e={lastEffect:null,stores:null},hi.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function T7(n,e,t,i){e.value=t,e.getSnapshot=i,A7(e)&&L7(n)}function P7(n,e,t){return t(function(){A7(e)&&L7(n)})}function A7(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ha(n,t)}catch{return!0}}function L7(n){var e=Zu(n,1);e!==null&&Va(e,n,1,-1)}function IN(n){var e=ul();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sy,lastRenderedState:n},e.queue=n,n=n.dispatch=tte.bind(null,hi,n),[e.memoizedState,n]}function My(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=hi.updateQueue,e===null?(e={lastEffect:null,stores:null},hi.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function D7(){return ea().memoizedState}function aM(n,e,t,i){var r=ul();hi.flags|=n,r.memoizedState=My(1|e,t,void 0,i===void 0?null:i)}function lC(n,e,t,i){var r=ea();i=i===void 0?null:i;var o=void 0;if(nr!==null){var s=nr.memoizedState;if(o=s.destroy,i!==null&&uO(i,s.deps)){r.memoizedState=My(e,t,o,i);return}}hi.flags|=n,r.memoizedState=My(1|e,t,o,i)}function NN(n,e){return aM(8390656,8,n,e)}function dO(n,e){return lC(2048,8,n,e)}function R7(n,e){return lC(4,2,n,e)}function O7(n,e){return lC(4,4,n,e)}function k7(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function I7(n,e,t){return t=t!=null?t.concat([n]):null,lC(4,4,k7.bind(null,e,n),t)}function pO(){}function N7(n,e){var t=ea();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&uO(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function z7(n,e){var t=ea();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&uO(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function V7(n,e,t){return(Sp&21)===0?(n.baseState&&(n.baseState=!1,Go=!0),n.memoizedState=t):(Ha(t,e)||(t=U9(),hi.lanes|=t,Mp|=t,n.baseState=!0),e)}function $ee(n,e){var t=On;On=t!==0&&4>t?t:4,n(!0);var i=mP.transition;mP.transition={};try{n(!1),e()}finally{On=t,mP.transition=i}}function F7(){return ea().memoizedState}function ete(n,e,t){var i=yh(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},B7(n))U7(e,t);else if(t=g7(n,e,t,i),t!==null){var r=So();Va(t,n,i,r),j7(t,e,i)}}function tte(n,e,t){var i=yh(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(B7(n))U7(e,r);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,t);if(r.hasEagerState=!0,r.eagerState=a,Ha(a,s)){var l=e.interleaved;l===null?(r.next=r,rO(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=g7(n,e,r,i),t!==null&&(r=So(),Va(t,n,i,r),j7(t,e,i))}}function B7(n){var e=n.alternate;return n===hi||e!==null&&e===hi}function U7(n,e){I_=i2=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function j7(n,e,t){if((t&4194240)!==0){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,W4(n,t)}}var r2={readContext:$s,useCallback:Yr,useContext:Yr,useEffect:Yr,useImperativeHandle:Yr,useInsertionEffect:Yr,useLayoutEffect:Yr,useMemo:Yr,useReducer:Yr,useRef:Yr,useState:Yr,useDebugValue:Yr,useDeferredValue:Yr,useTransition:Yr,useMutableSource:Yr,useSyncExternalStore:Yr,useId:Yr,unstable_isNewReconciler:!1},nte={readContext:$s,useCallback:function(n,e){return ul().memoizedState=[n,e===void 0?null:e],n},useContext:$s,useEffect:NN,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,aM(4194308,4,k7.bind(null,e,n),t)},useLayoutEffect:function(n,e){return aM(4194308,4,n,e)},useInsertionEffect:function(n,e){return aM(4,2,n,e)},useMemo:function(n,e){var t=ul();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=ul();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=ete.bind(null,hi,n),[i.memoizedState,n]},useRef:function(n){var e=ul();return n={current:n},e.memoizedState=n},useState:IN,useDebugValue:pO,useDeferredValue:function(n){return ul().memoizedState=n},useTransition:function(){var n=IN(!1),e=n[0];return n=$ee.bind(null,n[1]),ul().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=hi,r=ul();if(ni){if(t===void 0)throw Error(Ze(407));t=t()}else{if(t=e(),Cr===null)throw Error(Ze(349));(Sp&30)!==0||E7(i,e,t)}r.memoizedState=t;var o={value:t,getSnapshot:e};return r.queue=o,NN(P7.bind(null,i,o,n),[n]),i.flags|=2048,My(9,T7.bind(null,i,o,t,e),void 0,null),t},useId:function(){var n=ul(),e=Cr.identifierPrefix;if(ni){var t=Fu,i=Vu;t=(i&~(1<<32-za(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=wy++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Qee++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},ite={readContext:$s,useCallback:N7,useContext:$s,useEffect:dO,useImperativeHandle:I7,useInsertionEffect:R7,useLayoutEffect:O7,useMemo:z7,useReducer:vP,useRef:D7,useState:function(){return vP(Sy)},useDebugValue:pO,useDeferredValue:function(n){var e=ea();return V7(e,nr.memoizedState,n)},useTransition:function(){var n=vP(Sy)[0],e=ea().memoizedState;return[n,e]},useMutableSource:M7,useSyncExternalStore:C7,useId:F7,unstable_isNewReconciler:!1},rte={readContext:$s,useCallback:N7,useContext:$s,useEffect:dO,useImperativeHandle:I7,useInsertionEffect:R7,useLayoutEffect:O7,useMemo:z7,useReducer:gP,useRef:D7,useState:function(){return gP(Sy)},useDebugValue:pO,useDeferredValue:function(n){var e=ea();return nr===null?e.memoizedState=n:V7(e,nr.memoizedState,n)},useTransition:function(){var n=gP(Sy)[0],e=ea().memoizedState;return[n,e]},useMutableSource:M7,useSyncExternalStore:C7,useId:F7,unstable_isNewReconciler:!1};function Pv(n,e){try{var t="",i=e;do t+=R$(i),i=i.return;while(i);var r=t}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:r,digest:null}}function _P(n,e,t){return{value:n,source:null,stack:t!=null?t:null,digest:e!=null?e:null}}function MD(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var ote=typeof WeakMap=="function"?WeakMap:Map;function H7(n,e,t){t=ju(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){s2||(s2=!0,kD=i),MD(n,e)},t}function W7(n,e,t){t=ju(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){MD(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){MD(n,e),typeof i!="function"&&(_h===null?_h=new Set([this]):_h.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),t}function zN(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new ote;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=yte.bind(null,n,e,t),e.then(n,n))}function VN(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function FN(n,e,t,i,r){return(n.mode&1)===0?(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=ju(-1,1),e.tag=2,gh(t,e,1))),t.lanes|=1),n):(n.flags|=65536,n.lanes=r,n)}var ste=tc.ReactCurrentOwner,Go=!1;function xo(n,e,t,i){e.child=n===null?w7(e,null,t,i):Ev(e,n.child,t,i)}function BN(n,e,t,i,r){t=t.render;var o=e.ref;return $m(e,r),i=cO(n,e,t,i,o,r),t=hO(),n!==null&&!Go?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Ju(n,e,r)):(ni&&t&&Q4(e),e.flags|=1,xo(n,e,i,r),e.child)}function UN(n,e,t,i,r){if(n===null){var o=t.type;return typeof o=="function"&&!bO(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,G7(n,e,o,i,r)):(n=hM(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,(n.lanes&r)===0){var s=o.memoizedProps;if(t=t.compare,t=t!==null?t:vy,t(s,i)&&n.ref===e.ref)return Ju(n,e,r)}return e.flags|=1,n=xh(o,i),n.ref=e.ref,n.return=e,e.child=n}function G7(n,e,t,i,r){if(n!==null){var o=n.memoizedProps;if(vy(o,i)&&n.ref===e.ref)if(Go=!1,e.pendingProps=i=o,(n.lanes&r)!==0)(n.flags&131072)!==0&&(Go=!0);else return e.lanes=n.lanes,Ju(n,e,r)}return CD(n,e,t,i,r)}function X7(n,e,t){var i=e.pendingProps,r=i.children,o=n!==null?n.memoizedState:null;if(i.mode==="hidden")if((e.mode&1)===0)e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xn(Bm,ps),ps|=t;else{if((t&1073741824)===0)return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Xn(Bm,ps),ps|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=o!==null?o.baseLanes:t,Xn(Bm,ps),ps|=i}else o!==null?(i=o.baseLanes|t,e.memoizedState=null):i=t,Xn(Bm,ps),ps|=i;return xo(n,e,r,t),e.child}function q7(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function CD(n,e,t,i,r){var o=Yo(t)?bp:oo.current;return o=Mv(e,o),$m(e,r),t=cO(n,e,t,i,o,r),i=hO(),n!==null&&!Go?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Ju(n,e,r)):(ni&&i&&Q4(e),e.flags|=1,xo(n,e,t,r),e.child)}function jN(n,e,t,i,r){if(Yo(t)){var o=!0;ZM(e)}else o=!1;if($m(e,r),e.stateNode===null)lM(n,e),x7(e,t,i),SD(e,t,i,r),i=!0;else if(n===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=t.contextType;typeof u=="object"&&u!==null?u=$s(u):(u=Yo(t)?bp:oo.current,u=Mv(e,u));var c=t.getDerivedStateFromProps,h=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==i||l!==u)&&ON(e,s,i,u),Qc=!1;var p=e.memoizedState;s.state=p,t2(e,i,s,r),l=e.memoizedState,a!==i||p!==l||qo.current||Qc?(typeof c=="function"&&(wD(e,t,c,i),l=e.memoizedState),(a=Qc||RN(e,t,a,i,p,l,u))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),s.props=i,s.state=l,s.context=u,i=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{s=e.stateNode,_7(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Aa(e.type,a),s.props=u,h=e.pendingProps,p=s.context,l=t.contextType,typeof l=="object"&&l!==null?l=$s(l):(l=Yo(t)?bp:oo.current,l=Mv(e,l));var m=t.getDerivedStateFromProps;(c=typeof m=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==h||p!==l)&&ON(e,s,i,l),Qc=!1,p=e.memoizedState,s.state=p,t2(e,i,s,r);var y=e.memoizedState;a!==h||p!==y||qo.current||Qc?(typeof m=="function"&&(wD(e,t,m,i),y=e.memoizedState),(u=Qc||RN(e,t,u,i,p,y,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(i,y,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(i,y,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=y),s.props=i,s.state=y,s.context=l,i=u):(typeof s.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),i=!1)}return ED(n,e,t,i,o,r)}function ED(n,e,t,i,r,o){q7(n,e);var s=(e.flags&128)!==0;if(!i&&!s)return r&&TN(e,t,!1),Ju(n,e,o);i=e.stateNode,ste.current=e;var a=s&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&s?(e.child=Ev(e,n.child,null,o),e.child=Ev(e,null,a,o)):xo(n,e,a,o),e.memoizedState=i.state,r&&TN(e,t,!0),e.child}function Y7(n){var e=n.stateNode;e.pendingContext?EN(n,e.pendingContext,e.pendingContext!==e.context):e.context&&EN(n,e.context,!1),sO(n,e.containerInfo)}function HN(n,e,t,i,r){return Cv(),eO(r),e.flags|=256,xo(n,e,t,i),e.child}var TD={dehydrated:null,treeContext:null,retryLane:0};function PD(n){return{baseLanes:n,cachePool:null,transitions:null}}function K7(n,e,t){var i=e.pendingProps,r=li.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Xn(li,r&1),n===null)return xD(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((e.mode&1)===0?e.lanes=1:n.data==="$!"?e.lanes=8:e.lanes=1073741824,null):(s=i.children,n=i.fallback,o?(i=e.mode,o=e.child,s={mode:"hidden",children:s},(i&1)===0&&o!==null?(o.childLanes=0,o.pendingProps=s):o=hC(s,i,0,null),n=pp(n,i,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=PD(t),e.memoizedState=TD,n):fO(e,s));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return ate(n,e,s,i,a,r,t);if(o){o=i.fallback,s=e.mode,r=n.child,a=r.sibling;var l={mode:"hidden",children:i.children};return(s&1)===0&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=xh(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?o=xh(a,o):(o=pp(o,s,t,null),o.flags|=2),o.return=e,i.return=e,i.sibling=o,e.child=i,i=o,o=e.child,s=n.child.memoizedState,s=s===null?PD(t):{baseLanes:s.baseLanes|t,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=n.childLanes&~t,e.memoizedState=TD,i}return o=n.child,n=o.sibling,i=xh(o,{mode:"visible",children:i.children}),(e.mode&1)===0&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function fO(n,e){return e=hC({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Wb(n,e,t,i){return i!==null&&eO(i),Ev(e,n.child,null,t),n=fO(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function ate(n,e,t,i,r,o,s){if(t)return e.flags&256?(e.flags&=-257,i=_P(Error(Ze(422))),Wb(n,e,s,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=i.fallback,r=e.mode,i=hC({mode:"visible",children:i.children},r,0,null),o=pp(o,r,s,null),o.flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,(e.mode&1)!==0&&Ev(e,n.child,null,s),e.child.memoizedState=PD(s),e.memoizedState=TD,o);if((e.mode&1)===0)return Wb(n,e,s,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,o=Error(Ze(419)),i=_P(o,i,void 0),Wb(n,e,s,i)}if(a=(s&n.childLanes)!==0,Go||a){if(i=Cr,i!==null){switch(s&-s){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=(r&(i.suspendedLanes|s))!==0?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,Zu(n,r),Va(i,n,r,-1))}return xO(),i=_P(Error(Ze(421))),Wb(n,e,s,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=xte.bind(null,n),r._reactRetry=e,null):(n=o.treeContext,_s=vh(r.nextSibling),bs=e,ni=!0,Ra=null,n!==null&&(Hs[Ws++]=Vu,Hs[Ws++]=Fu,Hs[Ws++]=wp,Vu=n.id,Fu=n.overflow,wp=e),e=fO(e,i.children),e.flags|=4096,e)}function WN(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),bD(n.return,e,t)}function yP(n,e,t,i,r){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=t,o.tailMode=r)}function Z7(n,e,t){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(xo(n,e,i.children,t),i=li.current,(i&2)!==0)i=i&1|2,e.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&WN(n,t,e);else if(n.tag===19)WN(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Xn(li,i),(e.mode&1)===0)e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&n2(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),yP(e,!1,r,t,o);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&n2(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}yP(e,!0,t,null,o);break;case"together":yP(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function lM(n,e){(e.mode&1)===0&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ju(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Mp|=e.lanes,(t&e.childLanes)===0)return null;if(n!==null&&e.child!==n.child)throw Error(Ze(153));if(e.child!==null){for(n=e.child,t=xh(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=xh(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function lte(n,e,t){switch(e.tag){case 3:Y7(e),Cv();break;case 5:S7(e);break;case 1:Yo(e.type)&&ZM(e);break;case 4:sO(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Xn($M,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Xn(li,li.current&1),e.flags|=128,null):(t&e.child.childLanes)!==0?K7(n,e,t):(Xn(li,li.current&1),n=Ju(n,e,t),n!==null?n.sibling:null);Xn(li,li.current&1);break;case 19:if(i=(t&e.childLanes)!==0,(n.flags&128)!==0){if(i)return Z7(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Xn(li,li.current),i)break;return null;case 22:case 23:return e.lanes=0,X7(n,e,t)}return Ju(n,e,t)}var J7,AD,Q7,$7;J7=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};AD=function(){};Q7=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,op(Ml.current);var o=null;switch(t){case"input":r=JL(n,r),i=JL(n,i),o=[];break;case"select":r=pi({},r,{value:void 0}),i=pi({},i,{value:void 0}),o=[];break;case"textarea":r=eD(n,r),i=eD(n,i),o=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=YM)}nD(t,i);var s;t=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(s in a)a.hasOwnProperty(s)&&(t||(t={}),t[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(uy.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(t||(t={}),t[s]=l[s])}else t||(o||(o=[]),o.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(uy.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Jn("scroll",n),o||a===l||(o=[])):(o=o||[]).push(u,l))}t&&(o=o||[]).push("style",t);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};$7=function(n,e,t,i){t!==i&&(e.flags|=4)};function k0(n,e){if(!ni)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Kr(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function ute(n,e,t){var i=e.pendingProps;switch($4(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kr(e),null;case 1:return Yo(e.type)&&KM(),Kr(e),null;case 3:return i=e.stateNode,Tv(),$n(qo),$n(oo),lO(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(jb(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,Ra!==null&&(zD(Ra),Ra=null))),AD(n,e),Kr(e),null;case 5:aO(e);var r=op(by.current);if(t=e.type,n!==null&&e.stateNode!=null)Q7(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(Ze(166));return Kr(e),null}if(n=op(Ml.current),jb(e)){i=e.stateNode,t=e.type;var o=e.memoizedProps;switch(i[gl]=e,i[yy]=o,n=(e.mode&1)!==0,t){case"dialog":Jn("cancel",i),Jn("close",i);break;case"iframe":case"object":case"embed":Jn("load",i);break;case"video":case"audio":for(r=0;r<m_.length;r++)Jn(m_[r],i);break;case"source":Jn("error",i);break;case"img":case"image":case"link":Jn("error",i),Jn("load",i);break;case"details":Jn("toggle",i);break;case"input":$5(i,o),Jn("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Jn("invalid",i);break;case"textarea":tN(i,o),Jn("invalid",i)}nD(t,o),r=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?i.textContent!==a&&(o.suppressHydrationWarning!==!0&&Ub(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Ub(i.textContent,a,n),r=["children",""+a]):uy.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Jn("scroll",i)}switch(t){case"input":Ob(i),eN(i,o,!0);break;case"textarea":Ob(i),nN(i);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(i.onclick=YM)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{s=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=E9(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=s.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=s.createElement(t,{is:i.is}):(n=s.createElement(t),t==="select"&&(s=n,i.multiple?s.multiple=!0:i.size&&(s.size=i.size))):n=s.createElementNS(n,t),n[gl]=e,n[yy]=i,J7(n,e,!1,!1),e.stateNode=n;e:{switch(s=iD(t,i),t){case"dialog":Jn("cancel",n),Jn("close",n),r=i;break;case"iframe":case"object":case"embed":Jn("load",n),r=i;break;case"video":case"audio":for(r=0;r<m_.length;r++)Jn(m_[r],n);r=i;break;case"source":Jn("error",n),r=i;break;case"img":case"image":case"link":Jn("error",n),Jn("load",n),r=i;break;case"details":Jn("toggle",n),r=i;break;case"input":$5(n,i),r=JL(n,i),Jn("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=pi({},i,{value:void 0}),Jn("invalid",n);break;case"textarea":tN(n,i),r=eD(n,i),Jn("invalid",n);break;default:r=i}nD(t,r),a=r;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?A9(n,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&T9(n,l)):o==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&cy(n,l):typeof l=="number"&&cy(n,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(uy.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Jn("scroll",n):l!=null&&V4(n,o,l,s))}switch(t){case"input":Ob(n),eN(n,i,!1);break;case"textarea":Ob(n),nN(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Th(i.value));break;case"select":n.multiple=!!i.multiple,o=i.value,o!=null?Km(n,!!i.multiple,o,!1):i.defaultValue!=null&&Km(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=YM)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Kr(e),null;case 6:if(n&&e.stateNode!=null)$7(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Ze(166));if(t=op(by.current),op(Ml.current),jb(e)){if(i=e.stateNode,t=e.memoizedProps,i[gl]=e,(o=i.nodeValue!==t)&&(n=bs,n!==null))switch(n.tag){case 3:Ub(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Ub(i.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[gl]=e,e.stateNode=i}return Kr(e),null;case 13:if($n(li),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ni&&_s!==null&&(e.mode&1)!==0&&(e.flags&128)===0)v7(),Cv(),e.flags|=98560,o=!1;else if(o=jb(e),i!==null&&i.dehydrated!==null){if(n===null){if(!o)throw Error(Ze(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Ze(317));o[gl]=e}else Cv(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;Kr(e),o=!1}else Ra!==null&&(zD(Ra),Ra=null),o=!0;if(!o)return e.flags&65536?e:null}return(e.flags&128)!==0?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,(e.mode&1)!==0&&(n===null||(li.current&1)!==0?sr===0&&(sr=3):xO())),e.updateQueue!==null&&(e.flags|=4),Kr(e),null);case 4:return Tv(),AD(n,e),n===null&&gy(e.stateNode.containerInfo),Kr(e),null;case 10:return iO(e.type._context),Kr(e),null;case 17:return Yo(e.type)&&KM(),Kr(e),null;case 19:if($n(li),o=e.memoizedState,o===null)return Kr(e),null;if(i=(e.flags&128)!==0,s=o.rendering,s===null)if(i)k0(o,!1);else{if(sr!==0||n!==null&&(n.flags&128)!==0)for(n=e.child;n!==null;){if(s=n2(n),s!==null){for(e.flags|=128,k0(o,!1),i=s.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)o=t,n=i,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,n=s.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Xn(li,li.current&1|2),e.child}n=n.sibling}o.tail!==null&&Oi()>Av&&(e.flags|=128,i=!0,k0(o,!1),e.lanes=4194304)}else{if(!i)if(n=n2(s),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),k0(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!ni)return Kr(e),null}else 2*Oi()-o.renderingStartTime>Av&&t!==1073741824&&(e.flags|=128,i=!0,k0(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(t=o.last,t!==null?t.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Oi(),e.sibling=null,t=li.current,Xn(li,i?t&1|2:t&1),e):(Kr(e),null);case 22:case 23:return yO(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&(e.mode&1)!==0?(ps&1073741824)!==0&&(Kr(e),e.subtreeFlags&6&&(e.flags|=8192)):Kr(e),null;case 24:return null;case 25:return null}throw Error(Ze(156,e.tag))}function cte(n,e){switch($4(e),e.tag){case 1:return Yo(e.type)&&KM(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Tv(),$n(qo),$n(oo),lO(),n=e.flags,(n&65536)!==0&&(n&128)===0?(e.flags=n&-65537|128,e):null;case 5:return aO(e),null;case 13:if($n(li),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(Ze(340));Cv()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return $n(li),null;case 4:return Tv(),null;case 10:return iO(e.type._context),null;case 22:case 23:return yO(),null;case 24:return null;default:return null}}var Gb=!1,no=!1,hte=typeof WeakSet=="function"?WeakSet:Set,xt=null;function Fm(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){wi(n,e,i)}else t.current=null}function LD(n,e,t){try{t()}catch(i){wi(n,e,i)}}var GN=!1;function dte(n,e){if(pD=GM,n=i7(),J4(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var s=0,a=-1,l=-1,u=0,c=0,h=n,p=null;t:for(;;){for(var m;h!==t||r!==0&&h.nodeType!==3||(a=s+r),h!==o||i!==0&&h.nodeType!==3||(l=s+i),h.nodeType===3&&(s+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===n)break t;if(p===t&&++u===r&&(a=s),p===o&&++c===i&&(l=s),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(fD={focusedElem:n,selectionRange:t},GM=!1,xt=e;xt!==null;)if(e=xt,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,xt=n;else for(;xt!==null;){e=xt;try{var y=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var _=y.memoizedProps,g=y.memoizedState,b=e.stateNode,w=b.getSnapshotBeforeUpdate(e.elementType===e.type?_:Aa(e.type,_),g);b.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var M=e.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ze(163))}}catch(C){wi(e,e.return,C)}if(n=e.sibling,n!==null){n.return=e.return,xt=n;break}xt=e.return}return y=GN,GN=!1,y}function N_(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var o=r.destroy;r.destroy=void 0,o!==void 0&&LD(e,t,o)}r=r.next}while(r!==i)}}function uC(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function DD(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function ej(n){var e=n.alternate;e!==null&&(n.alternate=null,ej(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[gl],delete e[yy],delete e[gD],delete e[Yee],delete e[Kee])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function tj(n){return n.tag===5||n.tag===3||n.tag===4}function XN(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||tj(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function RD(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=YM));else if(i!==4&&(n=n.child,n!==null))for(RD(n,e,t),n=n.sibling;n!==null;)RD(n,e,t),n=n.sibling}function OD(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(OD(n,e,t),n=n.sibling;n!==null;)OD(n,e,t),n=n.sibling}var Ir=null,Da=!1;function Tc(n,e,t){for(t=t.child;t!==null;)nj(n,e,t),t=t.sibling}function nj(n,e,t){if(Sl&&typeof Sl.onCommitFiberUnmount=="function")try{Sl.onCommitFiberUnmount(tC,t)}catch{}switch(t.tag){case 5:no||Fm(t,e);case 6:var i=Ir,r=Da;Ir=null,Tc(n,e,t),Ir=i,Da=r,Ir!==null&&(Da?(n=Ir,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Ir.removeChild(t.stateNode));break;case 18:Ir!==null&&(Da?(n=Ir,t=t.stateNode,n.nodeType===8?dP(n.parentNode,t):n.nodeType===1&&dP(n,t),fy(n)):dP(Ir,t.stateNode));break;case 4:i=Ir,r=Da,Ir=t.stateNode.containerInfo,Da=!0,Tc(n,e,t),Ir=i,Da=r;break;case 0:case 11:case 14:case 15:if(!no&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var o=r,s=o.destroy;o=o.tag,s!==void 0&&((o&2)!==0||(o&4)!==0)&&LD(t,e,s),r=r.next}while(r!==i)}Tc(n,e,t);break;case 1:if(!no&&(Fm(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){wi(t,e,a)}Tc(n,e,t);break;case 21:Tc(n,e,t);break;case 22:t.mode&1?(no=(i=no)||t.memoizedState!==null,Tc(n,e,t),no=i):Tc(n,e,t);break;default:Tc(n,e,t)}}function qN(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new hte),e.forEach(function(i){var r=bte.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function ga(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var o=n,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:Ir=a.stateNode,Da=!1;break e;case 3:Ir=a.stateNode.containerInfo,Da=!0;break e;case 4:Ir=a.stateNode.containerInfo,Da=!0;break e}a=a.return}if(Ir===null)throw Error(Ze(160));nj(o,s,r),Ir=null,Da=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){wi(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ij(e,n),e=e.sibling}function ij(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(ga(e,n),al(n),i&4){try{N_(3,n,n.return),uC(3,n)}catch(_){wi(n,n.return,_)}try{N_(5,n,n.return)}catch(_){wi(n,n.return,_)}}break;case 1:ga(e,n),al(n),i&512&&t!==null&&Fm(t,t.return);break;case 5:if(ga(e,n),al(n),i&512&&t!==null&&Fm(t,t.return),n.flags&32){var r=n.stateNode;try{cy(r,"")}catch(_){wi(n,n.return,_)}}if(i&4&&(r=n.stateNode,r!=null)){var o=n.memoizedProps,s=t!==null?t.memoizedProps:o,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&M9(r,o),iD(a,s);var u=iD(a,o);for(s=0;s<l.length;s+=2){var c=l[s],h=l[s+1];c==="style"?A9(r,h):c==="dangerouslySetInnerHTML"?T9(r,h):c==="children"?cy(r,h):V4(r,c,h,u)}switch(a){case"input":QL(r,o);break;case"textarea":C9(r,o);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var m=o.value;m!=null?Km(r,!!o.multiple,m,!1):p!==!!o.multiple&&(o.defaultValue!=null?Km(r,!!o.multiple,o.defaultValue,!0):Km(r,!!o.multiple,o.multiple?[]:"",!1))}r[yy]=o}catch(_){wi(n,n.return,_)}}break;case 6:if(ga(e,n),al(n),i&4){if(n.stateNode===null)throw Error(Ze(162));r=n.stateNode,o=n.memoizedProps;try{r.nodeValue=o}catch(_){wi(n,n.return,_)}}break;case 3:if(ga(e,n),al(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{fy(e.containerInfo)}catch(_){wi(n,n.return,_)}break;case 4:ga(e,n),al(n);break;case 13:ga(e,n),al(n),r=n.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(gO=Oi())),i&4&&qN(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(no=(u=no)||c,ga(e,n),no=u):ga(e,n),al(n),i&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&(n.mode&1)!==0)for(xt=n,c=n.child;c!==null;){for(h=xt=c;xt!==null;){switch(p=xt,m=p.child,p.tag){case 0:case 11:case 14:case 15:N_(4,p,p.return);break;case 1:Fm(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){i=p,t=p.return;try{e=i,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(_){wi(i,t,_)}}break;case 5:Fm(p,p.return);break;case 22:if(p.memoizedState!==null){KN(h);continue}}m!==null?(m.return=p,xt=m):KN(h)}c=c.sibling}e:for(c=null,h=n;;){if(h.tag===5){if(c===null){c=h;try{r=h.stateNode,u?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=P9("display",s))}catch(_){wi(n,n.return,_)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(_){wi(n,n.return,_)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ga(e,n),al(n),i&4&&qN(n);break;case 21:break;default:ga(e,n),al(n)}}function al(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(tj(t)){var i=t;break e}t=t.return}throw Error(Ze(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(cy(r,""),i.flags&=-33);var o=XN(n);OD(n,o,r);break;case 3:case 4:var s=i.stateNode.containerInfo,a=XN(n);RD(n,a,s);break;default:throw Error(Ze(161))}}catch(l){wi(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function pte(n,e,t){xt=n,rj(n)}function rj(n,e,t){for(var i=(n.mode&1)!==0;xt!==null;){var r=xt,o=r.child;if(r.tag===22&&i){var s=r.memoizedState!==null||Gb;if(!s){var a=r.alternate,l=a!==null&&a.memoizedState!==null||no;a=Gb;var u=no;if(Gb=s,(no=l)&&!u)for(xt=r;xt!==null;)s=xt,l=s.child,s.tag===22&&s.memoizedState!==null?ZN(r):l!==null?(l.return=s,xt=l):ZN(r);for(;o!==null;)xt=o,rj(o),o=o.sibling;xt=r,Gb=a,no=u}YN(n)}else(r.subtreeFlags&8772)!==0&&o!==null?(o.return=r,xt=o):YN(n)}}function YN(n){for(;xt!==null;){var e=xt;if((e.flags&8772)!==0){var t=e.alternate;try{if((e.flags&8772)!==0)switch(e.tag){case 0:case 11:case 15:no||uC(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!no)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Aa(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&DN(e,o,i);break;case 3:var s=e.updateQueue;if(s!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}DN(e,s,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&fy(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ze(163))}no||e.flags&512&&DD(e)}catch(p){wi(e,e.return,p)}}if(e===n){xt=null;break}if(t=e.sibling,t!==null){t.return=e.return,xt=t;break}xt=e.return}}function KN(n){for(;xt!==null;){var e=xt;if(e===n){xt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,xt=t;break}xt=e.return}}function ZN(n){for(;xt!==null;){var e=xt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{uC(4,e)}catch(l){wi(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){wi(e,r,l)}}var o=e.return;try{DD(e)}catch(l){wi(e,o,l)}break;case 5:var s=e.return;try{DD(e)}catch(l){wi(e,s,l)}}}catch(l){wi(e,e.return,l)}if(e===n){xt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,xt=a;break}xt=e.return}}var fte=Math.ceil,o2=tc.ReactCurrentDispatcher,mO=tc.ReactCurrentOwner,Zs=tc.ReactCurrentBatchConfig,mn=0,Cr=null,Xi=null,Br=0,ps=0,Bm=Fh(0),sr=0,Cy=null,Mp=0,cC=0,vO=0,z_=null,jo=null,gO=0,Av=1/0,Au=null,s2=!1,kD=null,_h=null,Xb=!1,uh=null,a2=0,V_=0,ID=null,uM=-1,cM=0;function So(){return(mn&6)!==0?Oi():uM!==-1?uM:uM=Oi()}function yh(n){return(n.mode&1)===0?1:(mn&2)!==0&&Br!==0?Br&-Br:Jee.transition!==null?(cM===0&&(cM=U9()),cM):(n=On,n!==0||(n=window.event,n=n===void 0?16:Y9(n.type)),n)}function Va(n,e,t,i){if(50<V_)throw V_=0,ID=null,Error(Ze(185));$y(n,t,i),((mn&2)===0||n!==Cr)&&(n===Cr&&((mn&2)===0&&(cC|=t),sr===4&&ih(n,Br)),Ko(n,i),t===1&&mn===0&&(e.mode&1)===0&&(Av=Oi()+500,sC&&Bh()))}function Ko(n,e){var t=n.callbackNode;J$(n,e);var i=WM(n,n===Cr?Br:0);if(i===0)t!==null&&oN(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&oN(t),e===1)n.tag===0?Zee(JN.bind(null,n)):p7(JN.bind(null,n)),Xee(function(){(mn&6)===0&&Bh()}),t=null;else{switch(j9(i)){case 1:t=H4;break;case 4:t=F9;break;case 16:t=HM;break;case 536870912:t=B9;break;default:t=HM}t=dj(t,oj.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function oj(n,e){if(uM=-1,cM=0,(mn&6)!==0)throw Error(Ze(327));var t=n.callbackNode;if(ev()&&n.callbackNode!==t)return null;var i=WM(n,n===Cr?Br:0);if(i===0)return null;if((i&30)!==0||(i&n.expiredLanes)!==0||e)e=l2(n,i);else{e=i;var r=mn;mn|=2;var o=aj();(Cr!==n||Br!==e)&&(Au=null,Av=Oi()+500,dp(n,e));do try{gte();break}catch(a){sj(n,a)}while(1);nO(),o2.current=o,mn=r,Xi!==null?e=0:(Cr=null,Br=0,e=sr)}if(e!==0){if(e===2&&(r=lD(n),r!==0&&(i=r,e=ND(n,r))),e===1)throw t=Cy,dp(n,0),ih(n,i),Ko(n,Oi()),t;if(e===6)ih(n,i);else{if(r=n.current.alternate,(i&30)===0&&!mte(r)&&(e=l2(n,i),e===2&&(o=lD(n),o!==0&&(i=o,e=ND(n,o))),e===1))throw t=Cy,dp(n,0),ih(n,i),Ko(n,Oi()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(Ze(345));case 2:Kd(n,jo,Au);break;case 3:if(ih(n,i),(i&130023424)===i&&(e=gO+500-Oi(),10<e)){if(WM(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){So(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=vD(Kd.bind(null,n,jo,Au),e);break}Kd(n,jo,Au);break;case 4:if(ih(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var s=31-za(i);o=1<<s,s=e[s],s>r&&(r=s),i&=~o}if(i=r,i=Oi()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*fte(i/1960))-i,10<i){n.timeoutHandle=vD(Kd.bind(null,n,jo,Au),i);break}Kd(n,jo,Au);break;case 5:Kd(n,jo,Au);break;default:throw Error(Ze(329))}}}return Ko(n,Oi()),n.callbackNode===t?oj.bind(null,n):null}function ND(n,e){var t=z_;return n.current.memoizedState.isDehydrated&&(dp(n,e).flags|=256),n=l2(n,e),n!==2&&(e=jo,jo=t,e!==null&&zD(e)),n}function zD(n){jo===null?jo=n:jo.push.apply(jo,n)}function mte(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],o=r.getSnapshot;r=r.value;try{if(!Ha(o(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ih(n,e){for(e&=~vO,e&=~cC,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-za(e),i=1<<t;n[t]=-1,e&=~i}}function JN(n){if((mn&6)!==0)throw Error(Ze(327));ev();var e=WM(n,0);if((e&1)===0)return Ko(n,Oi()),null;var t=l2(n,e);if(n.tag!==0&&t===2){var i=lD(n);i!==0&&(e=i,t=ND(n,i))}if(t===1)throw t=Cy,dp(n,0),ih(n,e),Ko(n,Oi()),t;if(t===6)throw Error(Ze(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Kd(n,jo,Au),Ko(n,Oi()),null}function _O(n,e){var t=mn;mn|=1;try{return n(e)}finally{mn=t,mn===0&&(Av=Oi()+500,sC&&Bh())}}function Cp(n){uh!==null&&uh.tag===0&&(mn&6)===0&&ev();var e=mn;mn|=1;var t=Zs.transition,i=On;try{if(Zs.transition=null,On=1,n)return n()}finally{On=i,Zs.transition=t,mn=e,(mn&6)===0&&Bh()}}function yO(){ps=Bm.current,$n(Bm)}function dp(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Gee(t)),Xi!==null)for(t=Xi.return;t!==null;){var i=t;switch($4(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&KM();break;case 3:Tv(),$n(qo),$n(oo),lO();break;case 5:aO(i);break;case 4:Tv();break;case 13:$n(li);break;case 19:$n(li);break;case 10:iO(i.type._context);break;case 22:case 23:yO()}t=t.return}if(Cr=n,Xi=n=xh(n.current,null),Br=ps=e,sr=0,Cy=null,vO=cC=Mp=0,jo=z_=null,rp!==null){for(e=0;e<rp.length;e++)if(t=rp[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,o=t.pending;if(o!==null){var s=o.next;o.next=r,i.next=s}t.pending=i}rp=null}return n}function sj(n,e){do{var t=Xi;try{if(nO(),sM.current=r2,i2){for(var i=hi.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}i2=!1}if(Sp=0,_r=nr=hi=null,I_=!1,wy=0,mO.current=null,t===null||t.return===null){sr=1,Cy=e,Xi=null;break}e:{var o=n,s=t.return,a=t,l=e;if(e=Br,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if((c.mode&1)===0&&(h===0||h===11||h===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=VN(s);if(m!==null){m.flags&=-257,FN(m,s,a,o,e),m.mode&1&&zN(o,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var _=new Set;_.add(l),e.updateQueue=_}else y.add(l);break e}else{if((e&1)===0){zN(o,u,e),xO();break e}l=Error(Ze(426))}}else if(ni&&a.mode&1){var g=VN(s);if(g!==null){(g.flags&65536)===0&&(g.flags|=256),FN(g,s,a,o,e),eO(Pv(l,a));break e}}o=l=Pv(l,a),sr!==4&&(sr=2),z_===null?z_=[o]:z_.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var b=H7(o,l,e);LN(o,b);break e;case 1:a=l;var w=o.type,M=o.stateNode;if((o.flags&128)===0&&(typeof w.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(_h===null||!_h.has(M)))){o.flags|=65536,e&=-e,o.lanes|=e;var C=W7(o,a,e);LN(o,C);break e}}o=o.return}while(o!==null)}uj(t)}catch(P){e=P,Xi===t&&t!==null&&(Xi=t=t.return);continue}break}while(1)}function aj(){var n=o2.current;return o2.current=r2,n===null?r2:n}function xO(){(sr===0||sr===3||sr===2)&&(sr=4),Cr===null||(Mp&268435455)===0&&(cC&268435455)===0||ih(Cr,Br)}function l2(n,e){var t=mn;mn|=2;var i=aj();(Cr!==n||Br!==e)&&(Au=null,dp(n,e));do try{vte();break}catch(r){sj(n,r)}while(1);if(nO(),mn=t,o2.current=i,Xi!==null)throw Error(Ze(261));return Cr=null,Br=0,sr}function vte(){for(;Xi!==null;)lj(Xi)}function gte(){for(;Xi!==null&&!j$();)lj(Xi)}function lj(n){var e=hj(n.alternate,n,ps);n.memoizedProps=n.pendingProps,e===null?uj(n):Xi=e,mO.current=null}function uj(n){var e=n;do{var t=e.alternate;if(n=e.return,(e.flags&32768)===0){if(t=ute(t,e,ps),t!==null){Xi=t;return}}else{if(t=cte(t,e),t!==null){t.flags&=32767,Xi=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{sr=6,Xi=null;return}}if(e=e.sibling,e!==null){Xi=e;return}Xi=e=n}while(e!==null);sr===0&&(sr=5)}function Kd(n,e,t){var i=On,r=Zs.transition;try{Zs.transition=null,On=1,_te(n,e,t,i)}finally{Zs.transition=r,On=i}return null}function _te(n,e,t,i){do ev();while(uh!==null);if((mn&6)!==0)throw Error(Ze(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(Ze(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(Q$(n,o),n===Cr&&(Xi=Cr=null,Br=0),(t.subtreeFlags&2064)===0&&(t.flags&2064)===0||Xb||(Xb=!0,dj(HM,function(){return ev(),null})),o=(t.flags&15990)!==0,(t.subtreeFlags&15990)!==0||o){o=Zs.transition,Zs.transition=null;var s=On;On=1;var a=mn;mn|=4,mO.current=null,dte(n,t),ij(t,n),Vee(fD),GM=!!pD,fD=pD=null,n.current=t,pte(t),H$(),mn=a,On=s,Zs.transition=o}else n.current=t;if(Xb&&(Xb=!1,uh=n,a2=r),o=n.pendingLanes,o===0&&(_h=null),X$(t.stateNode),Ko(n,Oi()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(s2)throw s2=!1,n=kD,kD=null,n;return(a2&1)!==0&&n.tag!==0&&ev(),o=n.pendingLanes,(o&1)!==0?n===ID?V_++:(V_=0,ID=n):V_=0,Bh(),null}function ev(){if(uh!==null){var n=j9(a2),e=Zs.transition,t=On;try{if(Zs.transition=null,On=16>n?16:n,uh===null)var i=!1;else{if(n=uh,uh=null,a2=0,(mn&6)!==0)throw Error(Ze(331));var r=mn;for(mn|=4,xt=n.current;xt!==null;){var o=xt,s=o.child;if((xt.flags&16)!==0){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(xt=u;xt!==null;){var c=xt;switch(c.tag){case 0:case 11:case 15:N_(8,c,o)}var h=c.child;if(h!==null)h.return=c,xt=h;else for(;xt!==null;){c=xt;var p=c.sibling,m=c.return;if(ej(c),c===u){xt=null;break}if(p!==null){p.return=m,xt=p;break}xt=m}}}var y=o.alternate;if(y!==null){var _=y.child;if(_!==null){y.child=null;do{var g=_.sibling;_.sibling=null,_=g}while(_!==null)}}xt=o}}if((o.subtreeFlags&2064)!==0&&s!==null)s.return=o,xt=s;else e:for(;xt!==null;){if(o=xt,(o.flags&2048)!==0)switch(o.tag){case 0:case 11:case 15:N_(9,o,o.return)}var b=o.sibling;if(b!==null){b.return=o.return,xt=b;break e}xt=o.return}}var w=n.current;for(xt=w;xt!==null;){s=xt;var M=s.child;if((s.subtreeFlags&2064)!==0&&M!==null)M.return=s,xt=M;else e:for(s=w;xt!==null;){if(a=xt,(a.flags&2048)!==0)try{switch(a.tag){case 0:case 11:case 15:uC(9,a)}}catch(P){wi(a,a.return,P)}if(a===s){xt=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,xt=C;break e}xt=a.return}}if(mn=r,Bh(),Sl&&typeof Sl.onPostCommitFiberRoot=="function")try{Sl.onPostCommitFiberRoot(tC,n)}catch{}i=!0}return i}finally{On=t,Zs.transition=e}}return!1}function QN(n,e,t){e=Pv(t,e),e=H7(n,e,1),n=gh(n,e,1),e=So(),n!==null&&($y(n,1,e),Ko(n,e))}function wi(n,e,t){if(n.tag===3)QN(n,n,t);else for(;e!==null;){if(e.tag===3){QN(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(_h===null||!_h.has(i))){n=Pv(t,n),n=W7(e,n,1),e=gh(e,n,1),n=So(),e!==null&&($y(e,1,n),Ko(e,n));break}}e=e.return}}function yte(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=So(),n.pingedLanes|=n.suspendedLanes&t,Cr===n&&(Br&t)===t&&(sr===4||sr===3&&(Br&130023424)===Br&&500>Oi()-gO?dp(n,0):vO|=t),Ko(n,e)}function cj(n,e){e===0&&((n.mode&1)===0?e=1:(e=Nb,Nb<<=1,(Nb&130023424)===0&&(Nb=4194304)));var t=So();n=Zu(n,e),n!==null&&($y(n,e,t),Ko(n,t))}function xte(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),cj(n,t)}function bte(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(Ze(314))}i!==null&&i.delete(e),cj(n,t)}var hj;hj=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||qo.current)Go=!0;else{if((n.lanes&t)===0&&(e.flags&128)===0)return Go=!1,lte(n,e,t);Go=(n.flags&131072)!==0}else Go=!1,ni&&(e.flags&1048576)!==0&&f7(e,QM,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;lM(n,e),n=e.pendingProps;var r=Mv(e,oo.current);$m(e,t),r=cO(null,e,i,n,r,t);var o=hO();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Yo(i)?(o=!0,ZM(e)):o=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,oO(e),r.updater=aC,e.stateNode=r,r._reactInternals=e,SD(e,i,n,t),e=ED(null,e,i,!0,o,t)):(e.tag=0,ni&&o&&Q4(e),xo(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(lM(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=Ste(i),n=Aa(i,n),r){case 0:e=CD(null,e,i,n,t);break e;case 1:e=jN(null,e,i,n,t);break e;case 11:e=BN(null,e,i,n,t);break e;case 14:e=UN(null,e,i,Aa(i.type,n),t);break e}throw Error(Ze(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Aa(i,r),CD(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Aa(i,r),jN(n,e,i,r,t);case 3:e:{if(Y7(e),n===null)throw Error(Ze(387));i=e.pendingProps,o=e.memoizedState,r=o.element,_7(n,e),t2(e,i,null,t);var s=e.memoizedState;if(i=s.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){r=Pv(Error(Ze(423)),e),e=HN(n,e,i,t,r);break e}else if(i!==r){r=Pv(Error(Ze(424)),e),e=HN(n,e,i,t,r);break e}else for(_s=vh(e.stateNode.containerInfo.firstChild),bs=e,ni=!0,Ra=null,t=w7(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Cv(),i===r){e=Ju(n,e,t);break e}xo(n,e,i,t)}e=e.child}return e;case 5:return S7(e),n===null&&xD(e),i=e.type,r=e.pendingProps,o=n!==null?n.memoizedProps:null,s=r.children,mD(i,r)?s=null:o!==null&&mD(i,o)&&(e.flags|=32),q7(n,e),xo(n,e,s,t),e.child;case 6:return n===null&&xD(e),null;case 13:return K7(n,e,t);case 4:return sO(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Ev(e,null,i,t):xo(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Aa(i,r),BN(n,e,i,r,t);case 7:return xo(n,e,e.pendingProps,t),e.child;case 8:return xo(n,e,e.pendingProps.children,t),e.child;case 12:return xo(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,o=e.memoizedProps,s=r.value,Xn($M,i._currentValue),i._currentValue=s,o!==null)if(Ha(o.value,s)){if(o.children===r.children&&!qo.current){e=Ju(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(o.tag===1){l=ju(-1,t&-t),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),bD(o.return,t,e),a.lanes|=t;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(Ze(341));s.lanes|=t,a=s.alternate,a!==null&&(a.lanes|=t),bD(s,t,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}xo(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,$m(e,t),r=$s(r),i=i(r),e.flags|=1,xo(n,e,i,t),e.child;case 14:return i=e.type,r=Aa(i,e.pendingProps),r=Aa(i.type,r),UN(n,e,i,r,t);case 15:return G7(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Aa(i,r),lM(n,e),e.tag=1,Yo(i)?(n=!0,ZM(e)):n=!1,$m(e,t),x7(e,i,r),SD(e,i,r,t),ED(null,e,i,!0,n,t);case 19:return Z7(n,e,t);case 22:return X7(n,e,t)}throw Error(Ze(156,e.tag))};function dj(n,e){return V9(n,e)}function wte(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qs(n,e,t,i){return new wte(n,e,t,i)}function bO(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ste(n){if(typeof n=="function")return bO(n)?1:0;if(n!=null){if(n=n.$$typeof,n===B4)return 11;if(n===U4)return 14}return 2}function xh(n,e){var t=n.alternate;return t===null?(t=qs(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function hM(n,e,t,i,r,o){var s=2;if(i=n,typeof n=="function")bO(n)&&(s=1);else if(typeof n=="string")s=5;else e:switch(n){case Lm:return pp(t.children,r,o,e);case F4:s=8,r|=8;break;case qL:return n=qs(12,t,e,r|2),n.elementType=qL,n.lanes=o,n;case YL:return n=qs(13,t,e,r),n.elementType=YL,n.lanes=o,n;case KL:return n=qs(19,t,e,r),n.elementType=KL,n.lanes=o,n;case b9:return hC(t,r,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case y9:s=10;break e;case x9:s=9;break e;case B4:s=11;break e;case U4:s=14;break e;case Jc:s=16,i=null;break e}throw Error(Ze(130,n==null?n:typeof n,""))}return e=qs(s,t,e,r),e.elementType=n,e.type=i,e.lanes=o,e}function pp(n,e,t,i){return n=qs(7,n,i,e),n.lanes=t,n}function hC(n,e,t,i){return n=qs(22,n,i,e),n.elementType=b9,n.lanes=t,n.stateNode={isHidden:!1},n}function xP(n,e,t){return n=qs(6,n,null,e),n.lanes=t,n}function bP(n,e,t){return e=qs(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Mte(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tP(0),this.expirationTimes=tP(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tP(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function wO(n,e,t,i,r,o,s,a,l){return n=new Mte(n,e,t,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=qs(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},oO(o),n}function Cte(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Am,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function pj(n){if(!n)return Ph;n=n._reactInternals;e:{if(Fp(n)!==n||n.tag!==1)throw Error(Ze(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Yo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ze(171))}if(n.tag===1){var t=n.type;if(Yo(t))return d7(n,t,e)}return e}function fj(n,e,t,i,r,o,s,a,l){return n=wO(t,i,!0,n,r,o,s,a,l),n.context=pj(null),t=n.current,i=So(),r=yh(t),o=ju(i,r),o.callback=e!=null?e:null,gh(t,o,r),n.current.lanes=r,$y(n,r,i),Ko(n,i),n}function dC(n,e,t,i){var r=e.current,o=So(),s=yh(r);return t=pj(t),e.context===null?e.context=t:e.pendingContext=t,e=ju(o,s),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=gh(r,e,s),n!==null&&(Va(n,r,s,o),oM(n,r,s)),s}function u2(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function $N(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function SO(n,e){$N(n,e),(n=n.alternate)&&$N(n,e)}function Ete(){return null}var mj=typeof reportError=="function"?reportError:function(n){console.error(n)};function MO(n){this._internalRoot=n}pC.prototype.render=MO.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(Ze(409));dC(n,e,null,null)};pC.prototype.unmount=MO.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Cp(function(){dC(null,n,null,null)}),e[Ku]=null}};function pC(n){this._internalRoot=n}pC.prototype.unstable_scheduleHydration=function(n){if(n){var e=G9();n={blockedOn:null,target:n,priority:e};for(var t=0;t<nh.length&&e!==0&&e<nh[t].priority;t++);nh.splice(t,0,n),t===0&&q9(n)}};function CO(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function fC(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function e6(){}function Tte(n,e,t,i,r){if(r){if(typeof i=="function"){var o=i;i=function(){var u=u2(s);o.call(u)}}var s=fj(e,i,n,0,null,!1,!1,"",e6);return n._reactRootContainer=s,n[Ku]=s.current,gy(n.nodeType===8?n.parentNode:n),Cp(),s}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=u2(l);a.call(u)}}var l=wO(n,0,!1,null,null,!1,!1,"",e6);return n._reactRootContainer=l,n[Ku]=l.current,gy(n.nodeType===8?n.parentNode:n),Cp(function(){dC(e,l,t,i)}),l}function mC(n,e,t,i,r){var o=t._reactRootContainer;if(o){var s=o;if(typeof r=="function"){var a=r;r=function(){var l=u2(s);a.call(l)}}dC(e,s,n,r)}else s=Tte(t,e,n,r,i);return u2(s)}H9=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=f_(e.pendingLanes);t!==0&&(W4(e,t|1),Ko(e,Oi()),(mn&6)===0&&(Av=Oi()+500,Bh()))}break;case 13:Cp(function(){var i=Zu(n,1);if(i!==null){var r=So();Va(i,n,1,r)}}),SO(n,1)}};G4=function(n){if(n.tag===13){var e=Zu(n,134217728);if(e!==null){var t=So();Va(e,n,134217728,t)}SO(n,134217728)}};W9=function(n){if(n.tag===13){var e=yh(n),t=Zu(n,e);if(t!==null){var i=So();Va(t,n,e,i)}SO(n,e)}};G9=function(){return On};X9=function(n,e){var t=On;try{return On=n,e()}finally{On=t}};oD=function(n,e,t){switch(e){case"input":if(QL(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=oC(i);if(!r)throw Error(Ze(90));S9(i),QL(i,r)}}}break;case"textarea":C9(n,t);break;case"select":e=t.value,e!=null&&Km(n,!!t.multiple,e,!1)}};R9=_O;O9=Cp;var Pte={usingClientEntryPoint:!1,Events:[tx,km,oC,L9,D9,_O]},I0={findFiberByHostInstance:ip,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Ate={bundleType:I0.bundleType,version:I0.version,rendererPackageName:I0.rendererPackageName,rendererConfig:I0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:tc.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=N9(n),n===null?null:n.stateNode},findFiberByHostInstance:I0.findFiberByHostInstance||Ete,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qb.isDisabled&&qb.supportsFiber)try{tC=qb.inject(Ate),Sl=qb}catch{}}Ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pte;Ps.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!CO(e))throw Error(Ze(200));return Cte(n,e,null,t)};Ps.createRoot=function(n,e){if(!CO(n))throw Error(Ze(299));var t=!1,i="",r=mj;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=wO(n,1,!1,null,null,t,!1,i,r),n[Ku]=e.current,gy(n.nodeType===8?n.parentNode:n),new MO(e)};Ps.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(Ze(188)):(n=Object.keys(n).join(","),Error(Ze(268,n)));return n=N9(e),n=n===null?null:n.stateNode,n};Ps.flushSync=function(n){return Cp(n)};Ps.hydrate=function(n,e,t){if(!fC(e))throw Error(Ze(200));return mC(null,n,e,!0,t)};Ps.hydrateRoot=function(n,e,t){if(!CO(n))throw Error(Ze(405));var i=t!=null&&t.hydratedSources||null,r=!1,o="",s=mj;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),e=fj(e,null,n,1,t!=null?t:null,r,!1,o,s),n[Ku]=e.current,gy(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new pC(e)};Ps.render=function(n,e,t){if(!fC(e))throw Error(Ze(200));return mC(null,n,e,!1,t)};Ps.unmountComponentAtNode=function(n){if(!fC(n))throw Error(Ze(40));return n._reactRootContainer?(Cp(function(){mC(null,null,n,!1,function(){n._reactRootContainer=null,n[Ku]=null})}),!0):!1};Ps.unstable_batchedUpdates=_O;Ps.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!fC(t))throw Error(Ze(200));if(n==null||n._reactInternals===void 0)throw Error(Ze(38));return mC(n,e,t,!1,i)};Ps.version="18.2.0-next-9e3b772b8-20220608";(function(n){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}e(),n.exports=Ps})(f9);var t6=f9.exports;GL.createRoot=t6.createRoot,GL.hydrateRoot=t6.hydrateRoot;function VD(n,e){return VD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},VD(n,e)}function Dl(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,VD(n,e)}var FD={exports:{}},Lte="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Dte=Lte,Rte=Dte;function vj(){}function gj(){}gj.resetWarningCache=vj;var Ote=function(){function n(i,r,o,s,a,l){if(l!==Rte){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:gj,resetWarningCache:vj};return t.PropTypes=t,t};FD.exports=Ote();function Qo(){return Qo=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Qo.apply(this,arguments)}function Yb(n){return n.charAt(0)==="/"}function wP(n,e){for(var t=e,i=t+1,r=n.length;i<r;t+=1,i+=1)n[t]=n[i];n.pop()}function kte(n,e){e===void 0&&(e="");var t=n&&n.split("/")||[],i=e&&e.split("/")||[],r=n&&Yb(n),o=e&&Yb(e),s=r||o;if(n&&Yb(n)?i=t:t.length&&(i.pop(),i=i.concat(t)),!i.length)return"/";var a;if(i.length){var l=i[i.length-1];a=l==="."||l===".."||l===""}else a=!1;for(var u=0,c=i.length;c>=0;c--){var h=i[c];h==="."?wP(i,c):h===".."?(wP(i,c),u++):u&&(wP(i,c),u--)}if(!s)for(;u--;u)i.unshift("..");s&&i[0]!==""&&(!i[0]||!Yb(i[0]))&&i.unshift("");var p=i.join("/");return a&&p.substr(-1)!=="/"&&(p+="/"),p}var Ite=!0,SP="Invariant failed";function Bp(n,e){if(!n){if(Ite)throw new Error(SP);var t=typeof e=="function"?e():e,i=t?"".concat(SP,": ").concat(t):SP;throw new Error(i)}}function F_(n){return n.charAt(0)==="/"?n:"/"+n}function n6(n){return n.charAt(0)==="/"?n.substr(1):n}function Nte(n,e){return n.toLowerCase().indexOf(e.toLowerCase())===0&&"/?#".indexOf(n.charAt(e.length))!==-1}function _j(n,e){return Nte(n,e)?n.substr(e.length):n}function yj(n){return n.charAt(n.length-1)==="/"?n.slice(0,-1):n}function zte(n){var e=n||"/",t="",i="",r=e.indexOf("#");r!==-1&&(i=e.substr(r),e=e.substr(0,r));var o=e.indexOf("?");return o!==-1&&(t=e.substr(o),e=e.substr(0,o)),{pathname:e,search:t==="?"?"":t,hash:i==="#"?"":i}}function Uo(n){var e=n.pathname,t=n.search,i=n.hash,r=e||"/";return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(r+=i.charAt(0)==="#"?i:"#"+i),r}function ys(n,e,t,i){var r;typeof n=="string"?(r=zte(n),r.state=e):(r=Qo({},n),r.pathname===void 0&&(r.pathname=""),r.search?r.search.charAt(0)!=="?"&&(r.search="?"+r.search):r.search="",r.hash?r.hash.charAt(0)!=="#"&&(r.hash="#"+r.hash):r.hash="",e!==void 0&&r.state===void 0&&(r.state=e));try{r.pathname=decodeURI(r.pathname)}catch(o){throw o instanceof URIError?new URIError('Pathname "'+r.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):o}return t&&(r.key=t),i?r.pathname?r.pathname.charAt(0)!=="/"&&(r.pathname=kte(r.pathname,i.pathname)):r.pathname=i.pathname:r.pathname||(r.pathname="/"),r}function EO(){var n=null;function e(s){return n=s,function(){n===s&&(n=null)}}function t(s,a,l,u){if(n!=null){var c=typeof n=="function"?n(s,a):n;typeof c=="string"?typeof l=="function"?l(c,u):u(!0):u(c!==!1)}else u(!0)}var i=[];function r(s){var a=!0;function l(){a&&s.apply(void 0,arguments)}return i.push(l),function(){a=!1,i=i.filter(function(u){return u!==l})}}function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];i.forEach(function(u){return u.apply(void 0,a)})}return{setPrompt:e,confirmTransitionTo:t,appendListener:r,notifyListeners:o}}var xj=!!(typeof window<"u"&&window.document&&window.document.createElement);function bj(n,e){e(window.confirm(n))}function Vte(){var n=window.navigator.userAgent;return(n.indexOf("Android 2.")!==-1||n.indexOf("Android 4.0")!==-1)&&n.indexOf("Mobile Safari")!==-1&&n.indexOf("Chrome")===-1&&n.indexOf("Windows Phone")===-1?!1:window.history&&"pushState"in window.history}function Fte(){return window.navigator.userAgent.indexOf("Trident")===-1}function Bte(){return window.navigator.userAgent.indexOf("Firefox")===-1}function Ute(n){return n.state===void 0&&navigator.userAgent.indexOf("CriOS")===-1}var i6="popstate",r6="hashchange";function o6(){try{return window.history.state||{}}catch{return{}}}function jte(n){n===void 0&&(n={}),xj||Bp(!1);var e=window.history,t=Vte(),i=!Fte(),r=n,o=r.forceRefresh,s=o===void 0?!1:o,a=r.getUserConfirmation,l=a===void 0?bj:a,u=r.keyLength,c=u===void 0?6:u,h=n.basename?yj(F_(n.basename)):"";function p(B){var U=B||{},le=U.key,ne=U.state,fe=window.location,we=fe.pathname,Be=fe.search,oe=fe.hash,tt=we+Be+oe;return h&&(tt=_j(tt,h)),ys(tt,ne,le)}function m(){return Math.random().toString(36).substr(2,c)}var y=EO();function _(B){Qo(X,B),X.length=e.length,y.notifyListeners(X.location,X.action)}function g(B){Ute(B)||M(p(B.state))}function b(){M(p(o6()))}var w=!1;function M(B){if(w)w=!1,_();else{var U="POP";y.confirmTransitionTo(B,U,l,function(le){le?_({action:U,location:B}):C(B)})}}function C(B){var U=X.location,le=L.indexOf(U.key);le===-1&&(le=0);var ne=L.indexOf(B.key);ne===-1&&(ne=0);var fe=le-ne;fe&&(w=!0,N(fe))}var P=p(o6()),L=[P.key];function R(B){return h+Uo(B)}function E(B,U){var le="PUSH",ne=ys(B,U,m(),X.location);y.confirmTransitionTo(ne,le,l,function(fe){if(!!fe){var we=R(ne),Be=ne.key,oe=ne.state;if(t)if(e.pushState({key:Be,state:oe},null,we),s)window.location.href=we;else{var tt=L.indexOf(X.location.key),Ue=L.slice(0,tt+1);Ue.push(ne.key),L=Ue,_({action:le,location:ne})}else window.location.href=we}})}function D(B,U){var le="REPLACE",ne=ys(B,U,m(),X.location);y.confirmTransitionTo(ne,le,l,function(fe){if(!!fe){var we=R(ne),Be=ne.key,oe=ne.state;if(t)if(e.replaceState({key:Be,state:oe},null,we),s)window.location.replace(we);else{var tt=L.indexOf(X.location.key);tt!==-1&&(L[tt]=ne.key),_({action:le,location:ne})}else window.location.replace(we)}})}function N(B){e.go(B)}function j(){N(-1)}function te(){N(1)}var ee=0;function H(B){ee+=B,ee===1&&B===1?(window.addEventListener(i6,g),i&&window.addEventListener(r6,b)):ee===0&&(window.removeEventListener(i6,g),i&&window.removeEventListener(r6,b))}var Q=!1;function Z(B){B===void 0&&(B=!1);var U=y.setPrompt(B);return Q||(H(1),Q=!0),function(){return Q&&(Q=!1,H(-1)),U()}}function de(B){var U=y.appendListener(B);return H(1),function(){H(-1),U()}}var X={length:e.length,action:"POP",location:P,createHref:R,push:E,replace:D,go:N,goBack:j,goForward:te,block:Z,listen:de};return X}var s6="hashchange",Hte={hashbang:{encodePath:function(e){return e.charAt(0)==="!"?e:"!/"+n6(e)},decodePath:function(e){return e.charAt(0)==="!"?e.substr(1):e}},noslash:{encodePath:n6,decodePath:F_},slash:{encodePath:F_,decodePath:F_}};function wj(n){var e=n.indexOf("#");return e===-1?n:n.slice(0,e)}function N0(){var n=window.location.href,e=n.indexOf("#");return e===-1?"":n.substring(e+1)}function Wte(n){window.location.hash=n}function MP(n){window.location.replace(wj(window.location.href)+"#"+n)}function Gte(n){n===void 0&&(n={}),xj||Bp(!1);var e=window.history;Bte();var t=n,i=t.getUserConfirmation,r=i===void 0?bj:i,o=t.hashType,s=o===void 0?"slash":o,a=n.basename?yj(F_(n.basename)):"",l=Hte[s],u=l.encodePath,c=l.decodePath;function h(){var U=c(N0());return a&&(U=_j(U,a)),ys(U)}var p=EO();function m(U){Qo(B,U),B.length=e.length,p.notifyListeners(B.location,B.action)}var y=!1,_=null;function g(U,le){return U.pathname===le.pathname&&U.search===le.search&&U.hash===le.hash}function b(){var U=N0(),le=u(U);if(U!==le)MP(le);else{var ne=h(),fe=B.location;if(!y&&g(fe,ne)||_===Uo(ne))return;_=null,w(ne)}}function w(U){if(y)y=!1,m();else{var le="POP";p.confirmTransitionTo(U,le,r,function(ne){ne?m({action:le,location:U}):M(U)})}}function M(U){var le=B.location,ne=R.lastIndexOf(Uo(le));ne===-1&&(ne=0);var fe=R.lastIndexOf(Uo(U));fe===-1&&(fe=0);var we=ne-fe;we&&(y=!0,j(we))}var C=N0(),P=u(C);C!==P&&MP(P);var L=h(),R=[Uo(L)];function E(U){var le=document.querySelector("base"),ne="";return le&&le.getAttribute("href")&&(ne=wj(window.location.href)),ne+"#"+u(a+Uo(U))}function D(U,le){var ne="PUSH",fe=ys(U,void 0,void 0,B.location);p.confirmTransitionTo(fe,ne,r,function(we){if(!!we){var Be=Uo(fe),oe=u(a+Be),tt=N0()!==oe;if(tt){_=Be,Wte(oe);var Ue=R.lastIndexOf(Uo(B.location)),Ve=R.slice(0,Ue+1);Ve.push(Be),R=Ve,m({action:ne,location:fe})}else m()}})}function N(U,le){var ne="REPLACE",fe=ys(U,void 0,void 0,B.location);p.confirmTransitionTo(fe,ne,r,function(we){if(!!we){var Be=Uo(fe),oe=u(a+Be),tt=N0()!==oe;tt&&(_=Be,MP(oe));var Ue=R.indexOf(Uo(B.location));Ue!==-1&&(R[Ue]=Be),m({action:ne,location:fe})}})}function j(U){e.go(U)}function te(){j(-1)}function ee(){j(1)}var H=0;function Q(U){H+=U,H===1&&U===1?window.addEventListener(s6,b):H===0&&window.removeEventListener(s6,b)}var Z=!1;function de(U){U===void 0&&(U=!1);var le=p.setPrompt(U);return Z||(Q(1),Z=!0),function(){return Z&&(Z=!1,Q(-1)),le()}}function X(U){var le=p.appendListener(U);return Q(1),function(){Q(-1),le()}}var B={length:e.length,action:"POP",location:L,createHref:E,push:D,replace:N,go:j,goBack:te,goForward:ee,block:de,listen:X};return B}function a6(n,e,t){return Math.min(Math.max(n,e),t)}function Xte(n){n===void 0&&(n={});var e=n,t=e.getUserConfirmation,i=e.initialEntries,r=i===void 0?["/"]:i,o=e.initialIndex,s=o===void 0?0:o,a=e.keyLength,l=a===void 0?6:a,u=EO();function c(E){Qo(R,E),R.length=R.entries.length,u.notifyListeners(R.location,R.action)}function h(){return Math.random().toString(36).substr(2,l)}var p=a6(s,0,r.length-1),m=r.map(function(E){return typeof E=="string"?ys(E,void 0,h()):ys(E,void 0,E.key||h())}),y=Uo;function _(E,D){var N="PUSH",j=ys(E,D,h(),R.location);u.confirmTransitionTo(j,N,t,function(te){if(!!te){var ee=R.index,H=ee+1,Q=R.entries.slice(0);Q.length>H?Q.splice(H,Q.length-H,j):Q.push(j),c({action:N,location:j,index:H,entries:Q})}})}function g(E,D){var N="REPLACE",j=ys(E,D,h(),R.location);u.confirmTransitionTo(j,N,t,function(te){!te||(R.entries[R.index]=j,c({action:N,location:j}))})}function b(E){var D=a6(R.index+E,0,R.entries.length-1),N="POP",j=R.entries[D];u.confirmTransitionTo(j,N,t,function(te){te?c({action:N,location:j,index:D}):c()})}function w(){b(-1)}function M(){b(1)}function C(E){var D=R.index+E;return D>=0&&D<R.entries.length}function P(E){return E===void 0&&(E=!1),u.setPrompt(E)}function L(E){return u.appendListener(E)}var R={length:m.length,action:"POP",location:m[p],index:p,entries:m,createHref:y,push:_,replace:g,go:b,goBack:w,goForward:M,canGo:C,block:P,listen:L};return R}var CP=1073741823,l6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{};function qte(){var n="__global_unique_id__";return l6[n]=(l6[n]||0)+1}function Yte(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function Kte(n){var e=[];return{on:function(i){e.push(i)},off:function(i){e=e.filter(function(r){return r!==i})},get:function(){return n},set:function(i,r){n=i,e.forEach(function(o){return o(n,r)})}}}function Zte(n){return Array.isArray(n)?n[0]:n}function Jte(n,e){var t,i,r="__create-react-context-"+qte()+"__",o=function(a){Dl(l,a);function l(){var c;return c=a.apply(this,arguments)||this,c.emitter=Kte(c.props.value),c}var u=l.prototype;return u.getChildContext=function(){var h;return h={},h[r]=this.emitter,h},u.componentWillReceiveProps=function(h){if(this.props.value!==h.value){var p=this.props.value,m=h.value,y;Yte(p,m)?y=0:(y=typeof e=="function"?e(p,m):CP,y|=0,y!==0&&this.emitter.set(h.value,y))}},u.render=function(){return this.props.children},l}(hn.exports.Component);o.childContextTypes=(t={},t[r]=FD.exports.object.isRequired,t);var s=function(a){Dl(l,a);function l(){var c;return c=a.apply(this,arguments)||this,c.state={value:c.getValue()},c.onUpdate=function(h,p){var m=c.observedBits|0;(m&p)!==0&&c.setState({value:c.getValue()})},c}var u=l.prototype;return u.componentWillReceiveProps=function(h){var p=h.observedBits;this.observedBits=p==null?CP:p},u.componentDidMount=function(){this.context[r]&&this.context[r].on(this.onUpdate);var h=this.props.observedBits;this.observedBits=h==null?CP:h},u.componentWillUnmount=function(){this.context[r]&&this.context[r].off(this.onUpdate)},u.getValue=function(){return this.context[r]?this.context[r].get():n},u.render=function(){return Zte(this.props.children)(this.state.value)},l}(hn.exports.Component);return s.contextTypes=(i={},i[r]=FD.exports.object,i),{Provider:o,Consumer:s}}var Qte=_t.createContext||Jte,fg={exports:{}},$te=Array.isArray||function(n){return Object.prototype.toString.call(n)=="[object Array]"},c2=$te;fg.exports=Cj;fg.exports.parse=TO;fg.exports.compile=tne;fg.exports.tokensToFunction=Sj;fg.exports.tokensToRegExp=Mj;var ene=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function TO(n,e){for(var t=[],i=0,r=0,o="",s=e&&e.delimiter||"/",a;(a=ene.exec(n))!=null;){var l=a[0],u=a[1],c=a.index;if(o+=n.slice(r,c),r=c+l.length,u){o+=u[1];continue}var h=n[r],p=a[2],m=a[3],y=a[4],_=a[5],g=a[6],b=a[7];o&&(t.push(o),o="");var w=p!=null&&h!=null&&h!==p,M=g==="+"||g==="*",C=g==="?"||g==="*",P=a[2]||s,L=y||_;t.push({name:m||i++,prefix:p||"",delimiter:P,optional:C,repeat:M,partial:w,asterisk:!!b,pattern:L?rne(L):b?".*":"[^"+dM(P)+"]+?"})}return r<n.length&&(o+=n.substr(r)),o&&t.push(o),t}function tne(n,e){return Sj(TO(n,e),e)}function nne(n){return encodeURI(n).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function ine(n){return encodeURI(n).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function Sj(n,e){for(var t=new Array(n.length),i=0;i<n.length;i++)typeof n[i]=="object"&&(t[i]=new RegExp("^(?:"+n[i].pattern+")$",AO(e)));return function(r,o){for(var s="",a=r||{},l=o||{},u=l.pretty?nne:encodeURIComponent,c=0;c<n.length;c++){var h=n[c];if(typeof h=="string"){s+=h;continue}var p=a[h.name],m;if(p==null)if(h.optional){h.partial&&(s+=h.prefix);continue}else throw new TypeError('Expected "'+h.name+'" to be defined');if(c2(p)){if(!h.repeat)throw new TypeError('Expected "'+h.name+'" to not repeat, but received `'+JSON.stringify(p)+"`");if(p.length===0){if(h.optional)continue;throw new TypeError('Expected "'+h.name+'" to not be empty')}for(var y=0;y<p.length;y++){if(m=u(p[y]),!t[c].test(m))throw new TypeError('Expected all "'+h.name+'" to match "'+h.pattern+'", but received `'+JSON.stringify(m)+"`");s+=(y===0?h.prefix:h.delimiter)+m}continue}if(m=h.asterisk?ine(p):u(p),!t[c].test(m))throw new TypeError('Expected "'+h.name+'" to match "'+h.pattern+'", but received "'+m+'"');s+=h.prefix+m}return s}}function dM(n){return n.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function rne(n){return n.replace(/([=!:$\/()])/g,"\\$1")}function PO(n,e){return n.keys=e,n}function AO(n){return n&&n.sensitive?"":"i"}function one(n,e){var t=n.source.match(/\((?!\?)/g);if(t)for(var i=0;i<t.length;i++)e.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return PO(n,e)}function sne(n,e,t){for(var i=[],r=0;r<n.length;r++)i.push(Cj(n[r],e,t).source);var o=new RegExp("(?:"+i.join("|")+")",AO(t));return PO(o,e)}function ane(n,e,t){return Mj(TO(n,t),e,t)}function Mj(n,e,t){c2(e)||(t=e||t,e=[]),t=t||{};for(var i=t.strict,r=t.end!==!1,o="",s=0;s<n.length;s++){var a=n[s];if(typeof a=="string")o+=dM(a);else{var l=dM(a.prefix),u="(?:"+a.pattern+")";e.push(a),a.repeat&&(u+="(?:"+l+u+")*"),a.optional?a.partial?u=l+"("+u+")?":u="(?:"+l+"("+u+"))?":u=l+"("+u+")",o+=u}}var c=dM(t.delimiter||"/"),h=o.slice(-c.length)===c;return i||(o=(h?o.slice(0,-c.length):o)+"(?:"+c+"(?=$))?"),r?o+="$":o+=i&&h?"":"(?="+c+"|$)",PO(new RegExp("^"+o,AO(t)),e)}function Cj(n,e,t){return c2(e)||(t=e||t,e=[]),t=t||{},n instanceof RegExp?one(n,e):c2(n)?sne(n,e,t):ane(n,e,t)}var Ej={exports:{}},kn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pr=typeof Symbol=="function"&&Symbol.for,LO=Pr?Symbol.for("react.element"):60103,DO=Pr?Symbol.for("react.portal"):60106,vC=Pr?Symbol.for("react.fragment"):60107,gC=Pr?Symbol.for("react.strict_mode"):60108,_C=Pr?Symbol.for("react.profiler"):60114,yC=Pr?Symbol.for("react.provider"):60109,xC=Pr?Symbol.for("react.context"):60110,RO=Pr?Symbol.for("react.async_mode"):60111,bC=Pr?Symbol.for("react.concurrent_mode"):60111,wC=Pr?Symbol.for("react.forward_ref"):60112,SC=Pr?Symbol.for("react.suspense"):60113,lne=Pr?Symbol.for("react.suspense_list"):60120,MC=Pr?Symbol.for("react.memo"):60115,CC=Pr?Symbol.for("react.lazy"):60116,une=Pr?Symbol.for("react.block"):60121,cne=Pr?Symbol.for("react.fundamental"):60117,hne=Pr?Symbol.for("react.responder"):60118,dne=Pr?Symbol.for("react.scope"):60119;function Ls(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case LO:switch(n=n.type,n){case RO:case bC:case vC:case _C:case gC:case SC:return n;default:switch(n=n&&n.$$typeof,n){case xC:case wC:case CC:case MC:case yC:return n;default:return e}}case DO:return e}}}function Tj(n){return Ls(n)===bC}kn.AsyncMode=RO;kn.ConcurrentMode=bC;kn.ContextConsumer=xC;kn.ContextProvider=yC;kn.Element=LO;kn.ForwardRef=wC;kn.Fragment=vC;kn.Lazy=CC;kn.Memo=MC;kn.Portal=DO;kn.Profiler=_C;kn.StrictMode=gC;kn.Suspense=SC;kn.isAsyncMode=function(n){return Tj(n)||Ls(n)===RO};kn.isConcurrentMode=Tj;kn.isContextConsumer=function(n){return Ls(n)===xC};kn.isContextProvider=function(n){return Ls(n)===yC};kn.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===LO};kn.isForwardRef=function(n){return Ls(n)===wC};kn.isFragment=function(n){return Ls(n)===vC};kn.isLazy=function(n){return Ls(n)===CC};kn.isMemo=function(n){return Ls(n)===MC};kn.isPortal=function(n){return Ls(n)===DO};kn.isProfiler=function(n){return Ls(n)===_C};kn.isStrictMode=function(n){return Ls(n)===gC};kn.isSuspense=function(n){return Ls(n)===SC};kn.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===vC||n===bC||n===_C||n===gC||n===SC||n===lne||typeof n=="object"&&n!==null&&(n.$$typeof===CC||n.$$typeof===MC||n.$$typeof===yC||n.$$typeof===xC||n.$$typeof===wC||n.$$typeof===cne||n.$$typeof===hne||n.$$typeof===dne||n.$$typeof===une)};kn.typeOf=Ls;(function(n){n.exports=kn})(Ej);function EC(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,o;for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}var Pj=Ej.exports,pne={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},fne={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Aj={};Aj[Pj.ForwardRef]=pne;Aj[Pj.Memo]=fne;var OO={exports:{}},TC={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mne=hn.exports,vne=Symbol.for("react.element"),gne=Symbol.for("react.fragment"),_ne=Object.prototype.hasOwnProperty,yne=mne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xne={key:!0,ref:!0,__self:!0,__source:!0};function Lj(n,e,t){var i,r={},o=null,s=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(i in e)_ne.call(e,i)&&!xne.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:vne,type:n,key:o,ref:s,props:r,_owner:yne.current}}TC.Fragment=gne;TC.jsx=Lj;TC.jsxs=Lj;(function(n){n.exports=TC})(OO);const xr=OO.exports.jsx,Dj=OO.exports.jsxs;var Rj=function(e){var t=Qte();return t.displayName=e,t},bne=Rj("Router-History"),Lv=Rj("Router"),PC=function(n){Dl(e,n),e.computeRootMatch=function(r){return{path:"/",url:"/",params:{},isExact:r==="/"}};function e(i){var r;return r=n.call(this,i)||this,r.state={location:i.history.location},r._isMounted=!1,r._pendingLocation=null,i.staticContext||(r.unlisten=i.history.listen(function(o){r._pendingLocation=o})),r}var t=e.prototype;return t.componentDidMount=function(){var r=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen(function(o){r._isMounted&&r.setState({location:o})})),this._pendingLocation&&this.setState({location:this._pendingLocation})},t.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},t.render=function(){return _t.createElement(Lv.Provider,{value:{history:this.props.history,location:this.state.location,match:e.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},_t.createElement(bne.Provider,{children:this.props.children||null,value:this.props.history}))},e}(_t.Component);_t.Component;_t.Component;var u6={},wne=1e4,c6=0;function Sne(n,e){var t=""+e.end+e.strict+e.sensitive,i=u6[t]||(u6[t]={});if(i[n])return i[n];var r=[],o=fg.exports(n,r,e),s={regexp:o,keys:r};return c6<wne&&(i[n]=s,c6++),s}function kO(n,e){e===void 0&&(e={}),(typeof e=="string"||Array.isArray(e))&&(e={path:e});var t=e,i=t.path,r=t.exact,o=r===void 0?!1:r,s=t.strict,a=s===void 0?!1:s,l=t.sensitive,u=l===void 0?!1:l,c=[].concat(i);return c.reduce(function(h,p){if(!p&&p!=="")return null;if(h)return h;var m=Sne(p,{end:o,strict:a,sensitive:u}),y=m.regexp,_=m.keys,g=y.exec(n);if(!g)return null;var b=g[0],w=g.slice(1),M=n===b;return o&&!M?null:{path:p,url:p==="/"&&b===""?"/":b,isExact:M,params:_.reduce(function(C,P,L){return C[P.name]=w[L],C},{})}},null)}function Mne(n){return _t.Children.count(n)===0}var Cne=function(n){Dl(e,n);function e(){return n.apply(this,arguments)||this}var t=e.prototype;return t.render=function(){var r=this;return _t.createElement(Lv.Consumer,null,function(o){o||Bp(!1);var s=r.props.location||o.location,a=r.props.computedMatch?r.props.computedMatch:r.props.path?kO(s.pathname,r.props):o.match,l=Qo({},o,{location:s,match:a}),u=r.props,c=u.children,h=u.component,p=u.render;return Array.isArray(c)&&Mne(c)&&(c=null),_t.createElement(Lv.Provider,{value:l},l.match?c?typeof c=="function"?c(l):c:h?_t.createElement(h,l):p?p(l):null:typeof c=="function"?c(l):null)})},e}(_t.Component);function IO(n){return n.charAt(0)==="/"?n:"/"+n}function Ene(n,e){return n?Qo({},e,{pathname:IO(n)+e.pathname}):e}function Tne(n,e){if(!n)return e;var t=IO(n);return e.pathname.indexOf(t)!==0?e:Qo({},e,{pathname:e.pathname.substr(t.length)})}function h6(n){return typeof n=="string"?n:Uo(n)}function EP(n){return function(){Bp(!1)}}function d6(){}_t.Component;var Pne=function(n){Dl(e,n);function e(){return n.apply(this,arguments)||this}var t=e.prototype;return t.render=function(){var r=this;return _t.createElement(Lv.Consumer,null,function(o){o||Bp(!1);var s=r.props.location||o.location,a,l;return _t.Children.forEach(r.props.children,function(u){if(l==null&&_t.isValidElement(u)){a=u;var c=u.props.path||u.props.from;l=c?kO(s.pathname,Qo({},u.props,{path:c})):o.match}}),l?_t.cloneElement(a,{location:s,computedMatch:l}):null})},e}(_t.Component);_t.useContext;_t.Component;var Ane=function(n){Dl(e,n);function e(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i=n.call.apply(n,[this].concat(o))||this,i.history=Gte(i.props),i}var t=e.prototype;return t.render=function(){return xr(PC,{history:this.history,children:this.props.children})},e}(_t.Component),BD=function(e,t){return typeof e=="function"?e(t):e},UD=function(e,t){return typeof e=="string"?ys(e,null,null,t):e},NO=function(e){return e},Dv=_t.forwardRef;typeof Dv>"u"&&(Dv=NO);function Lne(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}var Dne=Dv(function(n,e){var t=n.innerRef,i=n.navigate,r=n.onClick,o=EC(n,["innerRef","navigate","onClick"]),s=o.target,a=Qo({},o,{onClick:function(u){try{r&&r(u)}catch(c){throw u.preventDefault(),c}!u.defaultPrevented&&u.button===0&&(!s||s==="_self")&&!Lne(u)&&(u.preventDefault(),i())}});return NO!==Dv?a.ref=e||t:a.ref=t,xr("a",{...a})}),Rne=Dv(function(n,e){var t=n.component,i=t===void 0?Dne:t,r=n.replace,o=n.to,s=n.innerRef,a=EC(n,["component","replace","to","innerRef"]);return _t.createElement(Lv.Consumer,null,function(l){l||Bp(!1);var u=l.history,c=UD(BD(o,l.location),l.location),h=c?u.createHref(c):"",p=Qo({},a,{href:h,navigate:function(){var y=BD(o,l.location),_=Uo(l.location)===Uo(UD(y)),g=r||_?u.replace:u.push;g(y)}});return NO!==Dv?p.ref=e||s:p.innerRef=s,_t.createElement(i,p)})}),Oj=function(e){return e},h2=_t.forwardRef;typeof h2>"u"&&(h2=Oj);function One(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e.filter(function(i){return i}).join(" ")}h2(function(n,e){var t=n["aria-current"],i=t===void 0?"page":t,r=n.activeClassName,o=r===void 0?"active":r,s=n.activeStyle,a=n.className,l=n.exact,u=n.isActive,c=n.location,h=n.sensitive,p=n.strict,m=n.style,y=n.to,_=n.innerRef,g=EC(n,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return _t.createElement(Lv.Consumer,null,function(b){b||Bp(!1);var w=c||b.location,M=UD(BD(y,w),w),C=M.pathname,P=C&&C.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),L=P?kO(w.pathname,{path:P,exact:l,sensitive:h,strict:p}):null,R=!!(u?u(L,w):L),E=typeof a=="function"?a(R):a,D=typeof m=="function"?m(R):m;R&&(E=One(E,o),D=Qo({},D,s));var N=Qo({"aria-current":R&&i||null,className:E,style:D,to:M},g);return Oj!==h2?N.ref=e||_:N.innerRef=_,xr(Rne,{...N})})});const kne="modulepreload",Ine=function(n){return"/"+n},p6={},ki=function(e,t,i){return!t||t.length===0?e():Promise.all(t.map(r=>{if(r=Ine(r),r in p6)return;p6[r]=!0;const o=r.endsWith(".css"),s=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${s}`))return;const a=document.createElement("link");if(a.rel=o?"stylesheet":kne,o||(a.as="script",a.crossOrigin=""),a.href=r,document.head.appendChild(a),o)return new Promise((l,u)=>{a.addEventListener("load",l),a.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())};var Nne=Object.defineProperty,zne=(n,e,t)=>e in n?Nne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,q=(n,e,t)=>(zne(n,typeof e!="symbol"?e+"":e,t),t),it=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jDe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ro={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(n,e){(function(){var t,i="4.17.21",r=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",s="Expected a function",a="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",u=500,c="__lodash_placeholder__",h=1,p=2,m=4,y=1,_=2,g=1,b=2,w=4,M=8,C=16,P=32,L=64,R=128,E=256,D=512,N=30,j="...",te=800,ee=16,H=1,Q=2,Z=3,de=1/0,X=9007199254740991,B=17976931348623157e292,U=0/0,le=4294967295,ne=le-1,fe=le>>>1,we=[["ary",R],["bind",g],["bindKey",b],["curry",M],["curryRight",C],["flip",D],["partial",P],["partialRight",L],["rearg",E]],Be="[object Arguments]",oe="[object Array]",tt="[object AsyncFunction]",Ue="[object Boolean]",Ve="[object Date]",Ae="[object DOMException]",Oe="[object Error]",Te="[object Function]",be="[object GeneratorFunction]",Ye="[object Map]",Ke="[object Number]",ft="[object Null]",mt="[object Object]",yt="[object Promise]",st="[object Proxy]",Ce="[object RegExp]",ve="[object Set]",k="[object String]",O="[object Symbol]",ie="[object Undefined]",ge="[object WeakMap]",ye="[object WeakSet]",Pe="[object ArrayBuffer]",Xe="[object DataView]",re="[object Float32Array]",Fe="[object Float64Array]",Ne="[object Int8Array]",He="[object Int16Array]",Ie="[object Int32Array]",nt="[object Uint8Array]",gt="[object Uint8ClampedArray]",kt="[object Uint16Array]",W="[object Uint32Array]",De=/\b__p \+= '';/g,ae=/\b(__p \+=) '' \+/g,Re=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Me=/&(?:amp|lt|gt|quot|#39);/g,bt=/[&<>"']/g,It=RegExp(Me.source),zt=RegExp(bt.source),Kn=/<%-([\s\S]+?)%>/g,Dt=/<%([\s\S]+?)%>/g,Bn=/<%=([\s\S]+?)%>/g,yn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Hl=/^\w*$/,Ds=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ra=/[\\^$.*+?()[\]{}|]/g,Qh=RegExp(ra.source),Wl=/^\s+/,Gl=/\s/,z=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,$=/\{\n\/\* \[wrapped with (.+)\] \*/,se=/,? & /,J=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,he=/[()=,{}\[\]\/\s]/,Ge=/\\(\\)?/g,et=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,$e=/\w*$/,rt=/^[-+]0x[0-9a-f]+$/i,Ct=/^0b[01]+$/i,ct=/^\[object .+?Constructor\]$/,ht=/^0o[0-7]+$/i,Ft=/^(?:0|[1-9]\d*)$/,Ki=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Pi=/($^)/,ti=/['\n\r\u2028\u2029\\]/g,vn="\\ud800-\\udfff",wt="\\u0300-\\u036f",Ar="\\ufe20-\\ufe2f",xn="\\u20d0-\\u20ff",bn=wt+Ar+xn,ii="\\u2700-\\u27bf",Lr="a-z\\xdf-\\xf6\\xf8-\\xff",oa="\\xac\\xb1\\xd7\\xf7",Qt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Dr="\\u2000-\\u206f",Rs=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",fn="A-Z\\xc0-\\xd6\\xd8-\\xde",Os="\\ufe0e\\ufe0f",dc=oa+Qt+Dr+Rs,sa="['\u2019]",$h="["+vn+"]",ns="["+dc+"]",Ka="["+bn+"]",Xl="\\d+",of="["+ii+"]",sf="["+Lr+"]",M1="[^"+vn+dc+Xl+ii+Lr+fn+"]",ql="\\ud83c[\\udffb-\\udfff]",C1="(?:"+Ka+"|"+ql+")",E1="[^"+vn+"]",af="(?:\\ud83c[\\udde6-\\uddff]){2}",lf="[\\ud800-\\udbff][\\udc00-\\udfff]",pc="["+fn+"]",ed="\\u200d",T1="(?:"+sf+"|"+M1+")",P1="(?:"+pc+"|"+M1+")",Wg="(?:"+sa+"(?:d|ll|m|re|s|t|ve))?",A1="(?:"+sa+"(?:D|LL|M|RE|S|T|VE))?",L1=C1+"?",D1="["+Os+"]?",tE="(?:"+ed+"(?:"+[E1,af,lf].join("|")+")"+D1+L1+")*",nE="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Gg="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",fc=D1+L1+tE,iE="(?:"+[of,af,lf].join("|")+")"+fc,td="(?:"+[E1+Ka+"?",Ka,af,lf,$h].join("|")+")",rE=RegExp(sa,"g"),Xg=RegExp(Ka,"g"),uf=RegExp(ql+"(?="+ql+")|"+td+fc,"g"),oE=RegExp([pc+"?"+sf+"+"+Wg+"(?="+[ns,pc,"$"].join("|")+")",P1+"+"+A1+"(?="+[ns,pc+T1,"$"].join("|")+")",pc+"?"+T1+"+"+Wg,pc+"+"+A1,Gg,nE,Xl,iE].join("|"),"g"),sE=RegExp("["+ed+vn+bn+Os+"]"),aE=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,lE=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],uE=-1,Un={};Un[re]=Un[Fe]=Un[Ne]=Un[He]=Un[Ie]=Un[nt]=Un[gt]=Un[kt]=Un[W]=!0,Un[Be]=Un[oe]=Un[Pe]=Un[Ue]=Un[Xe]=Un[Ve]=Un[Oe]=Un[Te]=Un[Ye]=Un[Ke]=Un[mt]=Un[Ce]=Un[ve]=Un[k]=Un[ge]=!1;var In={};In[Be]=In[oe]=In[Pe]=In[Xe]=In[Ue]=In[Ve]=In[re]=In[Fe]=In[Ne]=In[He]=In[Ie]=In[Ye]=In[Ke]=In[mt]=In[Ce]=In[ve]=In[k]=In[O]=In[nt]=In[gt]=In[kt]=In[W]=!0,In[Oe]=In[Te]=In[ge]=!1;var cE={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},hE={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},dE={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pE={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},fE=parseFloat,mE=parseInt,R1=typeof it=="object"&&it&&it.Object===Object&&it,vE=typeof self=="object"&&self&&self.Object===Object&&self,Vi=R1||vE||Function("return this")(),qg=e&&!e.nodeType&&e,Yl=qg&&!0&&n&&!n.nodeType&&n,O1=Yl&&Yl.exports===qg,cf=O1&&R1.process,ko=function(){try{var pe=Yl&&Yl.require&&Yl.require("util").types;return pe||cf&&cf.binding&&cf.binding("util")}catch{}}(),ks=ko&&ko.isArrayBuffer,Yg=ko&&ko.isDate,k1=ko&&ko.isMap,Fi=ko&&ko.isRegExp,I1=ko&&ko.isSet,nd=ko&&ko.isTypedArray;function Gr(pe,ke,Le){switch(Le.length){case 0:return pe.call(ke);case 1:return pe.call(ke,Le[0]);case 2:return pe.call(ke,Le[0],Le[1]);case 3:return pe.call(ke,Le[0],Le[1],Le[2])}return pe.apply(ke,Le)}function Kg(pe,ke,Le,pt){for(var Nt=-1,Kt=pe==null?0:pe.length;++Nt<Kt;){var jn=pe[Nt];ke(pt,jn,Le(jn),pe)}return pt}function co(pe,ke){for(var Le=-1,pt=pe==null?0:pe.length;++Le<pt&&ke(pe[Le],Le,pe)!==!1;);return pe}function gE(pe,ke){for(var Le=pe==null?0:pe.length;Le--&&ke(pe[Le],Le,pe)!==!1;);return pe}function N1(pe,ke){for(var Le=-1,pt=pe==null?0:pe.length;++Le<pt;)if(!ke(pe[Le],Le,pe))return!1;return!0}function Za(pe,ke){for(var Le=-1,pt=pe==null?0:pe.length,Nt=0,Kt=[];++Le<pt;){var jn=pe[Le];ke(jn,Le,pe)&&(Kt[Nt++]=jn)}return Kt}function Ja(pe,ke){var Le=pe==null?0:pe.length;return!!Le&&Zi(pe,ke,0)>-1}function hr(pe,ke,Le){for(var pt=-1,Nt=pe==null?0:pe.length;++pt<Nt;)if(Le(ke,pe[pt]))return!0;return!1}function En(pe,ke){for(var Le=-1,pt=pe==null?0:pe.length,Nt=Array(pt);++Le<pt;)Nt[Le]=ke(pe[Le],Le,pe);return Nt}function dr(pe,ke){for(var Le=-1,pt=ke.length,Nt=pe.length;++Le<pt;)pe[Nt+Le]=ke[Le];return pe}function Zg(pe,ke,Le,pt){var Nt=-1,Kt=pe==null?0:pe.length;for(pt&&Kt&&(Le=pe[++Nt]);++Nt<Kt;)Le=ke(Le,pe[Nt],Nt,pe);return Le}function z1(pe,ke,Le,pt){var Nt=pe==null?0:pe.length;for(pt&&Nt&&(Le=pe[--Nt]);Nt--;)Le=ke(Le,pe[Nt],Nt,pe);return Le}function id(pe,ke){for(var Le=-1,pt=pe==null?0:pe.length;++Le<pt;)if(ke(pe[Le],Le,pe))return!0;return!1}var Kl=Jg("length");function Gn(pe){return pe.split("")}function V1(pe){return pe.match(J)||[]}function vi(pe,ke,Le){var pt;return Le(pe,function(Nt,Kt,jn){if(ke(Nt,Kt,jn))return pt=Kt,!1}),pt}function rd(pe,ke,Le,pt){for(var Nt=pe.length,Kt=Le+(pt?1:-1);pt?Kt--:++Kt<Nt;)if(ke(pe[Kt],Kt,pe))return Kt;return-1}function Zi(pe,ke,Le){return ke===ke?U1(pe,ke,Le):rd(pe,mc,Le)}function _E(pe,ke,Le,pt){for(var Nt=Le-1,Kt=pe.length;++Nt<Kt;)if(pt(pe[Nt],ke))return Nt;return-1}function mc(pe){return pe!==pe}function hf(pe,ke){var Le=pe==null?0:pe.length;return Le?od(pe,ke)/Le:U}function Jg(pe){return function(ke){return ke==null?t:ke[pe]}}function Qg(pe){return function(ke){return pe==null?t:pe[ke]}}function df(pe,ke,Le,pt,Nt){return Nt(pe,function(Kt,jn,Ln){Le=pt?(pt=!1,Kt):ke(Le,Kt,jn,Ln)}),Le}function yE(pe,ke){var Le=pe.length;for(pe.sort(ke);Le--;)pe[Le]=pe[Le].value;return pe}function od(pe,ke){for(var Le,pt=-1,Nt=pe.length;++pt<Nt;){var Kt=ke(pe[pt]);Kt!==t&&(Le=Le===t?Kt:Le+Kt)}return Le}function Zl(pe,ke){for(var Le=-1,pt=Array(pe);++Le<pe;)pt[Le]=ke(Le);return pt}function pf(pe,ke){return En(ke,function(Le){return[Le,pe[Le]]})}function $g(pe){return pe&&pe.slice(0,e0(pe)+1).replace(Wl,"")}function gi(pe){return function(ke){return pe(ke)}}function ff(pe,ke){return En(ke,function(Le){return pe[Le]})}function Jl(pe,ke){return pe.has(ke)}function mf(pe,ke){for(var Le=-1,pt=pe.length;++Le<pt&&Zi(ke,pe[Le],0)>-1;);return Le}function F1(pe,ke){for(var Le=pe.length;Le--&&Zi(ke,pe[Le],0)>-1;);return Le}function vf(pe,ke){for(var Le=pe.length,pt=0;Le--;)pe[Le]===ke&&++pt;return pt}var vc=Qg(cE),gc=Qg(hE);function gf(pe){return"\\"+pE[pe]}function xE(pe,ke){return pe==null?t:pe[ke]}function _c(pe){return sE.test(pe)}function bE(pe){return aE.test(pe)}function wE(pe){for(var ke,Le=[];!(ke=pe.next()).done;)Le.push(ke.value);return Le}function aa(pe){var ke=-1,Le=Array(pe.size);return pe.forEach(function(pt,Nt){Le[++ke]=[Nt,pt]}),Le}function B1(pe,ke){return function(Le){return pe(ke(Le))}}function Qa(pe,ke){for(var Le=-1,pt=pe.length,Nt=0,Kt=[];++Le<pt;){var jn=pe[Le];(jn===ke||jn===c)&&(pe[Le]=c,Kt[Nt++]=Le)}return Kt}function _f(pe){var ke=-1,Le=Array(pe.size);return pe.forEach(function(pt){Le[++ke]=pt}),Le}function SE(pe){var ke=-1,Le=Array(pe.size);return pe.forEach(function(pt){Le[++ke]=[pt,pt]}),Le}function U1(pe,ke,Le){for(var pt=Le-1,Nt=pe.length;++pt<Nt;)if(pe[pt]===ke)return pt;return-1}function ME(pe,ke,Le){for(var pt=Le+1;pt--;)if(pe[pt]===ke)return pt;return pt}function yc(pe){return _c(pe)?yf(pe):Kl(pe)}function Ji(pe){return _c(pe)?EE(pe):Gn(pe)}function e0(pe){for(var ke=pe.length;ke--&&Gl.test(pe.charAt(ke)););return ke}var CE=Qg(dE);function yf(pe){for(var ke=uf.lastIndex=0;uf.test(pe);)++ke;return ke}function EE(pe){return pe.match(uf)||[]}function j1(pe){return pe.match(oE)||[]}var TE=function pe(ke){ke=ke==null?Vi:la.defaults(Vi.Object(),ke,la.pick(Vi,lE));var Le=ke.Array,pt=ke.Date,Nt=ke.Error,Kt=ke.Function,jn=ke.Math,Ln=ke.Object,Xr=ke.RegExp,PE=ke.String,ho=ke.TypeError,sd=Le.prototype,H1=Kt.prototype,Ql=Ln.prototype,ad=ke["__core-js_shared__"],ld=H1.toString,gn=Ql.hasOwnProperty,W1=0,t0=function(){var d=/[^.]+$/.exec(ad&&ad.keys&&ad.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),ud=Ql.toString,AE=ld.call(Ln),G1=Vi._,LE=Xr("^"+ld.call(gn).replace(ra,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cd=O1?ke.Buffer:t,ua=ke.Symbol,hd=ke.Uint8Array,n0=cd?cd.allocUnsafe:t,xf=B1(Ln.getPrototypeOf,Ln),X1=Ln.create,bf=Ql.propertyIsEnumerable,dd=sd.splice,q1=ua?ua.isConcatSpreadable:t,$l=ua?ua.iterator:t,$a=ua?ua.toStringTag:t,pd=function(){try{var d=Ed(Ln,"defineProperty");return d({},"",{}),d}catch{}}(),i0=ke.clearTimeout!==Vi.clearTimeout&&ke.clearTimeout,Y1=pt&&pt.now!==Vi.Date.now&&pt.now,DE=ke.setTimeout!==Vi.setTimeout&&ke.setTimeout,eu=jn.ceil,wf=jn.floor,r0=Ln.getOwnPropertySymbols,RE=cd?cd.isBuffer:t,o0=ke.isFinite,OE=sd.join,K1=B1(Ln.keys,Ln),Ai=jn.max,pr=jn.min,s0=pt.now,fd=ke.parseInt,Z1=jn.random,kE=sd.reverse,el=Ed(ke,"DataView"),md=Ed(ke,"Map"),a0=Ed(ke,"Promise"),xc=Ed(ke,"Set"),vd=Ed(ke,"WeakMap"),tu=Ed(Ln,"create"),Sf=vd&&new vd,tl={},IE=Td(el),NE=Td(md),l0=Td(a0),J1=Td(xc),zE=Td(vd),Mf=ua?ua.prototype:t,gd=Mf?Mf.valueOf:t,Cf=Mf?Mf.toString:t;function G(d){if(_i(d)&&!Ut(d)&&!(d instanceof $t)){if(d instanceof Io)return d;if(gn.call(d,"__wrapped__"))return d5(d)}return new Io(d)}var bc=function(){function d(){}return function(v){if(!ri(v))return{};if(X1)return X1(v);d.prototype=v;var T=new d;return d.prototype=t,T}}();function wc(){}function Io(d,v){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!v,this.__index__=0,this.__values__=t}G.templateSettings={escape:Kn,evaluate:Dt,interpolate:Bn,variable:"",imports:{_:G}},G.prototype=wc.prototype,G.prototype.constructor=G,Io.prototype=bc(wc.prototype),Io.prototype.constructor=Io;function $t(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=le,this.__views__=[]}function VE(){var d=new $t(this.__wrapped__);return d.__actions__=zo(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=zo(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=zo(this.__views__),d}function FE(){if(this.__filtered__){var d=new $t(this);d.__dir__=-1,d.__filtered__=!0}else d=this.clone(),d.__dir__*=-1;return d}function BE(){var d=this.__wrapped__.value(),v=this.__dir__,T=Ut(d),I=v<0,V=T?d.length:0,Y=FY(0,V,this.__views__),ue=Y.start,me=Y.end,_e=me-ue,je=I?me:ue-1,We=this.__iteratees__,qe=We.length,ut=0,Mt=pr(_e,this.__takeCount__);if(!T||!I&&V==_e&&Mt==_e)return II(d,this.__actions__);var Rt=[];e:for(;_e--&&ut<Mt;){je+=v;for(var Xt=-1,Ot=d[je];++Xt<qe;){var en=We[Xt],ln=en.iteratee,os=en.type,vo=ln(Ot);if(os==Q)Ot=vo;else if(!vo){if(os==H)continue e;break e}}Rt[ut++]=Ot}return Rt}$t.prototype=bc(wc.prototype),$t.prototype.constructor=$t;function nu(d){var v=-1,T=d==null?0:d.length;for(this.clear();++v<T;){var I=d[v];this.set(I[0],I[1])}}function UE(){this.__data__=tu?tu(null):{},this.size=0}function jE(d){var v=this.has(d)&&delete this.__data__[d];return this.size-=v?1:0,v}function HE(d){var v=this.__data__;if(tu){var T=v[d];return T===l?t:T}return gn.call(v,d)?v[d]:t}function WE(d){var v=this.__data__;return tu?v[d]!==t:gn.call(v,d)}function GE(d,v){var T=this.__data__;return this.size+=this.has(d)?0:1,T[d]=tu&&v===t?l:v,this}nu.prototype.clear=UE,nu.prototype.delete=jE,nu.prototype.get=HE,nu.prototype.has=WE,nu.prototype.set=GE;function ca(d){var v=-1,T=d==null?0:d.length;for(this.clear();++v<T;){var I=d[v];this.set(I[0],I[1])}}function u0(){this.__data__=[],this.size=0}function XE(d){var v=this.__data__,T=yd(v,d);if(T<0)return!1;var I=v.length-1;return T==I?v.pop():dd.call(v,T,1),--this.size,!0}function qE(d){var v=this.__data__,T=yd(v,d);return T<0?t:v[T][1]}function YE(d){return yd(this.__data__,d)>-1}function KE(d,v){var T=this.__data__,I=yd(T,d);return I<0?(++this.size,T.push([d,v])):T[I][1]=v,this}ca.prototype.clear=u0,ca.prototype.delete=XE,ca.prototype.get=qE,ca.prototype.has=YE,ca.prototype.set=KE;function ha(d){var v=-1,T=d==null?0:d.length;for(this.clear();++v<T;){var I=d[v];this.set(I[0],I[1])}}function ZE(){this.size=0,this.__data__={hash:new nu,map:new(md||ca),string:new nu}}function JE(d){var v=bb(this,d).delete(d);return this.size-=v?1:0,v}function QE(d){return bb(this,d).get(d)}function nl(d){return bb(this,d).has(d)}function Q1(d,v){var T=bb(this,d),I=T.size;return T.set(d,v),this.size+=T.size==I?0:1,this}ha.prototype.clear=ZE,ha.prototype.delete=JE,ha.prototype.get=QE,ha.prototype.has=nl,ha.prototype.set=Q1;function iu(d){var v=-1,T=d==null?0:d.length;for(this.__data__=new ha;++v<T;)this.add(d[v])}function $E(d){return this.__data__.set(d,l),this}function c0(d){return this.__data__.has(d)}iu.prototype.add=iu.prototype.push=$E,iu.prototype.has=c0;function No(d){var v=this.__data__=new ca(d);this.size=v.size}function $1(){this.__data__=new ca,this.size=0}function eT(d){var v=this.__data__,T=v.delete(d);return this.size=v.size,T}function tT(d){return this.__data__.get(d)}function nT(d){return this.__data__.has(d)}function iT(d,v){var T=this.__data__;if(T instanceof ca){var I=T.__data__;if(!md||I.length<r-1)return I.push([d,v]),this.size=++T.size,this;T=this.__data__=new ha(I)}return T.set(d,v),this.size=T.size,this}No.prototype.clear=$1,No.prototype.delete=eT,No.prototype.get=tT,No.prototype.has=nT,No.prototype.set=iT;function da(d,v){var T=Ut(d),I=!T&&Pd(d),V=!T&&!I&&Ec(d),Y=!T&&!I&&!V&&If(d),ue=T||I||V||Y,me=ue?Zl(d.length,PE):[],_e=me.length;for(var je in d)(v||gn.call(d,je))&&!(ue&&(je=="length"||V&&(je=="offset"||je=="parent")||Y&&(je=="buffer"||je=="byteLength"||je=="byteOffset")||uu(je,_e)))&&me.push(je);return me}function h0(d){var v=d.length;return v?d[S0(0,v-1)]:t}function Sc(d,v){return wb(zo(d),ru(v,0,d.length))}function rT(d){return wb(zo(d))}function Is(d,v,T){(T!==t&&!ma(d[v],T)||T===t&&!(v in d))&&pa(d,v,T)}function _d(d,v,T){var I=d[v];(!(gn.call(d,v)&&ma(I,T))||T===t&&!(v in d))&&pa(d,v,T)}function yd(d,v){for(var T=d.length;T--;)if(ma(d[T][0],v))return T;return-1}function oT(d,v,T,I){return fo(d,function(V,Y,ue){v(I,V,T(V),ue)}),I}function eb(d,v){return d&&ol(v,fr(v),d)}function sT(d,v){return d&&ol(v,Fo(v),d)}function pa(d,v,T){v=="__proto__"&&pd?pd(d,v,{configurable:!0,enumerable:!0,value:T,writable:!0}):d[v]=T}function is(d,v){for(var T=-1,I=v.length,V=Le(I),Y=d==null;++T<I;)V[T]=Y?t:UT(d,v[T]);return V}function ru(d,v,T){return d===d&&(T!==t&&(d=d<=T?d:T),v!==t&&(d=d>=v?d:v)),d}function po(d,v,T,I,V,Y){var ue,me=v&h,_e=v&p,je=v&m;if(T&&(ue=V?T(d,I,V,Y):T(d)),ue!==t)return ue;if(!ri(d))return d;var We=Ut(d);if(We){if(ue=UY(d),!me)return zo(d,ue)}else{var qe=qr(d),ut=qe==Te||qe==be;if(Ec(d))return VI(d,me);if(qe==mt||qe==Be||ut&&!V){if(ue=_e||ut?{}:i5(d),!me)return _e?LY(d,sT(ue,d)):AY(d,eb(ue,d))}else{if(!In[qe])return V?d:{};ue=jY(d,qe,me)}}Y||(Y=new No);var Mt=Y.get(d);if(Mt)return Mt;Y.set(d,ue),R5(d)?d.forEach(function(Ot){ue.add(po(Ot,v,T,Ot,d,Y))}):L5(d)&&d.forEach(function(Ot,en){ue.set(en,po(Ot,v,T,en,d,Y))});var Rt=je?_e?TT:ET:_e?Fo:fr,Xt=We?t:Rt(d);return co(Xt||d,function(Ot,en){Xt&&(en=Ot,Ot=d[en]),_d(ue,en,po(Ot,v,T,en,d,Y))}),ue}function aT(d){var v=fr(d);return function(T){return d0(T,d,v)}}function d0(d,v,T){var I=T.length;if(d==null)return!I;for(d=Ln(d);I--;){var V=T[I],Y=v[V],ue=d[V];if(ue===t&&!(V in d)||!Y(ue))return!1}return!0}function tb(d,v,T){if(typeof d!="function")throw new ho(s);return E0(function(){d.apply(t,T)},v)}function xd(d,v,T,I){var V=-1,Y=Ja,ue=!0,me=d.length,_e=[],je=v.length;if(!me)return _e;T&&(v=En(v,gi(T))),I?(Y=hr,ue=!1):v.length>=r&&(Y=Jl,ue=!1,v=new iu(v));e:for(;++V<me;){var We=d[V],qe=T==null?We:T(We);if(We=I||We!==0?We:0,ue&&qe===qe){for(var ut=je;ut--;)if(v[ut]===qe)continue e;_e.push(We)}else Y(v,qe,I)||_e.push(We)}return _e}var fo=HI(Ns),p0=HI(m0,!0);function lT(d,v){var T=!0;return fo(d,function(I,V,Y){return T=!!v(I,V,Y),T}),T}function Ef(d,v,T){for(var I=-1,V=d.length;++I<V;){var Y=d[I],ue=v(Y);if(ue!=null&&(me===t?ue===ue&&!rs(ue):T(ue,me)))var me=ue,_e=Y}return _e}function uT(d,v,T,I){var V=d.length;for(T=Gt(T),T<0&&(T=-T>V?0:V+T),I=I===t||I>V?V:Gt(I),I<0&&(I+=V),I=T>I?0:k5(I);T<I;)d[T++]=v;return d}function Tf(d,v){var T=[];return fo(d,function(I,V,Y){v(I,V,Y)&&T.push(I)}),T}function Qi(d,v,T,I,V){var Y=-1,ue=d.length;for(T||(T=WY),V||(V=[]);++Y<ue;){var me=d[Y];v>0&&T(me)?v>1?Qi(me,v-1,T,I,V):dr(V,me):I||(V[V.length]=me)}return V}var il=WI(),f0=WI(!0);function Ns(d,v){return d&&il(d,v,fr)}function m0(d,v){return d&&f0(d,v,fr)}function Pf(d,v){return Za(v,function(T){return cu(d[T])})}function ou(d,v){v=Mc(v,d);for(var T=0,I=v.length;d!=null&&T<I;)d=d[sl(v[T++])];return T&&T==I?d:t}function nb(d,v,T){var I=v(d);return Ut(d)?I:dr(I,T(d))}function Rr(d){return d==null?d===t?ie:ft:$a&&$a in Ln(d)?VY(d):JY(d)}function v0(d,v){return d>v}function bd(d,v){return d!=null&&gn.call(d,v)}function ib(d,v){return d!=null&&v in Ln(d)}function cT(d,v,T){return d>=pr(v,T)&&d<Ai(v,T)}function wd(d,v,T){for(var I=T?hr:Ja,V=d[0].length,Y=d.length,ue=Y,me=Le(Y),_e=1/0,je=[];ue--;){var We=d[ue];ue&&v&&(We=En(We,gi(v))),_e=pr(We.length,_e),me[ue]=!T&&(v||V>=120&&We.length>=120)?new iu(ue&&We):t}We=d[0];var qe=-1,ut=me[0];e:for(;++qe<V&&je.length<_e;){var Mt=We[qe],Rt=v?v(Mt):Mt;if(Mt=T||Mt!==0?Mt:0,!(ut?Jl(ut,Rt):I(je,Rt,T))){for(ue=Y;--ue;){var Xt=me[ue];if(!(Xt?Jl(Xt,Rt):I(d[ue],Rt,T)))continue e}ut&&ut.push(Rt),je.push(Mt)}}return je}function rb(d,v,T,I){return Ns(d,function(V,Y,ue){v(I,T(V),Y,ue)}),I}function Sd(d,v,T){v=Mc(v,d),d=a5(d,v);var I=d==null?d:d[sl(zs(v))];return I==null?t:Gr(I,d,T)}function Af(d){return _i(d)&&Rr(d)==Be}function hT(d){return _i(d)&&Rr(d)==Pe}function rl(d){return _i(d)&&Rr(d)==Ve}function Md(d,v,T,I,V){return d===v?!0:d==null||v==null||!_i(d)&&!_i(v)?d!==d&&v!==v:dT(d,v,T,I,Md,V)}function dT(d,v,T,I,V,Y){var ue=Ut(d),me=Ut(v),_e=ue?oe:qr(d),je=me?oe:qr(v);_e=_e==Be?mt:_e,je=je==Be?mt:je;var We=_e==mt,qe=je==mt,ut=_e==je;if(ut&&Ec(d)){if(!Ec(v))return!1;ue=!0,We=!1}if(ut&&!We)return Y||(Y=new No),ue||If(d)?e5(d,v,T,I,V,Y):NY(d,v,_e,T,I,V,Y);if(!(T&y)){var Mt=We&&gn.call(d,"__wrapped__"),Rt=qe&&gn.call(v,"__wrapped__");if(Mt||Rt){var Xt=Mt?d.value():d,Ot=Rt?v.value():v;return Y||(Y=new No),V(Xt,Ot,T,I,Y)}}return ut?(Y||(Y=new No),zY(d,v,T,I,V,Y)):!1}function g0(d){return _i(d)&&qr(d)==Ye}function _0(d,v,T,I){var V=T.length,Y=V,ue=!I;if(d==null)return!Y;for(d=Ln(d);V--;){var me=T[V];if(ue&&me[2]?me[1]!==d[me[0]]:!(me[0]in d))return!1}for(;++V<Y;){me=T[V];var _e=me[0],je=d[_e],We=me[1];if(ue&&me[2]){if(je===t&&!(_e in d))return!1}else{var qe=new No;if(I)var ut=I(je,We,_e,d,v,qe);if(!(ut===t?Md(We,je,y|_,I,qe):ut))return!1}}return!0}function ob(d){if(!ri(d)||XY(d))return!1;var v=cu(d)?LE:ct;return v.test(Td(d))}function sb(d){return _i(d)&&Rr(d)==Ce}function pT(d){return _i(d)&&qr(d)==ve}function fT(d){return _i(d)&&Pb(d.length)&&!!Un[Rr(d)]}function ab(d){return typeof d=="function"?d:d==null?Bo:typeof d=="object"?Ut(d)?cb(d[0],d[1]):ub(d):G5(d)}function y0(d){if(!C0(d))return K1(d);var v=[];for(var T in Ln(d))gn.call(d,T)&&T!="constructor"&&v.push(T);return v}function mT(d){if(!ri(d))return ZY(d);var v=C0(d),T=[];for(var I in d)I=="constructor"&&(v||!gn.call(d,I))||T.push(I);return T}function x0(d,v){return d<v}function lb(d,v){var T=-1,I=Vo(d)?Le(d.length):[];return fo(d,function(V,Y,ue){I[++T]=v(V,Y,ue)}),I}function ub(d){var v=AT(d);return v.length==1&&v[0][2]?o5(v[0][0],v[0][1]):function(T){return T===d||_0(T,d,v)}}function cb(d,v){return DT(d)&&r5(v)?o5(sl(d),v):function(T){var I=UT(T,d);return I===t&&I===v?jT(T,d):Md(v,I,y|_)}}function Cd(d,v,T,I,V){d!==v&&il(v,function(Y,ue){if(V||(V=new No),ri(Y))hb(d,v,ue,T,Cd,I,V);else{var me=I?I(OT(d,ue),Y,ue+"",d,v,V):t;me===t&&(me=Y),Is(d,ue,me)}},Fo)}function hb(d,v,T,I,V,Y,ue){var me=OT(d,T),_e=OT(v,T),je=ue.get(_e);if(je){Is(d,T,je);return}var We=Y?Y(me,_e,T+"",d,v,ue):t,qe=We===t;if(qe){var ut=Ut(_e),Mt=!ut&&Ec(_e),Rt=!ut&&!Mt&&If(_e);We=_e,ut||Mt||Rt?Ut(me)?We=me:Li(me)?We=zo(me):Mt?(qe=!1,We=VI(_e,!0)):Rt?(qe=!1,We=FI(_e,!0)):We=[]:T0(_e)||Pd(_e)?(We=me,Pd(me)?We=I5(me):(!ri(me)||cu(me))&&(We=i5(_e))):qe=!1}qe&&(ue.set(_e,We),V(We,_e,I,Y,ue),ue.delete(_e)),Is(d,T,We)}function b0(d,v){var T=d.length;if(T)return v+=v<0?T:0,uu(v,T)?d[v]:t}function db(d,v,T){v.length?v=En(v,function(Y){return Ut(Y)?function(ue){return ou(ue,Y.length===1?Y[0]:Y)}:Y}):v=[Bo];var I=-1;v=En(v,gi(Lt()));var V=lb(d,function(Y,ue,me){var _e=En(v,function(je){return je(Y)});return{criteria:_e,index:++I,value:Y}});return yE(V,function(Y,ue){return PY(Y,ue,T)})}function vT(d,v){return pb(d,v,function(T,I){return jT(d,I)})}function pb(d,v,T){for(var I=-1,V=v.length,Y={};++I<V;){var ue=v[I],me=ou(d,ue);T(me,ue)&&f(Y,Mc(ue,d),me)}return Y}function gT(d){return function(v){return ou(v,d)}}function w0(d,v,T,I){var V=I?_E:Zi,Y=-1,ue=v.length,me=d;for(d===v&&(v=zo(v)),T&&(me=En(d,gi(T)));++Y<ue;)for(var _e=0,je=v[Y],We=T?T(je):je;(_e=V(me,We,_e,I))>-1;)me!==d&&dd.call(me,_e,1),dd.call(d,_e,1);return d}function fb(d,v){for(var T=d?v.length:0,I=T-1;T--;){var V=v[T];if(T==I||V!==Y){var Y=V;uu(V)?dd.call(d,V,1):fa(d,V)}}return d}function S0(d,v){return d+wf(Z1()*(v-d+1))}function _T(d,v,T,I){for(var V=-1,Y=Ai(eu((v-d)/(T||1)),0),ue=Le(Y);Y--;)ue[I?Y:++V]=d,d+=T;return ue}function Lf(d,v){var T="";if(!d||v<1||v>X)return T;do v%2&&(T+=d),v=wf(v/2),v&&(d+=d);while(v);return T}function Wt(d,v){return kT(s5(d,v,Bo),d+"")}function yT(d){return h0(Nf(d))}function S(d,v){var T=Nf(d);return wb(T,ru(v,0,T.length))}function f(d,v,T,I){if(!ri(d))return d;v=Mc(v,d);for(var V=-1,Y=v.length,ue=Y-1,me=d;me!=null&&++V<Y;){var _e=sl(v[V]),je=T;if(_e==="__proto__"||_e==="constructor"||_e==="prototype")return d;if(V!=ue){var We=me[_e];je=I?I(We,_e,me):t,je===t&&(je=ri(We)?We:uu(v[V+1])?[]:{})}_d(me,_e,je),me=me[_e]}return d}var x=Sf?function(d,v){return Sf.set(d,v),d}:Bo,A=pd?function(d,v){return pd(d,"toString",{configurable:!0,enumerable:!1,value:WT(v),writable:!0})}:Bo;function F(d){return wb(Nf(d))}function ce(d,v,T){var I=-1,V=d.length;v<0&&(v=-v>V?0:V+v),T=T>V?V:T,T<0&&(T+=V),V=v>T?0:T-v>>>0,v>>>=0;for(var Y=Le(V);++I<V;)Y[I]=d[I+v];return Y}function xe(d,v){var T;return fo(d,function(I,V,Y){return T=v(I,V,Y),!T}),!!T}function Je(d,v,T){var I=0,V=d==null?I:d.length;if(typeof v=="number"&&v===v&&V<=fe){for(;I<V;){var Y=I+V>>>1,ue=d[Y];ue!==null&&!rs(ue)&&(T?ue<=v:ue<v)?I=Y+1:V=Y}return V}return Et(d,v,Bo,T)}function Et(d,v,T,I){var V=0,Y=d==null?0:d.length;if(Y===0)return 0;v=T(v);for(var ue=v!==v,me=v===null,_e=rs(v),je=v===t;V<Y;){var We=wf((V+Y)/2),qe=T(d[We]),ut=qe!==t,Mt=qe===null,Rt=qe===qe,Xt=rs(qe);if(ue)var Ot=I||Rt;else je?Ot=Rt&&(I||ut):me?Ot=Rt&&ut&&(I||!Mt):_e?Ot=Rt&&ut&&!Mt&&(I||!Xt):Mt||Xt?Ot=!1:Ot=I?qe<=v:qe<v;Ot?V=We+1:Y=We}return pr(Y,ne)}function At(d,v){for(var T=-1,I=d.length,V=0,Y=[];++T<I;){var ue=d[T],me=v?v(ue):ue;if(!T||!ma(me,_e)){var _e=me;Y[V++]=ue===0?0:ue}}return Y}function an(d){return typeof d=="number"?d:rs(d)?U:+d}function Ht(d){if(typeof d=="string")return d;if(Ut(d))return En(d,Ht)+"";if(rs(d))return Cf?Cf.call(d):"";var v=d+"";return v=="0"&&1/d==-de?"-0":v}function Or(d,v,T){var I=-1,V=Ja,Y=d.length,ue=!0,me=[],_e=me;if(T)ue=!1,V=hr;else if(Y>=r){var je=v?null:kY(d);if(je)return _f(je);ue=!1,V=Jl,_e=new iu}else _e=v?[]:me;e:for(;++I<Y;){var We=d[I],qe=v?v(We):We;if(We=T||We!==0?We:0,ue&&qe===qe){for(var ut=_e.length;ut--;)if(_e[ut]===qe)continue e;v&&_e.push(qe),me.push(We)}else V(_e,qe,T)||(_e!==me&&_e.push(qe),me.push(We))}return me}function fa(d,v){return v=Mc(v,d),d=a5(d,v),d==null||delete d[sl(zs(v))]}function su(d,v,T,I){return f(d,v,T(ou(d,v)),I)}function Df(d,v,T,I){for(var V=d.length,Y=I?V:-1;(I?Y--:++Y<V)&&v(d[Y],Y,d););return T?ce(d,I?0:Y,I?Y+1:V):ce(d,I?Y+1:0,I?V:Y)}function II(d,v){var T=d;return T instanceof $t&&(T=T.value()),Zg(v,function(I,V){return V.func.apply(V.thisArg,dr([I],V.args))},T)}function xT(d,v,T){var I=d.length;if(I<2)return I?Or(d[0]):[];for(var V=-1,Y=Le(I);++V<I;)for(var ue=d[V],me=-1;++me<I;)me!=V&&(Y[V]=xd(Y[V]||ue,d[me],v,T));return Or(Qi(Y,1),v,T)}function NI(d,v,T){for(var I=-1,V=d.length,Y=v.length,ue={};++I<V;){var me=I<Y?v[I]:t;T(ue,d[I],me)}return ue}function bT(d){return Li(d)?d:[]}function wT(d){return typeof d=="function"?d:Bo}function Mc(d,v){return Ut(d)?d:DT(d,v)?[d]:h5(Tn(d))}var MY=Wt;function Cc(d,v,T){var I=d.length;return T=T===t?I:T,!v&&T>=I?d:ce(d,v,T)}var zI=i0||function(d){return Vi.clearTimeout(d)};function VI(d,v){if(v)return d.slice();var T=d.length,I=n0?n0(T):new d.constructor(T);return d.copy(I),I}function ST(d){var v=new d.constructor(d.byteLength);return new hd(v).set(new hd(d)),v}function CY(d,v){var T=v?ST(d.buffer):d.buffer;return new d.constructor(T,d.byteOffset,d.byteLength)}function EY(d){var v=new d.constructor(d.source,$e.exec(d));return v.lastIndex=d.lastIndex,v}function TY(d){return gd?Ln(gd.call(d)):{}}function FI(d,v){var T=v?ST(d.buffer):d.buffer;return new d.constructor(T,d.byteOffset,d.length)}function BI(d,v){if(d!==v){var T=d!==t,I=d===null,V=d===d,Y=rs(d),ue=v!==t,me=v===null,_e=v===v,je=rs(v);if(!me&&!je&&!Y&&d>v||Y&&ue&&_e&&!me&&!je||I&&ue&&_e||!T&&_e||!V)return 1;if(!I&&!Y&&!je&&d<v||je&&T&&V&&!I&&!Y||me&&T&&V||!ue&&V||!_e)return-1}return 0}function PY(d,v,T){for(var I=-1,V=d.criteria,Y=v.criteria,ue=V.length,me=T.length;++I<ue;){var _e=BI(V[I],Y[I]);if(_e){if(I>=me)return _e;var je=T[I];return _e*(je=="desc"?-1:1)}}return d.index-v.index}function UI(d,v,T,I){for(var V=-1,Y=d.length,ue=T.length,me=-1,_e=v.length,je=Ai(Y-ue,0),We=Le(_e+je),qe=!I;++me<_e;)We[me]=v[me];for(;++V<ue;)(qe||V<Y)&&(We[T[V]]=d[V]);for(;je--;)We[me++]=d[V++];return We}function jI(d,v,T,I){for(var V=-1,Y=d.length,ue=-1,me=T.length,_e=-1,je=v.length,We=Ai(Y-me,0),qe=Le(We+je),ut=!I;++V<We;)qe[V]=d[V];for(var Mt=V;++_e<je;)qe[Mt+_e]=v[_e];for(;++ue<me;)(ut||V<Y)&&(qe[Mt+T[ue]]=d[V++]);return qe}function zo(d,v){var T=-1,I=d.length;for(v||(v=Le(I));++T<I;)v[T]=d[T];return v}function ol(d,v,T,I){var V=!T;T||(T={});for(var Y=-1,ue=v.length;++Y<ue;){var me=v[Y],_e=I?I(T[me],d[me],me,T,d):t;_e===t&&(_e=d[me]),V?pa(T,me,_e):_d(T,me,_e)}return T}function AY(d,v){return ol(d,LT(d),v)}function LY(d,v){return ol(d,t5(d),v)}function mb(d,v){return function(T,I){var V=Ut(T)?Kg:oT,Y=v?v():{};return V(T,d,Lt(I,2),Y)}}function Rf(d){return Wt(function(v,T){var I=-1,V=T.length,Y=V>1?T[V-1]:t,ue=V>2?T[2]:t;for(Y=d.length>3&&typeof Y=="function"?(V--,Y):t,ue&&mo(T[0],T[1],ue)&&(Y=V<3?t:Y,V=1),v=Ln(v);++I<V;){var me=T[I];me&&d(v,me,I,Y)}return v})}function HI(d,v){return function(T,I){if(T==null)return T;if(!Vo(T))return d(T,I);for(var V=T.length,Y=v?V:-1,ue=Ln(T);(v?Y--:++Y<V)&&I(ue[Y],Y,ue)!==!1;);return T}}function WI(d){return function(v,T,I){for(var V=-1,Y=Ln(v),ue=I(v),me=ue.length;me--;){var _e=ue[d?me:++V];if(T(Y[_e],_e,Y)===!1)break}return v}}function DY(d,v,T){var I=v&g,V=M0(d);function Y(){var ue=this&&this!==Vi&&this instanceof Y?V:d;return ue.apply(I?T:this,arguments)}return Y}function GI(d){return function(v){v=Tn(v);var T=_c(v)?Ji(v):t,I=T?T[0]:v.charAt(0),V=T?Cc(T,1).join(""):v.slice(1);return I[d]()+V}}function Of(d){return function(v){return Zg(H5(j5(v).replace(rE,"")),d,"")}}function M0(d){return function(){var v=arguments;switch(v.length){case 0:return new d;case 1:return new d(v[0]);case 2:return new d(v[0],v[1]);case 3:return new d(v[0],v[1],v[2]);case 4:return new d(v[0],v[1],v[2],v[3]);case 5:return new d(v[0],v[1],v[2],v[3],v[4]);case 6:return new d(v[0],v[1],v[2],v[3],v[4],v[5]);case 7:return new d(v[0],v[1],v[2],v[3],v[4],v[5],v[6])}var T=bc(d.prototype),I=d.apply(T,v);return ri(I)?I:T}}function RY(d,v,T){var I=M0(d);function V(){for(var Y=arguments.length,ue=Le(Y),me=Y,_e=kf(V);me--;)ue[me]=arguments[me];var je=Y<3&&ue[0]!==_e&&ue[Y-1]!==_e?[]:Qa(ue,_e);if(Y-=je.length,Y<T)return ZI(d,v,vb,V.placeholder,t,ue,je,t,t,T-Y);var We=this&&this!==Vi&&this instanceof V?I:d;return Gr(We,this,ue)}return V}function XI(d){return function(v,T,I){var V=Ln(v);if(!Vo(v)){var Y=Lt(T,3);v=fr(v),T=function(me){return Y(V[me],me,V)}}var ue=d(v,T,I);return ue>-1?V[Y?v[ue]:ue]:t}}function qI(d){return lu(function(v){var T=v.length,I=T,V=Io.prototype.thru;for(d&&v.reverse();I--;){var Y=v[I];if(typeof Y!="function")throw new ho(s);if(V&&!ue&&xb(Y)=="wrapper")var ue=new Io([],!0)}for(I=ue?I:T;++I<T;){Y=v[I];var me=xb(Y),_e=me=="wrapper"?PT(Y):t;_e&&RT(_e[0])&&_e[1]==(R|M|P|E)&&!_e[4].length&&_e[9]==1?ue=ue[xb(_e[0])].apply(ue,_e[3]):ue=Y.length==1&&RT(Y)?ue[me]():ue.thru(Y)}return function(){var je=arguments,We=je[0];if(ue&&je.length==1&&Ut(We))return ue.plant(We).value();for(var qe=0,ut=T?v[qe].apply(this,je):We;++qe<T;)ut=v[qe].call(this,ut);return ut}})}function vb(d,v,T,I,V,Y,ue,me,_e,je){var We=v&R,qe=v&g,ut=v&b,Mt=v&(M|C),Rt=v&D,Xt=ut?t:M0(d);function Ot(){for(var en=arguments.length,ln=Le(en),os=en;os--;)ln[os]=arguments[os];if(Mt)var vo=kf(Ot),ss=vf(ln,vo);if(I&&(ln=UI(ln,I,V,Mt)),Y&&(ln=jI(ln,Y,ue,Mt)),en-=ss,Mt&&en<je){var Di=Qa(ln,vo);return ZI(d,v,vb,Ot.placeholder,T,ln,Di,me,_e,je-en)}var va=qe?T:this,du=ut?va[d]:d;return en=ln.length,me?ln=QY(ln,me):Rt&&en>1&&ln.reverse(),We&&_e<en&&(ln.length=_e),this&&this!==Vi&&this instanceof Ot&&(du=Xt||M0(du)),du.apply(va,ln)}return Ot}function YI(d,v){return function(T,I){return rb(T,d,v(I),{})}}function gb(d,v){return function(T,I){var V;if(T===t&&I===t)return v;if(T!==t&&(V=T),I!==t){if(V===t)return I;typeof T=="string"||typeof I=="string"?(T=Ht(T),I=Ht(I)):(T=an(T),I=an(I)),V=d(T,I)}return V}}function MT(d){return lu(function(v){return v=En(v,gi(Lt())),Wt(function(T){var I=this;return d(v,function(V){return Gr(V,I,T)})})})}function _b(d,v){v=v===t?" ":Ht(v);var T=v.length;if(T<2)return T?Lf(v,d):v;var I=Lf(v,eu(d/yc(v)));return _c(v)?Cc(Ji(I),0,d).join(""):I.slice(0,d)}function OY(d,v,T,I){var V=v&g,Y=M0(d);function ue(){for(var me=-1,_e=arguments.length,je=-1,We=I.length,qe=Le(We+_e),ut=this&&this!==Vi&&this instanceof ue?Y:d;++je<We;)qe[je]=I[je];for(;_e--;)qe[je++]=arguments[++me];return Gr(ut,V?T:this,qe)}return ue}function KI(d){return function(v,T,I){return I&&typeof I!="number"&&mo(v,T,I)&&(T=I=t),v=hu(v),T===t?(T=v,v=0):T=hu(T),I=I===t?v<T?1:-1:hu(I),_T(v,T,I,d)}}function yb(d){return function(v,T){return typeof v=="string"&&typeof T=="string"||(v=Vs(v),T=Vs(T)),d(v,T)}}function ZI(d,v,T,I,V,Y,ue,me,_e,je){var We=v&M,qe=We?ue:t,ut=We?t:ue,Mt=We?Y:t,Rt=We?t:Y;v|=We?P:L,v&=~(We?L:P),v&w||(v&=~(g|b));var Xt=[d,v,V,Mt,qe,Rt,ut,me,_e,je],Ot=T.apply(t,Xt);return RT(d)&&l5(Ot,Xt),Ot.placeholder=I,u5(Ot,d,v)}function CT(d){var v=jn[d];return function(T,I){if(T=Vs(T),I=I==null?0:pr(Gt(I),292),I&&o0(T)){var V=(Tn(T)+"e").split("e"),Y=v(V[0]+"e"+(+V[1]+I));return V=(Tn(Y)+"e").split("e"),+(V[0]+"e"+(+V[1]-I))}return v(T)}}var kY=xc&&1/_f(new xc([,-0]))[1]==de?function(d){return new xc(d)}:qT;function JI(d){return function(v){var T=qr(v);return T==Ye?aa(v):T==ve?SE(v):pf(v,d(v))}}function au(d,v,T,I,V,Y,ue,me){var _e=v&b;if(!_e&&typeof d!="function")throw new ho(s);var je=I?I.length:0;if(je||(v&=~(P|L),I=V=t),ue=ue===t?ue:Ai(Gt(ue),0),me=me===t?me:Gt(me),je-=V?V.length:0,v&L){var We=I,qe=V;I=V=t}var ut=_e?t:PT(d),Mt=[d,v,T,I,V,We,qe,Y,ue,me];if(ut&&KY(Mt,ut),d=Mt[0],v=Mt[1],T=Mt[2],I=Mt[3],V=Mt[4],me=Mt[9]=Mt[9]===t?_e?0:d.length:Ai(Mt[9]-je,0),!me&&v&(M|C)&&(v&=~(M|C)),!v||v==g)var Rt=DY(d,v,T);else v==M||v==C?Rt=RY(d,v,me):(v==P||v==(g|P))&&!V.length?Rt=OY(d,v,T,I):Rt=vb.apply(t,Mt);var Xt=ut?x:l5;return u5(Xt(Rt,Mt),d,v)}function QI(d,v,T,I){return d===t||ma(d,Ql[T])&&!gn.call(I,T)?v:d}function $I(d,v,T,I,V,Y){return ri(d)&&ri(v)&&(Y.set(v,d),Cd(d,v,t,$I,Y),Y.delete(v)),d}function IY(d){return T0(d)?t:d}function e5(d,v,T,I,V,Y){var ue=T&y,me=d.length,_e=v.length;if(me!=_e&&!(ue&&_e>me))return!1;var je=Y.get(d),We=Y.get(v);if(je&&We)return je==v&&We==d;var qe=-1,ut=!0,Mt=T&_?new iu:t;for(Y.set(d,v),Y.set(v,d);++qe<me;){var Rt=d[qe],Xt=v[qe];if(I)var Ot=ue?I(Xt,Rt,qe,v,d,Y):I(Rt,Xt,qe,d,v,Y);if(Ot!==t){if(Ot)continue;ut=!1;break}if(Mt){if(!id(v,function(en,ln){if(!Jl(Mt,ln)&&(Rt===en||V(Rt,en,T,I,Y)))return Mt.push(ln)})){ut=!1;break}}else if(!(Rt===Xt||V(Rt,Xt,T,I,Y))){ut=!1;break}}return Y.delete(d),Y.delete(v),ut}function NY(d,v,T,I,V,Y,ue){switch(T){case Xe:if(d.byteLength!=v.byteLength||d.byteOffset!=v.byteOffset)return!1;d=d.buffer,v=v.buffer;case Pe:return!(d.byteLength!=v.byteLength||!Y(new hd(d),new hd(v)));case Ue:case Ve:case Ke:return ma(+d,+v);case Oe:return d.name==v.name&&d.message==v.message;case Ce:case k:return d==v+"";case Ye:var me=aa;case ve:var _e=I&y;if(me||(me=_f),d.size!=v.size&&!_e)return!1;var je=ue.get(d);if(je)return je==v;I|=_,ue.set(d,v);var We=e5(me(d),me(v),I,V,Y,ue);return ue.delete(d),We;case O:if(gd)return gd.call(d)==gd.call(v)}return!1}function zY(d,v,T,I,V,Y){var ue=T&y,me=ET(d),_e=me.length,je=ET(v),We=je.length;if(_e!=We&&!ue)return!1;for(var qe=_e;qe--;){var ut=me[qe];if(!(ue?ut in v:gn.call(v,ut)))return!1}var Mt=Y.get(d),Rt=Y.get(v);if(Mt&&Rt)return Mt==v&&Rt==d;var Xt=!0;Y.set(d,v),Y.set(v,d);for(var Ot=ue;++qe<_e;){ut=me[qe];var en=d[ut],ln=v[ut];if(I)var os=ue?I(ln,en,ut,v,d,Y):I(en,ln,ut,d,v,Y);if(!(os===t?en===ln||V(en,ln,T,I,Y):os)){Xt=!1;break}Ot||(Ot=ut=="constructor")}if(Xt&&!Ot){var vo=d.constructor,ss=v.constructor;vo!=ss&&"constructor"in d&&"constructor"in v&&!(typeof vo=="function"&&vo instanceof vo&&typeof ss=="function"&&ss instanceof ss)&&(Xt=!1)}return Y.delete(d),Y.delete(v),Xt}function lu(d){return kT(s5(d,t,m5),d+"")}function ET(d){return nb(d,fr,LT)}function TT(d){return nb(d,Fo,t5)}var PT=Sf?function(d){return Sf.get(d)}:qT;function xb(d){for(var v=d.name+"",T=tl[v],I=gn.call(tl,v)?T.length:0;I--;){var V=T[I],Y=V.func;if(Y==null||Y==d)return V.name}return v}function kf(d){var v=gn.call(G,"placeholder")?G:d;return v.placeholder}function Lt(){var d=G.iteratee||GT;return d=d===GT?ab:d,arguments.length?d(arguments[0],arguments[1]):d}function bb(d,v){var T=d.__data__;return GY(v)?T[typeof v=="string"?"string":"hash"]:T.map}function AT(d){for(var v=fr(d),T=v.length;T--;){var I=v[T],V=d[I];v[T]=[I,V,r5(V)]}return v}function Ed(d,v){var T=xE(d,v);return ob(T)?T:t}function VY(d){var v=gn.call(d,$a),T=d[$a];try{d[$a]=t;var I=!0}catch{}var V=ud.call(d);return I&&(v?d[$a]=T:delete d[$a]),V}var LT=r0?function(d){return d==null?[]:(d=Ln(d),Za(r0(d),function(v){return bf.call(d,v)}))}:YT,t5=r0?function(d){for(var v=[];d;)dr(v,LT(d)),d=xf(d);return v}:YT,qr=Rr;(el&&qr(new el(new ArrayBuffer(1)))!=Xe||md&&qr(new md)!=Ye||a0&&qr(a0.resolve())!=yt||xc&&qr(new xc)!=ve||vd&&qr(new vd)!=ge)&&(qr=function(d){var v=Rr(d),T=v==mt?d.constructor:t,I=T?Td(T):"";if(I)switch(I){case IE:return Xe;case NE:return Ye;case l0:return yt;case J1:return ve;case zE:return ge}return v});function FY(d,v,T){for(var I=-1,V=T.length;++I<V;){var Y=T[I],ue=Y.size;switch(Y.type){case"drop":d+=ue;break;case"dropRight":v-=ue;break;case"take":v=pr(v,d+ue);break;case"takeRight":d=Ai(d,v-ue);break}}return{start:d,end:v}}function BY(d){var v=d.match($);return v?v[1].split(se):[]}function n5(d,v,T){v=Mc(v,d);for(var I=-1,V=v.length,Y=!1;++I<V;){var ue=sl(v[I]);if(!(Y=d!=null&&T(d,ue)))break;d=d[ue]}return Y||++I!=V?Y:(V=d==null?0:d.length,!!V&&Pb(V)&&uu(ue,V)&&(Ut(d)||Pd(d)))}function UY(d){var v=d.length,T=new d.constructor(v);return v&&typeof d[0]=="string"&&gn.call(d,"index")&&(T.index=d.index,T.input=d.input),T}function i5(d){return typeof d.constructor=="function"&&!C0(d)?bc(xf(d)):{}}function jY(d,v,T){var I=d.constructor;switch(v){case Pe:return ST(d);case Ue:case Ve:return new I(+d);case Xe:return CY(d,T);case re:case Fe:case Ne:case He:case Ie:case nt:case gt:case kt:case W:return FI(d,T);case Ye:return new I;case Ke:case k:return new I(d);case Ce:return EY(d);case ve:return new I;case O:return TY(d)}}function HY(d,v){var T=v.length;if(!T)return d;var I=T-1;return v[I]=(T>1?"& ":"")+v[I],v=v.join(T>2?", ":" "),d.replace(z,`{
/* [wrapped with `+v+`] */
`)}function WY(d){return Ut(d)||Pd(d)||!!(q1&&d&&d[q1])}function uu(d,v){var T=typeof d;return v=v==null?X:v,!!v&&(T=="number"||T!="symbol"&&Ft.test(d))&&d>-1&&d%1==0&&d<v}function mo(d,v,T){if(!ri(T))return!1;var I=typeof v;return(I=="number"?Vo(T)&&uu(v,T.length):I=="string"&&v in T)?ma(T[v],d):!1}function DT(d,v){if(Ut(d))return!1;var T=typeof d;return T=="number"||T=="symbol"||T=="boolean"||d==null||rs(d)?!0:Hl.test(d)||!yn.test(d)||v!=null&&d in Ln(v)}function GY(d){var v=typeof d;return v=="string"||v=="number"||v=="symbol"||v=="boolean"?d!=="__proto__":d===null}function RT(d){var v=xb(d),T=G[v];if(typeof T!="function"||!(v in $t.prototype))return!1;if(d===T)return!0;var I=PT(T);return!!I&&d===I[0]}function XY(d){return!!t0&&t0 in d}var qY=ad?cu:KT;function C0(d){var v=d&&d.constructor,T=typeof v=="function"&&v.prototype||Ql;return d===T}function r5(d){return d===d&&!ri(d)}function o5(d,v){return function(T){return T==null?!1:T[d]===v&&(v!==t||d in Ln(T))}}function YY(d){var v=Eb(d,function(I){return T.size===u&&T.clear(),I}),T=v.cache;return v}function KY(d,v){var T=d[1],I=v[1],V=T|I,Y=V<(g|b|R),ue=I==R&&T==M||I==R&&T==E&&d[7].length<=v[8]||I==(R|E)&&v[7].length<=v[8]&&T==M;if(!(Y||ue))return d;I&g&&(d[2]=v[2],V|=T&g?0:w);var me=v[3];if(me){var _e=d[3];d[3]=_e?UI(_e,me,v[4]):me,d[4]=_e?Qa(d[3],c):v[4]}return me=v[5],me&&(_e=d[5],d[5]=_e?jI(_e,me,v[6]):me,d[6]=_e?Qa(d[5],c):v[6]),me=v[7],me&&(d[7]=me),I&R&&(d[8]=d[8]==null?v[8]:pr(d[8],v[8])),d[9]==null&&(d[9]=v[9]),d[0]=v[0],d[1]=V,d}function ZY(d){var v=[];if(d!=null)for(var T in Ln(d))v.push(T);return v}function JY(d){return ud.call(d)}function s5(d,v,T){return v=Ai(v===t?d.length-1:v,0),function(){for(var I=arguments,V=-1,Y=Ai(I.length-v,0),ue=Le(Y);++V<Y;)ue[V]=I[v+V];V=-1;for(var me=Le(v+1);++V<v;)me[V]=I[V];return me[v]=T(ue),Gr(d,this,me)}}function a5(d,v){return v.length<2?d:ou(d,ce(v,0,-1))}function QY(d,v){for(var T=d.length,I=pr(v.length,T),V=zo(d);I--;){var Y=v[I];d[I]=uu(Y,T)?V[Y]:t}return d}function OT(d,v){if(!(v==="constructor"&&typeof d[v]=="function")&&v!="__proto__")return d[v]}var l5=c5(x),E0=DE||function(d,v){return Vi.setTimeout(d,v)},kT=c5(A);function u5(d,v,T){var I=v+"";return kT(d,HY(I,$Y(BY(I),T)))}function c5(d){var v=0,T=0;return function(){var I=s0(),V=ee-(I-T);if(T=I,V>0){if(++v>=te)return arguments[0]}else v=0;return d.apply(t,arguments)}}function wb(d,v){var T=-1,I=d.length,V=I-1;for(v=v===t?I:v;++T<v;){var Y=S0(T,V),ue=d[Y];d[Y]=d[T],d[T]=ue}return d.length=v,d}var h5=YY(function(d){var v=[];return d.charCodeAt(0)===46&&v.push(""),d.replace(Ds,function(T,I,V,Y){v.push(V?Y.replace(Ge,"$1"):I||T)}),v});function sl(d){if(typeof d=="string"||rs(d))return d;var v=d+"";return v=="0"&&1/d==-de?"-0":v}function Td(d){if(d!=null){try{return ld.call(d)}catch{}try{return d+""}catch{}}return""}function $Y(d,v){return co(we,function(T){var I="_."+T[0];v&T[1]&&!Ja(d,I)&&d.push(I)}),d.sort()}function d5(d){if(d instanceof $t)return d.clone();var v=new Io(d.__wrapped__,d.__chain__);return v.__actions__=zo(d.__actions__),v.__index__=d.__index__,v.__values__=d.__values__,v}function eK(d,v,T){(T?mo(d,v,T):v===t)?v=1:v=Ai(Gt(v),0);var I=d==null?0:d.length;if(!I||v<1)return[];for(var V=0,Y=0,ue=Le(eu(I/v));V<I;)ue[Y++]=ce(d,V,V+=v);return ue}function tK(d){for(var v=-1,T=d==null?0:d.length,I=0,V=[];++v<T;){var Y=d[v];Y&&(V[I++]=Y)}return V}function nK(){var d=arguments.length;if(!d)return[];for(var v=Le(d-1),T=arguments[0],I=d;I--;)v[I-1]=arguments[I];return dr(Ut(T)?zo(T):[T],Qi(v,1))}var iK=Wt(function(d,v){return Li(d)?xd(d,Qi(v,1,Li,!0)):[]}),rK=Wt(function(d,v){var T=zs(v);return Li(T)&&(T=t),Li(d)?xd(d,Qi(v,1,Li,!0),Lt(T,2)):[]}),oK=Wt(function(d,v){var T=zs(v);return Li(T)&&(T=t),Li(d)?xd(d,Qi(v,1,Li,!0),t,T):[]});function sK(d,v,T){var I=d==null?0:d.length;return I?(v=T||v===t?1:Gt(v),ce(d,v<0?0:v,I)):[]}function aK(d,v,T){var I=d==null?0:d.length;return I?(v=T||v===t?1:Gt(v),v=I-v,ce(d,0,v<0?0:v)):[]}function lK(d,v){return d&&d.length?Df(d,Lt(v,3),!0,!0):[]}function uK(d,v){return d&&d.length?Df(d,Lt(v,3),!0):[]}function cK(d,v,T,I){var V=d==null?0:d.length;return V?(T&&typeof T!="number"&&mo(d,v,T)&&(T=0,I=V),uT(d,v,T,I)):[]}function p5(d,v,T){var I=d==null?0:d.length;if(!I)return-1;var V=T==null?0:Gt(T);return V<0&&(V=Ai(I+V,0)),rd(d,Lt(v,3),V)}function f5(d,v,T){var I=d==null?0:d.length;if(!I)return-1;var V=I-1;return T!==t&&(V=Gt(T),V=T<0?Ai(I+V,0):pr(V,I-1)),rd(d,Lt(v,3),V,!0)}function m5(d){var v=d==null?0:d.length;return v?Qi(d,1):[]}function hK(d){var v=d==null?0:d.length;return v?Qi(d,de):[]}function dK(d,v){var T=d==null?0:d.length;return T?(v=v===t?1:Gt(v),Qi(d,v)):[]}function pK(d){for(var v=-1,T=d==null?0:d.length,I={};++v<T;){var V=d[v];I[V[0]]=V[1]}return I}function v5(d){return d&&d.length?d[0]:t}function fK(d,v,T){var I=d==null?0:d.length;if(!I)return-1;var V=T==null?0:Gt(T);return V<0&&(V=Ai(I+V,0)),Zi(d,v,V)}function mK(d){var v=d==null?0:d.length;return v?ce(d,0,-1):[]}var vK=Wt(function(d){var v=En(d,bT);return v.length&&v[0]===d[0]?wd(v):[]}),gK=Wt(function(d){var v=zs(d),T=En(d,bT);return v===zs(T)?v=t:T.pop(),T.length&&T[0]===d[0]?wd(T,Lt(v,2)):[]}),_K=Wt(function(d){var v=zs(d),T=En(d,bT);return v=typeof v=="function"?v:t,v&&T.pop(),T.length&&T[0]===d[0]?wd(T,t,v):[]});function yK(d,v){return d==null?"":OE.call(d,v)}function zs(d){var v=d==null?0:d.length;return v?d[v-1]:t}function xK(d,v,T){var I=d==null?0:d.length;if(!I)return-1;var V=I;return T!==t&&(V=Gt(T),V=V<0?Ai(I+V,0):pr(V,I-1)),v===v?ME(d,v,V):rd(d,mc,V,!0)}function bK(d,v){return d&&d.length?b0(d,Gt(v)):t}var wK=Wt(g5);function g5(d,v){return d&&d.length&&v&&v.length?w0(d,v):d}function SK(d,v,T){return d&&d.length&&v&&v.length?w0(d,v,Lt(T,2)):d}function MK(d,v,T){return d&&d.length&&v&&v.length?w0(d,v,t,T):d}var CK=lu(function(d,v){var T=d==null?0:d.length,I=is(d,v);return fb(d,En(v,function(V){return uu(V,T)?+V:V}).sort(BI)),I});function EK(d,v){var T=[];if(!(d&&d.length))return T;var I=-1,V=[],Y=d.length;for(v=Lt(v,3);++I<Y;){var ue=d[I];v(ue,I,d)&&(T.push(ue),V.push(I))}return fb(d,V),T}function IT(d){return d==null?d:kE.call(d)}function TK(d,v,T){var I=d==null?0:d.length;return I?(T&&typeof T!="number"&&mo(d,v,T)?(v=0,T=I):(v=v==null?0:Gt(v),T=T===t?I:Gt(T)),ce(d,v,T)):[]}function PK(d,v){return Je(d,v)}function AK(d,v,T){return Et(d,v,Lt(T,2))}function LK(d,v){var T=d==null?0:d.length;if(T){var I=Je(d,v);if(I<T&&ma(d[I],v))return I}return-1}function DK(d,v){return Je(d,v,!0)}function RK(d,v,T){return Et(d,v,Lt(T,2),!0)}function OK(d,v){var T=d==null?0:d.length;if(T){var I=Je(d,v,!0)-1;if(ma(d[I],v))return I}return-1}function kK(d){return d&&d.length?At(d):[]}function IK(d,v){return d&&d.length?At(d,Lt(v,2)):[]}function NK(d){var v=d==null?0:d.length;return v?ce(d,1,v):[]}function zK(d,v,T){return d&&d.length?(v=T||v===t?1:Gt(v),ce(d,0,v<0?0:v)):[]}function VK(d,v,T){var I=d==null?0:d.length;return I?(v=T||v===t?1:Gt(v),v=I-v,ce(d,v<0?0:v,I)):[]}function FK(d,v){return d&&d.length?Df(d,Lt(v,3),!1,!0):[]}function BK(d,v){return d&&d.length?Df(d,Lt(v,3)):[]}var UK=Wt(function(d){return Or(Qi(d,1,Li,!0))}),jK=Wt(function(d){var v=zs(d);return Li(v)&&(v=t),Or(Qi(d,1,Li,!0),Lt(v,2))}),HK=Wt(function(d){var v=zs(d);return v=typeof v=="function"?v:t,Or(Qi(d,1,Li,!0),t,v)});function WK(d){return d&&d.length?Or(d):[]}function GK(d,v){return d&&d.length?Or(d,Lt(v,2)):[]}function XK(d,v){return v=typeof v=="function"?v:t,d&&d.length?Or(d,t,v):[]}function NT(d){if(!(d&&d.length))return[];var v=0;return d=Za(d,function(T){if(Li(T))return v=Ai(T.length,v),!0}),Zl(v,function(T){return En(d,Jg(T))})}function _5(d,v){if(!(d&&d.length))return[];var T=NT(d);return v==null?T:En(T,function(I){return Gr(v,t,I)})}var qK=Wt(function(d,v){return Li(d)?xd(d,v):[]}),YK=Wt(function(d){return xT(Za(d,Li))}),KK=Wt(function(d){var v=zs(d);return Li(v)&&(v=t),xT(Za(d,Li),Lt(v,2))}),ZK=Wt(function(d){var v=zs(d);return v=typeof v=="function"?v:t,xT(Za(d,Li),t,v)}),JK=Wt(NT);function QK(d,v){return NI(d||[],v||[],_d)}function $K(d,v){return NI(d||[],v||[],f)}var eZ=Wt(function(d){var v=d.length,T=v>1?d[v-1]:t;return T=typeof T=="function"?(d.pop(),T):t,_5(d,T)});function y5(d){var v=G(d);return v.__chain__=!0,v}function tZ(d,v){return v(d),d}function Sb(d,v){return v(d)}var nZ=lu(function(d){var v=d.length,T=v?d[0]:0,I=this.__wrapped__,V=function(Y){return is(Y,d)};return v>1||this.__actions__.length||!(I instanceof $t)||!uu(T)?this.thru(V):(I=I.slice(T,+T+(v?1:0)),I.__actions__.push({func:Sb,args:[V],thisArg:t}),new Io(I,this.__chain__).thru(function(Y){return v&&!Y.length&&Y.push(t),Y}))});function iZ(){return y5(this)}function rZ(){return new Io(this.value(),this.__chain__)}function oZ(){this.__values__===t&&(this.__values__=O5(this.value()));var d=this.__index__>=this.__values__.length,v=d?t:this.__values__[this.__index__++];return{done:d,value:v}}function sZ(){return this}function aZ(d){for(var v,T=this;T instanceof wc;){var I=d5(T);I.__index__=0,I.__values__=t,v?V.__wrapped__=I:v=I;var V=I;T=T.__wrapped__}return V.__wrapped__=d,v}function lZ(){var d=this.__wrapped__;if(d instanceof $t){var v=d;return this.__actions__.length&&(v=new $t(this)),v=v.reverse(),v.__actions__.push({func:Sb,args:[IT],thisArg:t}),new Io(v,this.__chain__)}return this.thru(IT)}function uZ(){return II(this.__wrapped__,this.__actions__)}var cZ=mb(function(d,v,T){gn.call(d,T)?++d[T]:pa(d,T,1)});function hZ(d,v,T){var I=Ut(d)?N1:lT;return T&&mo(d,v,T)&&(v=t),I(d,Lt(v,3))}function dZ(d,v){var T=Ut(d)?Za:Tf;return T(d,Lt(v,3))}var pZ=XI(p5),fZ=XI(f5);function mZ(d,v){return Qi(Mb(d,v),1)}function vZ(d,v){return Qi(Mb(d,v),de)}function gZ(d,v,T){return T=T===t?1:Gt(T),Qi(Mb(d,v),T)}function x5(d,v){var T=Ut(d)?co:fo;return T(d,Lt(v,3))}function b5(d,v){var T=Ut(d)?gE:p0;return T(d,Lt(v,3))}var _Z=mb(function(d,v,T){gn.call(d,T)?d[T].push(v):pa(d,T,[v])});function yZ(d,v,T,I){d=Vo(d)?d:Nf(d),T=T&&!I?Gt(T):0;var V=d.length;return T<0&&(T=Ai(V+T,0)),Ab(d)?T<=V&&d.indexOf(v,T)>-1:!!V&&Zi(d,v,T)>-1}var xZ=Wt(function(d,v,T){var I=-1,V=typeof v=="function",Y=Vo(d)?Le(d.length):[];return fo(d,function(ue){Y[++I]=V?Gr(v,ue,T):Sd(ue,v,T)}),Y}),bZ=mb(function(d,v,T){pa(d,T,v)});function Mb(d,v){var T=Ut(d)?En:lb;return T(d,Lt(v,3))}function wZ(d,v,T,I){return d==null?[]:(Ut(v)||(v=v==null?[]:[v]),T=I?t:T,Ut(T)||(T=T==null?[]:[T]),db(d,v,T))}var SZ=mb(function(d,v,T){d[T?0:1].push(v)},function(){return[[],[]]});function MZ(d,v,T){var I=Ut(d)?Zg:df,V=arguments.length<3;return I(d,Lt(v,4),T,V,fo)}function CZ(d,v,T){var I=Ut(d)?z1:df,V=arguments.length<3;return I(d,Lt(v,4),T,V,p0)}function EZ(d,v){var T=Ut(d)?Za:Tf;return T(d,Tb(Lt(v,3)))}function TZ(d){var v=Ut(d)?h0:yT;return v(d)}function PZ(d,v,T){(T?mo(d,v,T):v===t)?v=1:v=Gt(v);var I=Ut(d)?Sc:S;return I(d,v)}function AZ(d){var v=Ut(d)?rT:F;return v(d)}function LZ(d){if(d==null)return 0;if(Vo(d))return Ab(d)?yc(d):d.length;var v=qr(d);return v==Ye||v==ve?d.size:y0(d).length}function DZ(d,v,T){var I=Ut(d)?id:xe;return T&&mo(d,v,T)&&(v=t),I(d,Lt(v,3))}var RZ=Wt(function(d,v){if(d==null)return[];var T=v.length;return T>1&&mo(d,v[0],v[1])?v=[]:T>2&&mo(v[0],v[1],v[2])&&(v=[v[0]]),db(d,Qi(v,1),[])}),Cb=Y1||function(){return Vi.Date.now()};function OZ(d,v){if(typeof v!="function")throw new ho(s);return d=Gt(d),function(){if(--d<1)return v.apply(this,arguments)}}function w5(d,v,T){return v=T?t:v,v=d&&v==null?d.length:v,au(d,R,t,t,t,t,v)}function S5(d,v){var T;if(typeof v!="function")throw new ho(s);return d=Gt(d),function(){return--d>0&&(T=v.apply(this,arguments)),d<=1&&(v=t),T}}var zT=Wt(function(d,v,T){var I=g;if(T.length){var V=Qa(T,kf(zT));I|=P}return au(d,I,v,T,V)}),M5=Wt(function(d,v,T){var I=g|b;if(T.length){var V=Qa(T,kf(M5));I|=P}return au(v,I,d,T,V)});function C5(d,v,T){v=T?t:v;var I=au(d,M,t,t,t,t,t,v);return I.placeholder=C5.placeholder,I}function E5(d,v,T){v=T?t:v;var I=au(d,C,t,t,t,t,t,v);return I.placeholder=E5.placeholder,I}function T5(d,v,T){var I,V,Y,ue,me,_e,je=0,We=!1,qe=!1,ut=!0;if(typeof d!="function")throw new ho(s);v=Vs(v)||0,ri(T)&&(We=!!T.leading,qe="maxWait"in T,Y=qe?Ai(Vs(T.maxWait)||0,v):Y,ut="trailing"in T?!!T.trailing:ut);function Mt(Di){var va=I,du=V;return I=V=t,je=Di,ue=d.apply(du,va),ue}function Rt(Di){return je=Di,me=E0(en,v),We?Mt(Di):ue}function Xt(Di){var va=Di-_e,du=Di-je,X5=v-va;return qe?pr(X5,Y-du):X5}function Ot(Di){var va=Di-_e,du=Di-je;return _e===t||va>=v||va<0||qe&&du>=Y}function en(){var Di=Cb();if(Ot(Di))return ln(Di);me=E0(en,Xt(Di))}function ln(Di){return me=t,ut&&I?Mt(Di):(I=V=t,ue)}function os(){me!==t&&zI(me),je=0,I=_e=V=me=t}function vo(){return me===t?ue:ln(Cb())}function ss(){var Di=Cb(),va=Ot(Di);if(I=arguments,V=this,_e=Di,va){if(me===t)return Rt(_e);if(qe)return zI(me),me=E0(en,v),Mt(_e)}return me===t&&(me=E0(en,v)),ue}return ss.cancel=os,ss.flush=vo,ss}var kZ=Wt(function(d,v){return tb(d,1,v)}),IZ=Wt(function(d,v,T){return tb(d,Vs(v)||0,T)});function NZ(d){return au(d,D)}function Eb(d,v){if(typeof d!="function"||v!=null&&typeof v!="function")throw new ho(s);var T=function(){var I=arguments,V=v?v.apply(this,I):I[0],Y=T.cache;if(Y.has(V))return Y.get(V);var ue=d.apply(this,I);return T.cache=Y.set(V,ue)||Y,ue};return T.cache=new(Eb.Cache||ha),T}Eb.Cache=ha;function Tb(d){if(typeof d!="function")throw new ho(s);return function(){var v=arguments;switch(v.length){case 0:return!d.call(this);case 1:return!d.call(this,v[0]);case 2:return!d.call(this,v[0],v[1]);case 3:return!d.call(this,v[0],v[1],v[2])}return!d.apply(this,v)}}function zZ(d){return S5(2,d)}var VZ=MY(function(d,v){v=v.length==1&&Ut(v[0])?En(v[0],gi(Lt())):En(Qi(v,1),gi(Lt()));var T=v.length;return Wt(function(I){for(var V=-1,Y=pr(I.length,T);++V<Y;)I[V]=v[V].call(this,I[V]);return Gr(d,this,I)})}),VT=Wt(function(d,v){var T=Qa(v,kf(VT));return au(d,P,t,v,T)}),P5=Wt(function(d,v){var T=Qa(v,kf(P5));return au(d,L,t,v,T)}),FZ=lu(function(d,v){return au(d,E,t,t,t,v)});function BZ(d,v){if(typeof d!="function")throw new ho(s);return v=v===t?v:Gt(v),Wt(d,v)}function UZ(d,v){if(typeof d!="function")throw new ho(s);return v=v==null?0:Ai(Gt(v),0),Wt(function(T){var I=T[v],V=Cc(T,0,v);return I&&dr(V,I),Gr(d,this,V)})}function jZ(d,v,T){var I=!0,V=!0;if(typeof d!="function")throw new ho(s);return ri(T)&&(I="leading"in T?!!T.leading:I,V="trailing"in T?!!T.trailing:V),T5(d,v,{leading:I,maxWait:v,trailing:V})}function HZ(d){return w5(d,1)}function WZ(d,v){return VT(wT(v),d)}function GZ(){if(!arguments.length)return[];var d=arguments[0];return Ut(d)?d:[d]}function XZ(d){return po(d,m)}function qZ(d,v){return v=typeof v=="function"?v:t,po(d,m,v)}function YZ(d){return po(d,h|m)}function KZ(d,v){return v=typeof v=="function"?v:t,po(d,h|m,v)}function ZZ(d,v){return v==null||d0(d,v,fr(v))}function ma(d,v){return d===v||d!==d&&v!==v}var JZ=yb(v0),QZ=yb(function(d,v){return d>=v}),Pd=Af(function(){return arguments}())?Af:function(d){return _i(d)&&gn.call(d,"callee")&&!bf.call(d,"callee")},Ut=Le.isArray,$Z=ks?gi(ks):hT;function Vo(d){return d!=null&&Pb(d.length)&&!cu(d)}function Li(d){return _i(d)&&Vo(d)}function eJ(d){return d===!0||d===!1||_i(d)&&Rr(d)==Ue}var Ec=RE||KT,tJ=Yg?gi(Yg):rl;function nJ(d){return _i(d)&&d.nodeType===1&&!T0(d)}function iJ(d){if(d==null)return!0;if(Vo(d)&&(Ut(d)||typeof d=="string"||typeof d.splice=="function"||Ec(d)||If(d)||Pd(d)))return!d.length;var v=qr(d);if(v==Ye||v==ve)return!d.size;if(C0(d))return!y0(d).length;for(var T in d)if(gn.call(d,T))return!1;return!0}function rJ(d,v){return Md(d,v)}function oJ(d,v,T){T=typeof T=="function"?T:t;var I=T?T(d,v):t;return I===t?Md(d,v,t,T):!!I}function FT(d){if(!_i(d))return!1;var v=Rr(d);return v==Oe||v==Ae||typeof d.message=="string"&&typeof d.name=="string"&&!T0(d)}function sJ(d){return typeof d=="number"&&o0(d)}function cu(d){if(!ri(d))return!1;var v=Rr(d);return v==Te||v==be||v==tt||v==st}function A5(d){return typeof d=="number"&&d==Gt(d)}function Pb(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=X}function ri(d){var v=typeof d;return d!=null&&(v=="object"||v=="function")}function _i(d){return d!=null&&typeof d=="object"}var L5=k1?gi(k1):g0;function aJ(d,v){return d===v||_0(d,v,AT(v))}function lJ(d,v,T){return T=typeof T=="function"?T:t,_0(d,v,AT(v),T)}function uJ(d){return D5(d)&&d!=+d}function cJ(d){if(qY(d))throw new Nt(o);return ob(d)}function hJ(d){return d===null}function dJ(d){return d==null}function D5(d){return typeof d=="number"||_i(d)&&Rr(d)==Ke}function T0(d){if(!_i(d)||Rr(d)!=mt)return!1;var v=xf(d);if(v===null)return!0;var T=gn.call(v,"constructor")&&v.constructor;return typeof T=="function"&&T instanceof T&&ld.call(T)==AE}var BT=Fi?gi(Fi):sb;function pJ(d){return A5(d)&&d>=-X&&d<=X}var R5=I1?gi(I1):pT;function Ab(d){return typeof d=="string"||!Ut(d)&&_i(d)&&Rr(d)==k}function rs(d){return typeof d=="symbol"||_i(d)&&Rr(d)==O}var If=nd?gi(nd):fT;function fJ(d){return d===t}function mJ(d){return _i(d)&&qr(d)==ge}function vJ(d){return _i(d)&&Rr(d)==ye}var gJ=yb(x0),_J=yb(function(d,v){return d<=v});function O5(d){if(!d)return[];if(Vo(d))return Ab(d)?Ji(d):zo(d);if($l&&d[$l])return wE(d[$l]());var v=qr(d),T=v==Ye?aa:v==ve?_f:Nf;return T(d)}function hu(d){if(!d)return d===0?d:0;if(d=Vs(d),d===de||d===-de){var v=d<0?-1:1;return v*B}return d===d?d:0}function Gt(d){var v=hu(d),T=v%1;return v===v?T?v-T:v:0}function k5(d){return d?ru(Gt(d),0,le):0}function Vs(d){if(typeof d=="number")return d;if(rs(d))return U;if(ri(d)){var v=typeof d.valueOf=="function"?d.valueOf():d;d=ri(v)?v+"":v}if(typeof d!="string")return d===0?d:+d;d=$g(d);var T=Ct.test(d);return T||ht.test(d)?mE(d.slice(2),T?2:8):rt.test(d)?U:+d}function I5(d){return ol(d,Fo(d))}function yJ(d){return d?ru(Gt(d),-X,X):d===0?d:0}function Tn(d){return d==null?"":Ht(d)}var xJ=Rf(function(d,v){if(C0(v)||Vo(v)){ol(v,fr(v),d);return}for(var T in v)gn.call(v,T)&&_d(d,T,v[T])}),N5=Rf(function(d,v){ol(v,Fo(v),d)}),Lb=Rf(function(d,v,T,I){ol(v,Fo(v),d,I)}),bJ=Rf(function(d,v,T,I){ol(v,fr(v),d,I)}),wJ=lu(is);function SJ(d,v){var T=bc(d);return v==null?T:eb(T,v)}var MJ=Wt(function(d,v){d=Ln(d);var T=-1,I=v.length,V=I>2?v[2]:t;for(V&&mo(v[0],v[1],V)&&(I=1);++T<I;)for(var Y=v[T],ue=Fo(Y),me=-1,_e=ue.length;++me<_e;){var je=ue[me],We=d[je];(We===t||ma(We,Ql[je])&&!gn.call(d,je))&&(d[je]=Y[je])}return d}),CJ=Wt(function(d){return d.push(t,$I),Gr(z5,t,d)});function EJ(d,v){return vi(d,Lt(v,3),Ns)}function TJ(d,v){return vi(d,Lt(v,3),m0)}function PJ(d,v){return d==null?d:il(d,Lt(v,3),Fo)}function AJ(d,v){return d==null?d:f0(d,Lt(v,3),Fo)}function LJ(d,v){return d&&Ns(d,Lt(v,3))}function DJ(d,v){return d&&m0(d,Lt(v,3))}function RJ(d){return d==null?[]:Pf(d,fr(d))}function OJ(d){return d==null?[]:Pf(d,Fo(d))}function UT(d,v,T){var I=d==null?t:ou(d,v);return I===t?T:I}function kJ(d,v){return d!=null&&n5(d,v,bd)}function jT(d,v){return d!=null&&n5(d,v,ib)}var IJ=YI(function(d,v,T){v!=null&&typeof v.toString!="function"&&(v=ud.call(v)),d[v]=T},WT(Bo)),NJ=YI(function(d,v,T){v!=null&&typeof v.toString!="function"&&(v=ud.call(v)),gn.call(d,v)?d[v].push(T):d[v]=[T]},Lt),zJ=Wt(Sd);function fr(d){return Vo(d)?da(d):y0(d)}function Fo(d){return Vo(d)?da(d,!0):mT(d)}function VJ(d,v){var T={};return v=Lt(v,3),Ns(d,function(I,V,Y){pa(T,v(I,V,Y),I)}),T}function FJ(d,v){var T={};return v=Lt(v,3),Ns(d,function(I,V,Y){pa(T,V,v(I,V,Y))}),T}var BJ=Rf(function(d,v,T){Cd(d,v,T)}),z5=Rf(function(d,v,T,I){Cd(d,v,T,I)}),UJ=lu(function(d,v){var T={};if(d==null)return T;var I=!1;v=En(v,function(Y){return Y=Mc(Y,d),I||(I=Y.length>1),Y}),ol(d,TT(d),T),I&&(T=po(T,h|p|m,IY));for(var V=v.length;V--;)fa(T,v[V]);return T});function jJ(d,v){return V5(d,Tb(Lt(v)))}var HJ=lu(function(d,v){return d==null?{}:vT(d,v)});function V5(d,v){if(d==null)return{};var T=En(TT(d),function(I){return[I]});return v=Lt(v),pb(d,T,function(I,V){return v(I,V[0])})}function WJ(d,v,T){v=Mc(v,d);var I=-1,V=v.length;for(V||(V=1,d=t);++I<V;){var Y=d==null?t:d[sl(v[I])];Y===t&&(I=V,Y=T),d=cu(Y)?Y.call(d):Y}return d}function GJ(d,v,T){return d==null?d:f(d,v,T)}function XJ(d,v,T,I){return I=typeof I=="function"?I:t,d==null?d:f(d,v,T,I)}var F5=JI(fr),B5=JI(Fo);function qJ(d,v,T){var I=Ut(d),V=I||Ec(d)||If(d);if(v=Lt(v,4),T==null){var Y=d&&d.constructor;V?T=I?new Y:[]:ri(d)?T=cu(Y)?bc(xf(d)):{}:T={}}return(V?co:Ns)(d,function(ue,me,_e){return v(T,ue,me,_e)}),T}function YJ(d,v){return d==null?!0:fa(d,v)}function KJ(d,v,T){return d==null?d:su(d,v,wT(T))}function ZJ(d,v,T,I){return I=typeof I=="function"?I:t,d==null?d:su(d,v,wT(T),I)}function Nf(d){return d==null?[]:ff(d,fr(d))}function JJ(d){return d==null?[]:ff(d,Fo(d))}function QJ(d,v,T){return T===t&&(T=v,v=t),T!==t&&(T=Vs(T),T=T===T?T:0),v!==t&&(v=Vs(v),v=v===v?v:0),ru(Vs(d),v,T)}function $J(d,v,T){return v=hu(v),T===t?(T=v,v=0):T=hu(T),d=Vs(d),cT(d,v,T)}function eQ(d,v,T){if(T&&typeof T!="boolean"&&mo(d,v,T)&&(v=T=t),T===t&&(typeof v=="boolean"?(T=v,v=t):typeof d=="boolean"&&(T=d,d=t)),d===t&&v===t?(d=0,v=1):(d=hu(d),v===t?(v=d,d=0):v=hu(v)),d>v){var I=d;d=v,v=I}if(T||d%1||v%1){var V=Z1();return pr(d+V*(v-d+fE("1e-"+((V+"").length-1))),v)}return S0(d,v)}var tQ=Of(function(d,v,T){return v=v.toLowerCase(),d+(T?U5(v):v)});function U5(d){return HT(Tn(d).toLowerCase())}function j5(d){return d=Tn(d),d&&d.replace(Ki,vc).replace(Xg,"")}function nQ(d,v,T){d=Tn(d),v=Ht(v);var I=d.length;T=T===t?I:ru(Gt(T),0,I);var V=T;return T-=v.length,T>=0&&d.slice(T,V)==v}function iQ(d){return d=Tn(d),d&&zt.test(d)?d.replace(bt,gc):d}function rQ(d){return d=Tn(d),d&&Qh.test(d)?d.replace(ra,"\\$&"):d}var oQ=Of(function(d,v,T){return d+(T?"-":"")+v.toLowerCase()}),sQ=Of(function(d,v,T){return d+(T?" ":"")+v.toLowerCase()}),aQ=GI("toLowerCase");function lQ(d,v,T){d=Tn(d),v=Gt(v);var I=v?yc(d):0;if(!v||I>=v)return d;var V=(v-I)/2;return _b(wf(V),T)+d+_b(eu(V),T)}function uQ(d,v,T){d=Tn(d),v=Gt(v);var I=v?yc(d):0;return v&&I<v?d+_b(v-I,T):d}function cQ(d,v,T){d=Tn(d),v=Gt(v);var I=v?yc(d):0;return v&&I<v?_b(v-I,T)+d:d}function hQ(d,v,T){return T||v==null?v=0:v&&(v=+v),fd(Tn(d).replace(Wl,""),v||0)}function dQ(d,v,T){return(T?mo(d,v,T):v===t)?v=1:v=Gt(v),Lf(Tn(d),v)}function pQ(){var d=arguments,v=Tn(d[0]);return d.length<3?v:v.replace(d[1],d[2])}var fQ=Of(function(d,v,T){return d+(T?"_":"")+v.toLowerCase()});function mQ(d,v,T){return T&&typeof T!="number"&&mo(d,v,T)&&(v=T=t),T=T===t?le:T>>>0,T?(d=Tn(d),d&&(typeof v=="string"||v!=null&&!BT(v))&&(v=Ht(v),!v&&_c(d))?Cc(Ji(d),0,T):d.split(v,T)):[]}var vQ=Of(function(d,v,T){return d+(T?" ":"")+HT(v)});function gQ(d,v,T){return d=Tn(d),T=T==null?0:ru(Gt(T),0,d.length),v=Ht(v),d.slice(T,T+v.length)==v}function _Q(d,v,T){var I=G.templateSettings;T&&mo(d,v,T)&&(v=t),d=Tn(d),v=Lb({},v,I,QI);var V=Lb({},v.imports,I.imports,QI),Y=fr(V),ue=ff(V,Y),me,_e,je=0,We=v.interpolate||Pi,qe="__p += '",ut=Xr((v.escape||Pi).source+"|"+We.source+"|"+(We===Bn?et:Pi).source+"|"+(v.evaluate||Pi).source+"|$","g"),Mt="//# sourceURL="+(gn.call(v,"sourceURL")?(v.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++uE+"]")+`
`;d.replace(ut,function(Ot,en,ln,os,vo,ss){return ln||(ln=os),qe+=d.slice(je,ss).replace(ti,gf),en&&(me=!0,qe+=`' +
__e(`+en+`) +
'`),vo&&(_e=!0,qe+=`';
`+vo+`;
__p += '`),ln&&(qe+=`' +
((__t = (`+ln+`)) == null ? '' : __t) +
'`),je=ss+Ot.length,Ot}),qe+=`';
`;var Rt=gn.call(v,"variable")&&v.variable;if(!Rt)qe=`with (obj) {
`+qe+`
}
`;else if(he.test(Rt))throw new Nt(a);qe=(_e?qe.replace(De,""):qe).replace(ae,"$1").replace(Re,"$1;"),qe="function("+(Rt||"obj")+`) {
`+(Rt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(me?", __e = _.escape":"")+(_e?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+qe+`return __p
}`;var Xt=W5(function(){return Kt(Y,Mt+"return "+qe).apply(t,ue)});if(Xt.source=qe,FT(Xt))throw Xt;return Xt}function yQ(d){return Tn(d).toLowerCase()}function xQ(d){return Tn(d).toUpperCase()}function bQ(d,v,T){if(d=Tn(d),d&&(T||v===t))return $g(d);if(!d||!(v=Ht(v)))return d;var I=Ji(d),V=Ji(v),Y=mf(I,V),ue=F1(I,V)+1;return Cc(I,Y,ue).join("")}function wQ(d,v,T){if(d=Tn(d),d&&(T||v===t))return d.slice(0,e0(d)+1);if(!d||!(v=Ht(v)))return d;var I=Ji(d),V=F1(I,Ji(v))+1;return Cc(I,0,V).join("")}function SQ(d,v,T){if(d=Tn(d),d&&(T||v===t))return d.replace(Wl,"");if(!d||!(v=Ht(v)))return d;var I=Ji(d),V=mf(I,Ji(v));return Cc(I,V).join("")}function MQ(d,v){var T=N,I=j;if(ri(v)){var V="separator"in v?v.separator:V;T="length"in v?Gt(v.length):T,I="omission"in v?Ht(v.omission):I}d=Tn(d);var Y=d.length;if(_c(d)){var ue=Ji(d);Y=ue.length}if(T>=Y)return d;var me=T-yc(I);if(me<1)return I;var _e=ue?Cc(ue,0,me).join(""):d.slice(0,me);if(V===t)return _e+I;if(ue&&(me+=_e.length-me),BT(V)){if(d.slice(me).search(V)){var je,We=_e;for(V.global||(V=Xr(V.source,Tn($e.exec(V))+"g")),V.lastIndex=0;je=V.exec(We);)var qe=je.index;_e=_e.slice(0,qe===t?me:qe)}}else if(d.indexOf(Ht(V),me)!=me){var ut=_e.lastIndexOf(V);ut>-1&&(_e=_e.slice(0,ut))}return _e+I}function CQ(d){return d=Tn(d),d&&It.test(d)?d.replace(Me,CE):d}var EQ=Of(function(d,v,T){return d+(T?" ":"")+v.toUpperCase()}),HT=GI("toUpperCase");function H5(d,v,T){return d=Tn(d),v=T?t:v,v===t?bE(d)?j1(d):V1(d):d.match(v)||[]}var W5=Wt(function(d,v){try{return Gr(d,t,v)}catch(T){return FT(T)?T:new Nt(T)}}),TQ=lu(function(d,v){return co(v,function(T){T=sl(T),pa(d,T,zT(d[T],d))}),d});function PQ(d){var v=d==null?0:d.length,T=Lt();return d=v?En(d,function(I){if(typeof I[1]!="function")throw new ho(s);return[T(I[0]),I[1]]}):[],Wt(function(I){for(var V=-1;++V<v;){var Y=d[V];if(Gr(Y[0],this,I))return Gr(Y[1],this,I)}})}function AQ(d){return aT(po(d,h))}function WT(d){return function(){return d}}function LQ(d,v){return d==null||d!==d?v:d}var DQ=qI(),RQ=qI(!0);function Bo(d){return d}function GT(d){return ab(typeof d=="function"?d:po(d,h))}function OQ(d){return ub(po(d,h))}function kQ(d,v){return cb(d,po(v,h))}var IQ=Wt(function(d,v){return function(T){return Sd(T,d,v)}}),NQ=Wt(function(d,v){return function(T){return Sd(d,T,v)}});function XT(d,v,T){var I=fr(v),V=Pf(v,I);T==null&&!(ri(v)&&(V.length||!I.length))&&(T=v,v=d,d=this,V=Pf(v,fr(v)));var Y=!(ri(T)&&"chain"in T)||!!T.chain,ue=cu(d);return co(V,function(me){var _e=v[me];d[me]=_e,ue&&(d.prototype[me]=function(){var je=this.__chain__;if(Y||je){var We=d(this.__wrapped__),qe=We.__actions__=zo(this.__actions__);return qe.push({func:_e,args:arguments,thisArg:d}),We.__chain__=je,We}return _e.apply(d,dr([this.value()],arguments))})}),d}function zQ(){return Vi._===this&&(Vi._=G1),this}function qT(){}function VQ(d){return d=Gt(d),Wt(function(v){return b0(v,d)})}var FQ=MT(En),BQ=MT(N1),UQ=MT(id);function G5(d){return DT(d)?Jg(sl(d)):gT(d)}function jQ(d){return function(v){return d==null?t:ou(d,v)}}var HQ=KI(),WQ=KI(!0);function YT(){return[]}function KT(){return!1}function GQ(){return{}}function XQ(){return""}function qQ(){return!0}function YQ(d,v){if(d=Gt(d),d<1||d>X)return[];var T=le,I=pr(d,le);v=Lt(v),d-=le;for(var V=Zl(I,v);++T<d;)v(T);return V}function KQ(d){return Ut(d)?En(d,sl):rs(d)?[d]:zo(h5(Tn(d)))}function ZQ(d){var v=++W1;return Tn(d)+v}var JQ=gb(function(d,v){return d+v},0),QQ=CT("ceil"),$Q=gb(function(d,v){return d/v},1),e$=CT("floor");function t$(d){return d&&d.length?Ef(d,Bo,v0):t}function n$(d,v){return d&&d.length?Ef(d,Lt(v,2),v0):t}function i$(d){return hf(d,Bo)}function r$(d,v){return hf(d,Lt(v,2))}function o$(d){return d&&d.length?Ef(d,Bo,x0):t}function s$(d,v){return d&&d.length?Ef(d,Lt(v,2),x0):t}var a$=gb(function(d,v){return d*v},1),l$=CT("round"),u$=gb(function(d,v){return d-v},0);function c$(d){return d&&d.length?od(d,Bo):0}function h$(d,v){return d&&d.length?od(d,Lt(v,2)):0}return G.after=OZ,G.ary=w5,G.assign=xJ,G.assignIn=N5,G.assignInWith=Lb,G.assignWith=bJ,G.at=wJ,G.before=S5,G.bind=zT,G.bindAll=TQ,G.bindKey=M5,G.castArray=GZ,G.chain=y5,G.chunk=eK,G.compact=tK,G.concat=nK,G.cond=PQ,G.conforms=AQ,G.constant=WT,G.countBy=cZ,G.create=SJ,G.curry=C5,G.curryRight=E5,G.debounce=T5,G.defaults=MJ,G.defaultsDeep=CJ,G.defer=kZ,G.delay=IZ,G.difference=iK,G.differenceBy=rK,G.differenceWith=oK,G.drop=sK,G.dropRight=aK,G.dropRightWhile=lK,G.dropWhile=uK,G.fill=cK,G.filter=dZ,G.flatMap=mZ,G.flatMapDeep=vZ,G.flatMapDepth=gZ,G.flatten=m5,G.flattenDeep=hK,G.flattenDepth=dK,G.flip=NZ,G.flow=DQ,G.flowRight=RQ,G.fromPairs=pK,G.functions=RJ,G.functionsIn=OJ,G.groupBy=_Z,G.initial=mK,G.intersection=vK,G.intersectionBy=gK,G.intersectionWith=_K,G.invert=IJ,G.invertBy=NJ,G.invokeMap=xZ,G.iteratee=GT,G.keyBy=bZ,G.keys=fr,G.keysIn=Fo,G.map=Mb,G.mapKeys=VJ,G.mapValues=FJ,G.matches=OQ,G.matchesProperty=kQ,G.memoize=Eb,G.merge=BJ,G.mergeWith=z5,G.method=IQ,G.methodOf=NQ,G.mixin=XT,G.negate=Tb,G.nthArg=VQ,G.omit=UJ,G.omitBy=jJ,G.once=zZ,G.orderBy=wZ,G.over=FQ,G.overArgs=VZ,G.overEvery=BQ,G.overSome=UQ,G.partial=VT,G.partialRight=P5,G.partition=SZ,G.pick=HJ,G.pickBy=V5,G.property=G5,G.propertyOf=jQ,G.pull=wK,G.pullAll=g5,G.pullAllBy=SK,G.pullAllWith=MK,G.pullAt=CK,G.range=HQ,G.rangeRight=WQ,G.rearg=FZ,G.reject=EZ,G.remove=EK,G.rest=BZ,G.reverse=IT,G.sampleSize=PZ,G.set=GJ,G.setWith=XJ,G.shuffle=AZ,G.slice=TK,G.sortBy=RZ,G.sortedUniq=kK,G.sortedUniqBy=IK,G.split=mQ,G.spread=UZ,G.tail=NK,G.take=zK,G.takeRight=VK,G.takeRightWhile=FK,G.takeWhile=BK,G.tap=tZ,G.throttle=jZ,G.thru=Sb,G.toArray=O5,G.toPairs=F5,G.toPairsIn=B5,G.toPath=KQ,G.toPlainObject=I5,G.transform=qJ,G.unary=HZ,G.union=UK,G.unionBy=jK,G.unionWith=HK,G.uniq=WK,G.uniqBy=GK,G.uniqWith=XK,G.unset=YJ,G.unzip=NT,G.unzipWith=_5,G.update=KJ,G.updateWith=ZJ,G.values=Nf,G.valuesIn=JJ,G.without=qK,G.words=H5,G.wrap=WZ,G.xor=YK,G.xorBy=KK,G.xorWith=ZK,G.zip=JK,G.zipObject=QK,G.zipObjectDeep=$K,G.zipWith=eZ,G.entries=F5,G.entriesIn=B5,G.extend=N5,G.extendWith=Lb,XT(G,G),G.add=JQ,G.attempt=W5,G.camelCase=tQ,G.capitalize=U5,G.ceil=QQ,G.clamp=QJ,G.clone=XZ,G.cloneDeep=YZ,G.cloneDeepWith=KZ,G.cloneWith=qZ,G.conformsTo=ZZ,G.deburr=j5,G.defaultTo=LQ,G.divide=$Q,G.endsWith=nQ,G.eq=ma,G.escape=iQ,G.escapeRegExp=rQ,G.every=hZ,G.find=pZ,G.findIndex=p5,G.findKey=EJ,G.findLast=fZ,G.findLastIndex=f5,G.findLastKey=TJ,G.floor=e$,G.forEach=x5,G.forEachRight=b5,G.forIn=PJ,G.forInRight=AJ,G.forOwn=LJ,G.forOwnRight=DJ,G.get=UT,G.gt=JZ,G.gte=QZ,G.has=kJ,G.hasIn=jT,G.head=v5,G.identity=Bo,G.includes=yZ,G.indexOf=fK,G.inRange=$J,G.invoke=zJ,G.isArguments=Pd,G.isArray=Ut,G.isArrayBuffer=$Z,G.isArrayLike=Vo,G.isArrayLikeObject=Li,G.isBoolean=eJ,G.isBuffer=Ec,G.isDate=tJ,G.isElement=nJ,G.isEmpty=iJ,G.isEqual=rJ,G.isEqualWith=oJ,G.isError=FT,G.isFinite=sJ,G.isFunction=cu,G.isInteger=A5,G.isLength=Pb,G.isMap=L5,G.isMatch=aJ,G.isMatchWith=lJ,G.isNaN=uJ,G.isNative=cJ,G.isNil=dJ,G.isNull=hJ,G.isNumber=D5,G.isObject=ri,G.isObjectLike=_i,G.isPlainObject=T0,G.isRegExp=BT,G.isSafeInteger=pJ,G.isSet=R5,G.isString=Ab,G.isSymbol=rs,G.isTypedArray=If,G.isUndefined=fJ,G.isWeakMap=mJ,G.isWeakSet=vJ,G.join=yK,G.kebabCase=oQ,G.last=zs,G.lastIndexOf=xK,G.lowerCase=sQ,G.lowerFirst=aQ,G.lt=gJ,G.lte=_J,G.max=t$,G.maxBy=n$,G.mean=i$,G.meanBy=r$,G.min=o$,G.minBy=s$,G.stubArray=YT,G.stubFalse=KT,G.stubObject=GQ,G.stubString=XQ,G.stubTrue=qQ,G.multiply=a$,G.nth=bK,G.noConflict=zQ,G.noop=qT,G.now=Cb,G.pad=lQ,G.padEnd=uQ,G.padStart=cQ,G.parseInt=hQ,G.random=eQ,G.reduce=MZ,G.reduceRight=CZ,G.repeat=dQ,G.replace=pQ,G.result=WJ,G.round=l$,G.runInContext=pe,G.sample=TZ,G.size=LZ,G.snakeCase=fQ,G.some=DZ,G.sortedIndex=PK,G.sortedIndexBy=AK,G.sortedIndexOf=LK,G.sortedLastIndex=DK,G.sortedLastIndexBy=RK,G.sortedLastIndexOf=OK,G.startCase=vQ,G.startsWith=gQ,G.subtract=u$,G.sum=c$,G.sumBy=h$,G.template=_Q,G.times=YQ,G.toFinite=hu,G.toInteger=Gt,G.toLength=k5,G.toLower=yQ,G.toNumber=Vs,G.toSafeInteger=yJ,G.toString=Tn,G.toUpper=xQ,G.trim=bQ,G.trimEnd=wQ,G.trimStart=SQ,G.truncate=MQ,G.unescape=CQ,G.uniqueId=ZQ,G.upperCase=EQ,G.upperFirst=HT,G.each=x5,G.eachRight=b5,G.first=v5,XT(G,function(){var d={};return Ns(G,function(v,T){gn.call(G.prototype,T)||(d[T]=v)}),d}(),{chain:!1}),G.VERSION=i,co(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){G[d].placeholder=G}),co(["drop","take"],function(d,v){$t.prototype[d]=function(T){T=T===t?1:Ai(Gt(T),0);var I=this.__filtered__&&!v?new $t(this):this.clone();return I.__filtered__?I.__takeCount__=pr(T,I.__takeCount__):I.__views__.push({size:pr(T,le),type:d+(I.__dir__<0?"Right":"")}),I},$t.prototype[d+"Right"]=function(T){return this.reverse()[d](T).reverse()}}),co(["filter","map","takeWhile"],function(d,v){var T=v+1,I=T==H||T==Z;$t.prototype[d]=function(V){var Y=this.clone();return Y.__iteratees__.push({iteratee:Lt(V,3),type:T}),Y.__filtered__=Y.__filtered__||I,Y}}),co(["head","last"],function(d,v){var T="take"+(v?"Right":"");$t.prototype[d]=function(){return this[T](1).value()[0]}}),co(["initial","tail"],function(d,v){var T="drop"+(v?"":"Right");$t.prototype[d]=function(){return this.__filtered__?new $t(this):this[T](1)}}),$t.prototype.compact=function(){return this.filter(Bo)},$t.prototype.find=function(d){return this.filter(d).head()},$t.prototype.findLast=function(d){return this.reverse().find(d)},$t.prototype.invokeMap=Wt(function(d,v){return typeof d=="function"?new $t(this):this.map(function(T){return Sd(T,d,v)})}),$t.prototype.reject=function(d){return this.filter(Tb(Lt(d)))},$t.prototype.slice=function(d,v){d=Gt(d);var T=this;return T.__filtered__&&(d>0||v<0)?new $t(T):(d<0?T=T.takeRight(-d):d&&(T=T.drop(d)),v!==t&&(v=Gt(v),T=v<0?T.dropRight(-v):T.take(v-d)),T)},$t.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},$t.prototype.toArray=function(){return this.take(le)},Ns($t.prototype,function(d,v){var T=/^(?:filter|find|map|reject)|While$/.test(v),I=/^(?:head|last)$/.test(v),V=G[I?"take"+(v=="last"?"Right":""):v],Y=I||/^find/.test(v);!V||(G.prototype[v]=function(){var ue=this.__wrapped__,me=I?[1]:arguments,_e=ue instanceof $t,je=me[0],We=_e||Ut(ue),qe=function(en){var ln=V.apply(G,dr([en],me));return I&&ut?ln[0]:ln};We&&T&&typeof je=="function"&&je.length!=1&&(_e=We=!1);var ut=this.__chain__,Mt=!!this.__actions__.length,Rt=Y&&!ut,Xt=_e&&!Mt;if(!Y&&We){ue=Xt?ue:new $t(this);var Ot=d.apply(ue,me);return Ot.__actions__.push({func:Sb,args:[qe],thisArg:t}),new Io(Ot,ut)}return Rt&&Xt?d.apply(this,me):(Ot=this.thru(qe),Rt?I?Ot.value()[0]:Ot.value():Ot)})}),co(["pop","push","shift","sort","splice","unshift"],function(d){var v=sd[d],T=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",I=/^(?:pop|shift)$/.test(d);G.prototype[d]=function(){var V=arguments;if(I&&!this.__chain__){var Y=this.value();return v.apply(Ut(Y)?Y:[],V)}return this[T](function(ue){return v.apply(Ut(ue)?ue:[],V)})}}),Ns($t.prototype,function(d,v){var T=G[v];if(T){var I=T.name+"";gn.call(tl,I)||(tl[I]=[]),tl[I].push({name:v,func:T})}}),tl[vb(t,b).name]=[{name:"wrapper",func:t}],$t.prototype.clone=VE,$t.prototype.reverse=FE,$t.prototype.value=BE,G.prototype.at=nZ,G.prototype.chain=iZ,G.prototype.commit=rZ,G.prototype.next=oZ,G.prototype.plant=aZ,G.prototype.reverse=lZ,G.prototype.toJSON=G.prototype.valueOf=G.prototype.value=uZ,G.prototype.first=G.prototype.head,$l&&(G.prototype[$l]=sZ),G},la=TE();Yl?((Yl.exports=la)._=la,qg._=la):Vi._=la}).call(it)})(ro,ro.exports);const zl=(n,e,t)=>{if(!n.has(e)){const i=t();return n.set(e,i),i}return n.get(e)},Vne=n=>{throw new Error("unexpected value: "+n)},jD=(n,e,t=new WeakSet)=>{if(Array.isArray(n)){if(t.has(n))return;t.add(n);for(let i=0;i<n.length;++i){const r=n[i];e(i,r,n),jD(r,e,t)}}else if(n&&typeof n=="object"){if(t.has(n))return;t.add(n);for(const[i,r]of Object.entries(n))e(i,r,n),jD(r,e,t)}},kj=(n,e)=>{const t=n.indexOf(e);return t===-1?!1:(n.splice(t,1),!0)},Rv=(n,e=-1)=>n[n.length+e],Fne=n=>{const e=n.split(".");if(e.length===1)return e;const t=e.pop();return[e.join("."),t]},Ij=(n,e,t)=>{let i,r=!1,o,s,a=t==="trailingPromise"?new Promise(l=>s=l):void 0;return(...l)=>{if(o=l,r)return a!=null?a:i;r=!0,(t==="leading"||t==="both")&&(i=n(...o));const u=()=>{(t==="trailing"||t==="both"||t==="trailingPromise")&&(i=n(...o),s==null||s(i),a=t==="trailingPromise"?new Promise(c=>s=c):void 0),r=!1};return e>0?setTimeout(u,e):queueMicrotask(u),a!=null?a:i}},Nj=(n,e)=>{if(e===0){let i=!0;return queueMicrotask(()=>i&&n()),()=>i=!1}const t=setTimeout(n,e);return()=>clearTimeout(t)},qa=(n,e,t)=>{let i,r,o,s,a=t==="trailingPromise"?new Promise(l=>s=l):void 0;return(...l)=>(o=l,i?i():(t==="leading"||t==="both")&&(r=n(...o)),i=Nj(()=>{(t==="trailing"||t==="both"||t==="trailingPromise")&&(r=n(...o),s==null||s(r),a=t==="trailingPromise"?new Promise(u=>s=u):void 0),i=void 0},e),a!=null?a:r)},zj=(n,e,t)=>{const i=new WeakMap,r=new WeakMap,o=new WeakMap,s=new WeakMap,a=new WeakMap;return(l,...u)=>{var c;return t==="trailingPromise"&&!a.has(l)&&a.set(l,new Promise(h=>s.set(l,h))),o.set(l,u),i.has(l)?i.get(l)():(t==="leading"||t==="both")&&r.set(l,n(...u)),i.set(l,Nj(()=>{var h;if(t==="trailing"||t==="both"||t==="trailingPromise"){const p=n(...o.get(l));r.set(l,p),(h=s.get(l))===null||h===void 0||h(p),a.set(l,t==="trailingPromise"?new Promise(m=>s.set(l,m)):void 0)}i.delete(l)},e)),(c=a.get(l))!==null&&c!==void 0?c:r.get(l)}},Bne=n=>n,Up=(n,e)=>{let t,i=!1,r=e==null?void 0:e();return(...o)=>{if(e){const s=e();r!==s&&(i=!1),r=s}return i?t:(i=!0,t=n(...o))}},ix=(n,e)=>{for(const t of e)for(const i of Object.getOwnPropertyNames(t.prototype))!(i in n.prototype)&&Object.defineProperty(n.prototype,i,Object.getOwnPropertyDescriptor(t.prototype,i)||Object.create(null))};class zO{constructor(e=void 0){this._cb=e,this.done=void 0,this._value=void 0,this._callbacks=void 0,this._watched=void 0}then(e){var t;return this.done?(e(this._value),Une):(((t=this._callbacks)!==null&&t!==void 0?t:this._callbacks=new Set).add(e),new Cn(()=>this._callbacks.delete(e)))}watch(e){var t;return this.done?e._resolve(this._value):(((t=this._watched)!==null&&t!==void 0?t:this._watched=new Set).add(e),e.then(()=>this._watched.delete(e)),e)}_resolve(e){var t;if(this.done)return this;if(this.done=!0,this._value=e,(t=this._cb)===null||t===void 0||t.call(this,e),this._callbacks)for(const i of this._callbacks)i(e);if(this._watched)for(const i of this._watched)i._resolve(e);return this}}class Vj extends zO{constructor(e){super(e)}resolve(e){return this._resolve(e)}}class Cn extends zO{constructor(e){super(e)}cancel(){return this._resolve()}}class Fj extends zO{constructor(e){super(e)}_resolve(){return this.dispose(),this}dispose(){return super._resolve()}}const Une=new Cn().cancel();class Bj{constructor(){this.cbsMap=new Map}on(e,t){var i;if(Array.isArray(e)){const o=new Cn;for(const s of e)o.watch(this.on(s,t));return o}!((i=this.states)===null||i===void 0)&&i.has(e)&&t(this.states.get(e));const r=zl(this.cbsMap,e,()=>new Set);return r.add(t),new Cn(()=>r.delete(t))}once(e,t){const i=new Cn;return i.watch(this.on(e,r=>{i.cancel(),t(r)})),i}emit(e,t){if(this.cbsMap.has(e))for(const i of this.cbsMap.get(e))i(t)}hasState(e){var t;return!!(!((t=this.states)===null||t===void 0)&&t.has(e))}setState(e,t){var i;(i=this.states)!==null&&i!==void 0||(this.states=new Map),!(this.states.has(e)&&this.states.get(e)===t)&&(this.states.set(e,t),this.emit(e,t))}getState(e){var t;return(t=this.states)===null||t===void 0?void 0:t.get(e)}deleteState(e){var t;(t=this.states)===null||t===void 0||t.delete(e)}clear(){var e;this.cbsMap.clear(),(e=this.states)===null||e===void 0||e.clear()}}class jne{constructor(){this.cbs=new Set}on(e){return"state"in this&&e(this.state),this.cbs.add(e),new Cn(()=>this.cbs.delete(e))}once(e){const t=new Cn;return t.watch(this.on(i=>{t.cancel(),e(i)})),t}emit(e){for(const t of this.cbs)t(e)}setState(e){"state"in this&&this.state===e||(this.state=e,this.emit(e))}getState(){return this.state}}const lo=()=>{const n=new jne;return[e=>n.emit(e),(e,t)=>t?n.once(e):n.on(e),e=>n.setState(e),()=>n.getState()]},Hne=new WeakSet,Qe=n=>{const[,e,t,i]=lo();t(n);const r=o=>{if(o){const s=new Cn;return s.watch(e(a=>o(a,s))),s}return i()};return Hne.add(r),[t,r]},mg=(n,e)=>t=>{const i=e();i&&n([...i,t])},vg=(n,e)=>t=>{const i=e();i&&n(i.filter(r=>r!==t))},Uj=(n,e)=>()=>{const t=e();!t||(Array.isArray(t)?n([...t]):n({...t}))},Wne=(n,e)=>{const t=e();return t&&typeof t=="object"&&(jD(t,(i,r)=>Object.freeze(r)),Object.freeze(t)),()=>n(t)},Rl=[],f6=n=>{var e,t,i;const r=Rl[Rl.length-1];return(e=(t=r.fiber)[i=r.count++])!==null&&e!==void 0?e:t[i]=n()},m6=n=>{var e,t;const i=Rl[Rl.length-1],r=i.count++;return(e=(t=i.fiber)[r])!==null&&e!==void 0||(t[r]=n),[()=>i.fiber[r],o=>i.fiber[r]=o]},jj=(n,e,t,i,r,o)=>{Rl.push({count:0,fiber:t,handle:n});const s=i.map(u=>typeof u=="function"?u():u),a=!r||s.some((u,c)=>u!==r[c]);a&&typeof e=="function"&&e();const l=a?o():void 0;return Rl.pop(),[l,s,a]},Ey=(n,e)=>{const t=f6(()=>Rl[Rl.length-1].handle.watch(new Cn(()=>{var m;return(m=r())===null||m===void 0?void 0:m()})));if(t.done)return t;const i=f6(()=>[]),[r,o]=m6(void 0),[s,a]=m6(void 0),l=r(),u=s();l&&typeof l!="function"&&console.warn("cleanup is not a function");const[c,h,p]=jj(t,l,i,e,u,n);return p&&o(typeof c=="function"?c:void 0),a(h),t},Vt=(n,e)=>{const t=new Cn(()=>setTimeout(()=>r==null?void 0:r())),i=[];let r,o;const s=qa(()=>{const[a,l,u]=jj(t,r,i,e,o,n);u&&(r=typeof a=="function"?a:void 0),o=l},0,"trailing");s();for(const a of e)typeof a=="function"&&t.watch(a(s));return t},Gne=n=>{var e,t,i;const r=Rl[Rl.length-1];return(e=(t=r.fiber)[i=r.count++])!==null&&e!==void 0?e:t[i]={current:typeof n=="function"?n():n}};class Pt{constructor(e){[this.set,this.get]=Qe(e)}}/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const VO="143",Xne=0,v6=1,qne=2,Hj=1,Wj=2,v_=3,Ep=0,Zo=1,Qu=2,Yne=1,ji=0,tv=1,d2=2,g6=3,_6=4,HD=5,rh=100,Kne=101,Zne=102,y6=103,x6=104,WD=200,Jne=201,Qne=202,$ne=203,Gj=204,Xj=205,qj=206,eie=207,Yj=208,tie=209,nie=210,iie=0,rie=1,oie=2,GD=3,sie=4,aie=5,lie=6,uie=7,Kj=0,cie=1,hie=2,Cl=0,Zj=1,die=2,pie=3,fie=4,mie=5,Jj=300,Ov=301,kv=302,Ty=303,XD=304,AC=306,Iv=1e3,vs=1001,qD=1002,Mi=1003,b6=1004,w6=1005,Hi=1006,vie=1007,rx=1008,Tp=1009,gie=1010,_ie=1011,FO=1012,yie=1013,sp=1014,Ia=1015,Bu=1016,xie=1017,bie=1018,nv=1020,wie=1021,Sie=1022,Na=1023,Mie=1024,Cie=1025,fp=1026,Nv=1027,Eie=1028,Tie=1029,Pie=1030,Aie=1031,Lie=1033,TP=33776,PP=33777,AP=33778,LP=33779,S6=35840,M6=35841,C6=35842,E6=35843,Die=36196,T6=37492,P6=37496,A6=37808,L6=37809,D6=37810,R6=37811,O6=37812,k6=37813,I6=37814,N6=37815,z6=37816,V6=37817,F6=37818,B6=37819,U6=37820,j6=37821,H6=36492,YD=2200,KD=2201,Rie=2202,p2=2300,f2=2301,DP=2302,Um=2400,jm=2401,m2=2402,BO=2500,Oie=2501,HDe=1,WDe=2,Ah=3e3,xi=3001,kie=3200,LC=3201,ox=0,Qj=1,Lu="srgb",ap="srgb-linear",RP=7680,Iie=519,ZD=35044,W6="300 es",JD=1035;class jp{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const i=t.slice(0);for(let r=0,o=i.length;r<o;r++)i[r].call(this,e);e.target=null}}}const Zr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let G6=1234567;const B_=Math.PI/180,Py=180/Math.PI;function Js(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Zr[n&255]+Zr[n>>8&255]+Zr[n>>16&255]+Zr[n>>24&255]+"-"+Zr[e&255]+Zr[e>>8&255]+"-"+Zr[e>>16&15|64]+Zr[e>>24&255]+"-"+Zr[t&63|128]+Zr[t>>8&255]+"-"+Zr[t>>16&255]+Zr[t>>24&255]+Zr[i&255]+Zr[i>>8&255]+Zr[i>>16&255]+Zr[i>>24&255]).toLowerCase()}function rr(n,e,t){return Math.max(e,Math.min(t,n))}function UO(n,e){return(n%e+e)%e}function Nie(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function zie(n,e,t){return n!==e?(t-n)/(e-n):0}function U_(n,e,t){return(1-t)*n+t*e}function Vie(n,e,t,i){return U_(n,e,1-Math.exp(-t*i))}function Fie(n,e=1){return e-Math.abs(UO(n,e*2)-e)}function Bie(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function Uie(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function jie(n,e){return n+Math.floor(Math.random()*(e-n+1))}function Hie(n,e){return n+Math.random()*(e-n)}function Wie(n){return n*(.5-Math.random())}function Gie(n){n!==void 0&&(G6=n);let e=G6+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Xie(n){return n*B_}function qie(n){return n*Py}function QD(n){return(n&n-1)===0&&n!==0}function $j(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function v2(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Yie(n,e,t,i,r){const o=Math.cos,s=Math.sin,a=o(t/2),l=s(t/2),u=o((e+i)/2),c=s((e+i)/2),h=o((e-i)/2),p=s((e-i)/2),m=o((i-e)/2),y=s((i-e)/2);switch(r){case"XYX":n.set(a*c,l*h,l*p,a*u);break;case"YZY":n.set(l*p,a*c,l*h,a*u);break;case"ZXZ":n.set(l*h,l*p,a*c,a*u);break;case"XZX":n.set(a*c,l*y,l*m,a*u);break;case"YXY":n.set(l*m,a*c,l*y,a*u);break;case"ZYZ":n.set(l*y,l*m,a*c,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Kie(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Zie(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var OP=Object.freeze({__proto__:null,DEG2RAD:B_,RAD2DEG:Py,generateUUID:Js,clamp:rr,euclideanModulo:UO,mapLinear:Nie,inverseLerp:zie,lerp:U_,damp:Vie,pingpong:Fie,smoothstep:Bie,smootherstep:Uie,randInt:jie,randFloat:Hie,randFloatSpread:Wie,seededRandom:Gie,degToRad:Xie,radToDeg:qie,isPowerOfTwo:QD,ceilPowerOfTwo:$j,floorPowerOfTwo:v2,setQuaternionFromProperEuler:Yie,normalize:Zie,denormalize:Kie});class ze{constructor(e=0,t=0){ze.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),o=this.x-e.x,s=this.y-e.y;return this.x=o*i-s*r+e.x,this.y=o*r+s*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Vr{constructor(){Vr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,o,s,a,l,u){const c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=o,c[5]=l,c[6]=i,c[7]=s,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[3],l=i[6],u=i[1],c=i[4],h=i[7],p=i[2],m=i[5],y=i[8],_=r[0],g=r[3],b=r[6],w=r[1],M=r[4],C=r[7],P=r[2],L=r[5],R=r[8];return o[0]=s*_+a*w+l*P,o[3]=s*g+a*M+l*L,o[6]=s*b+a*C+l*R,o[1]=u*_+c*w+h*P,o[4]=u*g+c*M+h*L,o[7]=u*b+c*C+h*R,o[2]=p*_+m*w+y*P,o[5]=p*g+m*M+y*L,o[8]=p*b+m*C+y*R,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t*s*c-t*a*u-i*o*c+i*a*l+r*o*u-r*s*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*s-a*u,p=a*l-c*o,m=u*o-s*l,y=t*h+i*p+r*m;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/y;return e[0]=h*_,e[1]=(r*u-c*i)*_,e[2]=(a*i-r*s)*_,e[3]=p*_,e[4]=(c*t-r*l)*_,e[5]=(r*o-a*t)*_,e[6]=m*_,e[7]=(i*l-u*t)*_,e[8]=(s*t-i*o)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,o,s,a){const l=Math.cos(o),u=Math.sin(o);return this.set(i*l,i*u,-i*(l*s+u*a)+s+e,-r*u,r*l,-r*(-u*s+l*a)+a+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,o=r[0],s=r[3],a=r[6],l=r[1],u=r[4],c=r[7];return r[0]=t*o+i*l,r[3]=t*s+i*u,r[6]=t*a+i*c,r[1]=-i*o+t*l,r[4]=-i*s+t*u,r[7]=-i*a+t*c,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}function eH(n){for(let e=n.length-1;e>=0;--e)if(n[e]>65535)return!0;return!1}function Ay(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function mp(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function pM(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const kP={[Lu]:{[ap]:mp},[ap]:{[Lu]:pM}},_a={legacyMode:!0,get workingColorSpace(){return ap},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(kP[e]&&kP[e][t]!==void 0){const i=kP[e][t];return n.r=i(n.r),n.g=i(n.g),n.b=i(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},tH={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$i={r:0,g:0,b:0},ya={h:0,s:0,l:0},Kb={h:0,s:0,l:0};function IP(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}function Zb(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}class vt{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Lu){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,_a.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=ap){return this.r=e,this.g=t,this.b=i,_a.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=ap){if(e=UO(e,1),t=rr(t,0,1),i=rr(i,0,1),t===0)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+t):i+t-i*t,s=2*i-o;this.r=IP(s,o,e+1/3),this.g=IP(s,o,e),this.b=IP(s,o,e-1/3)}return _a.toWorkingColorSpace(this,r),this}setStyle(e,t=Lu){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let o;const s=r[1],a=r[2];switch(s){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,_a.toWorkingColorSpace(this,t),i(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,_a.toWorkingColorSpace(this,t),i(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(o[1])/360,u=parseInt(o[2],10)/100,c=parseInt(o[3],10)/100;return i(o[4]),this.setHSL(l,u,c,t)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=r[1],s=o.length;if(s===3)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,_a.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,_a.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Lu){const i=tH[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=mp(e.r),this.g=mp(e.g),this.b=mp(e.b),this}copyLinearToSRGB(e){return this.r=pM(e.r),this.g=pM(e.g),this.b=pM(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Lu){return _a.fromWorkingColorSpace(Zb(this,$i),e),rr($i.r*255,0,255)<<16^rr($i.g*255,0,255)<<8^rr($i.b*255,0,255)<<0}getHexString(e=Lu){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=ap){_a.fromWorkingColorSpace(Zb(this,$i),t);const i=$i.r,r=$i.g,o=$i.b,s=Math.max(i,r,o),a=Math.min(i,r,o);let l,u;const c=(a+s)/2;if(a===s)l=0,u=0;else{const h=s-a;switch(u=c<=.5?h/(s+a):h/(2-s-a),s){case i:l=(r-o)/h+(r<o?6:0);break;case r:l=(o-i)/h+2;break;case o:l=(i-r)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=ap){return _a.fromWorkingColorSpace(Zb(this,$i),t),e.r=$i.r,e.g=$i.g,e.b=$i.b,e}getStyle(e=Lu){return _a.fromWorkingColorSpace(Zb(this,$i),e),e!==Lu?`color(${e} ${$i.r} ${$i.g} ${$i.b})`:`rgb(${$i.r*255|0},${$i.g*255|0},${$i.b*255|0})`}offsetHSL(e,t,i){return this.getHSL(ya),ya.h+=e,ya.s+=t,ya.l+=i,this.setHSL(ya.h,ya.s,ya.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(ya),e.getHSL(Kb);const i=U_(ya.h,Kb.h,t),r=U_(ya.s,Kb.s,t),o=U_(ya.l,Kb.l,t);return this.setHSL(i,r,o),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}vt.NAMES=tH;let Vf;class nH{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Vf===void 0&&(Vf=Ay("canvas")),Vf.width=e.width,Vf.height=e.height;const i=Vf.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Vf}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Ay("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),o=r.data;for(let s=0;s<o.length;s++)o[s]=mp(o[s]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(mp(t[i]/255)*255):t[i]=mp(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class iH{constructor(e=null){this.isSource=!0,this.uuid=Js(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let o;if(Array.isArray(r)){o=[];for(let s=0,a=r.length;s<a;s++)r[s].isDataTexture?o.push(NP(r[s].image)):o.push(NP(r[s]))}else o=NP(r);i.url=o}return t||(e.images[this.uuid]=i),i}}function NP(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?nH.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Jie=0;class so extends jp{constructor(e=so.DEFAULT_IMAGE,t=so.DEFAULT_MAPPING,i=vs,r=vs,o=Hi,s=rx,a=Na,l=Tp,u=1,c=Ah){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Jie++}),this.uuid=Js(),this.name="",this.source=new iH(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=r,this.magFilter=o,this.minFilter=s,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new ze(0,0),this.repeat=new ze(1,1),this.center=new ze(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Vr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Jj)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Iv:e.x=e.x-Math.floor(e.x);break;case vs:e.x=e.x<0?0:1;break;case qD:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Iv:e.y=e.y-Math.floor(e.y);break;case vs:e.y=e.y<0?0:1;break;case qD:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}so.DEFAULT_IMAGE=null;so.DEFAULT_MAPPING=Jj;class _n{constructor(e=0,t=0,i=0,r=1){_n.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r+s[12]*o,this.y=s[1]*t+s[5]*i+s[9]*r+s[13]*o,this.z=s[2]*t+s[6]*i+s[10]*r+s[14]*o,this.w=s[3]*t+s[7]*i+s[11]*r+s[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,o;const s=e.elements,a=s[0],l=s[4],u=s[8],c=s[1],h=s[5],p=s[9],m=s[2],y=s[6],_=s[10];if(Math.abs(l-c)<.01&&Math.abs(u-m)<.01&&Math.abs(p-y)<.01){if(Math.abs(l+c)<.1&&Math.abs(u+m)<.1&&Math.abs(p+y)<.1&&Math.abs(a+h+_-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const b=(a+1)/2,w=(h+1)/2,M=(_+1)/2,C=(l+c)/4,P=(u+m)/4,L=(p+y)/4;return b>w&&b>M?b<.01?(i=0,r=.707106781,o=.707106781):(i=Math.sqrt(b),r=C/i,o=P/i):w>M?w<.01?(i=.707106781,r=0,o=.707106781):(r=Math.sqrt(w),i=C/r,o=L/r):M<.01?(i=.707106781,r=.707106781,o=0):(o=Math.sqrt(M),i=P/o,r=L/o),this.set(i,r,o,t),this}let g=Math.sqrt((y-p)*(y-p)+(u-m)*(u-m)+(c-l)*(c-l));return Math.abs(g)<.001&&(g=1),this.x=(y-p)/g,this.y=(u-m)/g,this.z=(c-l)/g,this.w=Math.acos((a+h+_-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Qn extends jp{constructor(e,t,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new _n(0,0,e,t),this.scissorTest=!1,this.viewport=new _n(0,0,e,t);const r={width:e,height:t,depth:1};this.texture=new so(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Hi,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new iH(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class rH extends so{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Mi,this.minFilter=Mi,this.wrapR=vs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Qie extends so{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Mi,this.minFilter=Mi,this.wrapR=vs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Mo{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,o,s,a){let l=i[r+0],u=i[r+1],c=i[r+2],h=i[r+3];const p=o[s+0],m=o[s+1],y=o[s+2],_=o[s+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h;return}if(a===1){e[t+0]=p,e[t+1]=m,e[t+2]=y,e[t+3]=_;return}if(h!==_||l!==p||u!==m||c!==y){let g=1-a;const b=l*p+u*m+c*y+h*_,w=b>=0?1:-1,M=1-b*b;if(M>Number.EPSILON){const P=Math.sqrt(M),L=Math.atan2(P,b*w);g=Math.sin(g*L)/P,a=Math.sin(a*L)/P}const C=a*w;if(l=l*g+p*C,u=u*g+m*C,c=c*g+y*C,h=h*g+_*C,g===1-a){const P=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=P,u*=P,c*=P,h*=P}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,o,s){const a=i[r],l=i[r+1],u=i[r+2],c=i[r+3],h=o[s],p=o[s+1],m=o[s+2],y=o[s+3];return e[t]=a*y+c*h+l*m-u*p,e[t+1]=l*y+c*p+u*h-a*m,e[t+2]=u*y+c*m+a*p-l*h,e[t+3]=c*y-a*h-l*p-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,o=e._z,s=e._order,a=Math.cos,l=Math.sin,u=a(i/2),c=a(r/2),h=a(o/2),p=l(i/2),m=l(r/2),y=l(o/2);switch(s){case"XYZ":this._x=p*c*h+u*m*y,this._y=u*m*h-p*c*y,this._z=u*c*y+p*m*h,this._w=u*c*h-p*m*y;break;case"YXZ":this._x=p*c*h+u*m*y,this._y=u*m*h-p*c*y,this._z=u*c*y-p*m*h,this._w=u*c*h+p*m*y;break;case"ZXY":this._x=p*c*h-u*m*y,this._y=u*m*h+p*c*y,this._z=u*c*y+p*m*h,this._w=u*c*h-p*m*y;break;case"ZYX":this._x=p*c*h-u*m*y,this._y=u*m*h+p*c*y,this._z=u*c*y-p*m*h,this._w=u*c*h+p*m*y;break;case"YZX":this._x=p*c*h+u*m*y,this._y=u*m*h+p*c*y,this._z=u*c*y-p*m*h,this._w=u*c*h-p*m*y;break;case"XZY":this._x=p*c*h-u*m*y,this._y=u*m*h-p*c*y,this._z=u*c*y+p*m*h,this._w=u*c*h+p*m*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],o=t[8],s=t[1],a=t[5],l=t[9],u=t[2],c=t[6],h=t[10],p=i+a+h;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(c-l)*m,this._y=(o-u)*m,this._z=(s-r)*m}else if(i>a&&i>h){const m=2*Math.sqrt(1+i-a-h);this._w=(c-l)/m,this._x=.25*m,this._y=(r+s)/m,this._z=(o+u)/m}else if(a>h){const m=2*Math.sqrt(1+a-i-h);this._w=(o-u)/m,this._x=(r+s)/m,this._y=.25*m,this._z=(l+c)/m}else{const m=2*Math.sqrt(1+h-i-a);this._w=(s-r)/m,this._x=(o+u)/m,this._y=(l+c)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(rr(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,o=e._z,s=e._w,a=t._x,l=t._y,u=t._z,c=t._w;return this._x=i*c+s*a+r*u-o*l,this._y=r*c+s*l+o*a-i*u,this._z=o*c+s*u+i*l-r*a,this._w=s*c-i*a-r*l-o*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,o=this._z,s=this._w;let a=s*e._w+i*e._x+r*e._y+o*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=i,this._y=r,this._z=o,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*s+t*this._w,this._x=m*i+t*this._x,this._y=m*r+t*this._y,this._z=m*o+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),h=Math.sin((1-t)*c)/u,p=Math.sin(t*c)/u;return this._w=s*h+this._w*p,this._x=i*h+this._x*p,this._y=r*h+this._y*p,this._z=o*h+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(o),i*Math.cos(o),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class K{constructor(e=0,t=0,i=0){K.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(X6.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(X6.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*r,this.y=o[1]*t+o[4]*i+o[7]*r,this.z=o[2]*t+o[5]*i+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=e.elements,s=1/(o[3]*t+o[7]*i+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*r+o[12])*s,this.y=(o[1]*t+o[5]*i+o[9]*r+o[13])*s,this.z=(o[2]*t+o[6]*i+o[10]*r+o[14])*s,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,o=e.x,s=e.y,a=e.z,l=e.w,u=l*t+s*r-a*i,c=l*i+a*t-o*r,h=l*r+o*i-s*t,p=-o*t-s*i-a*r;return this.x=u*l+p*-o+c*-a-h*-s,this.y=c*l+p*-s+h*-o-u*-a,this.z=h*l+p*-a+u*-s-c*-o,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r,this.y=o[1]*t+o[5]*i+o[9]*r,this.z=o[2]*t+o[6]*i+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,o=e.z,s=t.x,a=t.y,l=t.z;return this.x=r*l-o*a,this.y=o*s-i*l,this.z=i*a-r*s,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return zP.copy(this).projectOnVector(e),this.sub(zP)}reflect(e){return this.sub(zP.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(rr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const zP=new K,X6=new Mo;class Hr{constructor(e=new K(1/0,1/0,1/0),t=new K(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,u=e.length;l<u;l+=3){const c=e[l],h=e[l+1],p=e[l+2];c<t&&(t=c),h<i&&(i=h),p<r&&(r=p),c>o&&(o=c),h>s&&(s=h),p>a&&(a=p)}return this.min.set(t,i,r),this.max.set(o,s,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,u=e.count;l<u;l++){const c=e.getX(l),h=e.getY(l),p=e.getZ(l);c<t&&(t=c),h<i&&(i=h),p<r&&(r=p),c>o&&(o=c),h>s&&(s=h),p>a&&(a=p)}return this.min.set(t,i,r),this.max.set(o,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Ad.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){const o=i.attributes.position;for(let s=0,a=o.count;s<a;s++)Ad.fromBufferAttribute(o,s).applyMatrix4(e.matrixWorld),this.expandByPoint(Ad)}else i.boundingBox===null&&i.computeBoundingBox(),VP.copy(i.boundingBox),VP.applyMatrix4(e.matrixWorld),this.union(VP);const r=e.children;for(let o=0,s=r.length;o<s;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ad),Ad.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(z0),Jb.subVectors(this.max,z0),Ff.subVectors(e.a,z0),Bf.subVectors(e.b,z0),Uf.subVectors(e.c,z0),Pc.subVectors(Bf,Ff),Ac.subVectors(Uf,Bf),Ld.subVectors(Ff,Uf);let t=[0,-Pc.z,Pc.y,0,-Ac.z,Ac.y,0,-Ld.z,Ld.y,Pc.z,0,-Pc.x,Ac.z,0,-Ac.x,Ld.z,0,-Ld.x,-Pc.y,Pc.x,0,-Ac.y,Ac.x,0,-Ld.y,Ld.x,0];return!FP(t,Ff,Bf,Uf,Jb)||(t=[1,0,0,0,1,0,0,0,1],!FP(t,Ff,Bf,Uf,Jb))?!1:(Qb.crossVectors(Pc,Ac),t=[Qb.x,Qb.y,Qb.z],FP(t,Ff,Bf,Uf,Jb))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ad.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Ad).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(pu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),pu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),pu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),pu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),pu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),pu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),pu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),pu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(pu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const pu=[new K,new K,new K,new K,new K,new K,new K,new K],Ad=new K,VP=new Hr,Ff=new K,Bf=new K,Uf=new K,Pc=new K,Ac=new K,Ld=new K,z0=new K,Jb=new K,Qb=new K,Dd=new K;function FP(n,e,t,i,r){for(let o=0,s=n.length-3;o<=s;o+=3){Dd.fromArray(n,o);const a=r.x*Math.abs(Dd.x)+r.y*Math.abs(Dd.y)+r.z*Math.abs(Dd.z),l=e.dot(Dd),u=t.dot(Dd),c=i.dot(Dd);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}const $ie=new Hr,q6=new K,$b=new K,BP=new K;class Hp{constructor(e=new K,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):$ie.setFromPoints(e).getCenter(i);let r=0;for(let o=0,s=e.length;o<s;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){BP.subVectors(e,this.center);const t=BP.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.add(BP.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return this.center.equals(e.center)===!0?$b.set(0,0,1).multiplyScalar(e.radius):$b.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(q6.copy(e.center).add($b)),this.expandByPoint(q6.copy(e.center).sub($b)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const fu=new K,UP=new K,ew=new K,Lc=new K,jP=new K,tw=new K,HP=new K;class gg{constructor(e=new K,t=new K(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,fu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=fu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(fu.copy(this.direction).multiplyScalar(t).add(this.origin),fu.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){UP.copy(e).add(t).multiplyScalar(.5),ew.copy(t).sub(e).normalize(),Lc.copy(this.origin).sub(UP);const o=e.distanceTo(t)*.5,s=-this.direction.dot(ew),a=Lc.dot(this.direction),l=-Lc.dot(ew),u=Lc.lengthSq(),c=Math.abs(1-s*s);let h,p,m,y;if(c>0)if(h=s*l-a,p=s*a-l,y=o*c,h>=0)if(p>=-y)if(p<=y){const _=1/c;h*=_,p*=_,m=h*(h+s*p+2*a)+p*(s*h+p+2*l)+u}else p=o,h=Math.max(0,-(s*p+a)),m=-h*h+p*(p+2*l)+u;else p=-o,h=Math.max(0,-(s*p+a)),m=-h*h+p*(p+2*l)+u;else p<=-y?(h=Math.max(0,-(-s*o+a)),p=h>0?-o:Math.min(Math.max(-o,-l),o),m=-h*h+p*(p+2*l)+u):p<=y?(h=0,p=Math.min(Math.max(-o,-l),o),m=p*(p+2*l)+u):(h=Math.max(0,-(s*o+a)),p=h>0?o:Math.min(Math.max(-o,-l),o),m=-h*h+p*(p+2*l)+u);else p=s>0?-o:o,h=Math.max(0,-(s*p+a)),m=-h*h+p*(p+2*l)+u;return i&&i.copy(this.direction).multiplyScalar(h).add(this.origin),r&&r.copy(ew).multiplyScalar(p).add(UP),m}intersectSphere(e,t){fu.subVectors(e.center,this.origin);const i=fu.dot(this.direction),r=fu.dot(fu)-i*i,o=e.radius*e.radius;if(r>o)return null;const s=Math.sqrt(o-r),a=i-s,l=i+s;return a<0&&l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,o,s,a,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,p=this.origin;return u>=0?(i=(e.min.x-p.x)*u,r=(e.max.x-p.x)*u):(i=(e.max.x-p.x)*u,r=(e.min.x-p.x)*u),c>=0?(o=(e.min.y-p.y)*c,s=(e.max.y-p.y)*c):(o=(e.max.y-p.y)*c,s=(e.min.y-p.y)*c),i>s||o>r||((o>i||i!==i)&&(i=o),(s<r||r!==r)&&(r=s),h>=0?(a=(e.min.z-p.z)*h,l=(e.max.z-p.z)*h):(a=(e.max.z-p.z)*h,l=(e.min.z-p.z)*h),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,fu)!==null}intersectTriangle(e,t,i,r,o){jP.subVectors(t,e),tw.subVectors(i,e),HP.crossVectors(jP,tw);let s=this.direction.dot(HP),a;if(s>0){if(r)return null;a=1}else if(s<0)a=-1,s=-s;else return null;Lc.subVectors(this.origin,e);const l=a*this.direction.dot(tw.crossVectors(Lc,tw));if(l<0)return null;const u=a*this.direction.dot(jP.cross(Lc));if(u<0||l+u>s)return null;const c=-a*Lc.dot(HP);return c<0?null:this.at(c/s,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Bt{constructor(){Bt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,r,o,s,a,l,u,c,h,p,m,y,_,g){const b=this.elements;return b[0]=e,b[4]=t,b[8]=i,b[12]=r,b[1]=o,b[5]=s,b[9]=a,b[13]=l,b[2]=u,b[6]=c,b[10]=h,b[14]=p,b[3]=m,b[7]=y,b[11]=_,b[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Bt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/jf.setFromMatrixColumn(e,0).length(),o=1/jf.setFromMatrixColumn(e,1).length(),s=1/jf.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,o=e.z,s=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),c=Math.cos(o),h=Math.sin(o);if(e.order==="XYZ"){const p=s*c,m=s*h,y=a*c,_=a*h;t[0]=l*c,t[4]=-l*h,t[8]=u,t[1]=m+y*u,t[5]=p-_*u,t[9]=-a*l,t[2]=_-p*u,t[6]=y+m*u,t[10]=s*l}else if(e.order==="YXZ"){const p=l*c,m=l*h,y=u*c,_=u*h;t[0]=p+_*a,t[4]=y*a-m,t[8]=s*u,t[1]=s*h,t[5]=s*c,t[9]=-a,t[2]=m*a-y,t[6]=_+p*a,t[10]=s*l}else if(e.order==="ZXY"){const p=l*c,m=l*h,y=u*c,_=u*h;t[0]=p-_*a,t[4]=-s*h,t[8]=y+m*a,t[1]=m+y*a,t[5]=s*c,t[9]=_-p*a,t[2]=-s*u,t[6]=a,t[10]=s*l}else if(e.order==="ZYX"){const p=s*c,m=s*h,y=a*c,_=a*h;t[0]=l*c,t[4]=y*u-m,t[8]=p*u+_,t[1]=l*h,t[5]=_*u+p,t[9]=m*u-y,t[2]=-u,t[6]=a*l,t[10]=s*l}else if(e.order==="YZX"){const p=s*l,m=s*u,y=a*l,_=a*u;t[0]=l*c,t[4]=_-p*h,t[8]=y*h+m,t[1]=h,t[5]=s*c,t[9]=-a*c,t[2]=-u*c,t[6]=m*h+y,t[10]=p-_*h}else if(e.order==="XZY"){const p=s*l,m=s*u,y=a*l,_=a*u;t[0]=l*c,t[4]=-h,t[8]=u*c,t[1]=p*h+_,t[5]=s*c,t[9]=m*h-y,t[2]=y*h-m,t[6]=a*c,t[10]=_*h+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ere,e,tre)}lookAt(e,t,i){const r=this.elements;return as.subVectors(e,t),as.lengthSq()===0&&(as.z=1),as.normalize(),Dc.crossVectors(i,as),Dc.lengthSq()===0&&(Math.abs(i.z)===1?as.x+=1e-4:as.z+=1e-4,as.normalize(),Dc.crossVectors(i,as)),Dc.normalize(),nw.crossVectors(as,Dc),r[0]=Dc.x,r[4]=nw.x,r[8]=as.x,r[1]=Dc.y,r[5]=nw.y,r[9]=as.y,r[2]=Dc.z,r[6]=nw.z,r[10]=as.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[4],l=i[8],u=i[12],c=i[1],h=i[5],p=i[9],m=i[13],y=i[2],_=i[6],g=i[10],b=i[14],w=i[3],M=i[7],C=i[11],P=i[15],L=r[0],R=r[4],E=r[8],D=r[12],N=r[1],j=r[5],te=r[9],ee=r[13],H=r[2],Q=r[6],Z=r[10],de=r[14],X=r[3],B=r[7],U=r[11],le=r[15];return o[0]=s*L+a*N+l*H+u*X,o[4]=s*R+a*j+l*Q+u*B,o[8]=s*E+a*te+l*Z+u*U,o[12]=s*D+a*ee+l*de+u*le,o[1]=c*L+h*N+p*H+m*X,o[5]=c*R+h*j+p*Q+m*B,o[9]=c*E+h*te+p*Z+m*U,o[13]=c*D+h*ee+p*de+m*le,o[2]=y*L+_*N+g*H+b*X,o[6]=y*R+_*j+g*Q+b*B,o[10]=y*E+_*te+g*Z+b*U,o[14]=y*D+_*ee+g*de+b*le,o[3]=w*L+M*N+C*H+P*X,o[7]=w*R+M*j+C*Q+P*B,o[11]=w*E+M*te+C*Z+P*U,o[15]=w*D+M*ee+C*de+P*le,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],o=e[12],s=e[1],a=e[5],l=e[9],u=e[13],c=e[2],h=e[6],p=e[10],m=e[14],y=e[3],_=e[7],g=e[11],b=e[15];return y*(+o*l*h-r*u*h-o*a*p+i*u*p+r*a*m-i*l*m)+_*(+t*l*m-t*u*p+o*s*p-r*s*m+r*u*c-o*l*c)+g*(+t*u*h-t*a*m-o*s*h+i*s*m+o*a*c-i*u*c)+b*(-r*a*c-t*l*h+t*a*p+r*s*h-i*s*p+i*l*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],m=e[11],y=e[12],_=e[13],g=e[14],b=e[15],w=h*g*u-_*p*u+_*l*m-a*g*m-h*l*b+a*p*b,M=y*p*u-c*g*u-y*l*m+s*g*m+c*l*b-s*p*b,C=c*_*u-y*h*u+y*a*m-s*_*m-c*a*b+s*h*b,P=y*h*l-c*_*l-y*a*p+s*_*p+c*a*g-s*h*g,L=t*w+i*M+r*C+o*P;if(L===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const R=1/L;return e[0]=w*R,e[1]=(_*p*o-h*g*o-_*r*m+i*g*m+h*r*b-i*p*b)*R,e[2]=(a*g*o-_*l*o+_*r*u-i*g*u-a*r*b+i*l*b)*R,e[3]=(h*l*o-a*p*o-h*r*u+i*p*u+a*r*m-i*l*m)*R,e[4]=M*R,e[5]=(c*g*o-y*p*o+y*r*m-t*g*m-c*r*b+t*p*b)*R,e[6]=(y*l*o-s*g*o-y*r*u+t*g*u+s*r*b-t*l*b)*R,e[7]=(s*p*o-c*l*o+c*r*u-t*p*u-s*r*m+t*l*m)*R,e[8]=C*R,e[9]=(y*h*o-c*_*o-y*i*m+t*_*m+c*i*b-t*h*b)*R,e[10]=(s*_*o-y*a*o+y*i*u-t*_*u-s*i*b+t*a*b)*R,e[11]=(c*a*o-s*h*o-c*i*u+t*h*u+s*i*m-t*a*m)*R,e[12]=P*R,e[13]=(c*_*r-y*h*r+y*i*p-t*_*p-c*i*g+t*h*g)*R,e[14]=(y*a*r-s*_*r-y*i*l+t*_*l+s*i*g-t*a*g)*R,e[15]=(s*h*r-c*a*r+c*i*l-t*h*l-s*i*p+t*a*p)*R,this}scale(e){const t=this.elements,i=e.x,r=e.y,o=e.z;return t[0]*=i,t[4]*=r,t[8]*=o,t[1]*=i,t[5]*=r,t[9]*=o,t[2]*=i,t[6]*=r,t[10]*=o,t[3]*=i,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),o=1-i,s=e.x,a=e.y,l=e.z,u=o*s,c=o*a;return this.set(u*s+i,u*a-r*l,u*l+r*a,0,u*a+r*l,c*a+i,c*l-r*s,0,u*l-r*a,c*l+r*s,o*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,o,s){return this.set(1,i,o,0,e,1,s,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,o=t._x,s=t._y,a=t._z,l=t._w,u=o+o,c=s+s,h=a+a,p=o*u,m=o*c,y=o*h,_=s*c,g=s*h,b=a*h,w=l*u,M=l*c,C=l*h,P=i.x,L=i.y,R=i.z;return r[0]=(1-(_+b))*P,r[1]=(m+C)*P,r[2]=(y-M)*P,r[3]=0,r[4]=(m-C)*L,r[5]=(1-(p+b))*L,r[6]=(g+w)*L,r[7]=0,r[8]=(y+M)*R,r[9]=(g-w)*R,r[10]=(1-(p+_))*R,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let o=jf.set(r[0],r[1],r[2]).length();const s=jf.set(r[4],r[5],r[6]).length(),a=jf.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],xa.copy(this);const l=1/o,u=1/s,c=1/a;return xa.elements[0]*=l,xa.elements[1]*=l,xa.elements[2]*=l,xa.elements[4]*=u,xa.elements[5]*=u,xa.elements[6]*=u,xa.elements[8]*=c,xa.elements[9]*=c,xa.elements[10]*=c,t.setFromRotationMatrix(xa),i.x=o,i.y=s,i.z=a,this}makePerspective(e,t,i,r,o,s){const a=this.elements,l=2*o/(t-e),u=2*o/(i-r),c=(t+e)/(t-e),h=(i+r)/(i-r),p=-(s+o)/(s-o),m=-2*s*o/(s-o);return a[0]=l,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=m,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,o,s){const a=this.elements,l=1/(t-e),u=1/(i-r),c=1/(s-o),h=(t+e)*l,p=(i+r)*u,m=(s+o)*c;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-m,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const jf=new K,xa=new Bt,ere=new K(0,0,0),tre=new K(1,1,1),Dc=new K,nw=new K,as=new K,Y6=new Bt,K6=new Mo;class _g{constructor(e=0,t=0,i=0,r=_g.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,o=r[0],s=r[4],a=r[8],l=r[1],u=r[5],c=r[9],h=r[2],p=r[6],m=r[10];switch(t){case"XYZ":this._y=Math.asin(rr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,m),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(p,u),this._z=0);break;case"YXZ":this._x=Math.asin(-rr(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(rr(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-rr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,u));break;case"YZX":this._z=Math.asin(rr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-rr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(p,u),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-c,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return Y6.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Y6,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return K6.setFromEuler(this),this.setFromQuaternion(K6,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}_g.DefaultOrder="XYZ";_g.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class jO{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let nre=0;const Z6=new K,Hf=new Mo,mu=new Bt,iw=new K,V0=new K,ire=new K,rre=new Mo,J6=new K(1,0,0),Q6=new K(0,1,0),$6=new K(0,0,1),ore={type:"added"},ez={type:"removed"};class An extends jp{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:nre++}),this.uuid=Js(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=An.DefaultUp.clone();const e=new K,t=new _g,i=new Mo,r=new K(1,1,1);function o(){i.setFromEuler(t,!1)}function s(){t.setFromQuaternion(i,void 0,!1)}t._onChange(o),i._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Bt},normalMatrix:{value:new Vr}}),this.matrix=new Bt,this.matrixWorld=new Bt,this.matrixAutoUpdate=An.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new jO,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Hf.setFromAxisAngle(e,t),this.quaternion.multiply(Hf),this}rotateOnWorldAxis(e,t){return Hf.setFromAxisAngle(e,t),this.quaternion.premultiply(Hf),this}rotateX(e){return this.rotateOnAxis(J6,e)}rotateY(e){return this.rotateOnAxis(Q6,e)}rotateZ(e){return this.rotateOnAxis($6,e)}translateOnAxis(e,t){return Z6.copy(e).applyQuaternion(this.quaternion),this.position.add(Z6.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(J6,e)}translateY(e){return this.translateOnAxis(Q6,e)}translateZ(e){return this.translateOnAxis($6,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(mu.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?iw.copy(e):iw.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),V0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mu.lookAt(V0,iw,this.up):mu.lookAt(iw,V0,this.up),this.quaternion.setFromRotationMatrix(mu),r&&(mu.extractRotation(r.matrixWorld),Hf.setFromRotationMatrix(mu),this.quaternion.premultiply(Hf.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ore)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(ez)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(ez)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),mu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),mu.multiply(e.parent.matrixWorld)),e.applyMatrix4(mu),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(V0,e,ire),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(V0,rre,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let o=0,s=r.length;o<s;o++)r[o].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function o(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];o(e.shapes,h)}else o(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(o(e.materials,this.material[l]));r.material=a}else r.material=o(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(o(e.animations,l))}}if(t){const a=s(e.geometries),l=s(e.materials),u=s(e.textures),c=s(e.images),h=s(e.shapes),p=s(e.skeletons),m=s(e.animations),y=s(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),c.length>0&&(i.images=c),h.length>0&&(i.shapes=h),p.length>0&&(i.skeletons=p),m.length>0&&(i.animations=m),y.length>0&&(i.nodes=y)}return i.object=r,i;function s(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}An.DefaultUp=new K(0,1,0);An.DefaultMatrixAutoUpdate=!0;const ba=new K,vu=new K,WP=new K,gu=new K,Wf=new K,Gf=new K,tz=new K,GP=new K,XP=new K,qP=new K;class gs{constructor(e=new K,t=new K,i=new K){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),ba.subVectors(e,t),r.cross(ba);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,i,r,o){ba.subVectors(r,t),vu.subVectors(i,t),WP.subVectors(e,t);const s=ba.dot(ba),a=ba.dot(vu),l=ba.dot(WP),u=vu.dot(vu),c=vu.dot(WP),h=s*u-a*a;if(h===0)return o.set(-2,-1,-1);const p=1/h,m=(u*l-a*c)*p,y=(s*c-a*l)*p;return o.set(1-m-y,y,m)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,gu),gu.x>=0&&gu.y>=0&&gu.x+gu.y<=1}static getUV(e,t,i,r,o,s,a,l){return this.getBarycoord(e,t,i,r,gu),l.set(0,0),l.addScaledVector(o,gu.x),l.addScaledVector(s,gu.y),l.addScaledVector(a,gu.z),l}static isFrontFacing(e,t,i,r){return ba.subVectors(i,t),vu.subVectors(e,t),ba.cross(vu).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ba.subVectors(this.c,this.b),vu.subVectors(this.a,this.b),ba.cross(vu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return gs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return gs.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,o){return gs.getUV(e,this.a,this.b,this.c,t,i,r,o)}containsPoint(e){return gs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return gs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,o=this.c;let s,a;Wf.subVectors(r,i),Gf.subVectors(o,i),GP.subVectors(e,i);const l=Wf.dot(GP),u=Gf.dot(GP);if(l<=0&&u<=0)return t.copy(i);XP.subVectors(e,r);const c=Wf.dot(XP),h=Gf.dot(XP);if(c>=0&&h<=c)return t.copy(r);const p=l*h-c*u;if(p<=0&&l>=0&&c<=0)return s=l/(l-c),t.copy(i).addScaledVector(Wf,s);qP.subVectors(e,o);const m=Wf.dot(qP),y=Gf.dot(qP);if(y>=0&&m<=y)return t.copy(o);const _=m*u-l*y;if(_<=0&&u>=0&&y<=0)return a=u/(u-y),t.copy(i).addScaledVector(Gf,a);const g=c*y-m*h;if(g<=0&&h-c>=0&&m-y>=0)return tz.subVectors(o,r),a=(h-c)/(h-c+(m-y)),t.copy(r).addScaledVector(tz,a);const b=1/(g+_+p);return s=_*b,a=p*b,t.copy(i).addScaledVector(Wf,s).addScaledVector(Gf,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let sre=0;class Vl extends jp{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:sre++}),this.uuid=Js(),this.name="",this.type="Material",this.blending=tv,this.side=Ep,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Gj,this.blendDst=Xj,this.blendEquation=rh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=GD,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Iie,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=RP,this.stencilZFail=RP,this.stencilZPass=RP,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===Yne;continue}const r=this[t];if(r===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==tv&&(i.blending=this.blending),this.side!==Ep&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData);function r(o){const s=[];for(const a in o){const l=o[a];delete l.metadata,s.push(l)}return s}if(t){const o=r(e.textures),s=r(e.images);o.length>0&&(i.textures=o),s.length>0&&(i.images=s)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let o=0;o!==r;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class yg extends Vl{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new vt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kj,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Bi=new K,rw=new ze;class Co{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i===!0,this.usage=ZD,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),s=new vt),t[i++]=s.r,t[i++]=s.g,t[i++]=s.b}return this}copyVector2sArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),s=new ze),t[i++]=s.x,t[i++]=s.y}return this}copyVector3sArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),s=new K),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z}return this}copyVector4sArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),s=new _n),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z,t[i++]=s.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)rw.fromBufferAttribute(this,t),rw.applyMatrix3(e),this.setXY(t,rw.x,rw.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Bi.fromBufferAttribute(this,t),Bi.applyMatrix3(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Bi.fromBufferAttribute(this,t),Bi.applyMatrix4(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Bi.fromBufferAttribute(this,t),Bi.applyNormalMatrix(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Bi.fromBufferAttribute(this,t),Bi.transformDirection(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,o){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==ZD&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class oH extends Co{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class sH extends Co{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Zt extends Co{constructor(e,t,i){super(new Float32Array(e),t,i)}}let are=0;const Fs=new Bt,YP=new An,Xf=new K,ls=new Hr,F0=new Hr,mr=new K;class ei extends jp{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:are++}),this.uuid=Js(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(eH(e)?sH:oH)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const o=new Vr().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Fs.makeRotationFromQuaternion(e),this.applyMatrix4(Fs),this}rotateX(e){return Fs.makeRotationX(e),this.applyMatrix4(Fs),this}rotateY(e){return Fs.makeRotationY(e),this.applyMatrix4(Fs),this}rotateZ(e){return Fs.makeRotationZ(e),this.applyMatrix4(Fs),this}translate(e,t,i){return Fs.makeTranslation(e,t,i),this.applyMatrix4(Fs),this}scale(e,t,i){return Fs.makeScale(e,t,i),this.applyMatrix4(Fs),this}lookAt(e){return YP.lookAt(e),YP.updateMatrix(),this.applyMatrix4(YP.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Xf).negate(),this.translate(Xf.x,Xf.y,Xf.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const o=e[i];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new Zt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Hr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new K(-1/0,-1/0,-1/0),new K(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const o=t[i];ls.setFromBufferAttribute(o),this.morphTargetsRelative?(mr.addVectors(this.boundingBox.min,ls.min),this.boundingBox.expandByPoint(mr),mr.addVectors(this.boundingBox.max,ls.max),this.boundingBox.expandByPoint(mr)):(this.boundingBox.expandByPoint(ls.min),this.boundingBox.expandByPoint(ls.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Hp);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new K,1/0);return}if(e){const i=this.boundingSphere.center;if(ls.setFromBufferAttribute(e),t)for(let o=0,s=t.length;o<s;o++){const a=t[o];F0.setFromBufferAttribute(a),this.morphTargetsRelative?(mr.addVectors(ls.min,F0.min),ls.expandByPoint(mr),mr.addVectors(ls.max,F0.max),ls.expandByPoint(mr)):(ls.expandByPoint(F0.min),ls.expandByPoint(F0.max))}ls.getCenter(i);let r=0;for(let o=0,s=e.count;o<s;o++)mr.fromBufferAttribute(e,o),r=Math.max(r,i.distanceToSquared(mr));if(t)for(let o=0,s=t.length;o<s;o++){const a=t[o],l=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)mr.fromBufferAttribute(a,u),l&&(Xf.fromBufferAttribute(e,u),mr.add(Xf)),r=Math.max(r,i.distanceToSquared(mr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,o=t.normal.array,s=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Co(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,u=[],c=[];for(let N=0;N<a;N++)u[N]=new K,c[N]=new K;const h=new K,p=new K,m=new K,y=new ze,_=new ze,g=new ze,b=new K,w=new K;function M(N,j,te){h.fromArray(r,N*3),p.fromArray(r,j*3),m.fromArray(r,te*3),y.fromArray(s,N*2),_.fromArray(s,j*2),g.fromArray(s,te*2),p.sub(h),m.sub(h),_.sub(y),g.sub(y);const ee=1/(_.x*g.y-g.x*_.y);!isFinite(ee)||(b.copy(p).multiplyScalar(g.y).addScaledVector(m,-_.y).multiplyScalar(ee),w.copy(m).multiplyScalar(_.x).addScaledVector(p,-g.x).multiplyScalar(ee),u[N].add(b),u[j].add(b),u[te].add(b),c[N].add(w),c[j].add(w),c[te].add(w))}let C=this.groups;C.length===0&&(C=[{start:0,count:i.length}]);for(let N=0,j=C.length;N<j;++N){const te=C[N],ee=te.start,H=te.count;for(let Q=ee,Z=ee+H;Q<Z;Q+=3)M(i[Q+0],i[Q+1],i[Q+2])}const P=new K,L=new K,R=new K,E=new K;function D(N){R.fromArray(o,N*3),E.copy(R);const j=u[N];P.copy(j),P.sub(R.multiplyScalar(R.dot(j))).normalize(),L.crossVectors(E,j);const te=L.dot(c[N])<0?-1:1;l[N*4]=P.x,l[N*4+1]=P.y,l[N*4+2]=P.z,l[N*4+3]=te}for(let N=0,j=C.length;N<j;++N){const te=C[N],ee=te.start,H=te.count;for(let Q=ee,Z=ee+H;Q<Z;Q+=3)D(i[Q+0]),D(i[Q+1]),D(i[Q+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Co(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let p=0,m=i.count;p<m;p++)i.setXYZ(p,0,0,0);const r=new K,o=new K,s=new K,a=new K,l=new K,u=new K,c=new K,h=new K;if(e)for(let p=0,m=e.count;p<m;p+=3){const y=e.getX(p+0),_=e.getX(p+1),g=e.getX(p+2);r.fromBufferAttribute(t,y),o.fromBufferAttribute(t,_),s.fromBufferAttribute(t,g),c.subVectors(s,o),h.subVectors(r,o),c.cross(h),a.fromBufferAttribute(i,y),l.fromBufferAttribute(i,_),u.fromBufferAttribute(i,g),a.add(c),l.add(c),u.add(c),i.setXYZ(y,a.x,a.y,a.z),i.setXYZ(_,l.x,l.y,l.z),i.setXYZ(g,u.x,u.y,u.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),o.fromBufferAttribute(t,p+1),s.fromBufferAttribute(t,p+2),c.subVectors(s,o),h.subVectors(r,o),c.cross(h),i.setXYZ(p+0,c.x,c.y,c.z),i.setXYZ(p+1,c.x,c.y,c.z),i.setXYZ(p+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const r in i){if(e.attributes[r]===void 0)continue;const o=i[r].array,s=e.attributes[r],a=s.array,l=s.itemSize*t,u=Math.min(a.length,o.length-l);for(let c=0,h=l;c<u;c++,h++)o[h]=a[c]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)mr.fromBufferAttribute(e,t),mr.normalize(),e.setXYZ(t,mr.x,mr.y,mr.z)}toNonIndexed(){function e(a,l){const u=a.array,c=a.itemSize,h=a.normalized,p=new u.constructor(l.length*c);let m=0,y=0;for(let _=0,g=l.length;_<g;_++){a.isInterleavedBufferAttribute?m=l[_]*a.data.stride+a.offset:m=l[_]*c;for(let b=0;b<c;b++)p[y++]=u[m++]}return new Co(p,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ei,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);t.setAttribute(a,u)}const o=this.morphAttributes;for(const a in o){const l=[],u=o[a];for(let c=0,h=u.length;c<h;c++){const p=u[c],m=e(p,i);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,l=s.length;a<l;a++){const u=s[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let o=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,p=u.length;h<p;h++){const m=u[h];c.push(m.toJSON(e.data))}c.length>0&&(r[l]=c,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const u in r){const c=r[u];this.setAttribute(u,c.clone(t))}const o=e.morphAttributes;for(const u in o){const c=[],h=o[u];for(let p=0,m=h.length;p<m;p++)c.push(h[p].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let u=0,c=s.length;u<c;u++){const h=s[u];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const nz=new Bt,qf=new gg,KP=new Hp,Rc=new K,Oc=new K,kc=new K,ZP=new K,JP=new K,QP=new K,ow=new K,sw=new K,aw=new K,lw=new ze,uw=new ze,cw=new ze,$P=new K,hw=new K;class Fr extends An{constructor(e=new ei,t=new yg){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){const s=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=r}}}}raycast(e,t){const i=this.geometry,r=this.material,o=this.matrixWorld;if(r===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),KP.copy(i.boundingSphere),KP.applyMatrix4(o),e.ray.intersectsSphere(KP)===!1)||(nz.copy(o).invert(),qf.copy(e.ray).applyMatrix4(nz),i.boundingBox!==null&&qf.intersectsBox(i.boundingBox)===!1))return;let s;const a=i.index,l=i.attributes.position,u=i.morphAttributes.position,c=i.morphTargetsRelative,h=i.attributes.uv,p=i.attributes.uv2,m=i.groups,y=i.drawRange;if(a!==null)if(Array.isArray(r))for(let _=0,g=m.length;_<g;_++){const b=m[_],w=r[b.materialIndex],M=Math.max(b.start,y.start),C=Math.min(a.count,Math.min(b.start+b.count,y.start+y.count));for(let P=M,L=C;P<L;P+=3){const R=a.getX(P),E=a.getX(P+1),D=a.getX(P+2);s=dw(this,w,e,qf,l,u,c,h,p,R,E,D),s&&(s.faceIndex=Math.floor(P/3),s.face.materialIndex=b.materialIndex,t.push(s))}}else{const _=Math.max(0,y.start),g=Math.min(a.count,y.start+y.count);for(let b=_,w=g;b<w;b+=3){const M=a.getX(b),C=a.getX(b+1),P=a.getX(b+2);s=dw(this,r,e,qf,l,u,c,h,p,M,C,P),s&&(s.faceIndex=Math.floor(b/3),t.push(s))}}else if(l!==void 0)if(Array.isArray(r))for(let _=0,g=m.length;_<g;_++){const b=m[_],w=r[b.materialIndex],M=Math.max(b.start,y.start),C=Math.min(l.count,Math.min(b.start+b.count,y.start+y.count));for(let P=M,L=C;P<L;P+=3){const R=P,E=P+1,D=P+2;s=dw(this,w,e,qf,l,u,c,h,p,R,E,D),s&&(s.faceIndex=Math.floor(P/3),s.face.materialIndex=b.materialIndex,t.push(s))}}else{const _=Math.max(0,y.start),g=Math.min(l.count,y.start+y.count);for(let b=_,w=g;b<w;b+=3){const M=b,C=b+1,P=b+2;s=dw(this,r,e,qf,l,u,c,h,p,M,C,P),s&&(s.faceIndex=Math.floor(b/3),t.push(s))}}}}function lre(n,e,t,i,r,o,s,a){let l;if(e.side===Zo?l=i.intersectTriangle(s,o,r,!0,a):l=i.intersectTriangle(r,o,s,e.side!==Qu,a),l===null)return null;hw.copy(a),hw.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(hw);return u<t.near||u>t.far?null:{distance:u,point:hw.clone(),object:n}}function dw(n,e,t,i,r,o,s,a,l,u,c,h){Rc.fromBufferAttribute(r,u),Oc.fromBufferAttribute(r,c),kc.fromBufferAttribute(r,h);const p=n.morphTargetInfluences;if(o&&p){ow.set(0,0,0),sw.set(0,0,0),aw.set(0,0,0);for(let y=0,_=o.length;y<_;y++){const g=p[y],b=o[y];g!==0&&(ZP.fromBufferAttribute(b,u),JP.fromBufferAttribute(b,c),QP.fromBufferAttribute(b,h),s?(ow.addScaledVector(ZP,g),sw.addScaledVector(JP,g),aw.addScaledVector(QP,g)):(ow.addScaledVector(ZP.sub(Rc),g),sw.addScaledVector(JP.sub(Oc),g),aw.addScaledVector(QP.sub(kc),g)))}Rc.add(ow),Oc.add(sw),kc.add(aw)}n.isSkinnedMesh&&(n.boneTransform(u,Rc),n.boneTransform(c,Oc),n.boneTransform(h,kc));const m=lre(n,e,t,i,Rc,Oc,kc,$P);if(m){a&&(lw.fromBufferAttribute(a,u),uw.fromBufferAttribute(a,c),cw.fromBufferAttribute(a,h),m.uv=gs.getUV($P,Rc,Oc,kc,lw,uw,cw,new ze)),l&&(lw.fromBufferAttribute(l,u),uw.fromBufferAttribute(l,c),cw.fromBufferAttribute(l,h),m.uv2=gs.getUV($P,Rc,Oc,kc,lw,uw,cw,new ze));const y={a:u,b:c,c:h,normal:new K,materialIndex:0};gs.getNormal(Rc,Oc,kc,y.normal),m.face=y}return m}class Wp extends ei{constructor(e=1,t=1,i=1,r=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:o,depthSegments:s};const a=this;r=Math.floor(r),o=Math.floor(o),s=Math.floor(s);const l=[],u=[],c=[],h=[];let p=0,m=0;y("z","y","x",-1,-1,i,t,e,s,o,0),y("z","y","x",1,-1,i,t,-e,s,o,1),y("x","z","y",1,1,e,i,t,r,s,2),y("x","z","y",1,-1,e,i,-t,r,s,3),y("x","y","z",1,-1,e,t,i,r,o,4),y("x","y","z",-1,-1,e,t,-i,r,o,5),this.setIndex(l),this.setAttribute("position",new Zt(u,3)),this.setAttribute("normal",new Zt(c,3)),this.setAttribute("uv",new Zt(h,2));function y(_,g,b,w,M,C,P,L,R,E,D){const N=C/R,j=P/E,te=C/2,ee=P/2,H=L/2,Q=R+1,Z=E+1;let de=0,X=0;const B=new K;for(let U=0;U<Z;U++){const le=U*j-ee;for(let ne=0;ne<Q;ne++){const fe=ne*N-te;B[_]=fe*w,B[g]=le*M,B[b]=H,u.push(B.x,B.y,B.z),B[_]=0,B[g]=0,B[b]=L>0?1:-1,c.push(B.x,B.y,B.z),h.push(ne/R),h.push(1-U/E),de+=1}}for(let U=0;U<E;U++)for(let le=0;le<R;le++){const ne=p+le+Q*U,fe=p+le+Q*(U+1),we=p+(le+1)+Q*(U+1),Be=p+(le+1)+Q*U;l.push(ne,fe,Be),l.push(fe,we,Be),X+=6}a.addGroup(m,X,D),m+=X,p+=de}}static fromJSON(e){return new Wp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function zv(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function $r(n){const e={};for(let t=0;t<n.length;t++){const i=zv(n[t]);for(const r in i)e[r]=i[r]}return e}function ure(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}const zr={clone:zv,merge:$r};var cre=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,hre=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Mn extends Vl{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=cre,this.fragmentShader=hre,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=zv(e.uniforms),this.uniformsGroups=ure(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class HO extends An{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Bt,this.projectionMatrix=new Bt,this.projectionMatrixInverse=new Bt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class or extends HO{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Py*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(B_*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Py*2*Math.atan(Math.tan(B_*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,o,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(B_*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,o=-.5*r;const s=this.view;if(this.view!==null&&this.view.enabled){const l=s.fullWidth,u=s.fullHeight;o+=s.offsetX*r/l,t-=s.offsetY*i/u,r*=s.width/l,i*=s.height/u}const a=this.filmOffset;a!==0&&(o+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Yf=90,Kf=1;class aH extends An{constructor(e,t,i){if(super(),this.type="CubeCamera",i.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=i;const r=new or(Yf,Kf,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new K(1,0,0)),this.add(r);const o=new or(Yf,Kf,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new K(-1,0,0)),this.add(o);const s=new or(Yf,Kf,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new K(0,1,0)),this.add(s);const a=new or(Yf,Kf,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new K(0,-1,0)),this.add(a);const l=new or(Yf,Kf,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new K(0,0,1)),this.add(l);const u=new or(Yf,Kf,e,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new K(0,0,-1)),this.add(u)}update(e,t){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[r,o,s,a,l,u]=this.children,c=e.getRenderTarget(),h=e.toneMapping,p=e.xr.enabled;e.toneMapping=Cl,e.xr.enabled=!1;const m=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,o),e.setRenderTarget(i,2),e.render(t,s),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=m,e.setRenderTarget(i,5),e.render(t,u),e.setRenderTarget(c),e.toneMapping=h,e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class WO extends so{constructor(e,t,i,r,o,s,a,l,u,c){e=e!==void 0?e:[],t=t!==void 0?t:Ov,super(e,t,i,r,o,s,a,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class lH extends Qn{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new WO(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Hi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Wp(5,5,5),o=new Mn({name:"CubemapFromEquirect",uniforms:zv(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Zo,blending:ji});o.uniforms.tEquirect.value=t;const s=new Fr(r,o),a=t.minFilter;return t.minFilter===rx&&(t.minFilter=Hi),new aH(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,i,r){const o=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,i,r);e.setRenderTarget(o)}}const eA=new K,dre=new K,pre=new Vr;class Ou{constructor(e=new K(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=eA.subVectors(i,t).cross(dre.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(eA),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:t.copy(i).multiplyScalar(o).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||pre.getNormalMatrix(e),r=this.coplanarPoint(eA).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Zf=new Hp,pw=new K;class DC{constructor(e=new Ou,t=new Ou,i=new Ou,r=new Ou,o=new Ou,s=new Ou){this.planes=[e,t,i,r,o,s]}set(e,t,i,r,o,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(o),a[5].copy(s),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],o=i[1],s=i[2],a=i[3],l=i[4],u=i[5],c=i[6],h=i[7],p=i[8],m=i[9],y=i[10],_=i[11],g=i[12],b=i[13],w=i[14],M=i[15];return t[0].setComponents(a-r,h-l,_-p,M-g).normalize(),t[1].setComponents(a+r,h+l,_+p,M+g).normalize(),t[2].setComponents(a+o,h+u,_+m,M+b).normalize(),t[3].setComponents(a-o,h-u,_-m,M-b).normalize(),t[4].setComponents(a-s,h-c,_-y,M-w).normalize(),t[5].setComponents(a+s,h+c,_+y,M+w).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Zf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Zf)}intersectsSprite(e){return Zf.center.set(0,0,0),Zf.radius=.7071067811865476,Zf.applyMatrix4(e.matrixWorld),this.intersectsSphere(Zf)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(pw.x=r.normal.x>0?e.max.x:e.min.x,pw.y=r.normal.y>0?e.max.y:e.min.y,pw.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(pw)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function uH(){let n=null,e=!1,t=null,i=null;function r(o,s){t(o,s),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function fre(n,e){const t=e.isWebGL2,i=new WeakMap;function r(u,c){const h=u.array,p=u.usage,m=n.createBuffer();n.bindBuffer(c,m),n.bufferData(c,h,p),u.onUploadCallback();let y;if(h instanceof Float32Array)y=5126;else if(h instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)y=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else y=5123;else if(h instanceof Int16Array)y=5122;else if(h instanceof Uint32Array)y=5125;else if(h instanceof Int32Array)y=5124;else if(h instanceof Int8Array)y=5120;else if(h instanceof Uint8Array)y=5121;else if(h instanceof Uint8ClampedArray)y=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:m,type:y,bytesPerElement:h.BYTES_PER_ELEMENT,version:u.version}}function o(u,c,h){const p=c.array,m=c.updateRange;n.bindBuffer(h,u),m.count===-1?n.bufferSubData(h,0,p):(t?n.bufferSubData(h,m.offset*p.BYTES_PER_ELEMENT,p,m.offset,m.count):n.bufferSubData(h,m.offset*p.BYTES_PER_ELEMENT,p.subarray(m.offset,m.offset+m.count)),m.count=-1)}function s(u){return u.isInterleavedBufferAttribute&&(u=u.data),i.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const c=i.get(u);c&&(n.deleteBuffer(c.buffer),i.delete(u))}function l(u,c){if(u.isGLBufferAttribute){const p=i.get(u);(!p||p.version<u.version)&&i.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const h=i.get(u);h===void 0?i.set(u,r(u,c)):h.version<u.version&&(o(h.buffer,u,c),h.version=u.version)}return{get:s,remove:a,update:l}}class sx extends ei{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const o=e/2,s=t/2,a=Math.floor(i),l=Math.floor(r),u=a+1,c=l+1,h=e/a,p=t/l,m=[],y=[],_=[],g=[];for(let b=0;b<c;b++){const w=b*p-s;for(let M=0;M<u;M++){const C=M*h-o;y.push(C,-w,0),_.push(0,0,1),g.push(M/a),g.push(1-b/l)}}for(let b=0;b<l;b++)for(let w=0;w<a;w++){const M=w+u*b,C=w+u*(b+1),P=w+1+u*(b+1),L=w+1+u*b;m.push(M,C,L),m.push(C,P,L)}this.setIndex(m),this.setAttribute("position",new Zt(y,3)),this.setAttribute("normal",new Zt(_,3)),this.setAttribute("uv",new Zt(g,2))}static fromJSON(e){return new sx(e.width,e.height,e.widthSegments,e.heightSegments)}}var mre=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,vre=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,gre=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,_re=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,yre=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,xre=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,bre="vec3 transformed = vec3( position );",wre=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Sre=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,Mre=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Cre=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Ere=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Tre=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Pre=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Are=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Lre=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Dre=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Rre=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Ore=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,kre=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Ire=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Nre=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,zre=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Vre=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Fre=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Bre=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Ure="gl_FragColor = linearToOutputTexel( gl_FragColor );",jre=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Hre=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Wre=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Gre=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Xre=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,qre=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Yre=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Kre=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Zre=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Jre=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Qre=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,$re=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,eoe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,toe=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,noe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,ioe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,roe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,ooe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,soe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,aoe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,loe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,uoe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,coe=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,hoe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,doe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,poe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,foe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,moe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,voe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,goe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,_oe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,yoe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,xoe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,boe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,woe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Soe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Moe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Coe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Eoe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Toe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Poe=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Aoe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Loe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Doe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Roe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Ooe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,koe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Ioe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Noe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,zoe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Voe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Foe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Boe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Uoe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,joe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Hoe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Woe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Goe=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Xoe=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,qoe=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Yoe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Koe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Zoe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,Joe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Qoe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,$oe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,ese=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tse=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,nse=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,ise=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,rse=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,ose=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,sse=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,ase=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,lse=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,use=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,cse=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,hse=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const dse=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,pse=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,fse=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,mse=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vse=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,gse=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,_se=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,yse=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,xse=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,bse=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,wse=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Sse=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Mse=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Cse=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ese=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Tse=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Pse=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Ase=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Lse=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Dse=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Rse=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ose=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kse=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Ise=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Nse=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zse=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vse=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Fse=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Bse=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Use=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,jse=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Hse=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,tn={alphamap_fragment:mre,alphamap_pars_fragment:vre,alphatest_fragment:gre,alphatest_pars_fragment:_re,aomap_fragment:yre,aomap_pars_fragment:xre,begin_vertex:bre,beginnormal_vertex:wre,bsdfs:Sre,iridescence_fragment:Mre,bumpmap_pars_fragment:Cre,clipping_planes_fragment:Ere,clipping_planes_pars_fragment:Tre,clipping_planes_pars_vertex:Pre,clipping_planes_vertex:Are,color_fragment:Lre,color_pars_fragment:Dre,color_pars_vertex:Rre,color_vertex:Ore,common:kre,cube_uv_reflection_fragment:Ire,defaultnormal_vertex:Nre,displacementmap_pars_vertex:zre,displacementmap_vertex:Vre,emissivemap_fragment:Fre,emissivemap_pars_fragment:Bre,encodings_fragment:Ure,encodings_pars_fragment:jre,envmap_fragment:Hre,envmap_common_pars_fragment:Wre,envmap_pars_fragment:Gre,envmap_pars_vertex:Xre,envmap_physical_pars_fragment:ioe,envmap_vertex:qre,fog_vertex:Yre,fog_pars_vertex:Kre,fog_fragment:Zre,fog_pars_fragment:Jre,gradientmap_pars_fragment:Qre,lightmap_fragment:$re,lightmap_pars_fragment:eoe,lights_lambert_vertex:toe,lights_pars_begin:noe,lights_toon_fragment:roe,lights_toon_pars_fragment:ooe,lights_phong_fragment:soe,lights_phong_pars_fragment:aoe,lights_physical_fragment:loe,lights_physical_pars_fragment:uoe,lights_fragment_begin:coe,lights_fragment_maps:hoe,lights_fragment_end:doe,logdepthbuf_fragment:poe,logdepthbuf_pars_fragment:foe,logdepthbuf_pars_vertex:moe,logdepthbuf_vertex:voe,map_fragment:goe,map_pars_fragment:_oe,map_particle_fragment:yoe,map_particle_pars_fragment:xoe,metalnessmap_fragment:boe,metalnessmap_pars_fragment:woe,morphcolor_vertex:Soe,morphnormal_vertex:Moe,morphtarget_pars_vertex:Coe,morphtarget_vertex:Eoe,normal_fragment_begin:Toe,normal_fragment_maps:Poe,normal_pars_fragment:Aoe,normal_pars_vertex:Loe,normal_vertex:Doe,normalmap_pars_fragment:Roe,clearcoat_normal_fragment_begin:Ooe,clearcoat_normal_fragment_maps:koe,clearcoat_pars_fragment:Ioe,iridescence_pars_fragment:Noe,output_fragment:zoe,packing:Voe,premultiplied_alpha_fragment:Foe,project_vertex:Boe,dithering_fragment:Uoe,dithering_pars_fragment:joe,roughnessmap_fragment:Hoe,roughnessmap_pars_fragment:Woe,shadowmap_pars_fragment:Goe,shadowmap_pars_vertex:Xoe,shadowmap_vertex:qoe,shadowmask_pars_fragment:Yoe,skinbase_vertex:Koe,skinning_pars_vertex:Zoe,skinning_vertex:Joe,skinnormal_vertex:Qoe,specularmap_fragment:$oe,specularmap_pars_fragment:ese,tonemapping_fragment:tse,tonemapping_pars_fragment:nse,transmission_fragment:ise,transmission_pars_fragment:rse,uv_pars_fragment:ose,uv_pars_vertex:sse,uv_vertex:ase,uv2_pars_fragment:lse,uv2_pars_vertex:use,uv2_vertex:cse,worldpos_vertex:hse,background_vert:dse,background_frag:pse,cube_vert:fse,cube_frag:mse,depth_vert:vse,depth_frag:gse,distanceRGBA_vert:_se,distanceRGBA_frag:yse,equirect_vert:xse,equirect_frag:bse,linedashed_vert:wse,linedashed_frag:Sse,meshbasic_vert:Mse,meshbasic_frag:Cse,meshlambert_vert:Ese,meshlambert_frag:Tse,meshmatcap_vert:Pse,meshmatcap_frag:Ase,meshnormal_vert:Lse,meshnormal_frag:Dse,meshphong_vert:Rse,meshphong_frag:Ose,meshphysical_vert:kse,meshphysical_frag:Ise,meshtoon_vert:Nse,meshtoon_frag:zse,points_vert:Vse,points_frag:Fse,shadow_vert:Bse,shadow_frag:Use,sprite_vert:jse,sprite_frag:Hse},at={common:{diffuse:{value:new vt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Vr},uv2Transform:{value:new Vr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ze(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new vt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new vt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Vr}},sprite:{diffuse:{value:new vt(16777215)},opacity:{value:1},center:{value:new ze(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Vr}}},Oa={basic:{uniforms:$r([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.fog]),vertexShader:tn.meshbasic_vert,fragmentShader:tn.meshbasic_frag},lambert:{uniforms:$r([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.fog,at.lights,{emissive:{value:new vt(0)}}]),vertexShader:tn.meshlambert_vert,fragmentShader:tn.meshlambert_frag},phong:{uniforms:$r([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.fog,at.lights,{emissive:{value:new vt(0)},specular:{value:new vt(1118481)},shininess:{value:30}}]),vertexShader:tn.meshphong_vert,fragmentShader:tn.meshphong_frag},standard:{uniforms:$r([at.common,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.roughnessmap,at.metalnessmap,at.fog,at.lights,{emissive:{value:new vt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:tn.meshphysical_vert,fragmentShader:tn.meshphysical_frag},toon:{uniforms:$r([at.common,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.gradientmap,at.fog,at.lights,{emissive:{value:new vt(0)}}]),vertexShader:tn.meshtoon_vert,fragmentShader:tn.meshtoon_frag},matcap:{uniforms:$r([at.common,at.bumpmap,at.normalmap,at.displacementmap,at.fog,{matcap:{value:null}}]),vertexShader:tn.meshmatcap_vert,fragmentShader:tn.meshmatcap_frag},points:{uniforms:$r([at.points,at.fog]),vertexShader:tn.points_vert,fragmentShader:tn.points_frag},dashed:{uniforms:$r([at.common,at.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:tn.linedashed_vert,fragmentShader:tn.linedashed_frag},depth:{uniforms:$r([at.common,at.displacementmap]),vertexShader:tn.depth_vert,fragmentShader:tn.depth_frag},normal:{uniforms:$r([at.common,at.bumpmap,at.normalmap,at.displacementmap,{opacity:{value:1}}]),vertexShader:tn.meshnormal_vert,fragmentShader:tn.meshnormal_frag},sprite:{uniforms:$r([at.sprite,at.fog]),vertexShader:tn.sprite_vert,fragmentShader:tn.sprite_frag},background:{uniforms:{uvTransform:{value:new Vr},t2D:{value:null}},vertexShader:tn.background_vert,fragmentShader:tn.background_frag},cube:{uniforms:$r([at.envmap,{opacity:{value:1}}]),vertexShader:tn.cube_vert,fragmentShader:tn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:tn.equirect_vert,fragmentShader:tn.equirect_frag},distanceRGBA:{uniforms:$r([at.common,at.displacementmap,{referencePosition:{value:new K},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:tn.distanceRGBA_vert,fragmentShader:tn.distanceRGBA_frag},shadow:{uniforms:$r([at.lights,at.fog,{color:{value:new vt(0)},opacity:{value:1}}]),vertexShader:tn.shadow_vert,fragmentShader:tn.shadow_frag}};Oa.physical={uniforms:$r([Oa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ze(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new vt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ze},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new vt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new vt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:tn.meshphysical_vert,fragmentShader:tn.meshphysical_frag};function Wse(n,e,t,i,r,o){const s=new vt(0);let a=r===!0?0:1,l,u,c=null,h=0,p=null;function m(_,g){let b=!1,w=g.isScene===!0?g.background:null;w&&w.isTexture&&(w=e.get(w));const M=n.xr,C=M.getSession&&M.getSession();C&&C.environmentBlendMode==="additive"&&(w=null),w===null?y(s,a):w&&w.isColor&&(y(w,1),b=!0),(n.autoClear||b)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),w&&(w.isCubeTexture||w.mapping===AC)?(u===void 0&&(u=new Fr(new Wp(1,1,1),new Mn({name:"BackgroundCubeMaterial",uniforms:zv(Oa.cube.uniforms),vertexShader:Oa.cube.vertexShader,fragmentShader:Oa.cube.fragmentShader,side:Zo,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(P,L,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),u.material.uniforms.envMap.value=w,u.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,(c!==w||h!==w.version||p!==n.toneMapping)&&(u.material.needsUpdate=!0,c=w,h=w.version,p=n.toneMapping),u.layers.enableAll(),_.unshift(u,u.geometry,u.material,0,0,null)):w&&w.isTexture&&(l===void 0&&(l=new Fr(new sx(2,2),new Mn({name:"BackgroundMaterial",uniforms:zv(Oa.background.uniforms),vertexShader:Oa.background.vertexShader,fragmentShader:Oa.background.fragmentShader,side:Ep,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=w,w.matrixAutoUpdate===!0&&w.updateMatrix(),l.material.uniforms.uvTransform.value.copy(w.matrix),(c!==w||h!==w.version||p!==n.toneMapping)&&(l.material.needsUpdate=!0,c=w,h=w.version,p=n.toneMapping),l.layers.enableAll(),_.unshift(l,l.geometry,l.material,0,0,null))}function y(_,g){t.buffers.color.setClear(_.r,_.g,_.b,g,o)}return{getClearColor:function(){return s},setClearColor:function(_,g=1){s.set(_),a=g,y(s,a)},getClearAlpha:function(){return a},setClearAlpha:function(_){a=_,y(s,a)},render:m}}function Gse(n,e,t,i){const r=n.getParameter(34921),o=i.isWebGL2?null:e.get("OES_vertex_array_object"),s=i.isWebGL2||o!==null,a={},l=g(null);let u=l,c=!1;function h(H,Q,Z,de,X){let B=!1;if(s){const U=_(de,Z,Q);u!==U&&(u=U,m(u.object)),B=b(H,de,Z,X),B&&w(H,de,Z,X)}else{const U=Q.wireframe===!0;(u.geometry!==de.id||u.program!==Z.id||u.wireframe!==U)&&(u.geometry=de.id,u.program=Z.id,u.wireframe=U,B=!0)}X!==null&&t.update(X,34963),(B||c)&&(c=!1,E(H,Q,Z,de),X!==null&&n.bindBuffer(34963,t.get(X).buffer))}function p(){return i.isWebGL2?n.createVertexArray():o.createVertexArrayOES()}function m(H){return i.isWebGL2?n.bindVertexArray(H):o.bindVertexArrayOES(H)}function y(H){return i.isWebGL2?n.deleteVertexArray(H):o.deleteVertexArrayOES(H)}function _(H,Q,Z){const de=Z.wireframe===!0;let X=a[H.id];X===void 0&&(X={},a[H.id]=X);let B=X[Q.id];B===void 0&&(B={},X[Q.id]=B);let U=B[de];return U===void 0&&(U=g(p()),B[de]=U),U}function g(H){const Q=[],Z=[],de=[];for(let X=0;X<r;X++)Q[X]=0,Z[X]=0,de[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Q,enabledAttributes:Z,attributeDivisors:de,object:H,attributes:{},index:null}}function b(H,Q,Z,de){const X=u.attributes,B=Q.attributes;let U=0;const le=Z.getAttributes();for(const ne in le)if(le[ne].location>=0){const fe=X[ne];let we=B[ne];if(we===void 0&&(ne==="instanceMatrix"&&H.instanceMatrix&&(we=H.instanceMatrix),ne==="instanceColor"&&H.instanceColor&&(we=H.instanceColor)),fe===void 0||fe.attribute!==we||we&&fe.data!==we.data)return!0;U++}return u.attributesNum!==U||u.index!==de}function w(H,Q,Z,de){const X={},B=Q.attributes;let U=0;const le=Z.getAttributes();for(const ne in le)if(le[ne].location>=0){let fe=B[ne];fe===void 0&&(ne==="instanceMatrix"&&H.instanceMatrix&&(fe=H.instanceMatrix),ne==="instanceColor"&&H.instanceColor&&(fe=H.instanceColor));const we={};we.attribute=fe,fe&&fe.data&&(we.data=fe.data),X[ne]=we,U++}u.attributes=X,u.attributesNum=U,u.index=de}function M(){const H=u.newAttributes;for(let Q=0,Z=H.length;Q<Z;Q++)H[Q]=0}function C(H){P(H,0)}function P(H,Q){const Z=u.newAttributes,de=u.enabledAttributes,X=u.attributeDivisors;Z[H]=1,de[H]===0&&(n.enableVertexAttribArray(H),de[H]=1),X[H]!==Q&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](H,Q),X[H]=Q)}function L(){const H=u.newAttributes,Q=u.enabledAttributes;for(let Z=0,de=Q.length;Z<de;Z++)Q[Z]!==H[Z]&&(n.disableVertexAttribArray(Z),Q[Z]=0)}function R(H,Q,Z,de,X,B){i.isWebGL2===!0&&(Z===5124||Z===5125)?n.vertexAttribIPointer(H,Q,Z,X,B):n.vertexAttribPointer(H,Q,Z,de,X,B)}function E(H,Q,Z,de){if(i.isWebGL2===!1&&(H.isInstancedMesh||de.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;M();const X=de.attributes,B=Z.getAttributes(),U=Q.defaultAttributeValues;for(const le in B){const ne=B[le];if(ne.location>=0){let fe=X[le];if(fe===void 0&&(le==="instanceMatrix"&&H.instanceMatrix&&(fe=H.instanceMatrix),le==="instanceColor"&&H.instanceColor&&(fe=H.instanceColor)),fe!==void 0){const we=fe.normalized,Be=fe.itemSize,oe=t.get(fe);if(oe===void 0)continue;const tt=oe.buffer,Ue=oe.type,Ve=oe.bytesPerElement;if(fe.isInterleavedBufferAttribute){const Ae=fe.data,Oe=Ae.stride,Te=fe.offset;if(Ae.isInstancedInterleavedBuffer){for(let be=0;be<ne.locationSize;be++)P(ne.location+be,Ae.meshPerAttribute);H.isInstancedMesh!==!0&&de._maxInstanceCount===void 0&&(de._maxInstanceCount=Ae.meshPerAttribute*Ae.count)}else for(let be=0;be<ne.locationSize;be++)C(ne.location+be);n.bindBuffer(34962,tt);for(let be=0;be<ne.locationSize;be++)R(ne.location+be,Be/ne.locationSize,Ue,we,Oe*Ve,(Te+Be/ne.locationSize*be)*Ve)}else{if(fe.isInstancedBufferAttribute){for(let Ae=0;Ae<ne.locationSize;Ae++)P(ne.location+Ae,fe.meshPerAttribute);H.isInstancedMesh!==!0&&de._maxInstanceCount===void 0&&(de._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let Ae=0;Ae<ne.locationSize;Ae++)C(ne.location+Ae);n.bindBuffer(34962,tt);for(let Ae=0;Ae<ne.locationSize;Ae++)R(ne.location+Ae,Be/ne.locationSize,Ue,we,Be*Ve,Be/ne.locationSize*Ae*Ve)}}else if(U!==void 0){const we=U[le];if(we!==void 0)switch(we.length){case 2:n.vertexAttrib2fv(ne.location,we);break;case 3:n.vertexAttrib3fv(ne.location,we);break;case 4:n.vertexAttrib4fv(ne.location,we);break;default:n.vertexAttrib1fv(ne.location,we)}}}}L()}function D(){te();for(const H in a){const Q=a[H];for(const Z in Q){const de=Q[Z];for(const X in de)y(de[X].object),delete de[X];delete Q[Z]}delete a[H]}}function N(H){if(a[H.id]===void 0)return;const Q=a[H.id];for(const Z in Q){const de=Q[Z];for(const X in de)y(de[X].object),delete de[X];delete Q[Z]}delete a[H.id]}function j(H){for(const Q in a){const Z=a[Q];if(Z[H.id]===void 0)continue;const de=Z[H.id];for(const X in de)y(de[X].object),delete de[X];delete Z[H.id]}}function te(){ee(),c=!0,u!==l&&(u=l,m(u.object))}function ee(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:te,resetDefaultState:ee,dispose:D,releaseStatesOfGeometry:N,releaseStatesOfProgram:j,initAttributes:M,enableAttribute:C,disableUnusedAttributes:L}}function Xse(n,e,t,i){const r=i.isWebGL2;let o;function s(u){o=u}function a(u,c){n.drawArrays(o,u,c),t.update(c,o,1)}function l(u,c,h){if(h===0)return;let p,m;if(r)p=n,m="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[m](o,u,c,h),t.update(c,o,h)}this.setMode=s,this.render=a,this.renderInstances=l}function qse(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const R=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(R.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(R){if(R==="highp"){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";R="mediump"}return R==="mediump"&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&n instanceof WebGL2ComputeRenderingContext;let a=t.precision!==void 0?t.precision:"highp";const l=o(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=s||e.has("WEBGL_draw_buffers"),c=t.logarithmicDepthBuffer===!0,h=n.getParameter(34930),p=n.getParameter(35660),m=n.getParameter(3379),y=n.getParameter(34076),_=n.getParameter(34921),g=n.getParameter(36347),b=n.getParameter(36348),w=n.getParameter(36349),M=p>0,C=s||e.has("OES_texture_float"),P=M&&C,L=s?n.getParameter(36183):0;return{isWebGL2:s,drawBuffers:u,getMaxAnisotropy:r,getMaxPrecision:o,precision:a,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:y,maxAttributes:_,maxVertexUniforms:g,maxVaryings:b,maxFragmentUniforms:w,vertexTextures:M,floatFragmentTextures:C,floatVertexTextures:P,maxSamples:L}}function Yse(n){const e=this;let t=null,i=0,r=!1,o=!1;const s=new Ou,a=new Vr,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,p,m){const y=h.length!==0||p||i!==0||r;return r=p,t=c(h,m,0),i=h.length,y},this.beginShadows=function(){o=!0,c(null)},this.endShadows=function(){o=!1,u()},this.setState=function(h,p,m){const y=h.clippingPlanes,_=h.clipIntersection,g=h.clipShadows,b=n.get(h);if(!r||y===null||y.length===0||o&&!g)o?c(null):u();else{const w=o?0:i,M=w*4;let C=b.clippingState||null;l.value=C,C=c(y,p,M,m);for(let P=0;P!==M;++P)C[P]=t[P];b.clippingState=C,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=w}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function c(h,p,m,y){const _=h!==null?h.length:0;let g=null;if(_!==0){if(g=l.value,y!==!0||g===null){const b=m+_*4,w=p.matrixWorldInverse;a.getNormalMatrix(w),(g===null||g.length<b)&&(g=new Float32Array(b));for(let M=0,C=m;M!==_;++M,C+=4)s.copy(h[M]).applyMatrix4(w,a),s.normal.toArray(g,C),g[C+3]=s.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,g}}function Kse(n){let e=new WeakMap;function t(s,a){return a===Ty?s.mapping=Ov:a===XD&&(s.mapping=kv),s}function i(s){if(s&&s.isTexture&&s.isRenderTargetTexture===!1){const a=s.mapping;if(a===Ty||a===XD)if(e.has(s)){const l=e.get(s).texture;return t(l,s.mapping)}else{const l=s.image;if(l&&l.height>0){const u=new lH(l.height/2);return u.fromEquirectangularTexture(n,s),e.set(s,u),s.addEventListener("dispose",r),t(u.texture,s.mapping)}else return null}}return s}function r(s){const a=s.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}class ax extends HO{constructor(e=-1,t=1,i=1,r=-1,o=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,o,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=i-e,s=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=u*this.view.offsetX,s=o+u*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Hm=4,iz=[.125,.215,.35,.446,.526,.582],ep=20,tA=new ax,rz=new vt;let nA=null;const Zd=(1+Math.sqrt(5))/2,Jf=1/Zd,oz=[new K(1,1,1),new K(-1,1,1),new K(1,1,-1),new K(-1,1,-1),new K(0,Zd,Jf),new K(0,Zd,-Jf),new K(Jf,0,Zd),new K(-Jf,0,Zd),new K(Zd,Jf,0),new K(-Zd,Jf,0)];class sz{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){nA=this._renderer.getRenderTarget(),this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,i,r,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=uz(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=lz(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(nA),e.scissorTest=!1,fw(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ov||e.mapping===kv?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),nA=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Hi,minFilter:Hi,generateMipmaps:!1,type:Bu,format:Na,encoding:Ah,depthBuffer:!1},r=az(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=az(e,t,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Zse(o)),this._blurMaterial=Jse(o,e,t)}return r}_compileMaterial(e){const t=new Fr(this._lodPlanes[0],e);this._renderer.compile(t,tA)}_sceneToCubeUV(e,t,i,r){const o=new or(90,1,t,i),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],l=this._renderer,u=l.autoClear,c=l.toneMapping;l.getClearColor(rz),l.toneMapping=Cl,l.autoClear=!1;const h=new yg({name:"PMREM.Background",side:Zo,depthWrite:!1,depthTest:!1}),p=new Fr(new Wp,h);let m=!1;const y=e.background;y?y.isColor&&(h.color.copy(y),e.background=null,m=!0):(h.color.copy(rz),m=!0);for(let _=0;_<6;_++){const g=_%3;g===0?(o.up.set(0,s[_],0),o.lookAt(a[_],0,0)):g===1?(o.up.set(0,0,s[_]),o.lookAt(0,a[_],0)):(o.up.set(0,s[_],0),o.lookAt(0,0,a[_]));const b=this._cubeSize;fw(r,g*b,_>2?b:0,b,b),l.setRenderTarget(r),m&&l.render(p,o),l.render(e,o)}p.geometry.dispose(),p.material.dispose(),l.toneMapping=c,l.autoClear=u,e.background=y}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Ov||e.mapping===kv;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=uz()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=lz());const o=r?this._cubemapMaterial:this._equirectMaterial,s=new Fr(this._lodPlanes[0],o),a=o.uniforms;a.envMap.value=e;const l=this._cubeSize;fw(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(s,tA)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),s=oz[(r-1)%oz.length];this._blur(e,r-1,r,o,s)}t.autoClear=i}_blur(e,t,i,r,o){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,r,"latitudinal",o),this._halfBlur(s,e,i,i,r,"longitudinal",o)}_halfBlur(e,t,i,r,o,s,a){const l=this._renderer,u=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,h=new Fr(this._lodPlanes[r],u),p=u.uniforms,m=this._sizeLods[i]-1,y=isFinite(o)?Math.PI/(2*m):2*Math.PI/(2*ep-1),_=o/y,g=isFinite(o)?1+Math.floor(c*_):ep;g>ep&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${ep}`);const b=[];let w=0;for(let R=0;R<ep;++R){const E=R/_,D=Math.exp(-E*E/2);b.push(D),R===0?w+=D:R<g&&(w+=2*D)}for(let R=0;R<b.length;R++)b[R]=b[R]/w;p.envMap.value=e.texture,p.samples.value=g,p.weights.value=b,p.latitudinal.value=s==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:M}=this;p.dTheta.value=y,p.mipInt.value=M-i;const C=this._sizeLods[r],P=3*C*(r>M-Hm?r-M+Hm:0),L=4*(this._cubeSize-C);fw(t,P,L,3*C,2*C),l.setRenderTarget(t),l.render(h,tA)}}function Zse(n){const e=[],t=[],i=[];let r=n;const o=n-Hm+1+iz.length;for(let s=0;s<o;s++){const a=Math.pow(2,r);t.push(a);let l=1/a;s>n-Hm?l=iz[s-n+Hm-1]:s===0&&(l=0),i.push(l);const u=1/(a-2),c=-u,h=1+u,p=[c,c,h,c,h,h,c,c,h,h,c,h],m=6,y=6,_=3,g=2,b=1,w=new Float32Array(_*y*m),M=new Float32Array(g*y*m),C=new Float32Array(b*y*m);for(let L=0;L<m;L++){const R=L%3*2/3-1,E=L>2?0:-1,D=[R,E,0,R+2/3,E,0,R+2/3,E+1,0,R,E,0,R+2/3,E+1,0,R,E+1,0];w.set(D,_*y*L),M.set(p,g*y*L);const N=[L,L,L,L,L,L];C.set(N,b*y*L)}const P=new ei;P.setAttribute("position",new Co(w,_)),P.setAttribute("uv",new Co(M,g)),P.setAttribute("faceIndex",new Co(C,b)),e.push(P),r>Hm&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function az(n,e,t){const i=new Qn(n,e,t);return i.texture.mapping=AC,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function fw(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function Jse(n,e,t){const i=new Float32Array(ep),r=new K(0,1,0);return new Mn({name:"SphericalGaussianBlur",defines:{n:ep,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:GO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ji,depthTest:!1,depthWrite:!1})}function lz(){return new Mn({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:GO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ji,depthTest:!1,depthWrite:!1})}function uz(){return new Mn({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:GO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ji,depthTest:!1,depthWrite:!1})}function GO(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Qse(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,u=l===Ty||l===XD,c=l===Ov||l===kv;if(u||c)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=e.get(a);return t===null&&(t=new sz(n)),h=u?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}else{if(e.has(a))return e.get(a).texture;{const h=a.image;if(u&&h&&h.height>0||c&&h&&r(h)){t===null&&(t=new sz(n));const p=u?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",o),p.texture}else return null}}}return a}function r(a){let l=0;const u=6;for(let c=0;c<u;c++)a[c]!==void 0&&l++;return l===u}function o(a){const l=a.target;l.removeEventListener("dispose",o);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function s(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:s}}function $se(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function eae(n,e,t,i){const r={},o=new WeakMap;function s(h){const p=h.target;p.index!==null&&e.remove(p.index);for(const y in p.attributes)e.remove(p.attributes[y]);p.removeEventListener("dispose",s),delete r[p.id];const m=o.get(p);m&&(e.remove(m),o.delete(p)),i.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function a(h,p){return r[p.id]===!0||(p.addEventListener("dispose",s),r[p.id]=!0,t.memory.geometries++),p}function l(h){const p=h.attributes;for(const y in p)e.update(p[y],34962);const m=h.morphAttributes;for(const y in m){const _=m[y];for(let g=0,b=_.length;g<b;g++)e.update(_[g],34962)}}function u(h){const p=[],m=h.index,y=h.attributes.position;let _=0;if(m!==null){const w=m.array;_=m.version;for(let M=0,C=w.length;M<C;M+=3){const P=w[M+0],L=w[M+1],R=w[M+2];p.push(P,L,L,R,R,P)}}else{const w=y.array;_=y.version;for(let M=0,C=w.length/3-1;M<C;M+=3){const P=M+0,L=M+1,R=M+2;p.push(P,L,L,R,R,P)}}const g=new(eH(p)?sH:oH)(p,1);g.version=_;const b=o.get(h);b&&e.remove(b),o.set(h,g)}function c(h){const p=o.get(h);if(p){const m=h.index;m!==null&&p.version<m.version&&u(h)}else u(h);return o.get(h)}return{get:a,update:l,getWireframeAttribute:c}}function tae(n,e,t,i){const r=i.isWebGL2;let o;function s(p){o=p}let a,l;function u(p){a=p.type,l=p.bytesPerElement}function c(p,m){n.drawElements(o,m,a,p*l),t.update(m,o,1)}function h(p,m,y){if(y===0)return;let _,g;if(r)_=n,g="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",_===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}_[g](o,m,a,p*l,y),t.update(m,o,y)}this.setMode=s,this.setIndex=u,this.render=c,this.renderInstances=h}function nae(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,s,a){switch(t.calls++,s){case 4:t.triangles+=a*(o/3);break;case 1:t.lines+=a*(o/2);break;case 3:t.lines+=a*(o-1);break;case 2:t.lines+=a*o;break;case 0:t.points+=a*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s);break}}function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function iae(n,e){return n[0]-e[0]}function rae(n,e){return Math.abs(e[1])-Math.abs(n[1])}function iA(n,e){let t=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?t=127:i instanceof Uint8Array?t=255:i instanceof Uint16Array?t=65535:i instanceof Int16Array?t=32767:i instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),n.divideScalar(t)}function oae(n,e,t){const i={},r=new Float32Array(8),o=new WeakMap,s=new _n,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,c,h,p){const m=u.morphTargetInfluences;if(e.isWebGL2===!0){const y=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,_=y!==void 0?y.length:0;let g=o.get(c);if(g===void 0||g.count!==_){let M=function(){H.dispose(),o.delete(c),c.removeEventListener("dispose",M)};g!==void 0&&g.texture.dispose();const C=c.morphAttributes.position!==void 0,P=c.morphAttributes.normal!==void 0,L=c.morphAttributes.color!==void 0,R=c.morphAttributes.position||[],E=c.morphAttributes.normal||[],D=c.morphAttributes.color||[];let N=0;C===!0&&(N=1),P===!0&&(N=2),L===!0&&(N=3);let j=c.attributes.position.count*N,te=1;j>e.maxTextureSize&&(te=Math.ceil(j/e.maxTextureSize),j=e.maxTextureSize);const ee=new Float32Array(j*te*4*_),H=new rH(ee,j,te,_);H.type=Ia,H.needsUpdate=!0;const Q=N*4;for(let Z=0;Z<_;Z++){const de=R[Z],X=E[Z],B=D[Z],U=j*te*4*Z;for(let le=0;le<de.count;le++){const ne=le*Q;C===!0&&(s.fromBufferAttribute(de,le),de.normalized===!0&&iA(s,de),ee[U+ne+0]=s.x,ee[U+ne+1]=s.y,ee[U+ne+2]=s.z,ee[U+ne+3]=0),P===!0&&(s.fromBufferAttribute(X,le),X.normalized===!0&&iA(s,X),ee[U+ne+4]=s.x,ee[U+ne+5]=s.y,ee[U+ne+6]=s.z,ee[U+ne+7]=0),L===!0&&(s.fromBufferAttribute(B,le),B.normalized===!0&&iA(s,B),ee[U+ne+8]=s.x,ee[U+ne+9]=s.y,ee[U+ne+10]=s.z,ee[U+ne+11]=B.itemSize===4?s.w:1)}}g={count:_,texture:H,size:new ze(j,te)},o.set(c,g),c.addEventListener("dispose",M)}let b=0;for(let M=0;M<m.length;M++)b+=m[M];const w=c.morphTargetsRelative?1:1-b;p.getUniforms().setValue(n,"morphTargetBaseInfluence",w),p.getUniforms().setValue(n,"morphTargetInfluences",m),p.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),p.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}else{const y=m===void 0?0:m.length;let _=i[c.id];if(_===void 0||_.length!==y){_=[];for(let C=0;C<y;C++)_[C]=[C,0];i[c.id]=_}for(let C=0;C<y;C++){const P=_[C];P[0]=C,P[1]=m[C]}_.sort(rae);for(let C=0;C<8;C++)C<y&&_[C][1]?(a[C][0]=_[C][0],a[C][1]=_[C][1]):(a[C][0]=Number.MAX_SAFE_INTEGER,a[C][1]=0);a.sort(iae);const g=c.morphAttributes.position,b=c.morphAttributes.normal;let w=0;for(let C=0;C<8;C++){const P=a[C],L=P[0],R=P[1];L!==Number.MAX_SAFE_INTEGER&&R?(g&&c.getAttribute("morphTarget"+C)!==g[L]&&c.setAttribute("morphTarget"+C,g[L]),b&&c.getAttribute("morphNormal"+C)!==b[L]&&c.setAttribute("morphNormal"+C,b[L]),r[C]=R,w+=R):(g&&c.hasAttribute("morphTarget"+C)===!0&&c.deleteAttribute("morphTarget"+C),b&&c.hasAttribute("morphNormal"+C)===!0&&c.deleteAttribute("morphNormal"+C),r[C]=0)}const M=c.morphTargetsRelative?1:1-w;p.getUniforms().setValue(n,"morphTargetBaseInfluence",M),p.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:l}}function sae(n,e,t,i){let r=new WeakMap;function o(l){const u=i.render.frame,c=l.geometry,h=e.get(l,c);return r.get(h)!==u&&(e.update(h),r.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),l.instanceColor!==null&&t.update(l.instanceColor,34962)),h}function s(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:o,dispose:s}}const cH=new so,hH=new rH,dH=new Qie,pH=new WO,cz=[],hz=[],dz=new Float32Array(16),pz=new Float32Array(9),fz=new Float32Array(4);function xg(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let o=cz[r];if(o===void 0&&(o=new Float32Array(r),cz[r]=o),e!==0){i.toArray(o,0);for(let s=1,a=0;s!==e;++s)a+=t,n[s].toArray(o,a)}return o}function To(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Po(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function RC(n,e){let t=hz[e];t===void 0&&(t=new Int32Array(e),hz[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function aae(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function lae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(To(t,e))return;n.uniform2fv(this.addr,e),Po(t,e)}}function uae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(To(t,e))return;n.uniform3fv(this.addr,e),Po(t,e)}}function cae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(To(t,e))return;n.uniform4fv(this.addr,e),Po(t,e)}}function hae(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(To(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Po(t,e)}else{if(To(t,i))return;fz.set(i),n.uniformMatrix2fv(this.addr,!1,fz),Po(t,i)}}function dae(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(To(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Po(t,e)}else{if(To(t,i))return;pz.set(i),n.uniformMatrix3fv(this.addr,!1,pz),Po(t,i)}}function pae(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(To(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Po(t,e)}else{if(To(t,i))return;dz.set(i),n.uniformMatrix4fv(this.addr,!1,dz),Po(t,i)}}function fae(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function mae(n,e){const t=this.cache;To(t,e)||(n.uniform2iv(this.addr,e),Po(t,e))}function vae(n,e){const t=this.cache;To(t,e)||(n.uniform3iv(this.addr,e),Po(t,e))}function gae(n,e){const t=this.cache;To(t,e)||(n.uniform4iv(this.addr,e),Po(t,e))}function _ae(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function yae(n,e){const t=this.cache;To(t,e)||(n.uniform2uiv(this.addr,e),Po(t,e))}function xae(n,e){const t=this.cache;To(t,e)||(n.uniform3uiv(this.addr,e),Po(t,e))}function bae(n,e){const t=this.cache;To(t,e)||(n.uniform4uiv(this.addr,e),Po(t,e))}function wae(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||cH,r)}function Sae(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||dH,r)}function Mae(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||pH,r)}function Cae(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||hH,r)}function Eae(n){switch(n){case 5126:return aae;case 35664:return lae;case 35665:return uae;case 35666:return cae;case 35674:return hae;case 35675:return dae;case 35676:return pae;case 5124:case 35670:return fae;case 35667:case 35671:return mae;case 35668:case 35672:return vae;case 35669:case 35673:return gae;case 5125:return _ae;case 36294:return yae;case 36295:return xae;case 36296:return bae;case 35678:case 36198:case 36298:case 36306:case 35682:return wae;case 35679:case 36299:case 36307:return Sae;case 35680:case 36300:case 36308:case 36293:return Mae;case 36289:case 36303:case 36311:case 36292:return Cae}}function Tae(n,e){n.uniform1fv(this.addr,e)}function Pae(n,e){const t=xg(e,this.size,2);n.uniform2fv(this.addr,t)}function Aae(n,e){const t=xg(e,this.size,3);n.uniform3fv(this.addr,t)}function Lae(n,e){const t=xg(e,this.size,4);n.uniform4fv(this.addr,t)}function Dae(n,e){const t=xg(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function Rae(n,e){const t=xg(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function Oae(n,e){const t=xg(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function kae(n,e){n.uniform1iv(this.addr,e)}function Iae(n,e){n.uniform2iv(this.addr,e)}function Nae(n,e){n.uniform3iv(this.addr,e)}function zae(n,e){n.uniform4iv(this.addr,e)}function Vae(n,e){n.uniform1uiv(this.addr,e)}function Fae(n,e){n.uniform2uiv(this.addr,e)}function Bae(n,e){n.uniform3uiv(this.addr,e)}function Uae(n,e){n.uniform4uiv(this.addr,e)}function jae(n,e,t){const i=e.length,r=RC(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture2D(e[o]||cH,r[o])}function Hae(n,e,t){const i=e.length,r=RC(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture3D(e[o]||dH,r[o])}function Wae(n,e,t){const i=e.length,r=RC(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTextureCube(e[o]||pH,r[o])}function Gae(n,e,t){const i=e.length,r=RC(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||hH,r[o])}function Xae(n){switch(n){case 5126:return Tae;case 35664:return Pae;case 35665:return Aae;case 35666:return Lae;case 35674:return Dae;case 35675:return Rae;case 35676:return Oae;case 5124:case 35670:return kae;case 35667:case 35671:return Iae;case 35668:case 35672:return Nae;case 35669:case 35673:return zae;case 5125:return Vae;case 36294:return Fae;case 36295:return Bae;case 36296:return Uae;case 35678:case 36198:case 36298:case 36306:case 35682:return jae;case 35679:case 36299:case 36307:return Hae;case 35680:case 36300:case 36308:case 36293:return Wae;case 36289:case 36303:case 36311:case 36292:return Gae}}class qae{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=Eae(t.type)}}class Yae{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=Xae(t.type)}}class Kae{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let o=0,s=r.length;o!==s;++o){const a=r[o];a.setValue(e,t[a.id],i)}}}const rA=/(\w+)(\])?(\[|\.)?/g;function mz(n,e){n.seq.push(e),n.map[e.id]=e}function Zae(n,e,t){const i=n.name,r=i.length;for(rA.lastIndex=0;;){const o=rA.exec(i),s=rA.lastIndex;let a=o[1];const l=o[2]==="]",u=o[3];if(l&&(a=a|0),u===void 0||u==="["&&s+2===r){mz(t,u===void 0?new qae(a,n,e):new Yae(a,n,e));break}else{let c=t.map[a];c===void 0&&(c=new Kae(a),mz(t,c)),t=c}}}class fM{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const o=e.getActiveUniform(t,r),s=e.getUniformLocation(t,o.name);Zae(o,s,this)}}setValue(e,t,i,r){const o=this.map[t];o!==void 0&&o.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let o=0,s=t.length;o!==s;++o){const a=t[o],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,o=e.length;r!==o;++r){const s=e[r];s.id in t&&i.push(s)}return i}}function vz(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let Jae=0;function Qae(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let s=r;s<o;s++){const a=s+1;i.push(`${a===e?">":" "} ${a}: ${t[s]}`)}return i.join(`
`)}function $ae(n){switch(n){case Ah:return["Linear","( value )"];case xi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function gz(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const s=parseInt(o[1]);return t.toUpperCase()+`

`+r+`

`+Qae(n.getShaderSource(e),s)}else return r}function ele(n,e){const t=$ae(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function tle(n,e){let t;switch(e){case Zj:t="Linear";break;case die:t="Reinhard";break;case pie:t="OptimizedCineon";break;case fie:t="ACESFilmic";break;case mie:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function nle(n){return[n.extensionDerivatives||!!n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(g_).join(`
`)}function ile(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function rle(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const o=n.getActiveAttrib(e,r),s=o.name;let a=1;o.type===35674&&(a=2),o.type===35675&&(a=3),o.type===35676&&(a=4),t[s]={type:o.type,location:n.getAttribLocation(e,s),locationSize:a}}return t}function g_(n){return n!==""}function _z(n,e){return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function yz(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const ole=/^[ \t]*#include +<([\w\d./]+)>/gm;function $D(n){return n.replace(ole,sle)}function sle(n,e){const t=tn[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return $D(t)}const ale=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,lle=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function xz(n){return n.replace(lle,fH).replace(ale,ule)}function ule(n,e,t,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),fH(n,e,t,i)}function fH(n,e,t,i){let r="";for(let o=parseInt(e);o<parseInt(t);o++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function bz(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function cle(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===Hj?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===Wj?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===v_&&(e="SHADOWMAP_TYPE_VSM"),e}function hle(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Ov:case kv:e="ENVMAP_TYPE_CUBE";break;case AC:e="ENVMAP_TYPE_CUBE_UV";break}return e}function dle(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case kv:e="ENVMAP_MODE_REFRACTION";break}return e}function ple(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Kj:e="ENVMAP_BLENDING_MULTIPLY";break;case cie:e="ENVMAP_BLENDING_MIX";break;case hie:e="ENVMAP_BLENDING_ADD";break}return e}function fle(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function mle(n,e,t,i){const r=n.getContext(),o=t.defines;let s=t.vertexShader,a=t.fragmentShader;const l=cle(t),u=hle(t),c=dle(t),h=ple(t),p=fle(t),m=t.isWebGL2?"":nle(t),y=ile(o),_=r.createProgram();let g,b,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(g=[y].filter(g_).join(`
`),g.length>0&&(g+=`
`),b=[m,y].filter(g_).join(`
`),b.length>0&&(b+=`
`)):(g=[bz(t),"#define SHADER_NAME "+t.shaderName,y,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(g_).join(`
`),b=[m,bz(t),"#define SHADER_NAME "+t.shaderName,y,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Cl?"#define TONE_MAPPING":"",t.toneMapping!==Cl?tn.tonemapping_pars_fragment:"",t.toneMapping!==Cl?tle("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",tn.encodings_pars_fragment,ele("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(g_).join(`
`)),s=$D(s),s=_z(s,t),s=yz(s,t),a=$D(a),a=_z(a,t),a=yz(a,t),s=xz(s),a=xz(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,b=["#define varying in",t.glslVersion===W6?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===W6?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+b);const M=w+g+s,C=w+b+a,P=vz(r,35633,M),L=vz(r,35632,C);if(r.attachShader(_,P),r.attachShader(_,L),t.index0AttributeName!==void 0?r.bindAttribLocation(_,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),n.debug.checkShaderErrors){const D=r.getProgramInfoLog(_).trim(),N=r.getShaderInfoLog(P).trim(),j=r.getShaderInfoLog(L).trim();let te=!0,ee=!0;if(r.getProgramParameter(_,35714)===!1){te=!1;const H=gz(r,P,"vertex"),Q=gz(r,L,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,35715)+`

Program Info Log: `+D+`
`+H+`
`+Q)}else D!==""?console.warn("THREE.WebGLProgram: Program Info Log:",D):(N===""||j==="")&&(ee=!1);ee&&(this.diagnostics={runnable:te,programLog:D,vertexShader:{log:N,prefix:g},fragmentShader:{log:j,prefix:b}})}r.deleteShader(P),r.deleteShader(L);let R;this.getUniforms=function(){return R===void 0&&(R=new fM(r,_)),R};let E;return this.getAttributes=function(){return E===void 0&&(E=rle(r,_)),E},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.name=t.shaderName,this.id=Jae++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=P,this.fragmentShader=L,this}let vle=0;class gle{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),o=this._getShaderStage(i),s=this._getShaderCacheForMaterial(e);return s.has(r)===!1&&(s.add(r),r.usedTimes++),s.has(o)===!1&&(s.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return t.has(e)===!1&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(t.has(e)===!1){const i=new _le(e);t.set(e,i)}return t.get(e)}}class _le{constructor(e){this.id=vle++,this.code=e,this.usedTimes=0}}function yle(n,e,t,i,r,o,s){const a=new jO,l=new gle,u=[],c=r.isWebGL2,h=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(E,D,N,j,te){const ee=j.fog,H=te.geometry,Q=E.isMeshStandardMaterial?j.environment:null,Z=(E.isMeshStandardMaterial?t:e).get(E.envMap||Q),de=!!Z&&Z.mapping===AC?Z.image.height:null,X=y[E.type];E.precision!==null&&(m=r.getMaxPrecision(E.precision),m!==E.precision&&console.warn("THREE.WebGLProgram.getParameters:",E.precision,"not supported, using",m,"instead."));const B=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,U=B!==void 0?B.length:0;let le=0;H.morphAttributes.position!==void 0&&(le=1),H.morphAttributes.normal!==void 0&&(le=2),H.morphAttributes.color!==void 0&&(le=3);let ne,fe,we,Be;if(X){const Ae=Oa[X];ne=Ae.vertexShader,fe=Ae.fragmentShader}else ne=E.vertexShader,fe=E.fragmentShader,l.update(E),we=l.getVertexShaderID(E),Be=l.getFragmentShaderID(E);const oe=n.getRenderTarget(),tt=E.alphaTest>0,Ue=E.clearcoat>0,Ve=E.iridescence>0;return{isWebGL2:c,shaderID:X,shaderName:E.type,vertexShader:ne,fragmentShader:fe,defines:E.defines,customVertexShaderID:we,customFragmentShaderID:Be,isRawShaderMaterial:E.isRawShaderMaterial===!0,glslVersion:E.glslVersion,precision:m,instancing:te.isInstancedMesh===!0,instancingColor:te.isInstancedMesh===!0&&te.instanceColor!==null,supportsVertexTextures:p,outputEncoding:oe===null?n.outputEncoding:oe.isXRRenderTarget===!0?oe.texture.encoding:Ah,map:!!E.map,matcap:!!E.matcap,envMap:!!Z,envMapMode:Z&&Z.mapping,envMapCubeUVHeight:de,lightMap:!!E.lightMap,aoMap:!!E.aoMap,emissiveMap:!!E.emissiveMap,bumpMap:!!E.bumpMap,normalMap:!!E.normalMap,objectSpaceNormalMap:E.normalMapType===Qj,tangentSpaceNormalMap:E.normalMapType===ox,decodeVideoTexture:!!E.map&&E.map.isVideoTexture===!0&&E.map.encoding===xi,clearcoat:Ue,clearcoatMap:Ue&&!!E.clearcoatMap,clearcoatRoughnessMap:Ue&&!!E.clearcoatRoughnessMap,clearcoatNormalMap:Ue&&!!E.clearcoatNormalMap,iridescence:Ve,iridescenceMap:Ve&&!!E.iridescenceMap,iridescenceThicknessMap:Ve&&!!E.iridescenceThicknessMap,displacementMap:!!E.displacementMap,roughnessMap:!!E.roughnessMap,metalnessMap:!!E.metalnessMap,specularMap:!!E.specularMap,specularIntensityMap:!!E.specularIntensityMap,specularColorMap:!!E.specularColorMap,opaque:E.transparent===!1&&E.blending===tv,alphaMap:!!E.alphaMap,alphaTest:tt,gradientMap:!!E.gradientMap,sheen:E.sheen>0,sheenColorMap:!!E.sheenColorMap,sheenRoughnessMap:!!E.sheenRoughnessMap,transmission:E.transmission>0,transmissionMap:!!E.transmissionMap,thicknessMap:!!E.thicknessMap,combine:E.combine,vertexTangents:!!E.normalMap&&!!H.attributes.tangent,vertexColors:E.vertexColors,vertexAlphas:E.vertexColors===!0&&!!H.attributes.color&&H.attributes.color.itemSize===4,vertexUvs:!!E.map||!!E.bumpMap||!!E.normalMap||!!E.specularMap||!!E.alphaMap||!!E.emissiveMap||!!E.roughnessMap||!!E.metalnessMap||!!E.clearcoatMap||!!E.clearcoatRoughnessMap||!!E.clearcoatNormalMap||!!E.iridescenceMap||!!E.iridescenceThicknessMap||!!E.displacementMap||!!E.transmissionMap||!!E.thicknessMap||!!E.specularIntensityMap||!!E.specularColorMap||!!E.sheenColorMap||!!E.sheenRoughnessMap,uvsVertexOnly:!(!!E.map||!!E.bumpMap||!!E.normalMap||!!E.specularMap||!!E.alphaMap||!!E.emissiveMap||!!E.roughnessMap||!!E.metalnessMap||!!E.clearcoatNormalMap||!!E.iridescenceMap||!!E.iridescenceThicknessMap||E.transmission>0||!!E.transmissionMap||!!E.thicknessMap||!!E.specularIntensityMap||!!E.specularColorMap||E.sheen>0||!!E.sheenColorMap||!!E.sheenRoughnessMap)&&!!E.displacementMap,fog:!!ee,useFog:E.fog===!0,fogExp2:ee&&ee.isFogExp2,flatShading:!!E.flatShading,sizeAttenuation:E.sizeAttenuation,logarithmicDepthBuffer:h,skinning:te.isSkinnedMesh===!0,morphTargets:H.morphAttributes.position!==void 0,morphNormals:H.morphAttributes.normal!==void 0,morphColors:H.morphAttributes.color!==void 0,morphTargetsCount:U,morphTextureStride:le,numDirLights:D.directional.length,numPointLights:D.point.length,numSpotLights:D.spot.length,numRectAreaLights:D.rectArea.length,numHemiLights:D.hemi.length,numDirLightShadows:D.directionalShadowMap.length,numPointLightShadows:D.pointShadowMap.length,numSpotLightShadows:D.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:E.dithering,shadowMapEnabled:n.shadowMap.enabled&&N.length>0,shadowMapType:n.shadowMap.type,toneMapping:E.toneMapped?n.toneMapping:Cl,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:E.premultipliedAlpha,doubleSided:E.side===Qu,flipSided:E.side===Zo,useDepthPacking:!!E.depthPacking,depthPacking:E.depthPacking||0,index0AttributeName:E.index0AttributeName,extensionDerivatives:E.extensions&&E.extensions.derivatives,extensionFragDepth:E.extensions&&E.extensions.fragDepth,extensionDrawBuffers:E.extensions&&E.extensions.drawBuffers,extensionShaderTextureLOD:E.extensions&&E.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||i.has("EXT_shader_texture_lod"),customProgramCacheKey:E.customProgramCacheKey()}}function g(E){const D=[];if(E.shaderID?D.push(E.shaderID):(D.push(E.customVertexShaderID),D.push(E.customFragmentShaderID)),E.defines!==void 0)for(const N in E.defines)D.push(N),D.push(E.defines[N]);return E.isRawShaderMaterial===!1&&(b(D,E),w(D,E),D.push(n.outputEncoding)),D.push(E.customProgramCacheKey),D.join()}function b(E,D){E.push(D.precision),E.push(D.outputEncoding),E.push(D.envMapMode),E.push(D.envMapCubeUVHeight),E.push(D.combine),E.push(D.vertexUvs),E.push(D.fogExp2),E.push(D.sizeAttenuation),E.push(D.morphTargetsCount),E.push(D.morphAttributeCount),E.push(D.numDirLights),E.push(D.numPointLights),E.push(D.numSpotLights),E.push(D.numHemiLights),E.push(D.numRectAreaLights),E.push(D.numDirLightShadows),E.push(D.numPointLightShadows),E.push(D.numSpotLightShadows),E.push(D.shadowMapType),E.push(D.toneMapping),E.push(D.numClippingPlanes),E.push(D.numClipIntersection),E.push(D.depthPacking)}function w(E,D){a.disableAll(),D.isWebGL2&&a.enable(0),D.supportsVertexTextures&&a.enable(1),D.instancing&&a.enable(2),D.instancingColor&&a.enable(3),D.map&&a.enable(4),D.matcap&&a.enable(5),D.envMap&&a.enable(6),D.lightMap&&a.enable(7),D.aoMap&&a.enable(8),D.emissiveMap&&a.enable(9),D.bumpMap&&a.enable(10),D.normalMap&&a.enable(11),D.objectSpaceNormalMap&&a.enable(12),D.tangentSpaceNormalMap&&a.enable(13),D.clearcoat&&a.enable(14),D.clearcoatMap&&a.enable(15),D.clearcoatRoughnessMap&&a.enable(16),D.clearcoatNormalMap&&a.enable(17),D.iridescence&&a.enable(18),D.iridescenceMap&&a.enable(19),D.iridescenceThicknessMap&&a.enable(20),D.displacementMap&&a.enable(21),D.specularMap&&a.enable(22),D.roughnessMap&&a.enable(23),D.metalnessMap&&a.enable(24),D.gradientMap&&a.enable(25),D.alphaMap&&a.enable(26),D.alphaTest&&a.enable(27),D.vertexColors&&a.enable(28),D.vertexAlphas&&a.enable(29),D.vertexUvs&&a.enable(30),D.vertexTangents&&a.enable(31),D.uvsVertexOnly&&a.enable(32),D.fog&&a.enable(33),E.push(a.mask),a.disableAll(),D.useFog&&a.enable(0),D.flatShading&&a.enable(1),D.logarithmicDepthBuffer&&a.enable(2),D.skinning&&a.enable(3),D.morphTargets&&a.enable(4),D.morphNormals&&a.enable(5),D.morphColors&&a.enable(6),D.premultipliedAlpha&&a.enable(7),D.shadowMapEnabled&&a.enable(8),D.physicallyCorrectLights&&a.enable(9),D.doubleSided&&a.enable(10),D.flipSided&&a.enable(11),D.useDepthPacking&&a.enable(12),D.dithering&&a.enable(13),D.specularIntensityMap&&a.enable(14),D.specularColorMap&&a.enable(15),D.transmission&&a.enable(16),D.transmissionMap&&a.enable(17),D.thicknessMap&&a.enable(18),D.sheen&&a.enable(19),D.sheenColorMap&&a.enable(20),D.sheenRoughnessMap&&a.enable(21),D.decodeVideoTexture&&a.enable(22),D.opaque&&a.enable(23),E.push(a.mask)}function M(E){const D=y[E.type];let N;if(D){const j=Oa[D];N=zr.clone(j.uniforms)}else N=E.uniforms;return N}function C(E,D){let N;for(let j=0,te=u.length;j<te;j++){const ee=u[j];if(ee.cacheKey===D){N=ee,++N.usedTimes;break}}return N===void 0&&(N=new mle(n,D,E,o),u.push(N)),N}function P(E){if(--E.usedTimes===0){const D=u.indexOf(E);u[D]=u[u.length-1],u.pop(),E.destroy()}}function L(E){l.remove(E)}function R(){l.dispose()}return{getParameters:_,getProgramCacheKey:g,getUniforms:M,acquireProgram:C,releaseProgram:P,releaseShaderCache:L,programs:u,dispose:R}}function xle(){let n=new WeakMap;function e(o){let s=n.get(o);return s===void 0&&(s={},n.set(o,s)),s}function t(o){n.delete(o)}function i(o,s,a){n.get(o)[s]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function ble(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function wz(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function Sz(){const n=[];let e=0;const t=[],i=[],r=[];function o(){e=0,t.length=0,i.length=0,r.length=0}function s(h,p,m,y,_,g){let b=n[e];return b===void 0?(b={id:h.id,object:h,geometry:p,material:m,groupOrder:y,renderOrder:h.renderOrder,z:_,group:g},n[e]=b):(b.id=h.id,b.object=h,b.geometry=p,b.material=m,b.groupOrder=y,b.renderOrder=h.renderOrder,b.z=_,b.group=g),e++,b}function a(h,p,m,y,_,g){const b=s(h,p,m,y,_,g);m.transmission>0?i.push(b):m.transparent===!0?r.push(b):t.push(b)}function l(h,p,m,y,_,g){const b=s(h,p,m,y,_,g);m.transmission>0?i.unshift(b):m.transparent===!0?r.unshift(b):t.unshift(b)}function u(h,p){t.length>1&&t.sort(h||ble),i.length>1&&i.sort(p||wz),r.length>1&&r.sort(p||wz)}function c(){for(let h=e,p=n.length;h<p;h++){const m=n[h];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:i,transparent:r,init:o,push:a,unshift:l,finish:c,sort:u}}function wle(){let n=new WeakMap;function e(i,r){let o;return n.has(i)===!1?(o=new Sz,n.set(i,[o])):r>=n.get(i).length?(o=new Sz,n.get(i).push(o)):o=n.get(i)[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function Sle(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new K,color:new vt};break;case"SpotLight":t={position:new K,direction:new K,color:new vt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new K,color:new vt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new K,skyColor:new vt,groundColor:new vt};break;case"RectAreaLight":t={color:new vt,position:new K,halfWidth:new K,halfHeight:new K};break}return n[e.id]=t,t}}}function Mle(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ze};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ze};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ze,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let Cle=0;function Ele(n,e){return(e.castShadow?1:0)-(n.castShadow?1:0)}function Tle(n,e){const t=new Sle,i=Mle(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let c=0;c<9;c++)r.probe.push(new K);const o=new K,s=new Bt,a=new Bt;function l(c,h){let p=0,m=0,y=0;for(let D=0;D<9;D++)r.probe[D].set(0,0,0);let _=0,g=0,b=0,w=0,M=0,C=0,P=0,L=0;c.sort(Ele);const R=h!==!0?Math.PI:1;for(let D=0,N=c.length;D<N;D++){const j=c[D],te=j.color,ee=j.intensity,H=j.distance,Q=j.shadow&&j.shadow.map?j.shadow.map.texture:null;if(j.isAmbientLight)p+=te.r*ee*R,m+=te.g*ee*R,y+=te.b*ee*R;else if(j.isLightProbe)for(let Z=0;Z<9;Z++)r.probe[Z].addScaledVector(j.sh.coefficients[Z],ee);else if(j.isDirectionalLight){const Z=t.get(j);if(Z.color.copy(j.color).multiplyScalar(j.intensity*R),j.castShadow){const de=j.shadow,X=i.get(j);X.shadowBias=de.bias,X.shadowNormalBias=de.normalBias,X.shadowRadius=de.radius,X.shadowMapSize=de.mapSize,r.directionalShadow[_]=X,r.directionalShadowMap[_]=Q,r.directionalShadowMatrix[_]=j.shadow.matrix,C++}r.directional[_]=Z,_++}else if(j.isSpotLight){const Z=t.get(j);if(Z.position.setFromMatrixPosition(j.matrixWorld),Z.color.copy(te).multiplyScalar(ee*R),Z.distance=H,Z.coneCos=Math.cos(j.angle),Z.penumbraCos=Math.cos(j.angle*(1-j.penumbra)),Z.decay=j.decay,j.castShadow){const de=j.shadow,X=i.get(j);X.shadowBias=de.bias,X.shadowNormalBias=de.normalBias,X.shadowRadius=de.radius,X.shadowMapSize=de.mapSize,r.spotShadow[b]=X,r.spotShadowMap[b]=Q,r.spotShadowMatrix[b]=j.shadow.matrix,L++}r.spot[b]=Z,b++}else if(j.isRectAreaLight){const Z=t.get(j);Z.color.copy(te).multiplyScalar(ee),Z.halfWidth.set(j.width*.5,0,0),Z.halfHeight.set(0,j.height*.5,0),r.rectArea[w]=Z,w++}else if(j.isPointLight){const Z=t.get(j);if(Z.color.copy(j.color).multiplyScalar(j.intensity*R),Z.distance=j.distance,Z.decay=j.decay,j.castShadow){const de=j.shadow,X=i.get(j);X.shadowBias=de.bias,X.shadowNormalBias=de.normalBias,X.shadowRadius=de.radius,X.shadowMapSize=de.mapSize,X.shadowCameraNear=de.camera.near,X.shadowCameraFar=de.camera.far,r.pointShadow[g]=X,r.pointShadowMap[g]=Q,r.pointShadowMatrix[g]=j.shadow.matrix,P++}r.point[g]=Z,g++}else if(j.isHemisphereLight){const Z=t.get(j);Z.skyColor.copy(j.color).multiplyScalar(ee*R),Z.groundColor.copy(j.groundColor).multiplyScalar(ee*R),r.hemi[M]=Z,M++}}w>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=at.LTC_FLOAT_1,r.rectAreaLTC2=at.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=at.LTC_HALF_1,r.rectAreaLTC2=at.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=m,r.ambient[2]=y;const E=r.hash;(E.directionalLength!==_||E.pointLength!==g||E.spotLength!==b||E.rectAreaLength!==w||E.hemiLength!==M||E.numDirectionalShadows!==C||E.numPointShadows!==P||E.numSpotShadows!==L)&&(r.directional.length=_,r.spot.length=b,r.rectArea.length=w,r.point.length=g,r.hemi.length=M,r.directionalShadow.length=C,r.directionalShadowMap.length=C,r.pointShadow.length=P,r.pointShadowMap.length=P,r.spotShadow.length=L,r.spotShadowMap.length=L,r.directionalShadowMatrix.length=C,r.pointShadowMatrix.length=P,r.spotShadowMatrix.length=L,E.directionalLength=_,E.pointLength=g,E.spotLength=b,E.rectAreaLength=w,E.hemiLength=M,E.numDirectionalShadows=C,E.numPointShadows=P,E.numSpotShadows=L,r.version=Cle++)}function u(c,h){let p=0,m=0,y=0,_=0,g=0;const b=h.matrixWorldInverse;for(let w=0,M=c.length;w<M;w++){const C=c[w];if(C.isDirectionalLight){const P=r.directional[p];P.direction.setFromMatrixPosition(C.matrixWorld),o.setFromMatrixPosition(C.target.matrixWorld),P.direction.sub(o),P.direction.transformDirection(b),p++}else if(C.isSpotLight){const P=r.spot[y];P.position.setFromMatrixPosition(C.matrixWorld),P.position.applyMatrix4(b),P.direction.setFromMatrixPosition(C.matrixWorld),o.setFromMatrixPosition(C.target.matrixWorld),P.direction.sub(o),P.direction.transformDirection(b),y++}else if(C.isRectAreaLight){const P=r.rectArea[_];P.position.setFromMatrixPosition(C.matrixWorld),P.position.applyMatrix4(b),a.identity(),s.copy(C.matrixWorld),s.premultiply(b),a.extractRotation(s),P.halfWidth.set(C.width*.5,0,0),P.halfHeight.set(0,C.height*.5,0),P.halfWidth.applyMatrix4(a),P.halfHeight.applyMatrix4(a),_++}else if(C.isPointLight){const P=r.point[m];P.position.setFromMatrixPosition(C.matrixWorld),P.position.applyMatrix4(b),m++}else if(C.isHemisphereLight){const P=r.hemi[g];P.direction.setFromMatrixPosition(C.matrixWorld),P.direction.transformDirection(b),g++}}}return{setup:l,setupView:u,state:r}}function Mz(n,e){const t=new Tle(n,e),i=[],r=[];function o(){i.length=0,r.length=0}function s(c){i.push(c)}function a(c){r.push(c)}function l(c){t.setup(i,c)}function u(c){t.setupView(i,c)}return{init:o,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:l,setupLightsView:u,pushLight:s,pushShadow:a}}function Ple(n,e){let t=new WeakMap;function i(o,s=0){let a;return t.has(o)===!1?(a=new Mz(n,e),t.set(o,[a])):s>=t.get(o).length?(a=new Mz(n,e),t.get(o).push(a)):a=t.get(o)[s],a}function r(){t=new WeakMap}return{get:i,dispose:r}}class OC extends Vl{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=kie,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Ale extends Vl{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new K,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Lle=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Dle=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Rle(n,e,t){let i=new DC;const r=new ze,o=new ze,s=new _n,a=new OC({depthPacking:LC}),l=new Ale,u={},c=t.maxTextureSize,h={0:Zo,1:Ep,2:Qu},p=new Mn({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ze},radius:{value:4}},vertexShader:Lle,fragmentShader:Dle}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const y=new ei;y.setAttribute("position",new Co(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new Fr(y,p),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Hj,this.render=function(C,P,L){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||C.length===0)return;const R=n.getRenderTarget(),E=n.getActiveCubeFace(),D=n.getActiveMipmapLevel(),N=n.state;N.setBlending(ji),N.buffers.color.setClear(1,1,1,1),N.buffers.depth.setTest(!0),N.setScissorTest(!1);for(let j=0,te=C.length;j<te;j++){const ee=C[j],H=ee.shadow;if(H===void 0){console.warn("THREE.WebGLShadowMap:",ee,"has no shadow.");continue}if(H.autoUpdate===!1&&H.needsUpdate===!1)continue;r.copy(H.mapSize);const Q=H.getFrameExtents();if(r.multiply(Q),o.copy(H.mapSize),(r.x>c||r.y>c)&&(r.x>c&&(o.x=Math.floor(c/Q.x),r.x=o.x*Q.x,H.mapSize.x=o.x),r.y>c&&(o.y=Math.floor(c/Q.y),r.y=o.y*Q.y,H.mapSize.y=o.y)),H.map===null){const de=this.type!==v_?{minFilter:Mi,magFilter:Mi}:{};H.map=new Qn(r.x,r.y,de),H.map.texture.name=ee.name+".shadowMap",H.camera.updateProjectionMatrix()}n.setRenderTarget(H.map),n.clear();const Z=H.getViewportCount();for(let de=0;de<Z;de++){const X=H.getViewport(de);s.set(o.x*X.x,o.y*X.y,o.x*X.z,o.y*X.w),N.viewport(s),H.updateMatrices(ee,de),i=H.getFrustum(),M(P,L,H.camera,ee,this.type)}H.isPointLightShadow!==!0&&this.type===v_&&b(H,L),H.needsUpdate=!1}g.needsUpdate=!1,n.setRenderTarget(R,E,D)};function b(C,P){const L=e.update(_);p.defines.VSM_SAMPLES!==C.blurSamples&&(p.defines.VSM_SAMPLES=C.blurSamples,m.defines.VSM_SAMPLES=C.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),C.mapPass===null&&(C.mapPass=new Qn(r.x,r.y)),p.uniforms.shadow_pass.value=C.map.texture,p.uniforms.resolution.value=C.mapSize,p.uniforms.radius.value=C.radius,n.setRenderTarget(C.mapPass),n.clear(),n.renderBufferDirect(P,null,L,p,_,null),m.uniforms.shadow_pass.value=C.mapPass.texture,m.uniforms.resolution.value=C.mapSize,m.uniforms.radius.value=C.radius,n.setRenderTarget(C.map),n.clear(),n.renderBufferDirect(P,null,L,m,_,null)}function w(C,P,L,R,E,D){let N=null;const j=L.isPointLight===!0?C.customDistanceMaterial:C.customDepthMaterial;if(j!==void 0?N=j:N=L.isPointLight===!0?l:a,n.localClippingEnabled&&P.clipShadows===!0&&Array.isArray(P.clippingPlanes)&&P.clippingPlanes.length!==0||P.displacementMap&&P.displacementScale!==0||P.alphaMap&&P.alphaTest>0){const te=N.uuid,ee=P.uuid;let H=u[te];H===void 0&&(H={},u[te]=H);let Q=H[ee];Q===void 0&&(Q=N.clone(),H[ee]=Q),N=Q}return N.visible=P.visible,N.wireframe=P.wireframe,D===v_?N.side=P.shadowSide!==null?P.shadowSide:P.side:N.side=P.shadowSide!==null?P.shadowSide:h[P.side],N.alphaMap=P.alphaMap,N.alphaTest=P.alphaTest,N.clipShadows=P.clipShadows,N.clippingPlanes=P.clippingPlanes,N.clipIntersection=P.clipIntersection,N.displacementMap=P.displacementMap,N.displacementScale=P.displacementScale,N.displacementBias=P.displacementBias,N.wireframeLinewidth=P.wireframeLinewidth,N.linewidth=P.linewidth,L.isPointLight===!0&&N.isMeshDistanceMaterial===!0&&(N.referencePosition.setFromMatrixPosition(L.matrixWorld),N.nearDistance=R,N.farDistance=E),N}function M(C,P,L,R,E){if(C.visible===!1)return;if(C.layers.test(P.layers)&&(C.isMesh||C.isLine||C.isPoints)&&(C.castShadow||C.receiveShadow&&E===v_)&&(!C.frustumCulled||i.intersectsObject(C))){C.modelViewMatrix.multiplyMatrices(L.matrixWorldInverse,C.matrixWorld);const N=e.update(C),j=C.material;if(Array.isArray(j)){const te=N.groups;for(let ee=0,H=te.length;ee<H;ee++){const Q=te[ee],Z=j[Q.materialIndex];if(Z&&Z.visible){const de=w(C,Z,R,L.near,L.far,E);n.renderBufferDirect(L,null,N,de,C,Q)}}}else if(j.visible){const te=w(C,j,R,L.near,L.far,E);n.renderBufferDirect(L,null,N,te,C,null)}}const D=C.children;for(let N=0,j=D.length;N<j;N++)M(D[N],P,L,R,E)}}function Ole(n,e,t){const i=t.isWebGL2;function r(){let W=!1;const De=new _n;let ae=null;const Re=new _n(0,0,0,0);return{setMask:function(Me){ae!==Me&&!W&&(n.colorMask(Me,Me,Me,Me),ae=Me)},setLocked:function(Me){W=Me},setClear:function(Me,bt,It,zt,Kn){Kn===!0&&(Me*=zt,bt*=zt,It*=zt),De.set(Me,bt,It,zt),Re.equals(De)===!1&&(n.clearColor(Me,bt,It,zt),Re.copy(De))},reset:function(){W=!1,ae=null,Re.set(-1,0,0,0)}}}function o(){let W=!1,De=null,ae=null,Re=null;return{setTest:function(Me){Me?tt(2929):Ue(2929)},setMask:function(Me){De!==Me&&!W&&(n.depthMask(Me),De=Me)},setFunc:function(Me){if(ae!==Me){if(Me)switch(Me){case iie:n.depthFunc(512);break;case rie:n.depthFunc(519);break;case oie:n.depthFunc(513);break;case GD:n.depthFunc(515);break;case sie:n.depthFunc(514);break;case aie:n.depthFunc(518);break;case lie:n.depthFunc(516);break;case uie:n.depthFunc(517);break;default:n.depthFunc(515)}else n.depthFunc(515);ae=Me}},setLocked:function(Me){W=Me},setClear:function(Me){Re!==Me&&(n.clearDepth(Me),Re=Me)},reset:function(){W=!1,De=null,ae=null,Re=null}}}function s(){let W=!1,De=null,ae=null,Re=null,Me=null,bt=null,It=null,zt=null,Kn=null;return{setTest:function(Dt){W||(Dt?tt(2960):Ue(2960))},setMask:function(Dt){De!==Dt&&!W&&(n.stencilMask(Dt),De=Dt)},setFunc:function(Dt,Bn,yn){(ae!==Dt||Re!==Bn||Me!==yn)&&(n.stencilFunc(Dt,Bn,yn),ae=Dt,Re=Bn,Me=yn)},setOp:function(Dt,Bn,yn){(bt!==Dt||It!==Bn||zt!==yn)&&(n.stencilOp(Dt,Bn,yn),bt=Dt,It=Bn,zt=yn)},setLocked:function(Dt){W=Dt},setClear:function(Dt){Kn!==Dt&&(n.clearStencil(Dt),Kn=Dt)},reset:function(){W=!1,De=null,ae=null,Re=null,Me=null,bt=null,It=null,zt=null,Kn=null}}}const a=new r,l=new o,u=new s,c=new WeakMap,h=new WeakMap;let p={},m={},y=new WeakMap,_=[],g=null,b=!1,w=null,M=null,C=null,P=null,L=null,R=null,E=null,D=!1,N=null,j=null,te=null,ee=null,H=null;const Q=n.getParameter(35661);let Z=!1,de=0;const X=n.getParameter(7938);X.indexOf("WebGL")!==-1?(de=parseFloat(/^WebGL (\d)/.exec(X)[1]),Z=de>=1):X.indexOf("OpenGL ES")!==-1&&(de=parseFloat(/^OpenGL ES (\d)/.exec(X)[1]),Z=de>=2);let B=null,U={};const le=n.getParameter(3088),ne=n.getParameter(2978),fe=new _n().fromArray(le),we=new _n().fromArray(ne);function Be(W,De,ae){const Re=new Uint8Array(4),Me=n.createTexture();n.bindTexture(W,Me),n.texParameteri(W,10241,9728),n.texParameteri(W,10240,9728);for(let bt=0;bt<ae;bt++)n.texImage2D(De+bt,0,6408,1,1,0,6408,5121,Re);return Me}const oe={};oe[3553]=Be(3553,3553,1),oe[34067]=Be(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),tt(2929),l.setFunc(GD),ft(!1),mt(v6),tt(2884),Ye(ji);function tt(W){p[W]!==!0&&(n.enable(W),p[W]=!0)}function Ue(W){p[W]!==!1&&(n.disable(W),p[W]=!1)}function Ve(W,De){return m[W]!==De?(n.bindFramebuffer(W,De),m[W]=De,i&&(W===36009&&(m[36160]=De),W===36160&&(m[36009]=De)),!0):!1}function Ae(W,De){let ae=_,Re=!1;if(W)if(ae=y.get(De),ae===void 0&&(ae=[],y.set(De,ae)),W.isWebGLMultipleRenderTargets){const Me=W.texture;if(ae.length!==Me.length||ae[0]!==36064){for(let bt=0,It=Me.length;bt<It;bt++)ae[bt]=36064+bt;ae.length=Me.length,Re=!0}}else ae[0]!==36064&&(ae[0]=36064,Re=!0);else ae[0]!==1029&&(ae[0]=1029,Re=!0);Re&&(t.isWebGL2?n.drawBuffers(ae):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ae))}function Oe(W){return g!==W?(n.useProgram(W),g=W,!0):!1}const Te={[rh]:32774,[Kne]:32778,[Zne]:32779};if(i)Te[y6]=32775,Te[x6]=32776;else{const W=e.get("EXT_blend_minmax");W!==null&&(Te[y6]=W.MIN_EXT,Te[x6]=W.MAX_EXT)}const be={[WD]:0,[Jne]:1,[Qne]:768,[Gj]:770,[nie]:776,[Yj]:774,[qj]:772,[$ne]:769,[Xj]:771,[tie]:775,[eie]:773};function Ye(W,De,ae,Re,Me,bt,It,zt){if(W===ji){b===!0&&(Ue(3042),b=!1);return}if(b===!1&&(tt(3042),b=!0),W!==HD){if(W!==w||zt!==D){if((M!==rh||L!==rh)&&(n.blendEquation(32774),M=rh,L=rh),zt)switch(W){case tv:n.blendFuncSeparate(1,771,1,771);break;case d2:n.blendFunc(1,1);break;case g6:n.blendFuncSeparate(0,769,0,1);break;case _6:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",W);break}else switch(W){case tv:n.blendFuncSeparate(770,771,1,771);break;case d2:n.blendFunc(770,1);break;case g6:n.blendFuncSeparate(0,769,0,1);break;case _6:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",W);break}C=null,P=null,R=null,E=null,w=W,D=zt}return}Me=Me||De,bt=bt||ae,It=It||Re,(De!==M||Me!==L)&&(n.blendEquationSeparate(Te[De],Te[Me]),M=De,L=Me),(ae!==C||Re!==P||bt!==R||It!==E)&&(n.blendFuncSeparate(be[ae],be[Re],be[bt],be[It]),C=ae,P=Re,R=bt,E=It),w=W,D=null}function Ke(W,De){W.side===Qu?Ue(2884):tt(2884);let ae=W.side===Zo;De&&(ae=!ae),ft(ae),W.blending===tv&&W.transparent===!1?Ye(ji):Ye(W.blending,W.blendEquation,W.blendSrc,W.blendDst,W.blendEquationAlpha,W.blendSrcAlpha,W.blendDstAlpha,W.premultipliedAlpha),l.setFunc(W.depthFunc),l.setTest(W.depthTest),l.setMask(W.depthWrite),a.setMask(W.colorWrite);const Re=W.stencilWrite;u.setTest(Re),Re&&(u.setMask(W.stencilWriteMask),u.setFunc(W.stencilFunc,W.stencilRef,W.stencilFuncMask),u.setOp(W.stencilFail,W.stencilZFail,W.stencilZPass)),st(W.polygonOffset,W.polygonOffsetFactor,W.polygonOffsetUnits),W.alphaToCoverage===!0?tt(32926):Ue(32926)}function ft(W){N!==W&&(W?n.frontFace(2304):n.frontFace(2305),N=W)}function mt(W){W!==Xne?(tt(2884),W!==j&&(W===v6?n.cullFace(1029):W===qne?n.cullFace(1028):n.cullFace(1032))):Ue(2884),j=W}function yt(W){W!==te&&(Z&&n.lineWidth(W),te=W)}function st(W,De,ae){W?(tt(32823),(ee!==De||H!==ae)&&(n.polygonOffset(De,ae),ee=De,H=ae)):Ue(32823)}function Ce(W){W?tt(3089):Ue(3089)}function ve(W){W===void 0&&(W=33984+Q-1),B!==W&&(n.activeTexture(W),B=W)}function k(W,De){B===null&&ve();let ae=U[B];ae===void 0&&(ae={type:void 0,texture:void 0},U[B]=ae),(ae.type!==W||ae.texture!==De)&&(n.bindTexture(W,De||oe[W]),ae.type=W,ae.texture=De)}function O(){const W=U[B];W!==void 0&&W.type!==void 0&&(n.bindTexture(W.type,null),W.type=void 0,W.texture=void 0)}function ie(){try{n.compressedTexImage2D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function ge(){try{n.texSubImage2D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function ye(){try{n.texSubImage3D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Pe(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Xe(){try{n.texStorage2D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function re(){try{n.texStorage3D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Fe(){try{n.texImage2D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Ne(){try{n.texImage3D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function He(W){fe.equals(W)===!1&&(n.scissor(W.x,W.y,W.z,W.w),fe.copy(W))}function Ie(W){we.equals(W)===!1&&(n.viewport(W.x,W.y,W.z,W.w),we.copy(W))}function nt(W,De){let ae=h.get(De);ae===void 0&&(ae=new WeakMap,h.set(De,ae));let Re=ae.get(W);Re===void 0&&(Re=n.getUniformBlockIndex(De,W.name),ae.set(W,Re))}function gt(W,De){const ae=h.get(De).get(W);c.get(W)!==ae&&(n.uniformBlockBinding(De,ae,W.__bindingPointIndex),c.set(W,ae))}function kt(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),i===!0&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},B=null,U={},m={},y=new WeakMap,_=[],g=null,b=!1,w=null,M=null,C=null,P=null,L=null,R=null,E=null,D=!1,N=null,j=null,te=null,ee=null,H=null,fe.set(0,0,n.canvas.width,n.canvas.height),we.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:tt,disable:Ue,bindFramebuffer:Ve,drawBuffers:Ae,useProgram:Oe,setBlending:Ye,setMaterial:Ke,setFlipSided:ft,setCullFace:mt,setLineWidth:yt,setPolygonOffset:st,setScissorTest:Ce,activeTexture:ve,bindTexture:k,unbindTexture:O,compressedTexImage2D:ie,texImage2D:Fe,texImage3D:Ne,updateUBOMapping:nt,uniformBlockBinding:gt,texStorage2D:Xe,texStorage3D:re,texSubImage2D:ge,texSubImage3D:ye,compressedTexSubImage2D:Pe,scissor:He,viewport:Ie,reset:kt}}function kle(n,e,t,i,r,o,s){const a=r.isWebGL2,l=r.maxTextures,u=r.maxCubemapSize,c=r.maxTextureSize,h=r.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=/OculusBrowser/g.test(navigator.userAgent),y=new WeakMap;let _;const g=new WeakMap;let b=!1;try{b=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function w(k,O){return b?new OffscreenCanvas(k,O):Ay("canvas")}function M(k,O,ie,ge){let ye=1;if((k.width>ge||k.height>ge)&&(ye=ge/Math.max(k.width,k.height)),ye<1||O===!0)if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap){const Pe=O?v2:Math.floor,Xe=Pe(ye*k.width),re=Pe(ye*k.height);_===void 0&&(_=w(Xe,re));const Fe=ie?w(Xe,re):_;return Fe.width=Xe,Fe.height=re,Fe.getContext("2d").drawImage(k,0,0,Xe,re),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+Xe+"x"+re+")."),Fe}else return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k;return k}function C(k){return QD(k.width)&&QD(k.height)}function P(k){return a?!1:k.wrapS!==vs||k.wrapT!==vs||k.minFilter!==Mi&&k.minFilter!==Hi}function L(k,O){return k.generateMipmaps&&O&&k.minFilter!==Mi&&k.minFilter!==Hi}function R(k){n.generateMipmap(k)}function E(k,O,ie,ge,ye=!1){if(a===!1)return O;if(k!==null){if(n[k]!==void 0)return n[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let Pe=O;return O===6403&&(ie===5126&&(Pe=33326),ie===5131&&(Pe=33325),ie===5121&&(Pe=33321)),O===33319&&(ie===5126&&(Pe=33328),ie===5131&&(Pe=33327),ie===5121&&(Pe=33323)),O===6408&&(ie===5126&&(Pe=34836),ie===5131&&(Pe=34842),ie===5121&&(Pe=ge===xi&&ye===!1?35907:32856),ie===32819&&(Pe=32854),ie===32820&&(Pe=32855)),(Pe===33325||Pe===33326||Pe===33327||Pe===33328||Pe===34842||Pe===34836)&&e.get("EXT_color_buffer_float"),Pe}function D(k,O,ie){return L(k,ie)===!0||k.isFramebufferTexture&&k.minFilter!==Mi&&k.minFilter!==Hi?Math.log2(Math.max(O.width,O.height))+1:k.mipmaps!==void 0&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?O.mipmaps.length:1}function N(k){return k===Mi||k===b6||k===w6?9728:9729}function j(k){const O=k.target;O.removeEventListener("dispose",j),ee(O),O.isVideoTexture&&y.delete(O)}function te(k){const O=k.target;O.removeEventListener("dispose",te),Q(O)}function ee(k){const O=i.get(k);if(O.__webglInit===void 0)return;const ie=k.source,ge=g.get(ie);if(ge){const ye=ge[O.__cacheKey];ye.usedTimes--,ye.usedTimes===0&&H(k),Object.keys(ge).length===0&&g.delete(ie)}i.remove(k)}function H(k){const O=i.get(k);n.deleteTexture(O.__webglTexture);const ie=k.source,ge=g.get(ie);delete ge[O.__cacheKey],s.memory.textures--}function Q(k){const O=k.texture,ie=i.get(k),ge=i.get(O);if(ge.__webglTexture!==void 0&&(n.deleteTexture(ge.__webglTexture),s.memory.textures--),k.depthTexture&&k.depthTexture.dispose(),k.isWebGLCubeRenderTarget)for(let ye=0;ye<6;ye++)n.deleteFramebuffer(ie.__webglFramebuffer[ye]),ie.__webglDepthbuffer&&n.deleteRenderbuffer(ie.__webglDepthbuffer[ye]);else{if(n.deleteFramebuffer(ie.__webglFramebuffer),ie.__webglDepthbuffer&&n.deleteRenderbuffer(ie.__webglDepthbuffer),ie.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ie.__webglMultisampledFramebuffer),ie.__webglColorRenderbuffer)for(let ye=0;ye<ie.__webglColorRenderbuffer.length;ye++)ie.__webglColorRenderbuffer[ye]&&n.deleteRenderbuffer(ie.__webglColorRenderbuffer[ye]);ie.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ie.__webglDepthRenderbuffer)}if(k.isWebGLMultipleRenderTargets)for(let ye=0,Pe=O.length;ye<Pe;ye++){const Xe=i.get(O[ye]);Xe.__webglTexture&&(n.deleteTexture(Xe.__webglTexture),s.memory.textures--),i.remove(O[ye])}i.remove(O),i.remove(k)}let Z=0;function de(){Z=0}function X(){const k=Z;return k>=l&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+l),Z+=1,k}function B(k){const O=[];return O.push(k.wrapS),O.push(k.wrapT),O.push(k.magFilter),O.push(k.minFilter),O.push(k.anisotropy),O.push(k.internalFormat),O.push(k.format),O.push(k.type),O.push(k.generateMipmaps),O.push(k.premultiplyAlpha),O.push(k.flipY),O.push(k.unpackAlignment),O.push(k.encoding),O.join()}function U(k,O){const ie=i.get(k);if(k.isVideoTexture&&Ce(k),k.isRenderTargetTexture===!1&&k.version>0&&ie.__version!==k.version){const ge=k.image;if(ge===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ge.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ue(ie,k,O);return}}t.activeTexture(33984+O),t.bindTexture(3553,ie.__webglTexture)}function le(k,O){const ie=i.get(k);if(k.version>0&&ie.__version!==k.version){Ue(ie,k,O);return}t.activeTexture(33984+O),t.bindTexture(35866,ie.__webglTexture)}function ne(k,O){const ie=i.get(k);if(k.version>0&&ie.__version!==k.version){Ue(ie,k,O);return}t.activeTexture(33984+O),t.bindTexture(32879,ie.__webglTexture)}function fe(k,O){const ie=i.get(k);if(k.version>0&&ie.__version!==k.version){Ve(ie,k,O);return}t.activeTexture(33984+O),t.bindTexture(34067,ie.__webglTexture)}const we={[Iv]:10497,[vs]:33071,[qD]:33648},Be={[Mi]:9728,[b6]:9984,[w6]:9986,[Hi]:9729,[vie]:9985,[rx]:9987};function oe(k,O,ie){if(ie?(n.texParameteri(k,10242,we[O.wrapS]),n.texParameteri(k,10243,we[O.wrapT]),(k===32879||k===35866)&&n.texParameteri(k,32882,we[O.wrapR]),n.texParameteri(k,10240,Be[O.magFilter]),n.texParameteri(k,10241,Be[O.minFilter])):(n.texParameteri(k,10242,33071),n.texParameteri(k,10243,33071),(k===32879||k===35866)&&n.texParameteri(k,32882,33071),(O.wrapS!==vs||O.wrapT!==vs)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(k,10240,N(O.magFilter)),n.texParameteri(k,10241,N(O.minFilter)),O.minFilter!==Mi&&O.minFilter!==Hi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const ge=e.get("EXT_texture_filter_anisotropic");if(O.type===Ia&&e.has("OES_texture_float_linear")===!1||a===!1&&O.type===Bu&&e.has("OES_texture_half_float_linear")===!1)return;(O.anisotropy>1||i.get(O).__currentAnisotropy)&&(n.texParameterf(k,ge.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(O.anisotropy,r.getMaxAnisotropy())),i.get(O).__currentAnisotropy=O.anisotropy)}}function tt(k,O){let ie=!1;k.__webglInit===void 0&&(k.__webglInit=!0,O.addEventListener("dispose",j));const ge=O.source;let ye=g.get(ge);ye===void 0&&(ye={},g.set(ge,ye));const Pe=B(O);if(Pe!==k.__cacheKey){ye[Pe]===void 0&&(ye[Pe]={texture:n.createTexture(),usedTimes:0},s.memory.textures++,ie=!0),ye[Pe].usedTimes++;const Xe=ye[k.__cacheKey];Xe!==void 0&&(ye[k.__cacheKey].usedTimes--,Xe.usedTimes===0&&H(O)),k.__cacheKey=Pe,k.__webglTexture=ye[Pe].texture}return ie}function Ue(k,O,ie){let ge=3553;O.isDataArrayTexture&&(ge=35866),O.isData3DTexture&&(ge=32879);const ye=tt(k,O),Pe=O.source;if(t.activeTexture(33984+ie),t.bindTexture(ge,k.__webglTexture),Pe.version!==Pe.__currentVersion||ye===!0){n.pixelStorei(37440,O.flipY),n.pixelStorei(37441,O.premultiplyAlpha),n.pixelStorei(3317,O.unpackAlignment),n.pixelStorei(37443,0);const Xe=P(O)&&C(O.image)===!1;let re=M(O.image,Xe,!1,c);re=ve(O,re);const Fe=C(re)||a,Ne=o.convert(O.format,O.encoding);let He=o.convert(O.type),Ie=E(O.internalFormat,Ne,He,O.encoding,O.isVideoTexture);oe(ge,O,Fe);let nt;const gt=O.mipmaps,kt=a&&O.isVideoTexture!==!0,W=Pe.__currentVersion===void 0||ye===!0,De=D(O,re,Fe);if(O.isDepthTexture)Ie=6402,a?O.type===Ia?Ie=36012:O.type===sp?Ie=33190:O.type===nv?Ie=35056:Ie=33189:O.type===Ia&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),O.format===fp&&Ie===6402&&O.type!==FO&&O.type!==sp&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),O.type=sp,He=o.convert(O.type)),O.format===Nv&&Ie===6402&&(Ie=34041,O.type!==nv&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),O.type=nv,He=o.convert(O.type))),W&&(kt?t.texStorage2D(3553,1,Ie,re.width,re.height):t.texImage2D(3553,0,Ie,re.width,re.height,0,Ne,He,null));else if(O.isDataTexture)if(gt.length>0&&Fe){kt&&W&&t.texStorage2D(3553,De,Ie,gt[0].width,gt[0].height);for(let ae=0,Re=gt.length;ae<Re;ae++)nt=gt[ae],kt?t.texSubImage2D(3553,ae,0,0,nt.width,nt.height,Ne,He,nt.data):t.texImage2D(3553,ae,Ie,nt.width,nt.height,0,Ne,He,nt.data);O.generateMipmaps=!1}else kt?(W&&t.texStorage2D(3553,De,Ie,re.width,re.height),t.texSubImage2D(3553,0,0,0,re.width,re.height,Ne,He,re.data)):t.texImage2D(3553,0,Ie,re.width,re.height,0,Ne,He,re.data);else if(O.isCompressedTexture){kt&&W&&t.texStorage2D(3553,De,Ie,gt[0].width,gt[0].height);for(let ae=0,Re=gt.length;ae<Re;ae++)nt=gt[ae],O.format!==Na?Ne!==null?kt?t.compressedTexSubImage2D(3553,ae,0,0,nt.width,nt.height,Ne,nt.data):t.compressedTexImage2D(3553,ae,Ie,nt.width,nt.height,0,nt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kt?t.texSubImage2D(3553,ae,0,0,nt.width,nt.height,Ne,He,nt.data):t.texImage2D(3553,ae,Ie,nt.width,nt.height,0,Ne,He,nt.data)}else if(O.isDataArrayTexture)kt?(W&&t.texStorage3D(35866,De,Ie,re.width,re.height,re.depth),t.texSubImage3D(35866,0,0,0,0,re.width,re.height,re.depth,Ne,He,re.data)):t.texImage3D(35866,0,Ie,re.width,re.height,re.depth,0,Ne,He,re.data);else if(O.isData3DTexture)kt?(W&&t.texStorage3D(32879,De,Ie,re.width,re.height,re.depth),t.texSubImage3D(32879,0,0,0,0,re.width,re.height,re.depth,Ne,He,re.data)):t.texImage3D(32879,0,Ie,re.width,re.height,re.depth,0,Ne,He,re.data);else if(O.isFramebufferTexture){if(W)if(kt)t.texStorage2D(3553,De,Ie,re.width,re.height);else{let ae=re.width,Re=re.height;for(let Me=0;Me<De;Me++)t.texImage2D(3553,Me,Ie,ae,Re,0,Ne,He,null),ae>>=1,Re>>=1}}else if(gt.length>0&&Fe){kt&&W&&t.texStorage2D(3553,De,Ie,gt[0].width,gt[0].height);for(let ae=0,Re=gt.length;ae<Re;ae++)nt=gt[ae],kt?t.texSubImage2D(3553,ae,0,0,Ne,He,nt):t.texImage2D(3553,ae,Ie,Ne,He,nt);O.generateMipmaps=!1}else kt?(W&&t.texStorage2D(3553,De,Ie,re.width,re.height),t.texSubImage2D(3553,0,0,0,Ne,He,re)):t.texImage2D(3553,0,Ie,Ne,He,re);L(O,Fe)&&R(ge),Pe.__currentVersion=Pe.version,O.onUpdate&&O.onUpdate(O)}k.__version=O.version}function Ve(k,O,ie){if(O.image.length!==6)return;const ge=tt(k,O),ye=O.source;if(t.activeTexture(33984+ie),t.bindTexture(34067,k.__webglTexture),ye.version!==ye.__currentVersion||ge===!0){n.pixelStorei(37440,O.flipY),n.pixelStorei(37441,O.premultiplyAlpha),n.pixelStorei(3317,O.unpackAlignment),n.pixelStorei(37443,0);const Pe=O.isCompressedTexture||O.image[0].isCompressedTexture,Xe=O.image[0]&&O.image[0].isDataTexture,re=[];for(let ae=0;ae<6;ae++)!Pe&&!Xe?re[ae]=M(O.image[ae],!1,!0,u):re[ae]=Xe?O.image[ae].image:O.image[ae],re[ae]=ve(O,re[ae]);const Fe=re[0],Ne=C(Fe)||a,He=o.convert(O.format,O.encoding),Ie=o.convert(O.type),nt=E(O.internalFormat,He,Ie,O.encoding),gt=a&&O.isVideoTexture!==!0,kt=ye.__currentVersion===void 0||ge===!0;let W=D(O,Fe,Ne);oe(34067,O,Ne);let De;if(Pe){gt&&kt&&t.texStorage2D(34067,W,nt,Fe.width,Fe.height);for(let ae=0;ae<6;ae++){De=re[ae].mipmaps;for(let Re=0;Re<De.length;Re++){const Me=De[Re];O.format!==Na?He!==null?gt?t.compressedTexSubImage2D(34069+ae,Re,0,0,Me.width,Me.height,He,Me.data):t.compressedTexImage2D(34069+ae,Re,nt,Me.width,Me.height,0,Me.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):gt?t.texSubImage2D(34069+ae,Re,0,0,Me.width,Me.height,He,Ie,Me.data):t.texImage2D(34069+ae,Re,nt,Me.width,Me.height,0,He,Ie,Me.data)}}}else{De=O.mipmaps,gt&&kt&&(De.length>0&&W++,t.texStorage2D(34067,W,nt,re[0].width,re[0].height));for(let ae=0;ae<6;ae++)if(Xe){gt?t.texSubImage2D(34069+ae,0,0,0,re[ae].width,re[ae].height,He,Ie,re[ae].data):t.texImage2D(34069+ae,0,nt,re[ae].width,re[ae].height,0,He,Ie,re[ae].data);for(let Re=0;Re<De.length;Re++){const Me=De[Re].image[ae].image;gt?t.texSubImage2D(34069+ae,Re+1,0,0,Me.width,Me.height,He,Ie,Me.data):t.texImage2D(34069+ae,Re+1,nt,Me.width,Me.height,0,He,Ie,Me.data)}}else{gt?t.texSubImage2D(34069+ae,0,0,0,He,Ie,re[ae]):t.texImage2D(34069+ae,0,nt,He,Ie,re[ae]);for(let Re=0;Re<De.length;Re++){const Me=De[Re];gt?t.texSubImage2D(34069+ae,Re+1,0,0,He,Ie,Me.image[ae]):t.texImage2D(34069+ae,Re+1,nt,He,Ie,Me.image[ae])}}}L(O,Ne)&&R(34067),ye.__currentVersion=ye.version,O.onUpdate&&O.onUpdate(O)}k.__version=O.version}function Ae(k,O,ie,ge,ye){const Pe=o.convert(ie.format,ie.encoding),Xe=o.convert(ie.type),re=E(ie.internalFormat,Pe,Xe,ie.encoding);i.get(O).__hasExternalTextures||(ye===32879||ye===35866?t.texImage3D(ye,0,re,O.width,O.height,O.depth,0,Pe,Xe,null):t.texImage2D(ye,0,re,O.width,O.height,0,Pe,Xe,null)),t.bindFramebuffer(36160,k),st(O)?p.framebufferTexture2DMultisampleEXT(36160,ge,ye,i.get(ie).__webglTexture,0,yt(O)):n.framebufferTexture2D(36160,ge,ye,i.get(ie).__webglTexture,0),t.bindFramebuffer(36160,null)}function Oe(k,O,ie){if(n.bindRenderbuffer(36161,k),O.depthBuffer&&!O.stencilBuffer){let ge=33189;if(ie||st(O)){const ye=O.depthTexture;ye&&ye.isDepthTexture&&(ye.type===Ia?ge=36012:ye.type===sp&&(ge=33190));const Pe=yt(O);st(O)?p.renderbufferStorageMultisampleEXT(36161,Pe,ge,O.width,O.height):n.renderbufferStorageMultisample(36161,Pe,ge,O.width,O.height)}else n.renderbufferStorage(36161,ge,O.width,O.height);n.framebufferRenderbuffer(36160,36096,36161,k)}else if(O.depthBuffer&&O.stencilBuffer){const ge=yt(O);ie&&st(O)===!1?n.renderbufferStorageMultisample(36161,ge,35056,O.width,O.height):st(O)?p.renderbufferStorageMultisampleEXT(36161,ge,35056,O.width,O.height):n.renderbufferStorage(36161,34041,O.width,O.height),n.framebufferRenderbuffer(36160,33306,36161,k)}else{const ge=O.isWebGLMultipleRenderTargets===!0?O.texture:[O.texture];for(let ye=0;ye<ge.length;ye++){const Pe=ge[ye],Xe=o.convert(Pe.format,Pe.encoding),re=o.convert(Pe.type),Fe=E(Pe.internalFormat,Xe,re,Pe.encoding),Ne=yt(O);ie&&st(O)===!1?n.renderbufferStorageMultisample(36161,Ne,Fe,O.width,O.height):st(O)?p.renderbufferStorageMultisampleEXT(36161,Ne,Fe,O.width,O.height):n.renderbufferStorage(36161,Fe,O.width,O.height)}}n.bindRenderbuffer(36161,null)}function Te(k,O){if(O&&O.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,k),!(O.depthTexture&&O.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(O.depthTexture).__webglTexture||O.depthTexture.image.width!==O.width||O.depthTexture.image.height!==O.height)&&(O.depthTexture.image.width=O.width,O.depthTexture.image.height=O.height,O.depthTexture.needsUpdate=!0),U(O.depthTexture,0);const ie=i.get(O.depthTexture).__webglTexture,ge=yt(O);if(O.depthTexture.format===fp)st(O)?p.framebufferTexture2DMultisampleEXT(36160,36096,3553,ie,0,ge):n.framebufferTexture2D(36160,36096,3553,ie,0);else if(O.depthTexture.format===Nv)st(O)?p.framebufferTexture2DMultisampleEXT(36160,33306,3553,ie,0,ge):n.framebufferTexture2D(36160,33306,3553,ie,0);else throw new Error("Unknown depthTexture format")}function be(k){const O=i.get(k),ie=k.isWebGLCubeRenderTarget===!0;if(k.depthTexture&&!O.__autoAllocateDepthBuffer){if(ie)throw new Error("target.depthTexture not supported in Cube render targets");Te(O.__webglFramebuffer,k)}else if(ie){O.__webglDepthbuffer=[];for(let ge=0;ge<6;ge++)t.bindFramebuffer(36160,O.__webglFramebuffer[ge]),O.__webglDepthbuffer[ge]=n.createRenderbuffer(),Oe(O.__webglDepthbuffer[ge],k,!1)}else t.bindFramebuffer(36160,O.__webglFramebuffer),O.__webglDepthbuffer=n.createRenderbuffer(),Oe(O.__webglDepthbuffer,k,!1);t.bindFramebuffer(36160,null)}function Ye(k,O,ie){const ge=i.get(k);O!==void 0&&Ae(ge.__webglFramebuffer,k,k.texture,36064,3553),ie!==void 0&&be(k)}function Ke(k){const O=k.texture,ie=i.get(k),ge=i.get(O);k.addEventListener("dispose",te),k.isWebGLMultipleRenderTargets!==!0&&(ge.__webglTexture===void 0&&(ge.__webglTexture=n.createTexture()),ge.__version=O.version,s.memory.textures++);const ye=k.isWebGLCubeRenderTarget===!0,Pe=k.isWebGLMultipleRenderTargets===!0,Xe=C(k)||a;if(ye){ie.__webglFramebuffer=[];for(let re=0;re<6;re++)ie.__webglFramebuffer[re]=n.createFramebuffer()}else{if(ie.__webglFramebuffer=n.createFramebuffer(),Pe)if(r.drawBuffers){const re=k.texture;for(let Fe=0,Ne=re.length;Fe<Ne;Fe++){const He=i.get(re[Fe]);He.__webglTexture===void 0&&(He.__webglTexture=n.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&k.samples>0&&st(k)===!1){const re=Pe?O:[O];ie.__webglMultisampledFramebuffer=n.createFramebuffer(),ie.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,ie.__webglMultisampledFramebuffer);for(let Fe=0;Fe<re.length;Fe++){const Ne=re[Fe];ie.__webglColorRenderbuffer[Fe]=n.createRenderbuffer(),n.bindRenderbuffer(36161,ie.__webglColorRenderbuffer[Fe]);const He=o.convert(Ne.format,Ne.encoding),Ie=o.convert(Ne.type),nt=E(Ne.internalFormat,He,Ie,Ne.encoding),gt=yt(k);n.renderbufferStorageMultisample(36161,gt,nt,k.width,k.height),n.framebufferRenderbuffer(36160,36064+Fe,36161,ie.__webglColorRenderbuffer[Fe])}n.bindRenderbuffer(36161,null),k.depthBuffer&&(ie.__webglDepthRenderbuffer=n.createRenderbuffer(),Oe(ie.__webglDepthRenderbuffer,k,!0)),t.bindFramebuffer(36160,null)}}if(ye){t.bindTexture(34067,ge.__webglTexture),oe(34067,O,Xe);for(let re=0;re<6;re++)Ae(ie.__webglFramebuffer[re],k,O,36064,34069+re);L(O,Xe)&&R(34067),t.unbindTexture()}else if(Pe){const re=k.texture;for(let Fe=0,Ne=re.length;Fe<Ne;Fe++){const He=re[Fe],Ie=i.get(He);t.bindTexture(3553,Ie.__webglTexture),oe(3553,He,Xe),Ae(ie.__webglFramebuffer,k,He,36064+Fe,3553),L(He,Xe)&&R(3553)}t.unbindTexture()}else{let re=3553;(k.isWebGL3DRenderTarget||k.isWebGLArrayRenderTarget)&&(a?re=k.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(re,ge.__webglTexture),oe(re,O,Xe),Ae(ie.__webglFramebuffer,k,O,36064,re),L(O,Xe)&&R(re),t.unbindTexture()}k.depthBuffer&&be(k)}function ft(k){const O=C(k)||a,ie=k.isWebGLMultipleRenderTargets===!0?k.texture:[k.texture];for(let ge=0,ye=ie.length;ge<ye;ge++){const Pe=ie[ge];if(L(Pe,O)){const Xe=k.isWebGLCubeRenderTarget?34067:3553,re=i.get(Pe).__webglTexture;t.bindTexture(Xe,re),R(Xe),t.unbindTexture()}}}function mt(k){if(a&&k.samples>0&&st(k)===!1){const O=k.isWebGLMultipleRenderTargets?k.texture:[k.texture],ie=k.width,ge=k.height;let ye=16384;const Pe=[],Xe=k.stencilBuffer?33306:36096,re=i.get(k),Fe=k.isWebGLMultipleRenderTargets===!0;if(Fe)for(let Ne=0;Ne<O.length;Ne++)t.bindFramebuffer(36160,re.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Ne,36161,null),t.bindFramebuffer(36160,re.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Ne,3553,null,0);t.bindFramebuffer(36008,re.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,re.__webglFramebuffer);for(let Ne=0;Ne<O.length;Ne++){Pe.push(36064+Ne),k.depthBuffer&&Pe.push(Xe);const He=re.__ignoreDepthValues!==void 0?re.__ignoreDepthValues:!1;if(He===!1&&(k.depthBuffer&&(ye|=256),k.stencilBuffer&&(ye|=1024)),Fe&&n.framebufferRenderbuffer(36008,36064,36161,re.__webglColorRenderbuffer[Ne]),He===!0&&(n.invalidateFramebuffer(36008,[Xe]),n.invalidateFramebuffer(36009,[Xe])),Fe){const Ie=i.get(O[Ne]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,Ie,0)}n.blitFramebuffer(0,0,ie,ge,0,0,ie,ge,ye,9728),m&&n.invalidateFramebuffer(36008,Pe)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),Fe)for(let Ne=0;Ne<O.length;Ne++){t.bindFramebuffer(36160,re.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Ne,36161,re.__webglColorRenderbuffer[Ne]);const He=i.get(O[Ne]).__webglTexture;t.bindFramebuffer(36160,re.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Ne,3553,He,0)}t.bindFramebuffer(36009,re.__webglMultisampledFramebuffer)}}function yt(k){return Math.min(h,k.samples)}function st(k){const O=i.get(k);return a&&k.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&O.__useRenderToTexture!==!1}function Ce(k){const O=s.render.frame;y.get(k)!==O&&(y.set(k,O),k.update())}function ve(k,O){const ie=k.encoding,ge=k.format,ye=k.type;return k.isCompressedTexture===!0||k.isVideoTexture===!0||k.format===JD||ie!==Ah&&(ie===xi?a===!1?e.has("EXT_sRGB")===!0&&ge===Na?(k.format=JD,k.minFilter=Hi,k.generateMipmaps=!1):O=nH.sRGBToLinear(O):(ge!==Na||ye!==Tp)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ie)),O}this.allocateTextureUnit=X,this.resetTextureUnits=de,this.setTexture2D=U,this.setTexture2DArray=le,this.setTexture3D=ne,this.setTextureCube=fe,this.rebindTextures=Ye,this.setupRenderTarget=Ke,this.updateRenderTargetMipmap=ft,this.updateMultisampleRenderTarget=mt,this.setupDepthRenderbuffer=be,this.setupFrameBufferTexture=Ae,this.useMultisampledRTT=st}function Ile(n,e,t){const i=t.isWebGL2;function r(o,s=null){let a;if(o===Tp)return 5121;if(o===xie)return 32819;if(o===bie)return 32820;if(o===gie)return 5120;if(o===_ie)return 5122;if(o===FO)return 5123;if(o===yie)return 5124;if(o===sp)return 5125;if(o===Ia)return 5126;if(o===Bu)return i?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(o===wie)return 6406;if(o===Na)return 6408;if(o===Mie)return 6409;if(o===Cie)return 6410;if(o===fp)return 6402;if(o===Nv)return 34041;if(o===Eie)return 6403;if(o===Sie)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(o===JD)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(o===Tie)return 36244;if(o===Pie)return 33319;if(o===Aie)return 33320;if(o===Lie)return 36249;if(o===TP||o===PP||o===AP||o===LP)if(s===xi)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(o===TP)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(o===PP)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(o===AP)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(o===LP)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(o===TP)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===PP)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===AP)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===LP)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===S6||o===M6||o===C6||o===E6)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(o===S6)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===M6)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===C6)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===E6)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===Die)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(o===T6||o===P6)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(o===T6)return s===xi?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(o===P6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(o===A6||o===L6||o===D6||o===R6||o===O6||o===k6||o===I6||o===N6||o===z6||o===V6||o===F6||o===B6||o===U6||o===j6)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(o===A6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(o===L6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(o===D6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(o===R6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(o===O6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(o===k6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(o===I6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(o===N6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(o===z6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(o===V6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(o===F6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(o===B6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(o===U6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(o===j6)return s===xi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(o===H6)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(o===H6)return s===xi?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return o===nv?i?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[o]!==void 0?n[o]:null}return{convert:r}}class Nle extends or{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Ys extends An{constructor(){super(),this.isGroup=!0,this.type="Group"}}const zle={type:"move"};class oA{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ys,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ys,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new K,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new K),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ys,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new K,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new K),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,o=null,s=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){s=!0;for(const _ of e.hand.values()){const g=t.getJointPose(_,i);if(u.joints[_.jointName]===void 0){const w=new Ys;w.matrixAutoUpdate=!1,w.visible=!1,u.joints[_.jointName]=w,u.add(w)}const b=u.joints[_.jointName];g!==null&&(b.matrix.fromArray(g.transform.matrix),b.matrix.decompose(b.position,b.rotation,b.scale),b.jointRadius=g.radius),b.visible=g!==null}const c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],p=c.position.distanceTo(h.position),m=.02,y=.005;u.inputState.pinching&&p>m+y?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&p<=m-y&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),o!==null&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&o!==null&&(r=o),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(zle)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=o!==null),u!==null&&(u.visible=s!==null),this}}class mH extends so{constructor(e,t,i,r,o,s,a,l,u,c){if(c=c!==void 0?c:fp,c!==fp&&c!==Nv)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&c===fp&&(i=sp),i===void 0&&c===Nv&&(i=nv),super(null,r,o,s,a,l,c,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Mi,this.minFilter=l!==void 0?l:Mi,this.flipY=!1,this.generateMipmaps=!1}}class Vle extends jp{constructor(e,t){super();const i=this;let r=null,o=1,s=null,a="local-floor",l=null,u=null,c=null,h=null,p=null,m=null;const y=t.getContextAttributes();let _=null,g=null;const b=[],w=[],M=new or;M.layers.enable(1),M.viewport=new _n;const C=new or;C.layers.enable(2),C.viewport=new _n;const P=[M,C],L=new Nle;L.layers.enable(1),L.layers.enable(2);let R=null,E=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(B){let U=b[B];return U===void 0&&(U=new oA,b[B]=U),U.getTargetRaySpace()},this.getControllerGrip=function(B){let U=b[B];return U===void 0&&(U=new oA,b[B]=U),U.getGripSpace()},this.getHand=function(B){let U=b[B];return U===void 0&&(U=new oA,b[B]=U),U.getHandSpace()};function D(B){const U=w.indexOf(B.inputSource);if(U===-1)return;const le=b[U];le!==void 0&&le.dispatchEvent({type:B.type,data:B.inputSource})}function N(){r.removeEventListener("select",D),r.removeEventListener("selectstart",D),r.removeEventListener("selectend",D),r.removeEventListener("squeeze",D),r.removeEventListener("squeezestart",D),r.removeEventListener("squeezeend",D),r.removeEventListener("end",N),r.removeEventListener("inputsourceschange",j);for(let B=0;B<b.length;B++){const U=w[B];U!==null&&(w[B]=null,b[B].disconnect(U))}R=null,E=null,e.setRenderTarget(_),p=null,h=null,c=null,r=null,g=null,X.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(B){o=B,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(B){a=B,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(B){l=B},this.getBaseLayer=function(){return h!==null?h:p},this.getBinding=function(){return c},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=async function(B){if(r=B,r!==null){if(_=e.getRenderTarget(),r.addEventListener("select",D),r.addEventListener("selectstart",D),r.addEventListener("selectend",D),r.addEventListener("squeeze",D),r.addEventListener("squeezestart",D),r.addEventListener("squeezeend",D),r.addEventListener("end",N),r.addEventListener("inputsourceschange",j),y.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const U={antialias:r.renderState.layers===void 0?y.antialias:!0,alpha:y.alpha,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:o};p=new XRWebGLLayer(r,t,U),r.updateRenderState({baseLayer:p}),g=new Qn(p.framebufferWidth,p.framebufferHeight,{format:Na,type:Tp,encoding:e.outputEncoding})}else{let U=null,le=null,ne=null;y.depth&&(ne=y.stencil?35056:33190,U=y.stencil?Nv:fp,le=y.stencil?nv:sp);const fe={colorFormat:32856,depthFormat:ne,scaleFactor:o};c=new XRWebGLBinding(r,t),h=c.createProjectionLayer(fe),r.updateRenderState({layers:[h]}),g=new Qn(h.textureWidth,h.textureHeight,{format:Na,type:Tp,depthTexture:new mH(h.textureWidth,h.textureHeight,le,void 0,void 0,void 0,void 0,void 0,void 0,U),stencilBuffer:y.stencil,encoding:e.outputEncoding,samples:y.antialias?4:0});const we=e.properties.get(g);we.__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(1),l=null,s=await r.requestReferenceSpace(a),X.setContext(r),X.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function j(B){for(let U=0;U<B.removed.length;U++){const le=B.removed[U],ne=w.indexOf(le);ne>=0&&(w[ne]=null,b[ne].dispatchEvent({type:"disconnected",data:le}))}for(let U=0;U<B.added.length;U++){const le=B.added[U];let ne=w.indexOf(le);if(ne===-1){for(let we=0;we<b.length;we++)if(we>=w.length){w.push(le),ne=we;break}else if(w[we]===null){w[we]=le,ne=we;break}if(ne===-1)break}const fe=b[ne];fe&&fe.dispatchEvent({type:"connected",data:le})}}const te=new K,ee=new K;function H(B,U,le){te.setFromMatrixPosition(U.matrixWorld),ee.setFromMatrixPosition(le.matrixWorld);const ne=te.distanceTo(ee),fe=U.projectionMatrix.elements,we=le.projectionMatrix.elements,Be=fe[14]/(fe[10]-1),oe=fe[14]/(fe[10]+1),tt=(fe[9]+1)/fe[5],Ue=(fe[9]-1)/fe[5],Ve=(fe[8]-1)/fe[0],Ae=(we[8]+1)/we[0],Oe=Be*Ve,Te=Be*Ae,be=ne/(-Ve+Ae),Ye=be*-Ve;U.matrixWorld.decompose(B.position,B.quaternion,B.scale),B.translateX(Ye),B.translateZ(be),B.matrixWorld.compose(B.position,B.quaternion,B.scale),B.matrixWorldInverse.copy(B.matrixWorld).invert();const Ke=Be+be,ft=oe+be,mt=Oe-Ye,yt=Te+(ne-Ye),st=tt*oe/ft*Ke,Ce=Ue*oe/ft*Ke;B.projectionMatrix.makePerspective(mt,yt,st,Ce,Ke,ft)}function Q(B,U){U===null?B.matrixWorld.copy(B.matrix):B.matrixWorld.multiplyMatrices(U.matrixWorld,B.matrix),B.matrixWorldInverse.copy(B.matrixWorld).invert()}this.updateCamera=function(B){if(r===null)return;L.near=C.near=M.near=B.near,L.far=C.far=M.far=B.far,(R!==L.near||E!==L.far)&&(r.updateRenderState({depthNear:L.near,depthFar:L.far}),R=L.near,E=L.far);const U=B.parent,le=L.cameras;Q(L,U);for(let fe=0;fe<le.length;fe++)Q(le[fe],U);L.matrixWorld.decompose(L.position,L.quaternion,L.scale),B.position.copy(L.position),B.quaternion.copy(L.quaternion),B.scale.copy(L.scale),B.matrix.copy(L.matrix),B.matrixWorld.copy(L.matrixWorld);const ne=B.children;for(let fe=0,we=ne.length;fe<we;fe++)ne[fe].updateMatrixWorld(!0);le.length===2?H(L,M,C):L.projectionMatrix.copy(M.projectionMatrix)},this.getCamera=function(){return L},this.getFoveation=function(){if(h!==null)return h.fixedFoveation;if(p!==null)return p.fixedFoveation},this.setFoveation=function(B){h!==null&&(h.fixedFoveation=B),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=B)};let Z=null;function de(B,U){if(u=U.getViewerPose(l||s),m=U,u!==null){const le=u.views;p!==null&&(e.setRenderTargetFramebuffer(g,p.framebuffer),e.setRenderTarget(g));let ne=!1;le.length!==L.cameras.length&&(L.cameras.length=0,ne=!0);for(let fe=0;fe<le.length;fe++){const we=le[fe];let Be=null;if(p!==null)Be=p.getViewport(we);else{const tt=c.getViewSubImage(h,we);Be=tt.viewport,fe===0&&(e.setRenderTargetTextures(g,tt.colorTexture,h.ignoreDepthValues?void 0:tt.depthStencilTexture),e.setRenderTarget(g))}let oe=P[fe];oe===void 0&&(oe=new or,oe.layers.enable(fe),oe.viewport=new _n,P[fe]=oe),oe.matrix.fromArray(we.transform.matrix),oe.projectionMatrix.fromArray(we.projectionMatrix),oe.viewport.set(Be.x,Be.y,Be.width,Be.height),fe===0&&L.matrix.copy(oe.matrix),ne===!0&&L.cameras.push(oe)}}for(let le=0;le<b.length;le++){const ne=w[le],fe=b[le];ne!==null&&fe!==void 0&&fe.update(ne,U,l||s)}Z&&Z(B,U),m=null}const X=new uH;X.setAnimationLoop(de),this.setAnimationLoop=function(B){Z=B},this.dispose=function(){}}}function Fle(n,e){function t(_,g){_.fogColor.value.copy(g.color),g.isFog?(_.fogNear.value=g.near,_.fogFar.value=g.far):g.isFogExp2&&(_.fogDensity.value=g.density)}function i(_,g,b,w,M){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(_,g):g.isMeshToonMaterial?(r(_,g),c(_,g)):g.isMeshPhongMaterial?(r(_,g),u(_,g)):g.isMeshStandardMaterial?(r(_,g),h(_,g),g.isMeshPhysicalMaterial&&p(_,g,M)):g.isMeshMatcapMaterial?(r(_,g),m(_,g)):g.isMeshDepthMaterial?r(_,g):g.isMeshDistanceMaterial?(r(_,g),y(_,g)):g.isMeshNormalMaterial?r(_,g):g.isLineBasicMaterial?(o(_,g),g.isLineDashedMaterial&&s(_,g)):g.isPointsMaterial?a(_,g,b,w):g.isSpriteMaterial?l(_,g):g.isShadowMaterial?(_.color.value.copy(g.color),_.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function r(_,g){_.opacity.value=g.opacity,g.color&&_.diffuse.value.copy(g.color),g.emissive&&_.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Zo&&(_.bumpScale.value*=-1)),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias),g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Zo&&_.normalScale.value.negate()),g.specularMap&&(_.specularMap.value=g.specularMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);const b=e.get(g).envMap;if(b&&(_.envMap.value=b,_.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=g.reflectivity,_.ior.value=g.ior,_.refractionRatio.value=g.refractionRatio),g.lightMap){_.lightMap.value=g.lightMap;const C=n.physicallyCorrectLights!==!0?Math.PI:1;_.lightMapIntensity.value=g.lightMapIntensity*C}g.aoMap&&(_.aoMap.value=g.aoMap,_.aoMapIntensity.value=g.aoMapIntensity);let w;g.map?w=g.map:g.specularMap?w=g.specularMap:g.displacementMap?w=g.displacementMap:g.normalMap?w=g.normalMap:g.bumpMap?w=g.bumpMap:g.roughnessMap?w=g.roughnessMap:g.metalnessMap?w=g.metalnessMap:g.alphaMap?w=g.alphaMap:g.emissiveMap?w=g.emissiveMap:g.clearcoatMap?w=g.clearcoatMap:g.clearcoatNormalMap?w=g.clearcoatNormalMap:g.clearcoatRoughnessMap?w=g.clearcoatRoughnessMap:g.iridescenceMap?w=g.iridescenceMap:g.iridescenceThicknessMap?w=g.iridescenceThicknessMap:g.specularIntensityMap?w=g.specularIntensityMap:g.specularColorMap?w=g.specularColorMap:g.transmissionMap?w=g.transmissionMap:g.thicknessMap?w=g.thicknessMap:g.sheenColorMap?w=g.sheenColorMap:g.sheenRoughnessMap&&(w=g.sheenRoughnessMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),_.uvTransform.value.copy(w.matrix));let M;g.aoMap?M=g.aoMap:g.lightMap&&(M=g.lightMap),M!==void 0&&(M.isWebGLRenderTarget&&(M=M.texture),M.matrixAutoUpdate===!0&&M.updateMatrix(),_.uv2Transform.value.copy(M.matrix))}function o(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity}function s(_,g){_.dashSize.value=g.dashSize,_.totalSize.value=g.dashSize+g.gapSize,_.scale.value=g.scale}function a(_,g,b,w){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.size.value=g.size*b,_.scale.value=w*.5,g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);let M;g.map?M=g.map:g.alphaMap&&(M=g.alphaMap),M!==void 0&&(M.matrixAutoUpdate===!0&&M.updateMatrix(),_.uvTransform.value.copy(M.matrix))}function l(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.rotation.value=g.rotation,g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);let b;g.map?b=g.map:g.alphaMap&&(b=g.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),_.uvTransform.value.copy(b.matrix))}function u(_,g){_.specular.value.copy(g.specular),_.shininess.value=Math.max(g.shininess,1e-4)}function c(_,g){g.gradientMap&&(_.gradientMap.value=g.gradientMap)}function h(_,g){_.roughness.value=g.roughness,_.metalness.value=g.metalness,g.roughnessMap&&(_.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(_.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(_.envMapIntensity.value=g.envMapIntensity)}function p(_,g,b){_.ior.value=g.ior,g.sheen>0&&(_.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),_.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(_.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(_.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(_.clearcoat.value=g.clearcoat,_.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(_.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),_.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===Zo&&_.clearcoatNormalScale.value.negate())),g.iridescence>0&&(_.iridescence.value=g.iridescence,_.iridescenceIOR.value=g.iridescenceIOR,_.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(_.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(_.transmission.value=g.transmission,_.transmissionSamplerMap.value=b.texture,_.transmissionSamplerSize.value.set(b.width,b.height),g.transmissionMap&&(_.transmissionMap.value=g.transmissionMap),_.thickness.value=g.thickness,g.thicknessMap&&(_.thicknessMap.value=g.thicknessMap),_.attenuationDistance.value=g.attenuationDistance,_.attenuationColor.value.copy(g.attenuationColor)),_.specularIntensity.value=g.specularIntensity,_.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(_.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(_.specularColorMap.value=g.specularColorMap)}function m(_,g){g.matcap&&(_.matcap.value=g.matcap)}function y(_,g){_.referencePosition.value.copy(g.referencePosition),_.nearDistance.value=g.nearDistance,_.farDistance.value=g.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:i}}function Ble(n,e,t,i){let r={},o={},s=[];const a=t.isWebGL2?n.getParameter(35375):0;function l(w,M){const C=M.program;i.uniformBlockBinding(w,C)}function u(w,M){let C=r[w.id];C===void 0&&(y(w),C=c(w),r[w.id]=C,w.addEventListener("dispose",g));const P=M.program;i.updateUBOMapping(w,P);const L=e.render.frame;o[w.id]!==L&&(p(w),o[w.id]=L)}function c(w){const M=h();w.__bindingPointIndex=M;const C=n.createBuffer(),P=w.__size,L=w.usage;return n.bindBuffer(35345,C),n.bufferData(35345,P,L),n.bindBuffer(35345,null),n.bindBufferBase(35345,M,C),C}function h(){for(let w=0;w<a;w++)if(s.indexOf(w)===-1)return s.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(w){const M=r[w.id],C=w.uniforms,P=w.__cache;n.bindBuffer(35345,M);for(let L=0,R=C.length;L<R;L++){const E=C[L];if(m(E,L,P)===!0){const D=E.value,N=E.__offset;typeof D=="number"?(E.__data[0]=D,n.bufferSubData(35345,N,E.__data)):(E.value.isMatrix3?(E.__data[0]=E.value.elements[0],E.__data[1]=E.value.elements[1],E.__data[2]=E.value.elements[2],E.__data[3]=E.value.elements[0],E.__data[4]=E.value.elements[3],E.__data[5]=E.value.elements[4],E.__data[6]=E.value.elements[5],E.__data[7]=E.value.elements[0],E.__data[8]=E.value.elements[6],E.__data[9]=E.value.elements[7],E.__data[10]=E.value.elements[8],E.__data[11]=E.value.elements[0]):D.toArray(E.__data),n.bufferSubData(35345,N,E.__data))}}n.bindBuffer(35345,null)}function m(w,M,C){const P=w.value;if(C[M]===void 0)return typeof P=="number"?C[M]=P:C[M]=P.clone(),!0;if(typeof P=="number"){if(C[M]!==P)return C[M]=P,!0}else{const L=C[M];if(L.equals(P)===!1)return L.copy(P),!0}return!1}function y(w){const M=w.uniforms;let C=0;const P=16;let L=0;for(let R=0,E=M.length;R<E;R++){const D=M[R],N=_(D);if(D.__data=new Float32Array(N.storage/Float32Array.BYTES_PER_ELEMENT),D.__offset=C,R>0){L=C%P;const j=P-L;L!==0&&j-N.boundary<0&&(C+=P-L,D.__offset=C)}C+=N.storage}return L=C%P,L>0&&(C+=P-L),w.__size=C,w.__cache={},this}function _(w){const M=w.value,C={boundary:0,storage:0};return typeof M=="number"?(C.boundary=4,C.storage=4):M.isVector2?(C.boundary=8,C.storage=8):M.isVector3||M.isColor?(C.boundary=16,C.storage=12):M.isVector4?(C.boundary=16,C.storage=16):M.isMatrix3?(C.boundary=48,C.storage=48):M.isMatrix4?(C.boundary=64,C.storage=64):M.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",M),C}function g(w){const M=w.target;M.removeEventListener("dispose",g);const C=s.indexOf(M.__bindingPointIndex);s.splice(C,1),n.deleteBuffer(r[M.id]),delete r[M.id],delete o[M.id]}function b(){for(const w in r)n.deleteBuffer(r[w]);s=[],r={},o={}}return{bind:l,update:u,dispose:b}}function Ule(){const n=Ay("canvas");return n.style.display="block",n}function vH(n={}){this.isWebGLRenderer=!0;const e=n.canvas!==void 0?n.canvas:Ule(),t=n.context!==void 0?n.context:null,i=n.depth!==void 0?n.depth:!0,r=n.stencil!==void 0?n.stencil:!0,o=n.antialias!==void 0?n.antialias:!1,s=n.premultipliedAlpha!==void 0?n.premultipliedAlpha:!0,a=n.preserveDrawingBuffer!==void 0?n.preserveDrawingBuffer:!1,l=n.powerPreference!==void 0?n.powerPreference:"default",u=n.failIfMajorPerformanceCaveat!==void 0?n.failIfMajorPerformanceCaveat:!1;let c;t!==null?c=t.getContextAttributes().alpha:c=n.alpha!==void 0?n.alpha:!1;let h=null,p=null;const m=[],y=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ah,this.physicallyCorrectLights=!1,this.toneMapping=Cl,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const _=this;let g=!1,b=0,w=0,M=null,C=-1,P=null;const L=new _n,R=new _n;let E=null,D=e.width,N=e.height,j=1,te=null,ee=null;const H=new _n(0,0,D,N),Q=new _n(0,0,D,N);let Z=!1;const de=new DC;let X=!1,B=!1,U=null;const le=new Bt,ne=new ze,fe=new K,we={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Be(){return M===null?j:1}let oe=t;function tt(z,$){for(let se=0;se<z.length;se++){const J=z[se],he=e.getContext(J,$);if(he!==null)return he}return null}try{const z={alpha:!0,depth:i,stencil:r,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${VO}`),e.addEventListener("webglcontextlost",nt,!1),e.addEventListener("webglcontextrestored",gt,!1),e.addEventListener("webglcontextcreationerror",kt,!1),oe===null){const $=["webgl2","webgl","experimental-webgl"];if(_.isWebGL1Renderer===!0&&$.shift(),oe=tt($,z),oe===null)throw tt($)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}oe.getShaderPrecisionFormat===void 0&&(oe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(z){throw console.error("THREE.WebGLRenderer: "+z.message),z}let Ue,Ve,Ae,Oe,Te,be,Ye,Ke,ft,mt,yt,st,Ce,ve,k,O,ie,ge,ye,Pe,Xe,re,Fe,Ne;function He(){Ue=new $se(oe),Ve=new qse(oe,Ue,n),Ue.init(Ve),re=new Ile(oe,Ue,Ve),Ae=new Ole(oe,Ue,Ve),Oe=new nae,Te=new xle,be=new kle(oe,Ue,Ae,Te,Ve,re,Oe),Ye=new Kse(_),Ke=new Qse(_),ft=new fre(oe,Ve),Fe=new Gse(oe,Ue,ft,Ve),mt=new eae(oe,ft,Oe,Fe),yt=new sae(oe,mt,ft,Oe),ye=new oae(oe,Ve,be),O=new Yse(Te),st=new yle(_,Ye,Ke,Ue,Ve,Fe,O),Ce=new Fle(_,Te),ve=new wle,k=new Ple(Ue,Ve),ge=new Wse(_,Ye,Ae,yt,c,s),ie=new Rle(_,yt,Ve),Ne=new Ble(oe,Oe,Ve,Ae),Pe=new Xse(oe,Ue,Oe,Ve),Xe=new tae(oe,Ue,Oe,Ve),Oe.programs=st.programs,_.capabilities=Ve,_.extensions=Ue,_.properties=Te,_.renderLists=ve,_.shadowMap=ie,_.state=Ae,_.info=Oe}He();const Ie=new Vle(_,oe);this.xr=Ie,this.getContext=function(){return oe},this.getContextAttributes=function(){return oe.getContextAttributes()},this.forceContextLoss=function(){const z=Ue.get("WEBGL_lose_context");z&&z.loseContext()},this.forceContextRestore=function(){const z=Ue.get("WEBGL_lose_context");z&&z.restoreContext()},this.getPixelRatio=function(){return j},this.setPixelRatio=function(z){z!==void 0&&(j=z,this.setSize(D,N,!1))},this.getSize=function(z){return z.set(D,N)},this.setSize=function(z,$,se){if(Ie.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}D=z,N=$,e.width=Math.floor(z*j),e.height=Math.floor($*j),se!==!1&&(e.style.width=z+"px",e.style.height=$+"px"),this.setViewport(0,0,z,$)},this.getDrawingBufferSize=function(z){return z.set(D*j,N*j).floor()},this.setDrawingBufferSize=function(z,$,se){D=z,N=$,j=se,e.width=Math.floor(z*se),e.height=Math.floor($*se),this.setViewport(0,0,z,$)},this.getCurrentViewport=function(z){return z.copy(L)},this.getViewport=function(z){return z.copy(H)},this.setViewport=function(z,$,se,J){z.isVector4?H.set(z.x,z.y,z.z,z.w):H.set(z,$,se,J),Ae.viewport(L.copy(H).multiplyScalar(j).floor())},this.getScissor=function(z){return z.copy(Q)},this.setScissor=function(z,$,se,J){z.isVector4?Q.set(z.x,z.y,z.z,z.w):Q.set(z,$,se,J),Ae.scissor(R.copy(Q).multiplyScalar(j).floor())},this.getScissorTest=function(){return Z},this.setScissorTest=function(z){Ae.setScissorTest(Z=z)},this.setOpaqueSort=function(z){te=z},this.setTransparentSort=function(z){ee=z},this.getClearColor=function(z){return z.copy(ge.getClearColor())},this.setClearColor=function(){ge.setClearColor.apply(ge,arguments)},this.getClearAlpha=function(){return ge.getClearAlpha()},this.setClearAlpha=function(){ge.setClearAlpha.apply(ge,arguments)},this.clear=function(z=!0,$=!0,se=!0){let J=0;z&&(J|=16384),$&&(J|=256),se&&(J|=1024),oe.clear(J)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",nt,!1),e.removeEventListener("webglcontextrestored",gt,!1),e.removeEventListener("webglcontextcreationerror",kt,!1),ve.dispose(),k.dispose(),Te.dispose(),Ye.dispose(),Ke.dispose(),yt.dispose(),Fe.dispose(),Ne.dispose(),st.dispose(),Ie.dispose(),Ie.removeEventListener("sessionstart",bt),Ie.removeEventListener("sessionend",It),U&&(U.dispose(),U=null),zt.stop()};function nt(z){z.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function gt(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const z=Oe.autoReset,$=ie.enabled,se=ie.autoUpdate,J=ie.needsUpdate,he=ie.type;He(),Oe.autoReset=z,ie.enabled=$,ie.autoUpdate=se,ie.needsUpdate=J,ie.type=he}function kt(z){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",z.statusMessage)}function W(z){const $=z.target;$.removeEventListener("dispose",W),De($)}function De(z){ae(z),Te.remove(z)}function ae(z){const $=Te.get(z).programs;$!==void 0&&($.forEach(function(se){st.releaseProgram(se)}),z.isShaderMaterial&&st.releaseShaderCache(z))}this.renderBufferDirect=function(z,$,se,J,he,Ge){$===null&&($=we);const et=he.isMesh&&he.matrixWorld.determinant()<0,$e=Qh(z,$,se,J,he);Ae.setMaterial(J,et);let rt=se.index;const Ct=se.attributes.position;if(rt===null){if(Ct===void 0||Ct.count===0)return}else if(rt.count===0)return;let ct=1;J.wireframe===!0&&(rt=mt.getWireframeAttribute(se),ct=2),Fe.setup(he,J,$e,se,rt);let ht,Ft=Pe;rt!==null&&(ht=ft.get(rt),Ft=Xe,Ft.setIndex(ht));const Ki=rt!==null?rt.count:Ct.count,Pi=se.drawRange.start*ct,ti=se.drawRange.count*ct,vn=Ge!==null?Ge.start*ct:0,wt=Ge!==null?Ge.count*ct:1/0,Ar=Math.max(Pi,vn),xn=Math.min(Ki,Pi+ti,vn+wt)-1,bn=Math.max(0,xn-Ar+1);if(bn!==0){if(he.isMesh)J.wireframe===!0?(Ae.setLineWidth(J.wireframeLinewidth*Be()),Ft.setMode(1)):Ft.setMode(4);else if(he.isLine){let ii=J.linewidth;ii===void 0&&(ii=1),Ae.setLineWidth(ii*Be()),he.isLineSegments?Ft.setMode(1):he.isLineLoop?Ft.setMode(2):Ft.setMode(3)}else he.isPoints?Ft.setMode(0):he.isSprite&&Ft.setMode(4);if(he.isInstancedMesh)Ft.renderInstances(Ar,bn,he.count);else if(se.isInstancedBufferGeometry){const ii=Math.min(se.instanceCount,se._maxInstanceCount);Ft.renderInstances(Ar,bn,ii)}else Ft.render(Ar,bn)}},this.compile=function(z,$){p=k.get(z),p.init(),y.push(p),z.traverseVisible(function(se){se.isLight&&se.layers.test($.layers)&&(p.pushLight(se),se.castShadow&&p.pushShadow(se))}),p.setupLights(_.physicallyCorrectLights),z.traverse(function(se){const J=se.material;if(J)if(Array.isArray(J))for(let he=0;he<J.length;he++){const Ge=J[he];Ds(Ge,z,se)}else Ds(J,z,se)}),y.pop(),p=null};let Re=null;function Me(z){Re&&Re(z)}function bt(){zt.stop()}function It(){zt.start()}const zt=new uH;zt.setAnimationLoop(Me),typeof self<"u"&&zt.setContext(self),this.setAnimationLoop=function(z){Re=z,Ie.setAnimationLoop(z),z===null?zt.stop():zt.start()},Ie.addEventListener("sessionstart",bt),Ie.addEventListener("sessionend",It),this.render=function(z,$){if($!==void 0&&$.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;z.autoUpdate===!0&&z.updateMatrixWorld(),$.parent===null&&$.updateMatrixWorld(),Ie.enabled===!0&&Ie.isPresenting===!0&&(Ie.cameraAutoUpdate===!0&&Ie.updateCamera($),$=Ie.getCamera()),z.isScene===!0&&z.onBeforeRender(_,z,$,M),p=k.get(z,y.length),p.init(),y.push(p),le.multiplyMatrices($.projectionMatrix,$.matrixWorldInverse),de.setFromProjectionMatrix(le),B=this.localClippingEnabled,X=O.init(this.clippingPlanes,B,$),h=ve.get(z,m.length),h.init(),m.push(h),Kn(z,$,0,_.sortObjects),h.finish(),_.sortObjects===!0&&h.sort(te,ee),X===!0&&O.beginShadows();const se=p.state.shadowsArray;if(ie.render(se,z,$),X===!0&&O.endShadows(),this.info.autoReset===!0&&this.info.reset(),ge.render(h,z),p.setupLights(_.physicallyCorrectLights),$.isArrayCamera){const J=$.cameras;for(let he=0,Ge=J.length;he<Ge;he++){const et=J[he];Dt(h,z,et,et.viewport)}}else Dt(h,z,$);M!==null&&(be.updateMultisampleRenderTarget(M),be.updateRenderTargetMipmap(M)),z.isScene===!0&&z.onAfterRender(_,z,$),Fe.resetDefaultState(),C=-1,P=null,y.pop(),y.length>0?p=y[y.length-1]:p=null,m.pop(),m.length>0?h=m[m.length-1]:h=null};function Kn(z,$,se,J){if(z.visible===!1)return;if(z.layers.test($.layers)){if(z.isGroup)se=z.renderOrder;else if(z.isLOD)z.autoUpdate===!0&&z.update($);else if(z.isLight)p.pushLight(z),z.castShadow&&p.pushShadow(z);else if(z.isSprite){if(!z.frustumCulled||de.intersectsSprite(z)){J&&fe.setFromMatrixPosition(z.matrixWorld).applyMatrix4(le);const Ge=yt.update(z),et=z.material;et.visible&&h.push(z,Ge,et,se,fe.z,null)}}else if((z.isMesh||z.isLine||z.isPoints)&&(z.isSkinnedMesh&&z.skeleton.frame!==Oe.render.frame&&(z.skeleton.update(),z.skeleton.frame=Oe.render.frame),!z.frustumCulled||de.intersectsObject(z))){J&&fe.setFromMatrixPosition(z.matrixWorld).applyMatrix4(le);const Ge=yt.update(z),et=z.material;if(Array.isArray(et)){const $e=Ge.groups;for(let rt=0,Ct=$e.length;rt<Ct;rt++){const ct=$e[rt],ht=et[ct.materialIndex];ht&&ht.visible&&h.push(z,Ge,ht,se,fe.z,ct)}}else et.visible&&h.push(z,Ge,et,se,fe.z,null)}}const he=z.children;for(let Ge=0,et=he.length;Ge<et;Ge++)Kn(he[Ge],$,se,J)}function Dt(z,$,se,J){const he=z.opaque,Ge=z.transmissive,et=z.transparent;p.setupLightsView(se),Ge.length>0&&Bn(he,$,se),J&&Ae.viewport(L.copy(J)),he.length>0&&yn(he,$,se),Ge.length>0&&yn(Ge,$,se),et.length>0&&yn(et,$,se),Ae.buffers.depth.setTest(!0),Ae.buffers.depth.setMask(!0),Ae.buffers.color.setMask(!0),Ae.setPolygonOffset(!1)}function Bn(z,$,se){const J=Ve.isWebGL2;U===null&&(U=new Qn(1,1,{generateMipmaps:!0,type:Ue.has("EXT_color_buffer_half_float")?Bu:Tp,minFilter:rx,samples:J&&o===!0?4:0})),_.getDrawingBufferSize(ne),J?U.setSize(ne.x,ne.y):U.setSize(v2(ne.x),v2(ne.y));const he=_.getRenderTarget();_.setRenderTarget(U),_.clear();const Ge=_.toneMapping;_.toneMapping=Cl,yn(z,$,se),_.toneMapping=Ge,be.updateMultisampleRenderTarget(U),be.updateRenderTargetMipmap(U),_.setRenderTarget(he)}function yn(z,$,se){const J=$.isScene===!0?$.overrideMaterial:null;for(let he=0,Ge=z.length;he<Ge;he++){const et=z[he],$e=et.object,rt=et.geometry,Ct=J===null?et.material:J,ct=et.group;$e.layers.test(se.layers)&&Hl($e,$,se,rt,Ct,ct)}}function Hl(z,$,se,J,he,Ge){z.onBeforeRender(_,$,se,J,he,Ge),z.modelViewMatrix.multiplyMatrices(se.matrixWorldInverse,z.matrixWorld),z.normalMatrix.getNormalMatrix(z.modelViewMatrix),he.onBeforeRender(_,$,se,J,z,Ge),he.transparent===!0&&he.side===Qu?(he.side=Zo,he.needsUpdate=!0,_.renderBufferDirect(se,$,J,he,z,Ge),he.side=Ep,he.needsUpdate=!0,_.renderBufferDirect(se,$,J,he,z,Ge),he.side=Qu):_.renderBufferDirect(se,$,J,he,z,Ge),z.onAfterRender(_,$,se,J,he,Ge)}function Ds(z,$,se){$.isScene!==!0&&($=we);const J=Te.get(z),he=p.state.lights,Ge=p.state.shadowsArray,et=he.state.version,$e=st.getParameters(z,he.state,Ge,$,se),rt=st.getProgramCacheKey($e);let Ct=J.programs;J.environment=z.isMeshStandardMaterial?$.environment:null,J.fog=$.fog,J.envMap=(z.isMeshStandardMaterial?Ke:Ye).get(z.envMap||J.environment),Ct===void 0&&(z.addEventListener("dispose",W),Ct=new Map,J.programs=Ct);let ct=Ct.get(rt);if(ct!==void 0){if(J.currentProgram===ct&&J.lightsStateVersion===et)return ra(z,$e),ct}else $e.uniforms=st.getUniforms(z),z.onBuild(se,$e,_),z.onBeforeCompile($e,_),ct=st.acquireProgram($e,rt),Ct.set(rt,ct),J.uniforms=$e.uniforms;const ht=J.uniforms;(!z.isShaderMaterial&&!z.isRawShaderMaterial||z.clipping===!0)&&(ht.clippingPlanes=O.uniform),ra(z,$e),J.needsLights=Gl(z),J.lightsStateVersion=et,J.needsLights&&(ht.ambientLightColor.value=he.state.ambient,ht.lightProbe.value=he.state.probe,ht.directionalLights.value=he.state.directional,ht.directionalLightShadows.value=he.state.directionalShadow,ht.spotLights.value=he.state.spot,ht.spotLightShadows.value=he.state.spotShadow,ht.rectAreaLights.value=he.state.rectArea,ht.ltc_1.value=he.state.rectAreaLTC1,ht.ltc_2.value=he.state.rectAreaLTC2,ht.pointLights.value=he.state.point,ht.pointLightShadows.value=he.state.pointShadow,ht.hemisphereLights.value=he.state.hemi,ht.directionalShadowMap.value=he.state.directionalShadowMap,ht.directionalShadowMatrix.value=he.state.directionalShadowMatrix,ht.spotShadowMap.value=he.state.spotShadowMap,ht.spotShadowMatrix.value=he.state.spotShadowMatrix,ht.pointShadowMap.value=he.state.pointShadowMap,ht.pointShadowMatrix.value=he.state.pointShadowMatrix);const Ft=ct.getUniforms(),Ki=fM.seqWithValue(Ft.seq,ht);return J.currentProgram=ct,J.uniformsList=Ki,ct}function ra(z,$){const se=Te.get(z);se.outputEncoding=$.outputEncoding,se.instancing=$.instancing,se.skinning=$.skinning,se.morphTargets=$.morphTargets,se.morphNormals=$.morphNormals,se.morphColors=$.morphColors,se.morphTargetsCount=$.morphTargetsCount,se.numClippingPlanes=$.numClippingPlanes,se.numIntersection=$.numClipIntersection,se.vertexAlphas=$.vertexAlphas,se.vertexTangents=$.vertexTangents,se.toneMapping=$.toneMapping}function Qh(z,$,se,J,he){$.isScene!==!0&&($=we),be.resetTextureUnits();const Ge=$.fog,et=J.isMeshStandardMaterial?$.environment:null,$e=M===null?_.outputEncoding:M.isXRRenderTarget===!0?M.texture.encoding:Ah,rt=(J.isMeshStandardMaterial?Ke:Ye).get(J.envMap||et),Ct=J.vertexColors===!0&&!!se.attributes.color&&se.attributes.color.itemSize===4,ct=!!J.normalMap&&!!se.attributes.tangent,ht=!!se.morphAttributes.position,Ft=!!se.morphAttributes.normal,Ki=!!se.morphAttributes.color,Pi=J.toneMapped?_.toneMapping:Cl,ti=se.morphAttributes.position||se.morphAttributes.normal||se.morphAttributes.color,vn=ti!==void 0?ti.length:0,wt=Te.get(J),Ar=p.state.lights;if(X===!0&&(B===!0||z!==P)){const fn=z===P&&J.id===C;O.setState(J,z,fn)}let xn=!1;J.version===wt.__version?(wt.needsLights&&wt.lightsStateVersion!==Ar.state.version||wt.outputEncoding!==$e||he.isInstancedMesh&&wt.instancing===!1||!he.isInstancedMesh&&wt.instancing===!0||he.isSkinnedMesh&&wt.skinning===!1||!he.isSkinnedMesh&&wt.skinning===!0||wt.envMap!==rt||J.fog===!0&&wt.fog!==Ge||wt.numClippingPlanes!==void 0&&(wt.numClippingPlanes!==O.numPlanes||wt.numIntersection!==O.numIntersection)||wt.vertexAlphas!==Ct||wt.vertexTangents!==ct||wt.morphTargets!==ht||wt.morphNormals!==Ft||wt.morphColors!==Ki||wt.toneMapping!==Pi||Ve.isWebGL2===!0&&wt.morphTargetsCount!==vn)&&(xn=!0):(xn=!0,wt.__version=J.version);let bn=wt.currentProgram;xn===!0&&(bn=Ds(J,$,he));let ii=!1,Lr=!1,oa=!1;const Qt=bn.getUniforms(),Dr=wt.uniforms;if(Ae.useProgram(bn.program)&&(ii=!0,Lr=!0,oa=!0),J.id!==C&&(C=J.id,Lr=!0),ii||P!==z){if(Qt.setValue(oe,"projectionMatrix",z.projectionMatrix),Ve.logarithmicDepthBuffer&&Qt.setValue(oe,"logDepthBufFC",2/(Math.log(z.far+1)/Math.LN2)),P!==z&&(P=z,Lr=!0,oa=!0),J.isShaderMaterial||J.isMeshPhongMaterial||J.isMeshToonMaterial||J.isMeshStandardMaterial||J.envMap){const fn=Qt.map.cameraPosition;fn!==void 0&&fn.setValue(oe,fe.setFromMatrixPosition(z.matrixWorld))}(J.isMeshPhongMaterial||J.isMeshToonMaterial||J.isMeshLambertMaterial||J.isMeshBasicMaterial||J.isMeshStandardMaterial||J.isShaderMaterial)&&Qt.setValue(oe,"isOrthographic",z.isOrthographicCamera===!0),(J.isMeshPhongMaterial||J.isMeshToonMaterial||J.isMeshLambertMaterial||J.isMeshBasicMaterial||J.isMeshStandardMaterial||J.isShaderMaterial||J.isShadowMaterial||he.isSkinnedMesh)&&Qt.setValue(oe,"viewMatrix",z.matrixWorldInverse)}if(he.isSkinnedMesh){Qt.setOptional(oe,he,"bindMatrix"),Qt.setOptional(oe,he,"bindMatrixInverse");const fn=he.skeleton;fn&&(Ve.floatVertexTextures?(fn.boneTexture===null&&fn.computeBoneTexture(),Qt.setValue(oe,"boneTexture",fn.boneTexture,be),Qt.setValue(oe,"boneTextureSize",fn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Rs=se.morphAttributes;if((Rs.position!==void 0||Rs.normal!==void 0||Rs.color!==void 0&&Ve.isWebGL2===!0)&&ye.update(he,se,J,bn),(Lr||wt.receiveShadow!==he.receiveShadow)&&(wt.receiveShadow=he.receiveShadow,Qt.setValue(oe,"receiveShadow",he.receiveShadow)),Lr&&(Qt.setValue(oe,"toneMappingExposure",_.toneMappingExposure),wt.needsLights&&Wl(Dr,oa),Ge&&J.fog===!0&&Ce.refreshFogUniforms(Dr,Ge),Ce.refreshMaterialUniforms(Dr,J,j,N,U),fM.upload(oe,wt.uniformsList,Dr,be)),J.isShaderMaterial&&J.uniformsNeedUpdate===!0&&(fM.upload(oe,wt.uniformsList,Dr,be),J.uniformsNeedUpdate=!1),J.isSpriteMaterial&&Qt.setValue(oe,"center",he.center),Qt.setValue(oe,"modelViewMatrix",he.modelViewMatrix),Qt.setValue(oe,"normalMatrix",he.normalMatrix),Qt.setValue(oe,"modelMatrix",he.matrixWorld),J.isShaderMaterial||J.isRawShaderMaterial){const fn=J.uniformsGroups;for(let Os=0,dc=fn.length;Os<dc;Os++)if(Ve.isWebGL2){const sa=fn[Os];Ne.update(sa,bn),Ne.bind(sa,bn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return bn}function Wl(z,$){z.ambientLightColor.needsUpdate=$,z.lightProbe.needsUpdate=$,z.directionalLights.needsUpdate=$,z.directionalLightShadows.needsUpdate=$,z.pointLights.needsUpdate=$,z.pointLightShadows.needsUpdate=$,z.spotLights.needsUpdate=$,z.spotLightShadows.needsUpdate=$,z.rectAreaLights.needsUpdate=$,z.hemisphereLights.needsUpdate=$}function Gl(z){return z.isMeshLambertMaterial||z.isMeshToonMaterial||z.isMeshPhongMaterial||z.isMeshStandardMaterial||z.isShadowMaterial||z.isShaderMaterial&&z.lights===!0}this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return M},this.setRenderTargetTextures=function(z,$,se){Te.get(z.texture).__webglTexture=$,Te.get(z.depthTexture).__webglTexture=se;const J=Te.get(z);J.__hasExternalTextures=!0,J.__hasExternalTextures&&(J.__autoAllocateDepthBuffer=se===void 0,J.__autoAllocateDepthBuffer||Ue.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),J.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(z,$){const se=Te.get(z);se.__webglFramebuffer=$,se.__useDefaultFramebuffer=$===void 0},this.setRenderTarget=function(z,$=0,se=0){M=z,b=$,w=se;let J=!0;if(z){const $e=Te.get(z);$e.__useDefaultFramebuffer!==void 0?(Ae.bindFramebuffer(36160,null),J=!1):$e.__webglFramebuffer===void 0?be.setupRenderTarget(z):$e.__hasExternalTextures&&be.rebindTextures(z,Te.get(z.texture).__webglTexture,Te.get(z.depthTexture).__webglTexture)}let he=null,Ge=!1,et=!1;if(z){const $e=z.texture;($e.isData3DTexture||$e.isDataArrayTexture)&&(et=!0);const rt=Te.get(z).__webglFramebuffer;z.isWebGLCubeRenderTarget?(he=rt[$],Ge=!0):Ve.isWebGL2&&z.samples>0&&be.useMultisampledRTT(z)===!1?he=Te.get(z).__webglMultisampledFramebuffer:he=rt,L.copy(z.viewport),R.copy(z.scissor),E=z.scissorTest}else L.copy(H).multiplyScalar(j).floor(),R.copy(Q).multiplyScalar(j).floor(),E=Z;if(Ae.bindFramebuffer(36160,he)&&Ve.drawBuffers&&J&&Ae.drawBuffers(z,he),Ae.viewport(L),Ae.scissor(R),Ae.setScissorTest(E),Ge){const $e=Te.get(z.texture);oe.framebufferTexture2D(36160,36064,34069+$,$e.__webglTexture,se)}else if(et){const $e=Te.get(z.texture),rt=$||0;oe.framebufferTextureLayer(36160,36064,$e.__webglTexture,se||0,rt)}C=-1},this.readRenderTargetPixels=function(z,$,se,J,he,Ge,et){if(!(z&&z.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let $e=Te.get(z).__webglFramebuffer;if(z.isWebGLCubeRenderTarget&&et!==void 0&&($e=$e[et]),$e){Ae.bindFramebuffer(36160,$e);try{const rt=z.texture,Ct=rt.format,ct=rt.type;if(Ct!==Na&&re.convert(Ct)!==oe.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const ht=ct===Bu&&(Ue.has("EXT_color_buffer_half_float")||Ve.isWebGL2&&Ue.has("EXT_color_buffer_float"));if(ct!==Tp&&re.convert(ct)!==oe.getParameter(35738)&&!(ct===Ia&&(Ve.isWebGL2||Ue.has("OES_texture_float")||Ue.has("WEBGL_color_buffer_float")))&&!ht){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}$>=0&&$<=z.width-J&&se>=0&&se<=z.height-he&&oe.readPixels($,se,J,he,re.convert(Ct),re.convert(ct),Ge)}finally{const rt=M!==null?Te.get(M).__webglFramebuffer:null;Ae.bindFramebuffer(36160,rt)}}},this.copyFramebufferToTexture=function(z,$,se=0){const J=Math.pow(2,-se),he=Math.floor($.image.width*J),Ge=Math.floor($.image.height*J);be.setTexture2D($,0),oe.copyTexSubImage2D(3553,se,0,0,z.x,z.y,he,Ge),Ae.unbindTexture()},this.copyTextureToTexture=function(z,$,se,J=0){const he=$.image.width,Ge=$.image.height,et=re.convert(se.format),$e=re.convert(se.type);be.setTexture2D(se,0),oe.pixelStorei(37440,se.flipY),oe.pixelStorei(37441,se.premultiplyAlpha),oe.pixelStorei(3317,se.unpackAlignment),$.isDataTexture?oe.texSubImage2D(3553,J,z.x,z.y,he,Ge,et,$e,$.image.data):$.isCompressedTexture?oe.compressedTexSubImage2D(3553,J,z.x,z.y,$.mipmaps[0].width,$.mipmaps[0].height,et,$.mipmaps[0].data):oe.texSubImage2D(3553,J,z.x,z.y,et,$e,$.image),J===0&&se.generateMipmaps&&oe.generateMipmap(3553),Ae.unbindTexture()},this.copyTextureToTexture3D=function(z,$,se,J,he=0){if(_.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ge=z.max.x-z.min.x+1,et=z.max.y-z.min.y+1,$e=z.max.z-z.min.z+1,rt=re.convert(J.format),Ct=re.convert(J.type);let ct;if(J.isData3DTexture)be.setTexture3D(J,0),ct=32879;else if(J.isDataArrayTexture)be.setTexture2DArray(J,0),ct=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}oe.pixelStorei(37440,J.flipY),oe.pixelStorei(37441,J.premultiplyAlpha),oe.pixelStorei(3317,J.unpackAlignment);const ht=oe.getParameter(3314),Ft=oe.getParameter(32878),Ki=oe.getParameter(3316),Pi=oe.getParameter(3315),ti=oe.getParameter(32877),vn=se.isCompressedTexture?se.mipmaps[0]:se.image;oe.pixelStorei(3314,vn.width),oe.pixelStorei(32878,vn.height),oe.pixelStorei(3316,z.min.x),oe.pixelStorei(3315,z.min.y),oe.pixelStorei(32877,z.min.z),se.isDataTexture||se.isData3DTexture?oe.texSubImage3D(ct,he,$.x,$.y,$.z,Ge,et,$e,rt,Ct,vn.data):se.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),oe.compressedTexSubImage3D(ct,he,$.x,$.y,$.z,Ge,et,$e,rt,vn.data)):oe.texSubImage3D(ct,he,$.x,$.y,$.z,Ge,et,$e,rt,Ct,vn),oe.pixelStorei(3314,ht),oe.pixelStorei(32878,Ft),oe.pixelStorei(3316,Ki),oe.pixelStorei(3315,Pi),oe.pixelStorei(32877,ti),he===0&&J.generateMipmaps&&oe.generateMipmap(ct),Ae.unbindTexture()},this.initTexture=function(z){z.isCubeTexture?be.setTextureCube(z,0):z.isData3DTexture?be.setTexture3D(z,0):z.isDataArrayTexture?be.setTexture2DArray(z,0):be.setTexture2D(z,0),Ae.unbindTexture()},this.resetState=function(){b=0,w=0,M=null,Ae.reset(),Fe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class jle extends vH{}jle.prototype.isWebGL1Renderer=!0;class Hle extends An{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}}class Wle{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=ZD,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Js()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,o=this.stride;r<o;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Js()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Js()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const go=new K;class g2{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)go.fromBufferAttribute(this,t),go.applyMatrix4(e),this.setXYZ(t,go.x,go.y,go.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)go.fromBufferAttribute(this,t),go.applyNormalMatrix(e),this.setXYZ(t,go.x,go.y,go.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)go.fromBufferAttribute(this,t),go.transformDirection(e),this.setXYZ(t,go.x,go.y,go.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return new Co(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new g2(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class gH extends Vl{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new vt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Qf;const B0=new K,$f=new K,em=new K,tm=new ze,U0=new ze,_H=new Bt,mw=new K,j0=new K,vw=new K,Cz=new ze,sA=new ze,Ez=new ze;class Gle extends An{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",Qf===void 0){Qf=new ei;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Wle(t,5);Qf.setIndex([0,1,2,0,2,3]),Qf.setAttribute("position",new g2(i,3,0,!1)),Qf.setAttribute("uv",new g2(i,2,3,!1))}this.geometry=Qf,this.material=e!==void 0?e:new gH,this.center=new ze(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),$f.setFromMatrixScale(this.matrixWorld),_H.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),em.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&$f.multiplyScalar(-em.z);const i=this.material.rotation;let r,o;i!==0&&(o=Math.cos(i),r=Math.sin(i));const s=this.center;gw(mw.set(-.5,-.5,0),em,s,$f,r,o),gw(j0.set(.5,-.5,0),em,s,$f,r,o),gw(vw.set(.5,.5,0),em,s,$f,r,o),Cz.set(0,0),sA.set(1,0),Ez.set(1,1);let a=e.ray.intersectTriangle(mw,j0,vw,!1,B0);if(a===null&&(gw(j0.set(-.5,.5,0),em,s,$f,r,o),sA.set(0,1),a=e.ray.intersectTriangle(mw,vw,j0,!1,B0),a===null))return;const l=e.ray.origin.distanceTo(B0);l<e.near||l>e.far||t.push({distance:l,point:B0.clone(),uv:gs.getUV(B0,mw,j0,vw,Cz,sA,Ez,new ze),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function gw(n,e,t,i,r,o){tm.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(U0.x=o*tm.x-r*tm.y,U0.y=r*tm.x+o*tm.y):U0.copy(tm),n.copy(e),n.x+=U0.x,n.y+=U0.y,n.applyMatrix4(_H)}const Tz=new K,Pz=new _n,Az=new _n,Xle=new K,Lz=new Bt;class GDe extends Fr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Bt,this.bindMatrixInverse=new Bt}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new _n,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;Pz.fromBufferAttribute(r.attributes.skinIndex,e),Az.fromBufferAttribute(r.attributes.skinWeight,e),Tz.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const s=Az.getComponent(o);if(s!==0){const a=Pz.getComponent(o);Lz.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(Xle.copy(Tz).applyMatrix4(Lz),s)}}return t.applyMatrix4(this.bindMatrixInverse)}}class yH extends An{constructor(){super(),this.isBone=!0,this.type="Bone"}}class xH extends so{constructor(e=null,t=1,i=1,r,o,s,a,l,u=Mi,c=Mi,h,p){super(null,s,a,l,u,c,r,o,h,p),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Dz=new Bt,qle=new Bt;class bH{constructor(e=[],t=[]){this.uuid=Js(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Bt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Bt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let o=0,s=e.length;o<s;o++){const a=e[o]?e[o].matrixWorld:qle;Dz.multiplyMatrices(a,t[o]),Dz.toArray(i,o*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new bH(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=$j(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new xH(t,e,e,Na,Ia);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const o=e.bones[i];let s=t[o];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),s=new yH),this.bones.push(s),this.boneInverses.push(new Bt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,o=t.length;r<o;r++){const s=t[r];e.bones.push(s.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class Gp extends Vl{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new vt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Rz=new K,Oz=new K,kz=new Bt,aA=new gg,_w=new Hp;class XO extends An{constructor(e=new ei,t=new Gp){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,o=t.count;r<o;r++)Rz.fromBufferAttribute(t,r-1),Oz.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=Rz.distanceTo(Oz);e.setAttribute("lineDistance",new Zt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),_w.copy(i.boundingSphere),_w.applyMatrix4(r),_w.radius+=o,e.ray.intersectsSphere(_w)===!1)return;kz.copy(r).invert(),aA.copy(e.ray).applyMatrix4(kz);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=new K,c=new K,h=new K,p=new K,m=this.isLineSegments?2:1,y=i.index,_=i.attributes.position;if(y!==null){const g=Math.max(0,s.start),b=Math.min(y.count,s.start+s.count);for(let w=g,M=b-1;w<M;w+=m){const C=y.getX(w),P=y.getX(w+1);if(u.fromBufferAttribute(_,C),c.fromBufferAttribute(_,P),aA.distanceSqToSegment(u,c,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);const L=e.ray.origin.distanceTo(p);L<e.near||L>e.far||t.push({distance:L,point:h.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else{const g=Math.max(0,s.start),b=Math.min(_.count,s.start+s.count);for(let w=g,M=b-1;w<M;w+=m){if(u.fromBufferAttribute(_,w),c.fromBufferAttribute(_,w+1),aA.distanceSqToSegment(u,c,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);const C=e.ray.origin.distanceTo(p);C<e.near||C>e.far||t.push({distance:C,point:h.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){const s=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=r}}}}}const Iz=new K,Nz=new K;class lx extends XO{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,o=t.count;r<o;r+=2)Iz.fromBufferAttribute(t,r),Nz.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+Iz.distanceTo(Nz);e.setAttribute("lineDistance",new Zt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class XDe extends XO{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Yle extends Vl{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new vt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const zz=new Bt,eR=new gg,yw=new Hp,xw=new K;class qDe extends An{constructor(e=new ei,t=new Yle){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),yw.copy(i.boundingSphere),yw.applyMatrix4(r),yw.radius+=o,e.ray.intersectsSphere(yw)===!1)return;zz.copy(r).invert(),eR.copy(e.ray).applyMatrix4(zz);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=i.index,c=i.attributes.position;if(u!==null){const h=Math.max(0,s.start),p=Math.min(u.count,s.start+s.count);for(let m=h,y=p;m<y;m++){const _=u.getX(m);xw.fromBufferAttribute(c,_),Vz(xw,_,l,r,e,t,this)}}else{const h=Math.max(0,s.start),p=Math.min(c.count,s.start+s.count);for(let m=h,y=p;m<y;m++)xw.fromBufferAttribute(c,m),Vz(xw,m,l,r,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){const s=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=r}}}}}function Vz(n,e,t,i,r,o,s){const a=eR.distanceSqToPoint(n);if(a<t){const l=new K;eR.closestPointToPoint(n,l),l.applyMatrix4(i);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;o.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:s})}}class Kle extends so{constructor(e,t,i,r,o,s,a,l,u){super(e,t,i,r,o,s,a,l,u),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:Hi,this.magFilter=o!==void 0?o:Hi,this.generateMipmaps=!1;const c=this;function h(){c.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Fl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),o=0;t.push(0);for(let s=1;s<=e;s++)i=this.getPoint(s/e),o+=i.distanceTo(r),t.push(o),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const o=i.length;let s;t?s=t:s=e*i[o-1];let a=0,l=o-1,u;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),u=i[r]-s,u<0)a=r+1;else if(u>0)l=r-1;else{l=r;break}if(r=l,i[r]===s)return r/(o-1);const c=i[r],h=i[r+1]-c,p=(s-c)/h;return(r+p)/(o-1)}getTangent(e,t){let i=e-1e-4,r=e+1e-4;i<0&&(i=0),r>1&&(r=1);const o=this.getPoint(i),s=this.getPoint(r),a=t||(o.isVector2?new ze:new K);return a.copy(s).sub(o).normalize(),a}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new K,r=[],o=[],s=[],a=new K,l=new Bt;for(let m=0;m<=e;m++){const y=m/e;r[m]=this.getTangentAt(y,new K)}o[0]=new K,s[0]=new K;let u=Number.MAX_VALUE;const c=Math.abs(r[0].x),h=Math.abs(r[0].y),p=Math.abs(r[0].z);c<=u&&(u=c,i.set(1,0,0)),h<=u&&(u=h,i.set(0,1,0)),p<=u&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),o[0].crossVectors(r[0],a),s[0].crossVectors(r[0],o[0]);for(let m=1;m<=e;m++){if(o[m]=o[m-1].clone(),s[m]=s[m-1].clone(),a.crossVectors(r[m-1],r[m]),a.length()>Number.EPSILON){a.normalize();const y=Math.acos(rr(r[m-1].dot(r[m]),-1,1));o[m].applyMatrix4(l.makeRotationAxis(a,y))}s[m].crossVectors(r[m],o[m])}if(t===!0){let m=Math.acos(rr(o[0].dot(o[e]),-1,1));m/=e,r[0].dot(a.crossVectors(o[0],o[e]))>0&&(m=-m);for(let y=1;y<=e;y++)o[y].applyMatrix4(l.makeRotationAxis(r[y],m*y)),s[y].crossVectors(r[y],o[y])}return{tangents:r,normals:o,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class qO extends Fl{constructor(e=0,t=0,i=1,r=1,o=0,s=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=s,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new ze,r=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const s=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(s?o=0:o=r),this.aClockwise===!0&&!s&&(o===r?o=-r:o=o-r);const a=this.aStartAngle+e*o;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),p=l-this.aX,m=u-this.aY;l=p*c-m*h+this.aX,u=p*h+m*c+this.aY}return i.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Zle extends qO{constructor(e,t,i,r,o,s){super(e,t,i,i,r,o,s),this.isArcCurve=!0,this.type="ArcCurve"}}function YO(){let n=0,e=0,t=0,i=0;function r(o,s,a,l){n=o,e=a,t=-3*o+3*s-2*a-l,i=2*o-2*s+a+l}return{initCatmullRom:function(o,s,a,l,u){r(s,a,u*(a-o),u*(l-s))},initNonuniformCatmullRom:function(o,s,a,l,u,c,h){let p=(s-o)/u-(a-o)/(u+c)+(a-s)/c,m=(a-s)/c-(l-s)/(c+h)+(l-a)/h;p*=c,m*=c,r(s,a,p,m)},calc:function(o){const s=o*o,a=s*o;return n+e*o+t*s+i*a}}}const bw=new K,lA=new YO,uA=new YO,cA=new YO;class Jle extends Fl{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new K){const i=t,r=this.points,o=r.length,s=(o-(this.closed?0:1))*e;let a=Math.floor(s),l=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/o)+1)*o:l===0&&a===o-1&&(a=o-2,l=1);let u,c;this.closed||a>0?u=r[(a-1)%o]:(bw.subVectors(r[0],r[1]).add(r[0]),u=bw);const h=r[a%o],p=r[(a+1)%o];if(this.closed||a+2<o?c=r[(a+2)%o]:(bw.subVectors(r[o-1],r[o-2]).add(r[o-1]),c=bw),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let y=Math.pow(u.distanceToSquared(h),m),_=Math.pow(h.distanceToSquared(p),m),g=Math.pow(p.distanceToSquared(c),m);_<1e-4&&(_=1),y<1e-4&&(y=_),g<1e-4&&(g=_),lA.initNonuniformCatmullRom(u.x,h.x,p.x,c.x,y,_,g),uA.initNonuniformCatmullRom(u.y,h.y,p.y,c.y,y,_,g),cA.initNonuniformCatmullRom(u.z,h.z,p.z,c.z,y,_,g)}else this.curveType==="catmullrom"&&(lA.initCatmullRom(u.x,h.x,p.x,c.x,this.tension),uA.initCatmullRom(u.y,h.y,p.y,c.y,this.tension),cA.initCatmullRom(u.z,h.z,p.z,c.z,this.tension));return i.set(lA.calc(l),uA.calc(l),cA.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new K().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Fz(n,e,t,i,r){const o=(i-e)*.5,s=(r-t)*.5,a=n*n,l=n*a;return(2*t-2*i+o+s)*l+(-3*t+3*i-2*o-s)*a+o*n+t}function Qle(n,e){const t=1-n;return t*t*e}function $le(n,e){return 2*(1-n)*n*e}function eue(n,e){return n*n*e}function j_(n,e,t,i){return Qle(n,e)+$le(n,t)+eue(n,i)}function tue(n,e){const t=1-n;return t*t*t*e}function nue(n,e){const t=1-n;return 3*t*t*n*e}function iue(n,e){return 3*(1-n)*n*n*e}function rue(n,e){return n*n*n*e}function H_(n,e,t,i,r){return tue(n,e)+nue(n,t)+iue(n,i)+rue(n,r)}class wH extends Fl{constructor(e=new ze,t=new ze,i=new ze,r=new ze){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new ze){const i=t,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return i.set(H_(e,r.x,o.x,s.x,a.x),H_(e,r.y,o.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class oue extends Fl{constructor(e=new K,t=new K,i=new K,r=new K){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new K){const i=t,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return i.set(H_(e,r.x,o.x,s.x,a.x),H_(e,r.y,o.y,s.y,a.y),H_(e,r.z,o.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class KO extends Fl{constructor(e=new ze,t=new ze){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ze){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const i=t||new ze;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class sue extends Fl{constructor(e=new K,t=new K){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new K){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class SH extends Fl{constructor(e=new ze,t=new ze,i=new ze){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new ze){const i=t,r=this.v0,o=this.v1,s=this.v2;return i.set(j_(e,r.x,o.x,s.x),j_(e,r.y,o.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class aue extends Fl{constructor(e=new K,t=new K,i=new K){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new K){const i=t,r=this.v0,o=this.v1,s=this.v2;return i.set(j_(e,r.x,o.x,s.x),j_(e,r.y,o.y,s.y),j_(e,r.z,o.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class MH extends Fl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ze){const i=t,r=this.points,o=(r.length-1)*e,s=Math.floor(o),a=o-s,l=r[s===0?s:s-1],u=r[s],c=r[s>r.length-2?r.length-1:s+1],h=r[s>r.length-3?r.length-1:s+2];return i.set(Fz(a,l.x,u.x,c.x,h.x),Fz(a,l.y,u.y,c.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new ze().fromArray(r))}return this}}var CH=Object.freeze({__proto__:null,ArcCurve:Zle,CatmullRomCurve3:Jle,CubicBezierCurve:wH,CubicBezierCurve3:oue,EllipseCurve:qO,LineCurve:KO,LineCurve3:sue,QuadraticBezierCurve:SH,QuadraticBezierCurve3:aue,SplineCurve:MH});class lue extends Fl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new KO(t,e))}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let o=0;for(;o<r.length;){if(r[o]>=i){const s=r[o]-i,a=this.curves[o],l=a.getLength(),u=l===0?0:1-s/l;return a.getPointAt(u,t)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,o=this.curves;r<o.length;r++){const s=o[r],a=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,l=s.getPoints(a);for(let u=0;u<l.length;u++){const c=l[u];i&&i.equals(c)||(t.push(c),i=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new CH[r.type]().fromJSON(r))}return this}}class tR extends lue{constructor(e){super(),this.type="Path",this.currentPoint=new ze,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new KO(this.currentPoint.clone(),new ze(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const o=new SH(this.currentPoint.clone(),new ze(e,t),new ze(i,r));return this.curves.push(o),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,o,s){const a=new wH(this.currentPoint.clone(),new ze(e,t),new ze(i,r),new ze(o,s));return this.curves.push(a),this.currentPoint.set(o,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new MH(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,o,s){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,i,r,o,s),this}absarc(e,t,i,r,o,s){return this.absellipse(e,t,i,i,r,o,s),this}ellipse(e,t,i,r,o,s,a,l){const u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,t+c,i,r,o,s,a,l),this}absellipse(e,t,i,r,o,s,a,l){const u=new qO(e,t,i,r,o,s,a,l);if(this.curves.length>0){const h=u.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(u);const c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class ZO extends ei{constructor(e=1,t=8,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const o=[],s=[],a=[],l=[],u=new K,c=new ze;s.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let h=0,p=3;h<=t;h++,p+=3){const m=i+h/t*r;u.x=e*Math.cos(m),u.y=e*Math.sin(m),s.push(u.x,u.y,u.z),a.push(0,0,1),c.x=(s[p]/e+1)/2,c.y=(s[p+1]/e+1)/2,l.push(c.x,c.y)}for(let h=1;h<=t;h++)o.push(h,h+1,0);this.setIndex(o),this.setAttribute("position",new Zt(s,3)),this.setAttribute("normal",new Zt(a,3)),this.setAttribute("uv",new Zt(l,2))}static fromJSON(e){return new ZO(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class kC extends ei{constructor(e=1,t=1,i=1,r=8,o=1,s=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:o,openEnded:s,thetaStart:a,thetaLength:l};const u=this;r=Math.floor(r),o=Math.floor(o);const c=[],h=[],p=[],m=[];let y=0;const _=[],g=i/2;let b=0;w(),s===!1&&(e>0&&M(!0),t>0&&M(!1)),this.setIndex(c),this.setAttribute("position",new Zt(h,3)),this.setAttribute("normal",new Zt(p,3)),this.setAttribute("uv",new Zt(m,2));function w(){const C=new K,P=new K;let L=0;const R=(t-e)/i;for(let E=0;E<=o;E++){const D=[],N=E/o,j=N*(t-e)+e;for(let te=0;te<=r;te++){const ee=te/r,H=ee*l+a,Q=Math.sin(H),Z=Math.cos(H);P.x=j*Q,P.y=-N*i+g,P.z=j*Z,h.push(P.x,P.y,P.z),C.set(Q,R,Z).normalize(),p.push(C.x,C.y,C.z),m.push(ee,1-N),D.push(y++)}_.push(D)}for(let E=0;E<r;E++)for(let D=0;D<o;D++){const N=_[D][E],j=_[D+1][E],te=_[D+1][E+1],ee=_[D][E+1];c.push(N,j,ee),c.push(j,te,ee),L+=6}u.addGroup(b,L,0),b+=L}function M(C){const P=y,L=new ze,R=new K;let E=0;const D=C===!0?e:t,N=C===!0?1:-1;for(let te=1;te<=r;te++)h.push(0,g*N,0),p.push(0,N,0),m.push(.5,.5),y++;const j=y;for(let te=0;te<=r;te++){const ee=te/r*l+a,H=Math.cos(ee),Q=Math.sin(ee);R.x=D*Q,R.y=g*N,R.z=D*H,h.push(R.x,R.y,R.z),p.push(0,N,0),L.x=H*.5+.5,L.y=Q*.5*N+.5,m.push(L.x,L.y),y++}for(let te=0;te<r;te++){const ee=P+te,H=j+te;C===!0?c.push(H,H+1,ee):c.push(H+1,H,ee),E+=3}u.addGroup(b,E,C===!0?1:2),b+=E}}static fromJSON(e){return new kC(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class JO extends kC{constructor(e=1,t=1,i=8,r=1,o=!1,s=0,a=Math.PI*2){super(0,e,t,i,r,o,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:s,thetaLength:a}}static fromJSON(e){return new JO(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class IC extends ei{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const o=[],s=[];a(r),u(i),c(),this.setAttribute("position",new Zt(o,3)),this.setAttribute("normal",new Zt(o.slice(),3)),this.setAttribute("uv",new Zt(s,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(w){const M=new K,C=new K,P=new K;for(let L=0;L<t.length;L+=3)m(t[L+0],M),m(t[L+1],C),m(t[L+2],P),l(M,C,P,w)}function l(w,M,C,P){const L=P+1,R=[];for(let E=0;E<=L;E++){R[E]=[];const D=w.clone().lerp(C,E/L),N=M.clone().lerp(C,E/L),j=L-E;for(let te=0;te<=j;te++)te===0&&E===L?R[E][te]=D:R[E][te]=D.clone().lerp(N,te/j)}for(let E=0;E<L;E++)for(let D=0;D<2*(L-E)-1;D++){const N=Math.floor(D/2);D%2===0?(p(R[E][N+1]),p(R[E+1][N]),p(R[E][N])):(p(R[E][N+1]),p(R[E+1][N+1]),p(R[E+1][N]))}}function u(w){const M=new K;for(let C=0;C<o.length;C+=3)M.x=o[C+0],M.y=o[C+1],M.z=o[C+2],M.normalize().multiplyScalar(w),o[C+0]=M.x,o[C+1]=M.y,o[C+2]=M.z}function c(){const w=new K;for(let M=0;M<o.length;M+=3){w.x=o[M+0],w.y=o[M+1],w.z=o[M+2];const C=g(w)/2/Math.PI+.5,P=b(w)/Math.PI+.5;s.push(C,1-P)}y(),h()}function h(){for(let w=0;w<s.length;w+=6){const M=s[w+0],C=s[w+2],P=s[w+4],L=Math.max(M,C,P),R=Math.min(M,C,P);L>.9&&R<.1&&(M<.2&&(s[w+0]+=1),C<.2&&(s[w+2]+=1),P<.2&&(s[w+4]+=1))}}function p(w){o.push(w.x,w.y,w.z)}function m(w,M){const C=w*3;M.x=e[C+0],M.y=e[C+1],M.z=e[C+2]}function y(){const w=new K,M=new K,C=new K,P=new K,L=new ze,R=new ze,E=new ze;for(let D=0,N=0;D<o.length;D+=9,N+=6){w.set(o[D+0],o[D+1],o[D+2]),M.set(o[D+3],o[D+4],o[D+5]),C.set(o[D+6],o[D+7],o[D+8]),L.set(s[N+0],s[N+1]),R.set(s[N+2],s[N+3]),E.set(s[N+4],s[N+5]),P.copy(w).add(M).add(C).divideScalar(3);const j=g(P);_(L,N+0,w,j),_(R,N+2,M,j),_(E,N+4,C,j)}}function _(w,M,C,P){P<0&&w.x===1&&(s[M]=w.x-1),C.x===0&&C.z===0&&(s[M]=P/2/Math.PI+.5)}function g(w){return Math.atan2(w.z,-w.x)}function b(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}static fromJSON(e){return new IC(e.vertices,e.indices,e.radius,e.details)}}class mM extends tR{constructor(e){super(e),this.uuid=Js(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new tR().fromJSON(r))}return this}}const uue={triangulate:function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let o=EH(n,0,r,t,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,u,c,h,p,m;if(i&&(o=fue(n,e,o,t)),n.length>80*t){a=u=n[0],l=c=n[1];for(let y=t;y<r;y+=t)h=n[y],p=n[y+1],h<a&&(a=h),p<l&&(l=p),h>u&&(u=h),p>c&&(c=p);m=Math.max(u-a,c-l),m=m!==0?1/m:0}return Ly(o,s,t,a,l,m),s}};function EH(n,e,t,i,r){let o,s;if(r===Cue(n,e,t,i)>0)for(o=e;o<t;o+=i)s=Bz(o,n[o],n[o+1],s);else for(o=t-i;o>=e;o-=i)s=Bz(o,n[o],n[o+1],s);return s&&NC(s,s.next)&&(Ry(s),s=s.next),s}function Lh(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(NC(t,t.next)||ui(t.prev,t,t.next)===0)){if(Ry(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Ly(n,e,t,i,r,o,s){if(!n)return;!s&&o&&yue(n,i,r,o);let a=n,l,u;for(;n.prev!==n.next;){if(l=n.prev,u=n.next,o?hue(n,i,r,o):cue(n)){e.push(l.i/t),e.push(n.i/t),e.push(u.i/t),Ry(n),n=u.next,a=u.next;continue}if(n=u,n===a){s?s===1?(n=due(Lh(n),e,t),Ly(n,e,t,i,r,o,2)):s===2&&pue(n,e,t,i,r,o):Ly(Lh(n),e,t,i,r,o,1);break}}}function cue(n){const e=n.prev,t=n,i=n.next;if(ui(e,t,i)>=0)return!1;let r=n.next.next;for(;r!==n.prev;){if(Wm(e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y)&&ui(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function hue(n,e,t,i){const r=n.prev,o=n,s=n.next;if(ui(r,o,s)>=0)return!1;const a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,u=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,c=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,h=nR(a,l,e,t,i),p=nR(u,c,e,t,i);let m=n.prevZ,y=n.nextZ;for(;m&&m.z>=h&&y&&y.z<=p;){if(m!==n.prev&&m!==n.next&&Wm(r.x,r.y,o.x,o.y,s.x,s.y,m.x,m.y)&&ui(m.prev,m,m.next)>=0||(m=m.prevZ,y!==n.prev&&y!==n.next&&Wm(r.x,r.y,o.x,o.y,s.x,s.y,y.x,y.y)&&ui(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;m&&m.z>=h;){if(m!==n.prev&&m!==n.next&&Wm(r.x,r.y,o.x,o.y,s.x,s.y,m.x,m.y)&&ui(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;y&&y.z<=p;){if(y!==n.prev&&y!==n.next&&Wm(r.x,r.y,o.x,o.y,s.x,s.y,y.x,y.y)&&ui(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function due(n,e,t){let i=n;do{const r=i.prev,o=i.next.next;!NC(r,o)&&TH(r,i,i.next,o)&&Dy(r,o)&&Dy(o,r)&&(e.push(r.i/t),e.push(i.i/t),e.push(o.i/t),Ry(i),Ry(i.next),i=n=o),i=i.next}while(i!==n);return Lh(i)}function pue(n,e,t,i,r,o){let s=n;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&wue(s,a)){let l=PH(s,a);s=Lh(s,s.next),l=Lh(l,l.next),Ly(s,e,t,i,r,o),Ly(l,e,t,i,r,o);return}a=a.next}s=s.next}while(s!==n)}function fue(n,e,t,i){const r=[];let o,s,a,l,u;for(o=0,s=e.length;o<s;o++)a=e[o]*i,l=o<s-1?e[o+1]*i:n.length,u=EH(n,a,l,i,!1),u===u.next&&(u.steiner=!0),r.push(bue(u));for(r.sort(mue),o=0;o<r.length;o++)vue(r[o],t),t=Lh(t,t.next);return t}function mue(n,e){return n.x-e.x}function vue(n,e){if(e=gue(n,e),e){const t=PH(e,n);Lh(e,e.next),Lh(t,t.next)}}function gue(n,e){let t=e;const i=n.x,r=n.y;let o=-1/0,s;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const p=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=i&&p>o){if(o=p,p===i){if(r===t.y)return t;if(r===t.next.y)return t.next}s=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!s)return null;if(i===o)return s;const a=s,l=s.x,u=s.y;let c=1/0,h;t=s;do i>=t.x&&t.x>=l&&i!==t.x&&Wm(r<u?i:o,r,l,u,r<u?o:i,r,t.x,t.y)&&(h=Math.abs(r-t.y)/(i-t.x),Dy(t,n)&&(h<c||h===c&&(t.x>s.x||t.x===s.x&&_ue(s,t)))&&(s=t,c=h)),t=t.next;while(t!==a);return s}function _ue(n,e){return ui(n.prev,n,e.prev)<0&&ui(e.next,n,n.next)<0}function yue(n,e,t,i){let r=n;do r.z===null&&(r.z=nR(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,xue(r)}function xue(n){let e,t,i,r,o,s,a,l,u=1;do{for(t=n,n=null,o=null,s=0;t;){for(s++,i=t,a=0,e=0;e<u&&(a++,i=i.nextZ,!!i);e++);for(l=u;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:n=r,r.prevZ=o,o=r;t=i}o.nextZ=null,u*=2}while(s>1);return n}function nR(n,e,t,i,r){return n=32767*(n-t)*r,e=32767*(e-i)*r,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function bue(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Wm(n,e,t,i,r,o,s,a){return(r-s)*(e-a)-(n-s)*(o-a)>=0&&(n-s)*(i-a)-(t-s)*(e-a)>=0&&(t-s)*(o-a)-(r-s)*(i-a)>=0}function wue(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!Sue(n,e)&&(Dy(n,e)&&Dy(e,n)&&Mue(n,e)&&(ui(n.prev,n,e.prev)||ui(n,e.prev,e))||NC(n,e)&&ui(n.prev,n,n.next)>0&&ui(e.prev,e,e.next)>0)}function ui(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function NC(n,e){return n.x===e.x&&n.y===e.y}function TH(n,e,t,i){const r=Sw(ui(n,e,t)),o=Sw(ui(n,e,i)),s=Sw(ui(t,i,n)),a=Sw(ui(t,i,e));return!!(r!==o&&s!==a||r===0&&ww(n,t,e)||o===0&&ww(n,i,e)||s===0&&ww(t,n,i)||a===0&&ww(t,e,i))}function ww(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Sw(n){return n>0?1:n<0?-1:0}function Sue(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&TH(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Dy(n,e){return ui(n.prev,n,n.next)<0?ui(n,e,n.next)>=0&&ui(n,n.prev,e)>=0:ui(n,e,n.prev)<0||ui(n,n.next,e)<0}function Mue(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,o=(n.y+e.y)/2;do t.y>o!=t.next.y>o&&t.next.y!==t.y&&r<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function PH(n,e){const t=new iR(n.i,n.x,n.y),i=new iR(e.i,e.x,e.y),r=n.next,o=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,o.next=i,i.prev=o,i}function Bz(n,e,t,i){const r=new iR(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ry(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function iR(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cue(n,e,t,i){let r=0;for(let o=e,s=t-i;o<t;o+=i)r+=(n[s]-n[o])*(n[o+1]+n[s+1]),s=o;return r}class iv{static area(e){const t=e.length;let i=0;for(let r=t-1,o=0;o<t;r=o++)i+=e[r].x*e[o].y-e[o].x*e[r].y;return i*.5}static isClockWise(e){return iv.area(e)<0}static triangulateShape(e,t){const i=[],r=[],o=[];Uz(e),jz(i,e);let s=e.length;t.forEach(Uz);for(let l=0;l<t.length;l++)r.push(s),s+=t[l].length,jz(i,t[l]);const a=uue.triangulate(i,r);for(let l=0;l<a.length;l+=3)o.push(a.slice(l,l+3));return o}}function Uz(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function jz(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class _2 extends ei{constructor(e=new mM([new ze(.5,.5),new ze(-.5,.5),new ze(-.5,-.5),new ze(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],o=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];s(u)}this.setAttribute("position",new Zt(r,3)),this.setAttribute("uv",new Zt(o,2)),this.computeVertexNormals();function s(a){const l=[],u=t.curveSegments!==void 0?t.curveSegments:12,c=t.steps!==void 0?t.steps:1,h=t.depth!==void 0?t.depth:1;let p=t.bevelEnabled!==void 0?t.bevelEnabled:!0,m=t.bevelThickness!==void 0?t.bevelThickness:.2,y=t.bevelSize!==void 0?t.bevelSize:m-.1,_=t.bevelOffset!==void 0?t.bevelOffset:0,g=t.bevelSegments!==void 0?t.bevelSegments:3;const b=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:Eue;let M,C=!1,P,L,R,E;b&&(M=b.getSpacedPoints(c),C=!0,p=!1,P=b.computeFrenetFrames(c,!1),L=new K,R=new K,E=new K),p||(g=0,m=0,y=0,_=0);const D=a.extractPoints(u);let N=D.shape;const j=D.holes;if(!iv.isClockWise(N)){N=N.reverse();for(let Oe=0,Te=j.length;Oe<Te;Oe++){const be=j[Oe];iv.isClockWise(be)&&(j[Oe]=be.reverse())}}const te=iv.triangulateShape(N,j),ee=N;for(let Oe=0,Te=j.length;Oe<Te;Oe++){const be=j[Oe];N=N.concat(be)}function H(Oe,Te,be){return Te||console.error("THREE.ExtrudeGeometry: vec does not exist"),Te.clone().multiplyScalar(be).add(Oe)}const Q=N.length,Z=te.length;function de(Oe,Te,be){let Ye,Ke,ft;const mt=Oe.x-Te.x,yt=Oe.y-Te.y,st=be.x-Oe.x,Ce=be.y-Oe.y,ve=mt*mt+yt*yt,k=mt*Ce-yt*st;if(Math.abs(k)>Number.EPSILON){const O=Math.sqrt(ve),ie=Math.sqrt(st*st+Ce*Ce),ge=Te.x-yt/O,ye=Te.y+mt/O,Pe=be.x-Ce/ie,Xe=be.y+st/ie,re=((Pe-ge)*Ce-(Xe-ye)*st)/(mt*Ce-yt*st);Ye=ge+mt*re-Oe.x,Ke=ye+yt*re-Oe.y;const Fe=Ye*Ye+Ke*Ke;if(Fe<=2)return new ze(Ye,Ke);ft=Math.sqrt(Fe/2)}else{let O=!1;mt>Number.EPSILON?st>Number.EPSILON&&(O=!0):mt<-Number.EPSILON?st<-Number.EPSILON&&(O=!0):Math.sign(yt)===Math.sign(Ce)&&(O=!0),O?(Ye=-yt,Ke=mt,ft=Math.sqrt(ve)):(Ye=mt,Ke=yt,ft=Math.sqrt(ve/2))}return new ze(Ye/ft,Ke/ft)}const X=[];for(let Oe=0,Te=ee.length,be=Te-1,Ye=Oe+1;Oe<Te;Oe++,be++,Ye++)be===Te&&(be=0),Ye===Te&&(Ye=0),X[Oe]=de(ee[Oe],ee[be],ee[Ye]);const B=[];let U,le=X.concat();for(let Oe=0,Te=j.length;Oe<Te;Oe++){const be=j[Oe];U=[];for(let Ye=0,Ke=be.length,ft=Ke-1,mt=Ye+1;Ye<Ke;Ye++,ft++,mt++)ft===Ke&&(ft=0),mt===Ke&&(mt=0),U[Ye]=de(be[Ye],be[ft],be[mt]);B.push(U),le=le.concat(U)}for(let Oe=0;Oe<g;Oe++){const Te=Oe/g,be=m*Math.cos(Te*Math.PI/2),Ye=y*Math.sin(Te*Math.PI/2)+_;for(let Ke=0,ft=ee.length;Ke<ft;Ke++){const mt=H(ee[Ke],X[Ke],Ye);oe(mt.x,mt.y,-be)}for(let Ke=0,ft=j.length;Ke<ft;Ke++){const mt=j[Ke];U=B[Ke];for(let yt=0,st=mt.length;yt<st;yt++){const Ce=H(mt[yt],U[yt],Ye);oe(Ce.x,Ce.y,-be)}}}const ne=y+_;for(let Oe=0;Oe<Q;Oe++){const Te=p?H(N[Oe],le[Oe],ne):N[Oe];C?(R.copy(P.normals[0]).multiplyScalar(Te.x),L.copy(P.binormals[0]).multiplyScalar(Te.y),E.copy(M[0]).add(R).add(L),oe(E.x,E.y,E.z)):oe(Te.x,Te.y,0)}for(let Oe=1;Oe<=c;Oe++)for(let Te=0;Te<Q;Te++){const be=p?H(N[Te],le[Te],ne):N[Te];C?(R.copy(P.normals[Oe]).multiplyScalar(be.x),L.copy(P.binormals[Oe]).multiplyScalar(be.y),E.copy(M[Oe]).add(R).add(L),oe(E.x,E.y,E.z)):oe(be.x,be.y,h/c*Oe)}for(let Oe=g-1;Oe>=0;Oe--){const Te=Oe/g,be=m*Math.cos(Te*Math.PI/2),Ye=y*Math.sin(Te*Math.PI/2)+_;for(let Ke=0,ft=ee.length;Ke<ft;Ke++){const mt=H(ee[Ke],X[Ke],Ye);oe(mt.x,mt.y,h+be)}for(let Ke=0,ft=j.length;Ke<ft;Ke++){const mt=j[Ke];U=B[Ke];for(let yt=0,st=mt.length;yt<st;yt++){const Ce=H(mt[yt],U[yt],Ye);C?oe(Ce.x,Ce.y+M[c-1].y,M[c-1].x+be):oe(Ce.x,Ce.y,h+be)}}}fe(),we();function fe(){const Oe=r.length/3;if(p){let Te=0,be=Q*Te;for(let Ye=0;Ye<Z;Ye++){const Ke=te[Ye];tt(Ke[2]+be,Ke[1]+be,Ke[0]+be)}Te=c+g*2,be=Q*Te;for(let Ye=0;Ye<Z;Ye++){const Ke=te[Ye];tt(Ke[0]+be,Ke[1]+be,Ke[2]+be)}}else{for(let Te=0;Te<Z;Te++){const be=te[Te];tt(be[2],be[1],be[0])}for(let Te=0;Te<Z;Te++){const be=te[Te];tt(be[0]+Q*c,be[1]+Q*c,be[2]+Q*c)}}i.addGroup(Oe,r.length/3-Oe,0)}function we(){const Oe=r.length/3;let Te=0;Be(ee,Te),Te+=ee.length;for(let be=0,Ye=j.length;be<Ye;be++){const Ke=j[be];Be(Ke,Te),Te+=Ke.length}i.addGroup(Oe,r.length/3-Oe,1)}function Be(Oe,Te){let be=Oe.length;for(;--be>=0;){const Ye=be;let Ke=be-1;Ke<0&&(Ke=Oe.length-1);for(let ft=0,mt=c+g*2;ft<mt;ft++){const yt=Q*ft,st=Q*(ft+1),Ce=Te+Ye+yt,ve=Te+Ke+yt,k=Te+Ke+st,O=Te+Ye+st;Ue(Ce,ve,k,O)}}}function oe(Oe,Te,be){l.push(Oe),l.push(Te),l.push(be)}function tt(Oe,Te,be){Ve(Oe),Ve(Te),Ve(be);const Ye=r.length/3,Ke=w.generateTopUV(i,r,Ye-3,Ye-2,Ye-1);Ae(Ke[0]),Ae(Ke[1]),Ae(Ke[2])}function Ue(Oe,Te,be,Ye){Ve(Oe),Ve(Te),Ve(Ye),Ve(Te),Ve(be),Ve(Ye);const Ke=r.length/3,ft=w.generateSideWallUV(i,r,Ke-6,Ke-3,Ke-2,Ke-1);Ae(ft[0]),Ae(ft[1]),Ae(ft[3]),Ae(ft[1]),Ae(ft[2]),Ae(ft[3])}function Ve(Oe){r.push(l[Oe*3+0]),r.push(l[Oe*3+1]),r.push(l[Oe*3+2])}function Ae(Oe){o.push(Oe.x),o.push(Oe.y)}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return Tue(t,i,e)}static fromJSON(e,t){const i=[];for(let o=0,s=e.shapes.length;o<s;o++){const a=t[e.shapes[o]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new CH[r.type]().fromJSON(r)),new _2(i,e.options)}}const Eue={generateTopUV:function(n,e,t,i,r){const o=e[t*3],s=e[t*3+1],a=e[i*3],l=e[i*3+1],u=e[r*3],c=e[r*3+1];return[new ze(o,s),new ze(a,l),new ze(u,c)]},generateSideWallUV:function(n,e,t,i,r,o){const s=e[t*3],a=e[t*3+1],l=e[t*3+2],u=e[i*3],c=e[i*3+1],h=e[i*3+2],p=e[r*3],m=e[r*3+1],y=e[r*3+2],_=e[o*3],g=e[o*3+1],b=e[o*3+2];return Math.abs(a-c)<Math.abs(s-u)?[new ze(s,1-l),new ze(u,1-h),new ze(p,1-y),new ze(_,1-b)]:[new ze(a,1-l),new ze(c,1-h),new ze(m,1-y),new ze(g,1-b)]}};function Tue(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const o=n[i];t.shapes.push(o.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class QO extends IC{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new QO(e.radius,e.detail)}}class $O extends ei{constructor(e=1,t=32,i=16,r=0,o=Math.PI*2,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:o,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(s+a,Math.PI);let u=0;const c=[],h=new K,p=new K,m=[],y=[],_=[],g=[];for(let b=0;b<=i;b++){const w=[],M=b/i;let C=0;b==0&&s==0?C=.5/t:b==i&&l==Math.PI&&(C=-.5/t);for(let P=0;P<=t;P++){const L=P/t;h.x=-e*Math.cos(r+L*o)*Math.sin(s+M*a),h.y=e*Math.cos(s+M*a),h.z=e*Math.sin(r+L*o)*Math.sin(s+M*a),y.push(h.x,h.y,h.z),p.copy(h).normalize(),_.push(p.x,p.y,p.z),g.push(L+C,1-M),w.push(u++)}c.push(w)}for(let b=0;b<i;b++)for(let w=0;w<t;w++){const M=c[b][w+1],C=c[b][w],P=c[b+1][w],L=c[b+1][w+1];(b!==0||s>0)&&m.push(M,C,L),(b!==i-1||l<Math.PI)&&m.push(C,P,L)}this.setIndex(m),this.setAttribute("position",new Zt(y,3)),this.setAttribute("normal",new Zt(_,3)),this.setAttribute("uv",new Zt(g,2))}static fromJSON(e){return new $O(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class ek extends IC{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ek(e.radius,e.detail)}}class tk extends ei{constructor(e=1,t=.4,i=8,r=6,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:o},i=Math.floor(i),r=Math.floor(r);const s=[],a=[],l=[],u=[],c=new K,h=new K,p=new K;for(let m=0;m<=i;m++)for(let y=0;y<=r;y++){const _=y/r*o,g=m/i*Math.PI*2;h.x=(e+t*Math.cos(g))*Math.cos(_),h.y=(e+t*Math.cos(g))*Math.sin(_),h.z=t*Math.sin(g),a.push(h.x,h.y,h.z),c.x=e*Math.cos(_),c.y=e*Math.sin(_),p.subVectors(h,c).normalize(),l.push(p.x,p.y,p.z),u.push(y/r),u.push(m/i)}for(let m=1;m<=i;m++)for(let y=1;y<=r;y++){const _=(r+1)*m+y-1,g=(r+1)*(m-1)+y-1,b=(r+1)*(m-1)+y,w=(r+1)*m+y;s.push(_,g,w),s.push(g,b,w)}this.setIndex(s),this.setAttribute("position",new Zt(a,3)),this.setAttribute("normal",new Zt(l,3)),this.setAttribute("uv",new Zt(u,2))}static fromJSON(e){return new tk(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class AH extends Vl{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new vt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new vt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ox,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class YDe extends AH{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ze(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return rr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new vt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new vt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new vt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Pue extends Vl{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new vt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new vt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ox,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Aue extends Vl{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ox,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}function Ic(n,e,t){return LH(n)?new n.constructor(n.subarray(e,t!==void 0?t:n.length)):n.slice(e,t)}function Mw(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function LH(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Lue(n){function e(r,o){return n[r]-n[o]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function Hz(n,e,t){const i=n.length,r=new n.constructor(i);for(let o=0,s=0;s!==i;++o){const a=t[o]*e;for(let l=0;l!==e;++l)r[s++]=n[a+l]}return r}function DH(n,e,t,i){let r=1,o=n[0];for(;o!==void 0&&o[i]===void 0;)o=n[r++];if(o===void 0)return;let s=o[i];if(s!==void 0)if(Array.isArray(s))do s=o[i],s!==void 0&&(e.push(o.time),t.push.apply(t,s)),o=n[r++];while(o!==void 0);else if(s.toArray!==void 0)do s=o[i],s!==void 0&&(e.push(o.time),s.toArray(t,t.length)),o=n[r++];while(o!==void 0);else do s=o[i],s!==void 0&&(e.push(o.time),t.push(s)),o=n[r++];while(o!==void 0)}class zC{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],o=t[i-1];e:{t:{let s;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<o)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(o=r,r=t[++i],e<r)break t}s=t.length;break n}if(!(e>=o)){const a=t[1];e<a&&(i=2,o=a);for(let l=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=o,o=t[--i-1],e>=o)break t}s=i,i=0;break n}break e}for(;i<s;){const a=i+s>>>1;e<t[a]?s=a:i=a+1}if(r=t[i],o=t[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,r)}return this.interpolate_(i,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=e*r;for(let s=0;s!==r;++s)t[s]=i[o+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Due extends zC{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Um,endingEnd:Um}}intervalChanged_(e,t,i){const r=this.parameterPositions;let o=e-2,s=e+1,a=r[o],l=r[s];if(a===void 0)switch(this.getSettings_().endingStart){case jm:o=e,a=2*t-i;break;case m2:o=r.length-2,a=t+r[o]-r[o+1];break;default:o=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case jm:s=e,l=2*i-t;break;case m2:s=1,l=i+r[1]-r[0];break;default:s=e-1,l=t}const u=(i-t)*.5,c=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(l-i),this._offsetPrev=o*c,this._offsetNext=s*c}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=this._offsetPrev,h=this._offsetNext,p=this._weightPrev,m=this._weightNext,y=(i-t)/(r-t),_=y*y,g=_*y,b=-p*g+2*p*_-p*y,w=(1+p)*g+(-1.5-2*p)*_+(-.5+p)*y+1,M=(-1-m)*g+(1.5+m)*_+.5*y,C=m*g-m*_;for(let P=0;P!==a;++P)o[P]=b*s[c+P]+w*s[u+P]+M*s[l+P]+C*s[h+P];return o}}class RH extends zC{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=(i-t)/(r-t),h=1-c;for(let p=0;p!==a;++p)o[p]=s[u+p]*h+s[l+p]*c;return o}}class Rue extends zC{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Bl{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Mw(t,this.TimeBufferType),this.values=Mw(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Mw(e.times,Array),values:Mw(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Rue(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new RH(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Due(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case p2:t=this.InterpolantFactoryMethodDiscrete;break;case f2:t=this.InterpolantFactoryMethodLinear;break;case DP:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return p2;case this.InterpolantFactoryMethodLinear:return f2;case this.InterpolantFactoryMethodSmooth:return DP}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let o=0,s=r-1;for(;o!==r&&i[o]<e;)++o;for(;s!==-1&&i[s]>t;)--s;if(++s,o!==0||s!==r){o>=s&&(s=Math.max(s,1),o=s-1);const a=this.getValueSize();this.times=Ic(i,o,s),this.values=Ic(this.values,o*a,s*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,o=i.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==o;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(s!==null&&s>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,s),e=!1;break}s=l}if(r!==void 0&&LH(r))for(let a=0,l=r.length;a!==l;++a){const u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=Ic(this.times),t=Ic(this.values),i=this.getValueSize(),r=this.getInterpolation()===DP,o=e.length-1;let s=1;for(let a=1;a<o;++a){let l=!1;const u=e[a],c=e[a+1];if(u!==c&&(a!==1||u!==e[0]))if(r)l=!0;else{const h=a*i,p=h-i,m=h+i;for(let y=0;y!==i;++y){const _=t[h+y];if(_!==t[p+y]||_!==t[m+y]){l=!0;break}}}if(l){if(a!==s){e[s]=e[a];const h=a*i,p=s*i;for(let m=0;m!==i;++m)t[p+m]=t[h+m]}++s}}if(o>0){e[s]=e[o];for(let a=o*i,l=s*i,u=0;u!==i;++u)t[l+u]=t[a+u];++s}return s!==e.length?(this.times=Ic(e,0,s),this.values=Ic(t,0,s*i)):(this.times=e,this.values=t),this}clone(){const e=Ic(this.times,0),t=Ic(this.values,0),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Bl.prototype.TimeBufferType=Float32Array;Bl.prototype.ValueBufferType=Float32Array;Bl.prototype.DefaultInterpolation=f2;class bg extends Bl{}bg.prototype.ValueTypeName="bool";bg.prototype.ValueBufferType=Array;bg.prototype.DefaultInterpolation=p2;bg.prototype.InterpolantFactoryMethodLinear=void 0;bg.prototype.InterpolantFactoryMethodSmooth=void 0;class OH extends Bl{}OH.prototype.ValueTypeName="color";class Oy extends Bl{}Oy.prototype.ValueTypeName="number";class Oue extends zC{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let u=e*a;for(let c=u+a;u!==c;u+=4)Mo.slerpFlat(o,0,s,u-a,s,u,l);return o}}class ux extends Bl{InterpolantFactoryMethodLinear(e){return new Oue(this.times,this.values,this.getValueSize(),e)}}ux.prototype.ValueTypeName="quaternion";ux.prototype.DefaultInterpolation=f2;ux.prototype.InterpolantFactoryMethodSmooth=void 0;class wg extends Bl{}wg.prototype.ValueTypeName="string";wg.prototype.ValueBufferType=Array;wg.prototype.DefaultInterpolation=p2;wg.prototype.InterpolantFactoryMethodLinear=void 0;wg.prototype.InterpolantFactoryMethodSmooth=void 0;class y2 extends Bl{}y2.prototype.ValueTypeName="vector";class rR{constructor(e,t=-1,i,r=BO){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Js(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let s=0,a=i.length;s!==a;++s)t.push(Iue(i[s]).scale(r));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,s=i.length;o!==s;++o)t.push(Bl.toJSON(i[o]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const o=t.length,s=[];for(let a=0;a<o;a++){let l=[],u=[];l.push((a+o-1)%o,a,(a+1)%o),u.push(0,1,0);const c=Lue(l);l=Hz(l,1,c),u=Hz(u,1,c),!r&&l[0]===0&&(l.push(o),u.push(u[0])),s.push(new Oy(".morphTargetInfluences["+t[a].name+"]",l,u).scale(1/i))}return new this(e,-1,s)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],c=u.name.match(o);if(c&&c.length>1){const h=c[1];let p=r[h];p||(r[h]=p=[]),p.push(u)}}const s=[];for(const a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(c,h,p,m,y){if(p.length!==0){const _=[],g=[];DH(p,_,g,m),_.length!==0&&y.push(new c(h,_,g))}},r=[],o=e.name||"default",s=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let c=0;c<u.length;c++){const h=u[c].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const p={};let m;for(m=0;m<h.length;m++)if(h[m].morphTargets)for(let y=0;y<h[m].morphTargets.length;y++)p[h[m].morphTargets[y]]=-1;for(const y in p){const _=[],g=[];for(let b=0;b!==h[m].morphTargets.length;++b){const w=h[m];_.push(w.time),g.push(w.morphTarget===y?1:0)}r.push(new Oy(".morphTargetInfluence["+y+"]",_,g))}l=p.length*s}else{const p=".bones["+t[c].name+"]";i(y2,p+".position",h,"pos",r),i(ux,p+".quaternion",h,"rot",r),i(y2,p+".scale",h,"scl",r)}}return r.length===0?null:new this(o,l,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const o=this.tracks[i];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function kue(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Oy;case"vector":case"vector2":case"vector3":case"vector4":return y2;case"color":return OH;case"quaternion":return ux;case"bool":case"boolean":return bg;case"string":return wg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function Iue(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=kue(n.type);if(n.times===void 0){const t=[],i=[];DH(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Vv={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class Nue{constructor(e,t,i){const r=this;let o=!1,s=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(c){a++,o===!1&&r.onStart!==void 0&&r.onStart(c,s,a),o=!0},this.itemEnd=function(c){s++,r.onProgress!==void 0&&r.onProgress(c,s,a),s===a&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(c){r.onError!==void 0&&r.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,h){return u.push(c,h),this},this.removeHandler=function(c){const h=u.indexOf(c);return h!==-1&&u.splice(h,2),this},this.getHandler=function(c){for(let h=0,p=u.length;h<p;h+=2){const m=u[h],y=u[h+1];if(m.global&&(m.lastIndex=0),m.test(c))return y}return null}}}const zue=new Nue;class Xp{constructor(e){this.manager=e!==void 0?e:zue,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,o){i.load(e,r,t,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const _u={};class Vue extends Error{constructor(e,t){super(e),this.response=t}}class kH extends Xp{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=Vv.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(_u[e]!==void 0){_u[e].push({onLoad:t,onProgress:i,onError:r});return}_u[e]=[],_u[e].push({onLoad:t,onProgress:i,onError:r});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(s).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const c=_u[e],h=u.body.getReader(),p=u.headers.get("Content-Length"),m=p?parseInt(p):0,y=m!==0;let _=0;const g=new ReadableStream({start(b){w();function w(){h.read().then(({done:M,value:C})=>{if(M)b.close();else{_+=C.byteLength;const P=new ProgressEvent("progress",{lengthComputable:y,loaded:_,total:m});for(let L=0,R=c.length;L<R;L++){const E=c[L];E.onProgress&&E.onProgress(P)}b.enqueue(C),w()}})}}});return new Response(g)}else throw new Vue(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return u.json();default:if(a===void 0)return u.text();{const c=/charset="?([^;"\s]*)"?/i.exec(a),h=c&&c[1]?c[1].toLowerCase():void 0,p=new TextDecoder(h);return u.arrayBuffer().then(m=>p.decode(m))}}}).then(u=>{Vv.add(e,u);const c=_u[e];delete _u[e];for(let h=0,p=c.length;h<p;h++){const m=c[h];m.onLoad&&m.onLoad(u)}}).catch(u=>{const c=_u[e];if(c===void 0)throw this.manager.itemError(e),u;delete _u[e];for(let h=0,p=c.length;h<p;h++){const m=c[h];m.onError&&m.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class IH extends Xp{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=Vv.get(e);if(s!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;const a=Ay("img");function l(){c(),Vv.add(e,this),t&&t(this),o.manager.itemEnd(e)}function u(h){c(),r&&r(h),o.manager.itemError(e),o.manager.itemEnd(e)}function c(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(e),a.src=e,a}}class Fue extends Xp{constructor(e){super(e)}load(e,t,i,r){const o=new WO,s=new IH(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function l(u){s.load(e[u],function(c){o.images[u]=c,a++,a===6&&(o.needsUpdate=!0,t&&t(o))},void 0,r)}for(let u=0;u<e.length;++u)l(u);return o}}class Bue extends Xp{constructor(e){super(e)}load(e,t,i,r){const o=this,s=new xH,a=new kH(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(o.withCredentials),a.load(e,function(l){const u=o.parse(l);!u||(u.image!==void 0?s.image=u.image:u.data!==void 0&&(s.image.width=u.width,s.image.height=u.height,s.image.data=u.data),s.wrapS=u.wrapS!==void 0?u.wrapS:vs,s.wrapT=u.wrapT!==void 0?u.wrapT:vs,s.magFilter=u.magFilter!==void 0?u.magFilter:Hi,s.minFilter=u.minFilter!==void 0?u.minFilter:Hi,s.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.encoding!==void 0&&(s.encoding=u.encoding),u.flipY!==void 0&&(s.flipY=u.flipY),u.format!==void 0&&(s.format=u.format),u.type!==void 0&&(s.type=u.type),u.mipmaps!==void 0&&(s.mipmaps=u.mipmaps,s.minFilter=rx),u.mipmapCount===1&&(s.minFilter=Hi),u.generateMipmaps!==void 0&&(s.generateMipmaps=u.generateMipmaps),s.needsUpdate=!0,t&&t(s,u))},i,r),s}}class Uue extends Xp{constructor(e){super(e)}load(e,t,i,r){const o=new so,s=new IH(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){o.image=a,o.needsUpdate=!0,t!==void 0&&t(o)},i,r),o}}class Sg extends An{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new vt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class jue extends Sg{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(An.DefaultUp),this.updateMatrix(),this.groundColor=new vt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Wz=new Bt,Gz=new K,Xz=new K;class nk{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ze(512,512),this.map=null,this.mapPass=null,this.matrix=new Bt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new DC,this._frameExtents=new ze(1,1),this._viewportCount=1,this._viewports=[new _n(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;Gz.setFromMatrixPosition(e.matrixWorld),t.position.copy(Gz),Xz.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Xz),t.updateMatrixWorld(),Wz.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Wz),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Hue extends nk{constructor(){super(new or(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=Py*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;(i!==t.fov||r!==t.aspect||o!==t.far)&&(t.fov=i,t.aspect=r,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Wue extends Sg{constructor(e,t,i=0,r=Math.PI/3,o=0,s=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(An.DefaultUp),this.updateMatrix(),this.target=new An,this.distance=i,this.angle=r,this.penumbra=o,this.decay=s,this.shadow=new Hue}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const qz=new Bt,H0=new K,hA=new K;class Gue extends nk{constructor(){super(new or(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ze(4,2),this._viewportCount=6,this._viewports=[new _n(2,1,1,1),new _n(0,1,1,1),new _n(3,1,1,1),new _n(1,1,1,1),new _n(3,0,1,1),new _n(1,0,1,1)],this._cubeDirections=[new K(1,0,0),new K(-1,0,0),new K(0,0,1),new K(0,0,-1),new K(0,1,0),new K(0,-1,0)],this._cubeUps=[new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,0,1),new K(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),H0.setFromMatrixPosition(e.matrixWorld),i.position.copy(H0),hA.copy(i.position),hA.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(hA),i.updateMatrixWorld(),r.makeTranslation(-H0.x,-H0.y,-H0.z),qz.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qz)}}class Xue extends Sg{constructor(e,t,i=0,r=1){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Gue}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class que extends nk{constructor(){super(new ax(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Yue extends Sg{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(An.DefaultUp),this.updateMatrix(),this.target=new An,this.shadow=new que}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Kue extends Sg{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Zue extends Sg{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class KDe{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class ZDe extends Xp{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=Vv.get(e);if(s!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(l){Vv.add(e,l),t&&t(l),o.manager.itemEnd(e)}).catch(function(l){r&&r(l),o.manager.itemError(e),o.manager.itemEnd(e)}),o.manager.itemStart(e)}}let Cw;const NH={getContext:function(){return Cw===void 0&&(Cw=new(window.AudioContext||window.webkitAudioContext)),Cw},setContext:function(n){Cw=n}};class Jue extends Xp{constructor(e){super(e)}load(e,t,i,r){const o=this,s=new kH(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){try{const l=a.slice(0);NH.getContext().decodeAudioData(l,function(u){t(u)})}catch(l){r?r(l):console.error(l),o.manager.itemError(e)}},i,r)}}class ik{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Yz(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Yz();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Yz(){return(typeof performance>"u"?Date:performance).now()}const Rd=new K,Kz=new Mo,Que=new K,Od=new K;class $ue extends An{constructor(){super(),this.type="AudioListener",this.context=NH.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new ik}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Rd,Kz,Que),Od.set(0,0,-1).applyQuaternion(Kz),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Rd.x,r),t.positionY.linearRampToValueAtTime(Rd.y,r),t.positionZ.linearRampToValueAtTime(Rd.z,r),t.forwardX.linearRampToValueAtTime(Od.x,r),t.forwardY.linearRampToValueAtTime(Od.y,r),t.forwardZ.linearRampToValueAtTime(Od.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(Rd.x,Rd.y,Rd.z),t.setOrientation(Od.x,Od.y,Od.z,i.x,i.y,i.z)}}class ece extends An{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const kd=new K,Zz=new Mo,tce=new K,Id=new K;class nce extends ece{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(kd,Zz,tce),Id.set(0,0,1).applyQuaternion(Zz);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(kd.x,i),t.positionY.linearRampToValueAtTime(kd.y,i),t.positionZ.linearRampToValueAtTime(kd.z,i),t.orientationX.linearRampToValueAtTime(Id.x,i),t.orientationY.linearRampToValueAtTime(Id.y,i),t.orientationZ.linearRampToValueAtTime(Id.z,i)}else t.setPosition(kd.x,kd.y,kd.z),t.setOrientation(Id.x,Id.y,Id.z)}}class ice{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,o,s;switch(t){case"quaternion":r=this._slerp,o=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,o=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,o=e*r+r;let s=this.cumulativeWeight;if(s===0){for(let a=0;a!==r;++a)i[o+a]=i[a];s=t}else{s+=t;const a=t/s;this._mixBufferRegion(i,o,0,a,r)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,o=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const l=t*this._origIndex;this._mixBufferRegion(i,r,l,1-o,t)}s>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,u=t+t;l!==u;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let o=i,s=r;o!==s;++o)t[o]=t[r+o%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,o){if(r>=.5)for(let s=0;s!==o;++s)e[t+s]=e[i+s]}_slerp(e,t,i,r){Mo.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,o){const s=this._workIndex*o;Mo.multiplyQuaternionsFlat(e,s,e,t,e,i),Mo.slerpFlat(e,t,e,t,e,s,r)}_lerp(e,t,i,r,o){const s=1-r;for(let a=0;a!==o;++a){const l=t+a;e[l]=e[l]*s+e[i+a]*r}}_lerpAdditive(e,t,i,r,o){for(let s=0;s!==o;++s){const a=t+s;e[a]=e[a]+e[i+s]*r}}}const rk="\\[\\]\\.:\\/",rce=new RegExp("["+rk+"]","g"),ok="[^"+rk+"]",oce="[^"+rk.replace("\\.","")+"]",sce=/((?:WC+[\/:])*)/.source.replace("WC",ok),ace=/(WCOD+)?/.source.replace("WCOD",oce),lce=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ok),uce=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ok),cce=new RegExp("^"+sce+ace+lce+uce+"$"),hce=["material","materials","bones"];class dce{constructor(e,t,i){const r=i||Sn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=i.length;r!==o;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class Sn{constructor(e,t,i){this.path=t,this.parsedPath=i||Sn.parseTrackName(t),this.node=Sn.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new Sn.Composite(e,t,i):new Sn(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(rce,"")}static parseTrackName(e){const t=cce.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const o=i.nodeName.substring(r+1);hce.indexOf(o)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=o)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(o){for(let s=0;s<o.length;s++){const a=o[s];if(a.name===t||a.uuid===t)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let o=t.propertyIndex;if(e||(e=Sn.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let u=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const s=e[r];if(s===void 0){const u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(o!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=o}else s.fromArray!==void 0&&s.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Sn.Composite=dce;Sn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Sn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Sn.prototype.GetterByBindingType=[Sn.prototype._getValue_direct,Sn.prototype._getValue_array,Sn.prototype._getValue_arrayElement,Sn.prototype._getValue_toArray];Sn.prototype.SetterByBindingTypeAndVersioning=[[Sn.prototype._setValue_direct,Sn.prototype._setValue_direct_setNeedsUpdate,Sn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Sn.prototype._setValue_array,Sn.prototype._setValue_array_setNeedsUpdate,Sn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Sn.prototype._setValue_arrayElement,Sn.prototype._setValue_arrayElement_setNeedsUpdate,Sn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Sn.prototype._setValue_fromArray,Sn.prototype._setValue_fromArray_setNeedsUpdate,Sn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class pce{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const o=t.tracks,s=o.length,a=new Array(s),l={endingStart:Um,endingEnd:Um};for(let u=0;u!==s;++u){const c=o[u].createInterpolant(null);a[u]=c,c.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=KD,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,o=e._clip.duration,s=o/r,a=r/o;e.warp(1,s,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,o=r.time,s=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,u=a.sampleValues;return l[0]=o,l[1]=o+i,u[0]=e/s,u[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const o=this._startTime;if(o!==null){const l=(e-o)*i;if(l<0||i===0)return;this._startTime=null,t=i*l}t*=this._updateTimeScale(e);const s=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case Oie:for(let c=0,h=l.length;c!==h;++c)l[c].evaluate(s),u[c].accumulateAdditive(a);break;case BO:default:for(let c=0,h=l.length;c!==h;++c)l[c].evaluate(s),u[c].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;i!==null&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,o=this._loopCount;const s=i===Rie;if(e===0)return o===-1?r:s&&(o&1)===1?t-r:r;if(i===YD){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,o+=Math.abs(a);const l=this.repetitions-o;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const u=e<0;this._setEndings(u,!u,s)}else this._setEndings(!1,!1,s);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(s&&(o&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=jm,r.endingEnd=jm):(e?r.endingStart=this.zeroSlopeAtStart?jm:Um:r.endingStart=m2,t?r.endingEnd=this.zeroSlopeAtEnd?jm:Um:r.endingEnd=m2)}_scheduleFading(e,t,i){const r=this._mixer,o=r.time;let s=this._weightInterpolant;s===null&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);const a=s.parameterPositions,l=s.sampleValues;return a[0]=o,l[0]=t,a[1]=o+e,l[1]=i,this}}const fce=new Float32Array(1);class mce extends jp{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,o=r.length,s=e._propertyBindings,a=e._interpolants,l=i.uuid,u=this._bindingsByRootAndName;let c=u[l];c===void 0&&(c={},u[l]=c);for(let h=0;h!==o;++h){const p=r[h],m=p.name;let y=c[m];if(y!==void 0)++y.referenceCount,s[h]=y;else{if(y=s[h],y!==void 0){y._cacheIndex===null&&(++y.referenceCount,this._addInactiveBinding(y,l,m));continue}const _=t&&t._propertyBindings[h].binding.parsedPath;y=new ice(Sn.create(i,m,_),p.ValueTypeName,p.getValueSize()),++y.referenceCount,this._addInactiveBinding(y,l,m),s[h]=y}a[h].resultBuffer=y.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,o=this._actionsByClip[r];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const o=t[i];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const o=t[i];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,o=this._actionsByClip;let s=o[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=s;else{const a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),s.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const o=e._clip.uuid,s=this._actionsByClip,a=s[o],l=a.knownActions,u=l[l.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,l[c]=u,l.pop(),e._byClipCacheIndex=null;const h=a.actionByRoot,p=(e._localRoot||this._root).uuid;delete h[p],l.length===0&&delete s[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const o=t[i];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,o=this._bindings;let s=r[t];s===void 0&&(s={},r[t]=s),s[i]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,o=i.path,s=this._bindingsByRootAndName,a=s[r],l=t[t.length-1],u=e._cacheIndex;l._cacheIndex=u,t[u]=l,t.pop(),delete a[o],Object.keys(a).length===0&&delete s[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new RH(new Float32Array(2),new Float32Array(2),1,fce),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,o=t[r];e.__cacheIndex=r,t[r]=e,o.__cacheIndex=i,t[i]=o}clipAction(e,t,i){const r=t||this._root,o=r.uuid;let s=typeof e=="string"?rR.findByName(r,e):e;const a=s!==null?s.uuid:e,l=this._actionsByClip[a];let u=null;if(i===void 0&&(s!==null?i=s.blendMode:i=BO),l!==void 0){const h=l.actionByRoot[o];if(h!==void 0&&h.blendMode===i)return h;u=l.knownActions[0],s===null&&(s=u._clip)}if(s===null)return null;const c=new pce(this,s,t,i);return this._bindAction(c,u),this._addInactiveAction(c,a,o),c}existingAction(e,t){const i=t||this._root,r=i.uuid,o=typeof e=="string"?rR.findByName(i,e):e,s=o?o.uuid:e,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,o=Math.sign(e),s=this._accuIndex^=1;for(let u=0;u!==i;++u)t[u]._update(r,e,o,s);const a=this._bindings,l=this._nActiveBindings;for(let u=0;u!==l;++u)a[u].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,o=r[i];if(o!==void 0){const s=o.knownActions;for(let a=0,l=s.length;a!==l;++a){const u=s[a];this._deactivateAction(u);const c=u._cacheIndex,h=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,h._cacheIndex=c,t[c]=h,t.pop(),this._removeInactiveBindingsForAction(u)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const s in i){const a=i[s].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,o=r[t];if(o!==void 0)for(const s in o){const a=o[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class zH{constructor(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new zH(this.value.clone===void 0?this.value:this.value.clone())}}class vce{constructor(e,t,i=0,r=1/0){this.ray=new gg(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new jO,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return oR(e,this,i,t),i.sort(Jz),i}intersectObjects(e,t=!0,i=[]){for(let r=0,o=e.length;r<o;r++)oR(e[r],this,i,t);return i.sort(Jz),i}}function Jz(n,e){return n.distance-e.distance}function oR(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),i===!0){const r=n.children;for(let o=0,s=r.length;o<s;o++)oR(r[o],e,t,!0)}}const Qz=new ze;class JDe{constructor(e=new ze(1/0,1/0),t=new ze(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Qz.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Qz.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const $z=new K,Ew=new K;class Fa{constructor(e=new K,t=new K){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){$z.subVectors(e,this.start),Ew.subVectors(this.end,this.start);const i=Ew.dot(Ew);let r=Ew.dot($z)/i;return t&&(r=rr(r,0,1)),r}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const eV=new K;class gce extends An{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const i=new ei,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,l=32;s<l;s++,a++){const u=s/l*Math.PI*2,c=a/l*Math.PI*2;r.push(Math.cos(u),Math.sin(u),1,Math.cos(c),Math.sin(c),1)}i.setAttribute("position",new Zt(r,3));const o=new Gp({fog:!1,toneMapped:!1});this.cone=new lx(i,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),eV.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(eV),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Nc=new K,Tw=new Bt,dA=new Bt;class _ce extends lx{constructor(e){const t=VH(e),i=new ei,r=[],o=[],s=new vt(0,0,1),a=new vt(0,1,0);for(let u=0;u<t.length;u++){const c=t[u];c.parent&&c.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),o.push(s.r,s.g,s.b),o.push(a.r,a.g,a.b))}i.setAttribute("position",new Zt(r,3)),i.setAttribute("color",new Zt(o,3));const l=new Gp({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");dA.copy(this.root.matrixWorld).invert();for(let o=0,s=0;o<t.length;o++){const a=t[o];a.parent&&a.parent.isBone&&(Tw.multiplyMatrices(dA,a.matrixWorld),Nc.setFromMatrixPosition(Tw),r.setXYZ(s,Nc.x,Nc.y,Nc.z),Tw.multiplyMatrices(dA,a.parent.matrixWorld),Nc.setFromMatrixPosition(Tw),r.setXYZ(s+1,Nc.x,Nc.y,Nc.z),s+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function VH(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,VH(n.children[t]));return e}class yce extends lx{constructor(e=10,t=10,i=4473924,r=8947848){i=new vt(i),r=new vt(r);const o=t/2,s=e/t,a=e/2,l=[],u=[];for(let p=0,m=0,y=-a;p<=t;p++,y+=s){l.push(-a,0,y,a,0,y),l.push(y,0,-a,y,0,a);const _=p===o?i:r;_.toArray(u,m),m+=3,_.toArray(u,m),m+=3,_.toArray(u,m),m+=3,_.toArray(u,m),m+=3}const c=new ei;c.setAttribute("position",new Zt(l,3)),c.setAttribute("color",new Zt(u,3));const h=new Gp({vertexColors:!0,toneMapped:!1});super(c,h),this.type="GridHelper"}}const Pw=new K,yi=new HO;class xce extends lx{constructor(e){const t=new ei,i=new Gp({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],o=[],s={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(y,_){l(y),l(_)}function l(y){r.push(0,0,0),o.push(0,0,0),s[y]===void 0&&(s[y]=[]),s[y].push(r.length/3-1)}t.setAttribute("position",new Zt(r,3)),t.setAttribute("color",new Zt(o,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();const u=new vt(16755200),c=new vt(16711680),h=new vt(43775),p=new vt(16777215),m=new vt(3355443);this.setColors(u,c,h,p,m)}setColors(e,t,i,r,o){const s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,r.r,r.g,r.b),s.setXYZ(39,r.r,r.g,r.b),s.setXYZ(40,o.r,o.g,o.b),s.setXYZ(41,o.r,o.g,o.b),s.setXYZ(42,o.r,o.g,o.b),s.setXYZ(43,o.r,o.g,o.b),s.setXYZ(44,o.r,o.g,o.b),s.setXYZ(45,o.r,o.g,o.b),s.setXYZ(46,o.r,o.g,o.b),s.setXYZ(47,o.r,o.g,o.b),s.setXYZ(48,o.r,o.g,o.b),s.setXYZ(49,o.r,o.g,o.b),s.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,i=1,r=1;yi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ri("c",t,e,yi,0,0,-1),Ri("t",t,e,yi,0,0,1),Ri("n1",t,e,yi,-i,-r,-1),Ri("n2",t,e,yi,i,-r,-1),Ri("n3",t,e,yi,-i,r,-1),Ri("n4",t,e,yi,i,r,-1),Ri("f1",t,e,yi,-i,-r,1),Ri("f2",t,e,yi,i,-r,1),Ri("f3",t,e,yi,-i,r,1),Ri("f4",t,e,yi,i,r,1),Ri("u1",t,e,yi,i*.7,r*1.1,-1),Ri("u2",t,e,yi,-i*.7,r*1.1,-1),Ri("u3",t,e,yi,0,r*2,-1),Ri("cf1",t,e,yi,-i,0,1),Ri("cf2",t,e,yi,i,0,1),Ri("cf3",t,e,yi,0,-r,1),Ri("cf4",t,e,yi,0,r,1),Ri("cn1",t,e,yi,-i,0,-1),Ri("cn2",t,e,yi,i,0,-1),Ri("cn3",t,e,yi,0,-r,-1),Ri("cn4",t,e,yi,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ri(n,e,t,i,r,o,s){Pw.set(r,o,s).unproject(i);const a=e[n];if(a!==void 0){const l=t.getAttribute("position");for(let u=0,c=a.length;u<c;u++)l.setXYZ(a[u],Pw.x,Pw.y,Pw.z)}}const Aw=new Hr;class FH extends lx{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),o=new ei;o.setIndex(new Co(i,1)),o.setAttribute("position",new Co(r,3)),super(o,new Gp({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Aw.setFromObject(this.object),Aw.isEmpty())return;const t=Aw.min,i=Aw.max,r=this.geometry.attributes.position,o=r.array;o[0]=i.x,o[1]=i.y,o[2]=i.z,o[3]=t.x,o[4]=i.y,o[5]=i.z,o[6]=t.x,o[7]=t.y,o[8]=i.z,o[9]=i.x,o[10]=t.y,o[11]=i.z,o[12]=i.x,o[13]=i.y,o[14]=t.z,o[15]=t.x,o[16]=i.y,o[17]=t.z,o[18]=t.x,o[19]=t.y,o[20]=t.z,o[21]=i.x,o[22]=t.y,o[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}}class QDe{constructor(){this.type="ShapePath",this.color=new vt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new tR,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,o,s){return this.currentPath.bezierCurveTo(e,t,i,r,o,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function i(w){const M=[];for(let C=0,P=w.length;C<P;C++){const L=w[C],R=new mM;R.curves=L.curves,M.push(R)}return M}function r(w,M){const C=M.length;let P=!1;for(let L=C-1,R=0;R<C;L=R++){let E=M[L],D=M[R],N=D.x-E.x,j=D.y-E.y;if(Math.abs(j)>Number.EPSILON){if(j<0&&(E=M[R],N=-N,D=M[L],j=-j),w.y<E.y||w.y>D.y)continue;if(w.y===E.y){if(w.x===E.x)return!0}else{const te=j*(w.x-E.x)-N*(w.y-E.y);if(te===0)return!0;if(te<0)continue;P=!P}}else{if(w.y!==E.y)continue;if(D.x<=w.x&&w.x<=E.x||E.x<=w.x&&w.x<=D.x)return!0}}return P}const o=iv.isClockWise,s=this.subPaths;if(s.length===0)return[];if(t===!0)return i(s);let a,l,u;const c=[];if(s.length===1)return l=s[0],u=new mM,u.curves=l.curves,c.push(u),c;let h=!o(s[0].getPoints());h=e?!h:h;const p=[],m=[];let y=[],_=0,g;m[_]=void 0,y[_]=[];for(let w=0,M=s.length;w<M;w++)l=s[w],g=l.getPoints(),a=o(g),a=e?!a:a,a?(!h&&m[_]&&_++,m[_]={s:new mM,p:g},m[_].s.curves=l.curves,h&&_++,y[_]=[]):y[_].push({h:l,p:g[0]});if(!m[0])return i(s);if(m.length>1){let w=!1,M=0;for(let C=0,P=m.length;C<P;C++)p[C]=[];for(let C=0,P=m.length;C<P;C++){const L=y[C];for(let R=0;R<L.length;R++){const E=L[R];let D=!0;for(let N=0;N<m.length;N++)r(E.p,m[N].p)&&(C!==N&&M++,D?(D=!1,p[N].push(E)):w=!0);D&&p[C].push(E)}}M>0&&w===!1&&(y=p)}let b;for(let w=0,M=m.length;w<M;w++){u=m[w].s,c.push(u),b=y[w];for(let C=0,P=b.length;C<P;C++)u.holes.push(b[C].h)}return c}}const Iu=bce();function bce(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):u<-14?(i[l]=1024>>-u-14,i[l|256]=1024>>-u-14|32768,r[l]=-u-1,r[l|256]=-u-1):u<=15?(i[l]=u+15<<10,i[l|256]=u+15<<10|32768,r[l]=13,r[l|256]=13):u<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const o=new Uint32Array(2048),s=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,c=0;for(;(u&8388608)===0;)u<<=1,c-=8388608;u&=-8388609,c+=947912704,o[l]=u|c}for(let l=1024;l<2048;++l)o[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)s[l]=l<<23;s[31]=1199570944,s[32]=2147483648;for(let l=33;l<63;++l)s[l]=2147483648+(l-32<<23);s[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:o,exponentTable:s,offsetTable:a}}function wce(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=rr(n,-65504,65504),Iu.floatView[0]=n;const e=Iu.uint32View[0],t=e>>23&511;return Iu.baseTable[t]+((e&8388607)>>Iu.shiftTable[t])}function Sce(n){const e=n>>10;return Iu.uint32View[0]=Iu.mantissaTable[Iu.offsetTable[e]+(n&1023)]+Iu.exponentTable[e],Iu.floatView[0]}var Lw=Object.freeze({__proto__:null,toHalfFloat:wce,fromHalfFloat:Sce});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:VO}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=VO);const[Dw,Yn]=lo(),[VC,Wa]=Qe([]),tV=mg(VC,Wa),Mce=vg(VC,Wa),sk=Wne(VC,Wa),BH=new WeakSet,[$De,UH]=Qe(!1),[Cce,Ti]=Qe(void 0),Fv=n=>{!UH()&&Cce(n)},St=new Hle;Vt(()=>{const n=Ti();if(!n)return;const e=new FH(n.nativeObject3d),t=requestAnimationFrame(()=>St.add(e)),i=Yn(()=>e.update());return()=>{cancelAnimationFrame(t),St.remove(e),i.cancel()}},[Ti]);Vt(()=>{const n=Wa();if(!n.length)return;const e=[];for(const i of n){const r=new FH(i.outerObject3d);St.add(r),e.push(r)}const t=Yn(()=>{for(const i of e)i.update()});return()=>{for(const i of e)St.remove(i);t.cancel()}},[Wa]);const jH=100,rn=1/jH,Wi=jH,HH=Number.EPSILON,ws=100*rn,Hu=ws*.5;class __{constructor(e,t){this.x=e,this.y=t}}class vp{constructor(e,t,i){this.x=e,this.y=t,this.z=i}}const gp=180/Math.PI,yr=Math.PI/180,ak=(n,e,t,i,r,o)=>Math.sqrt((n-i)**2+(e-r)**2+(t-o)**2),Ece=(n,e,t,i)=>{const r=t*=yr;return new __(n+i*Math.cos(r),e+i*Math.sin(r))},WH=new Set,FC=n=>{for(const e of n)WH.add(e)},Uh={onLoop:Function,proxy:Object};FC(["proxy"]);const jh={onLoop:void 0,proxy:void 0},ku=()=>{};class ci{constructor(e){q(this,"value"),this.value=e}}const Tce={...Uh,onClick:Function,onMouseDown:Function,onMouseUp:Function,onMouseOver:Function,onMouseOut:Function,onMouseMove:Function,onLookToEnd:Function,lookAt:[Function,Array],lookTo:[Function,Array],name:String,id:String,bloom:Boolean,outline:Boolean,visible:Boolean,frustumCulled:Boolean,castShadow:Boolean,receiveShadow:Boolean,metalnessFactor:Number,roughnessFactor:Number,opacityFactor:Number,adjustColor:String,toon:Boolean};FC(["lookAt","lookTo"]);const Pce={...jh,onClick:void 0,onMouseDown:void 0,onMouseUp:void 0,onMouseOver:void 0,onMouseOut:void 0,onMouseMove:void 0,onLookToEnd:void 0,lookAt:ku,lookTo:ku,name:"",id:void 0,bloom:!1,outline:!1,visible:!0,frustumCulled:!0,castShadow:!0,receiveShadow:!0,metalnessFactor:new ci(0),roughnessFactor:new ci(1),opacityFactor:new ci(1),adjustColor:new ci("#ffffff"),toon:!1},Ace={...Tce,animations:Object,animation:[String,Number,Array,Boolean,Object],animationPaused:Boolean,animationRepeat:Boolean,onAnimationFinish:Function},Lce={...Pce,animations:{},animation:void 0,animationPaused:new ci(!1),animationRepeat:new ci(!0),onAnimationFinish:void 0},lk={...Uh,x:Number,y:Number,z:Number},uk={...jh,x:0,y:0,z:0},GH={...Ace,...lk,onIntersect:Function,onIntersectOut:Function,onMoveToEnd:Function,moveTo:[Function,Array],lerpTo:[Function,Array],placeAt:[Function,Array],translateX:[Function,Array],translateY:[Function,Array],translateZ:[Function,Array],intersectIds:Array,scaleX:Number,scaleY:Number,scaleZ:Number,scale:Number,rotationX:Number,rotationY:Number,rotationZ:Number,rotation:Number};FC(["intersectIds","moveTo","lerpTo"]);const XH={...Lce,...uk,onIntersect:void 0,onIntersectOut:void 0,onMoveToEnd:void 0,moveTo:ku,lerpTo:ku,placeAt:ku,translateX:ku,translateY:ku,translateZ:ku,intersectIds:void 0,scaleX:1,scaleY:1,scaleZ:1,scale:1,rotationX:0,rotationY:0,rotationZ:0,rotation:0},BC={color:String,fog:Boolean,opacity:Number,texture:[String,Object],videoTexture:[String,Object],alphaMap:String,textureRepeat:[Object,Number],textureFlipY:Boolean},UC={color:"#ffffff",fog:!0,opacity:1,texture:void 0,videoTexture:void 0,alphaMap:void 0,textureRepeat:new ci({x:1,y:1}),textureFlipY:new ci(!1)},ck={color:String,wireframe:Boolean,envMap:String,aoMap:String,aoMapIntensity:Number,bumpMap:String,bumpScale:Number,displacementMap:String,displacementScale:Number,displacementBias:Number,emissive:Boolean,emissiveColor:String,emissiveMap:String,emissiveIntensity:Number,lightMap:String,lightMapIntensity:Number,metalnessMap:String,metalness:Number,roughnessMap:String,roughness:Number,normalMap:String,normalScale:[Object,Number],normalMapType:String},hk={color:"#ffffff",wireframe:!1,envMap:void 0,aoMap:void 0,aoMapIntensity:1,bumpMap:void 0,bumpScale:1,displacementMap:void 0,displacementScale:1,displacementBias:0,emissive:!1,emissiveColor:"#000000",emissiveMap:void 0,emissiveIntensity:1,lightMap:void 0,lightMapIntensity:1,metalnessMap:void 0,metalness:0,roughnessMap:void 0,roughness:1,normalMap:void 0,normalScale:{x:1,y:1},normalMapType:void 0},Dce={...GH,...BC,...ck},Rce={...XH,...UC,...hk},[qH,YH]=Qe(0),dk=()=>qH(YH()+1),Bv=()=>qH(YH()-1),nV=[0],iV=new Map,Oce=new Set,pk=n=>e=>{iV.set(n,e.loaded),nV[0]=[...iV.values()].reduce((t,i)=>t+i,0),Oce.forEach(t=>{try{t(nV[0])}finally{}})};class kce extends Bue{constructor(e){super(e),this.type=Bu}parse(e){const t=function(h,p){switch(h){case 1:console.error("THREE.RGBELoader Read Error: "+(p||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(p||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(p||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(p||""))}return-1},i=`
`,r=function(h,p,m){p=p||1024;let y=h.pos,_=-1,g=0,b="",w=String.fromCharCode.apply(null,new Uint16Array(h.subarray(y,y+128)));for(;0>(_=w.indexOf(i))&&g<p&&y<h.byteLength;)b+=w,g+=w.length,y+=128,w+=String.fromCharCode.apply(null,new Uint16Array(h.subarray(y,y+128)));return-1<_?(m!==!1&&(h.pos+=g+_+1),b+w.slice(0,_)):!1},o=function(h){const p=/^#\?(\S+)/,m=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,y=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,_=/^\s*FORMAT=(\S+)\s*$/,g=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,b={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let w,M;if(h.pos>=h.byteLength||!(w=r(h)))return t(1,"no header found");if(!(M=w.match(p)))return t(3,"bad initial token");for(b.valid|=1,b.programtype=M[1],b.string+=w+`
`;w=r(h),w!==!1;){if(b.string+=w+`
`,w.charAt(0)==="#"){b.comments+=w+`
`;continue}if((M=w.match(m))&&(b.gamma=parseFloat(M[1])),(M=w.match(y))&&(b.exposure=parseFloat(M[1])),(M=w.match(_))&&(b.valid|=2,b.format=M[1]),(M=w.match(g))&&(b.valid|=4,b.height=parseInt(M[1],10),b.width=parseInt(M[2],10)),b.valid&2&&b.valid&4)break}return b.valid&2?b.valid&4?b:t(3,"missing image size specifier"):t(3,"missing format specifier")},s=function(h,p,m){const y=p;if(y<8||y>32767||h[0]!==2||h[1]!==2||h[2]&128)return new Uint8Array(h);if(y!==(h[2]<<8|h[3]))return t(3,"wrong scanline width");const _=new Uint8Array(4*p*m);if(!_.length)return t(4,"unable to allocate buffer space");let g=0,b=0;const w=4*y,M=new Uint8Array(4),C=new Uint8Array(w);let P=m;for(;P>0&&b<h.byteLength;){if(b+4>h.byteLength)return t(1);if(M[0]=h[b++],M[1]=h[b++],M[2]=h[b++],M[3]=h[b++],M[0]!=2||M[1]!=2||(M[2]<<8|M[3])!=y)return t(3,"bad rgbe scanline format");let L=0,R;for(;L<w&&b<h.byteLength;){R=h[b++];const D=R>128;if(D&&(R-=128),R===0||L+R>w)return t(3,"bad scanline data");if(D){const N=h[b++];for(let j=0;j<R;j++)C[L++]=N}else C.set(h.subarray(b,b+R),L),L+=R,b+=R}const E=y;for(let D=0;D<E;D++){let N=0;_[g]=C[D+N],N+=y,_[g+1]=C[D+N],N+=y,_[g+2]=C[D+N],N+=y,_[g+3]=C[D+N],g+=4}P--}return _},a=function(h,p,m,y){const _=h[p+3],g=Math.pow(2,_-128)/255;m[y+0]=h[p+0]*g,m[y+1]=h[p+1]*g,m[y+2]=h[p+2]*g,m[y+3]=1},l=function(h,p,m,y){const _=h[p+3],g=Math.pow(2,_-128)/255;m[y+0]=Lw.toHalfFloat(Math.min(h[p+0]*g,65504)),m[y+1]=Lw.toHalfFloat(Math.min(h[p+1]*g,65504)),m[y+2]=Lw.toHalfFloat(Math.min(h[p+2]*g,65504)),m[y+3]=Lw.toHalfFloat(1)},u=new Uint8Array(e);u.pos=0;const c=o(u);if(c!==-1){const h=c.width,p=c.height,m=s(u.subarray(u.pos),h,p);if(m!==-1){let y,_,g;switch(this.type){case Ia:g=m.length/4;const b=new Float32Array(g*4);for(let M=0;M<g;M++)a(m,M*4,b,M*4);y=b,_=Ia;break;case Bu:g=m.length/4;const w=new Uint16Array(g*4);for(let M=0;M<g;M++)l(m,M*4,w,M*4);y=w,_=Bu;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:h,height:p,data:y,header:c.string,gamma:c.gamma,exposure:c.exposure,type:_}}}return null}setDataType(e){return this.type=e,this}load(e,t,i,r){function o(s,a){switch(s.type){case Ia:case Bu:s.encoding=Ah,s.minFilter=Hi,s.magFilter=Hi,s.generateMipmaps=!1,s.flipY=!0;break}t&&t(s,a)}return super.load(e,o,i,r)}}const Ice=new Map,Nce=new Uue,zce=new kce,pA=new Bj,to=(n,e)=>(e&&pA.once(n,()=>queueMicrotask(e)),zl(Ice,n,()=>(dk(),(n.toLowerCase().toLowerCase().endsWith(".hdr")?zce:Nce).load(n,t=>{t.wrapS=t.wrapT=Iv,pA.setState(n),Bv()},pk(n),()=>{pA.setState(n),Bv()})))),Vce=()=>{const n=new Map,e=qa(()=>{for(const t of n.values())t();n.clear()},0,"trailing");return(t,i)=>{n.set(t,i),e()}},W0=["map","alphaMap"],Fce=Vce();class cx{constructor(){q(this,"materialCloned"),q(this,"_opacity"),q(this,"videoTextureState"),q(this,"textureState"),q(this,"_alphaMap"),q(this,"_textureRepeat"),q(this,"_textureFlipY")}tryCloneMaterial(){this.materialCloned||(this.materialCloned=!0,this.material=this.nativeObject3d.material=this.material.clone(),this.then(()=>this.material.dispose()))}get color(){return"#"+this.material.color.getHexString()}set color(e){this.tryCloneMaterial(),this.material.color=new vt(e)}get fog(){return this.material.fog}set fog(e){this.tryCloneMaterial(),this.material.fog=e}get opacity(){var e;return(e=this._opacity)!=null?e:this._opacity=1}set opacity(e){this.tryCloneMaterial(),this._opacity=e,this.material.opacity=e,this.material.transparent=e<=1,this.nativeObject3d.visible=!!e}applyTexture(e){const t=this._textureRepeat,i=this._textureFlipY;Fce(this,()=>{this.tryCloneMaterial();for(const r of e){const o=this.material[r];if(!o)return;t!==void 0&&(o.repeat=t),i!==void 0&&(o.flipY=i),o.needsUpdate=!0}})}initTexture(){if(this.textureState)return;this.tryCloneMaterial();const e=this.videoTextureState=new Pt(void 0),t=this.textureState=new Pt(void 0);this.createEffect(()=>{const i=t.get(),r=e.get();if(r){let a;typeof r=="string"?(a=document.createElement("video"),a.crossOrigin="anonymous",a.src=r,a.loop=!0,a.autoplay=!0,a.muted=!0,a.playsInline=!0,a.play()):a=r;const l=new Kle(a,void 0,Iv,Iv),{material:u}=this,{map:c}=u;return u.map=l,u.needsUpdate=!0,this.applyTexture(W0),()=>{a.pause(),l.dispose(),u.map=c,u.needsUpdate=!0}}if(!i)return;const{material:o}=this,{map:s}=o;return o.map=to(i),this.applyTexture(W0),()=>{o.map=s,this.material.needsUpdate=!0}},[e.get,t.get])}get videoTexture(){var e;return(e=this.videoTextureState)==null?void 0:e.get()}set videoTexture(e){this.initTexture(),this.videoTextureState.set(e)}get texture(){var e;return(e=this.textureState)==null?void 0:e.get()}set texture(e){this.initTexture(),this.textureState.set(e)}get alphaMap(){return this._alphaMap}set alphaMap(e){this.tryCloneMaterial(),this._alphaMap=e,this.material.alphaMap=e?to(e):null,this.applyTexture(W0)}get textureRepeat(){return this._textureRepeat}set textureRepeat(e){typeof e=="number"&&(e=new ze(e,e)),this._textureRepeat=e,this.applyTexture(W0)}get textureFlipY(){return this._textureFlipY}set textureFlipY(e){this._textureFlipY=e,this.applyTexture(W0)}}const yu=["map","alphaMap","envMap","aoMap","bumpMap","displacementMap","emissiveMap","lightMap","metalnessMap","roughnessMap","normalMap"];class fk extends cx{constructor(){super(...arguments),q(this,"_envMap"),q(this,"_aoMap"),q(this,"_bumpMap"),q(this,"_displacementMap"),q(this,"_emissiveMap"),q(this,"_emissive"),q(this,"_lightMap"),q(this,"_metalnessMap"),q(this,"_roughnessMap"),q(this,"_normalMap"),q(this,"_normalMapType")}get wireframe(){return this.material.wireframe}set wireframe(e){this.tryCloneMaterial(),this.material.wireframe=e}get envMap(){return this._envMap}set envMap(e){this.tryCloneMaterial(),this._envMap=e,this.material.envMap=e?to(e):null,this.applyTexture(yu)}get aoMap(){return this._aoMap}set aoMap(e){this.tryCloneMaterial(),this._aoMap=e,this.material.aoMap=e?to(e):null,this.applyTexture(yu)}get aoMapIntensity(){return this.material.aoMapIntensity}set aoMapIntensity(e){this.tryCloneMaterial(),this.material.aoMapIntensity=e}get bumpMap(){return this._bumpMap}set bumpMap(e){this.tryCloneMaterial(),this._bumpMap=e,this.material.bumpMap=e?to(e):null,this.applyTexture(yu)}get bumpScale(){return this.material.bumpScale}set bumpScale(e){this.tryCloneMaterial(),this.material.bumpScale=e}get displacementMap(){return this._displacementMap}set displacementMap(e){this.tryCloneMaterial(),this._displacementMap=e,this.material.displacementMap=e?to(e):null,this.applyTexture(yu)}get displacementScale(){return this.material.displacementScale}set displacementScale(e){this.tryCloneMaterial(),this.material.displacementScale=e}get displacementBias(){return this.material.displacementBias}set displacementBias(e){this.tryCloneMaterial(),this.material.displacementBias=e}get emissiveColor(){return"#"+this.material.emissive.getHexString()}set emissiveColor(e){this.tryCloneMaterial(),this.material.emissive=new vt(e)}get emissiveMap(){return this._emissiveMap}set emissiveMap(e){this.tryCloneMaterial(),this._emissiveMap=e,this.material.emissiveMap=e?to(e):null,this.applyTexture(yu)}get emissiveIntensity(){return this.material.emissiveIntensity}set emissiveIntensity(e){this.tryCloneMaterial(),this.material.emissiveIntensity=e}get emissive(){return!!this._emissive}set emissive(e){this._emissive=e,e&&(this.tryCloneMaterial(),this.material.emissiveMap=this.material.map,this.material.emissive=this.material.color)}get lightMap(){return this._lightMap}set lightMap(e){this.tryCloneMaterial(),this._lightMap=e,this.material.lightMap=e?to(e):null,this.applyTexture(yu)}get lightMapIntensity(){return this.material.lightMapIntensity}set lightMapIntensity(e){this.tryCloneMaterial(),this.material.lightMapIntensity=e}get metalnessMap(){return this._metalnessMap}set metalnessMap(e){this.tryCloneMaterial(),this._metalnessMap=e,this.material.metalnessMap=e?to(e):null,this.applyTexture(yu)}get metalness(){return this.material.metalness}set metalness(e){this.tryCloneMaterial(),this.material.metalness=e}get roughnessMap(){return this._roughnessMap}set roughnessMap(e){this.tryCloneMaterial(),this._roughnessMap=e,this.material.roughnessMap=e?to(e):null,this.applyTexture(yu)}get roughness(){return this.material.roughness}set roughness(e){this.tryCloneMaterial(),this.material.roughness=e}get normalMap(){return this._normalMap}set normalMap(e){this.tryCloneMaterial(),this._normalMap=e,this.material.normalMap=e?to(e):null,this.applyTexture(yu)}get normalScale(){return this.material.normalScale}set normalScale(e){this.tryCloneMaterial(),typeof e=="number"?this.material.normalScale=new ze(e,e):this.material.normalScale=e}get normalMapType(){return this._normalMapType}set normalMapType(e){this.tryCloneMaterial(),this._normalMapType=e,this.material.normalMapType=e==="objectSpace"?Qj:ox}}const[Bce,Mg]=lo(),vM=qa(Bce,0,"trailing"),Ii=new Set,jC=new WeakSet;class mk extends Fj{constructor(e=new An){super(),q(this,"outerObject3d"),q(this,"nativeObject3d"),q(this,"parent"),q(this,"children"),this.outerObject3d=e,e.userData.manager=this,this.nativeObject3d=e,Ii.add(this),vM()}get uuid(){return this.outerObject3d.uuid}_append(e){var t,i,r;Ii.delete(e),vM(),(i=(t=e.parent)==null?void 0:t.children)==null||i.delete(e),e.parent=this,((r=this.children)!=null?r:this.children=new Set).add(e)}append(e){this._append(e),this.outerObject3d.add(e.outerObject3d)}attach(e){this._append(e),this.outerObject3d.attach(e.outerObject3d)}dispose(){var e,t,i;if(this.done)return this;if(super.dispose(),Ii.delete(this),vM(),(t=(e=this.parent)==null?void 0:e.children)==null||t.delete(this),this.parent=void 0,(i=this.outerObject3d.parent)==null||i.remove(this.outerObject3d),this.children)for(const r of this.children)r.dispose();return this}}const Ci=new K,Uce=new K,eRe=new K,Jd=new Mo,jce=new Mo,Hce=new K(0,0,0);Object.freeze(Hce);const sR=new K(ws,ws,ws);Object.freeze(sR);const KH=new K(Hu,Hu,Hu);Object.freeze(KH);const rv=new Hr,ZH=new gg,ai=new _g(0,0,0,"YXZ"),tRe=new Fa,JH=new DC,Wce=new Bt,y_=Math.PI*.5,QH=new yg({wireframe:!0}),x2=new AH,Ba=n=>new vp(n.x*Wi,n.y*Wi,n.z*Wi),vk=n=>new K(n.x*rn,n.y*rn,n.z*rn),[Rw,Cg]=lo(),Ow=new WeakMap,Dn=n=>{if(n.parent===St)return n.position.clone();if(Ow.has(n))return Ow.get(n).clone();const e=n.getWorldPosition(new K);return Ow.set(n,e.clone()),Cg(()=>Ow.delete(n),!0),e},kw=new WeakMap,hx=n=>{if(kw.has(n))return kw.get(n).clone();let e;return n instanceof yH?e=Dn(n):(n.updateWorldMatrix(!0,!1),rv.setFromObject(n),rv.isEmpty()?e=Dn(n):e=rv.getCenter(new K)),kw.set(n,e.clone()),Cg(()=>kw.delete(n),!0),e},Gce=!!window.chrome,Xce=(()=>{const n=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(n)?!0:!!/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(n)})(),[qce,ky]=Qe("#000000"),[Yce,aR]=Qe(!1),[Kce,fi]=Qe(void 0);Vt(()=>{const n=new vH({powerPreference:"high-performance",alpha:ky()==="transparent",logarithmicDepthBuffer:Gce&&!Xce?aR():!1,antialias:!0});return n.shadowMap.enabled=!0,n.shadowMap.type=Wj,Kce(n),()=>{n.dispose()}},[ky,aR]);const[Zce,lR]=Qe(60),$H=(n,e,t)=>{let i=0;const r=setInterval(()=>{document.hidden||(t(),e!==-1&&++i>=e&&clearInterval(r))},n);return new Cn(()=>clearInterval(r))},uR=new Set,Jce=new ik;let G0=0;const cl=[1],HC=[0];Vt(()=>{const n=fi();if(!n)return;const e=1/lR()*.9,t=1/60;n.setAnimationLoop(()=>{if(G0+=Jce.getDelta(),!(G0<e)){cl[0]=G0/t,HC[0]=G0,G0=0;for(const i of uR)i()}})},[lR,fi]);const x_=n=>(uR.add(n),new Cn(()=>uR.delete(n)));class nc extends mk{constructor(){super(...arguments),q(this,"_proxy"),q(this,"handles"),q(this,"_onLoop")}get proxy(){return this._proxy}set proxy(e){this._proxy&&(this._proxy.__target=void 0),this._proxy=e,e&&(e.__target=this)}timer(e,t,i){return this.watch($H(e,t,i))}beforeRender(e){return this.watch(Yn(e))}queueMicrotask(e){queueMicrotask(()=>!this.done&&e())}cancellable(e){return this.watch(new Cn(e))}createEffect(e,t){return this.watch(Vt(e,t))}cancelHandle(e,t){var i,r;const o=(i=this.handles)!=null?i:this.handles=new Map;if((r=o.get(e))==null||r.cancel(),!t)return;const s=t();return o.set(e,s),s}dispose(){if(this.done)return this;if(super.dispose(),this.handles)for(const e of this.handles.values())e.cancel();return this}get onLoop(){return this._onLoop}set onLoop(e){this._onLoop=e,this.cancelHandle("onLoop",e&&(()=>Yn(e)))}}class gk extends nc{get x(){return this.outerObject3d.position.x*Wi}set x(e){this.outerObject3d.position.x=e*rn}get y(){return this.outerObject3d.position.y*Wi}set y(e){this.outerObject3d.position.y=e*rn}get z(){return this.outerObject3d.position.z*Wi}set z(e){this.outerObject3d.position.z=e*rn}getWorldPosition(){return Ba(Dn(this.nativeObject3d))}}const Pp=n=>n instanceof nc&&"x"in n,dn={c:null,u:[new K,new K,new K],e:[]},wn={c:null,u:[new K,new K,new K],e:[]},oi=[[],[],[]],jt=[[],[],[]],Zn=[],Nd=new K,zd=new K,Vd=new K,er=new K,rV=new K,oV=new K,wa=new Vr,sV=new Hr,Iw=new Bt,aV=new Bt,lV=new gg;class _k{constructor(e=new K,t=new K,i=new Vr){this.center=e,this.halfSize=t,this.rotation=i}set(e,t,i){return this.center=e,this.halfSize=t,this.rotation=i,this}copy(e){return this.center.copy(e.center),this.halfSize.copy(e.halfSize),this.rotation.copy(e.rotation),this}clone(){return new this.constructor().copy(this)}getSize(e){return e.copy(this.halfSize).multiplyScalar(2)}clampPoint(e,t){const i=this.halfSize;er.subVectors(e,this.center),this.rotation.extractBasis(Nd,zd,Vd),t.copy(this.center);const r=OP.clamp(er.dot(Nd),-i.x,i.x);t.add(Nd.multiplyScalar(r));const o=OP.clamp(er.dot(zd),-i.y,i.y);t.add(zd.multiplyScalar(o));const s=OP.clamp(er.dot(Vd),-i.z,i.z);return t.add(Vd.multiplyScalar(s)),t}containsPoint(e){return er.subVectors(e,this.center),this.rotation.extractBasis(Nd,zd,Vd),Math.abs(er.dot(Nd))<=this.halfSize.x&&Math.abs(er.dot(zd))<=this.halfSize.y&&Math.abs(er.dot(Vd))<=this.halfSize.z}intersectsBox3(e){return this.intersectsOBB(Qce.fromBox3(e))}intersectsSphere(e){return this.clampPoint(e.center,oV),oV.distanceToSquared(e.center)<=e.radius*e.radius}intersectsOBB(e,t=Number.EPSILON){dn.c=this.center,dn.e[0]=this.halfSize.x,dn.e[1]=this.halfSize.y,dn.e[2]=this.halfSize.z,this.rotation.extractBasis(dn.u[0],dn.u[1],dn.u[2]),wn.c=e.center,wn.e[0]=e.halfSize.x,wn.e[1]=e.halfSize.y,wn.e[2]=e.halfSize.z,e.rotation.extractBasis(wn.u[0],wn.u[1],wn.u[2]);for(let o=0;o<3;o++)for(let s=0;s<3;s++)oi[o][s]=dn.u[o].dot(wn.u[s]);er.subVectors(wn.c,dn.c),Zn[0]=er.dot(dn.u[0]),Zn[1]=er.dot(dn.u[1]),Zn[2]=er.dot(dn.u[2]);for(let o=0;o<3;o++)for(let s=0;s<3;s++)jt[o][s]=Math.abs(oi[o][s])+t;let i,r;for(let o=0;o<3;o++)if(i=dn.e[o],r=wn.e[0]*jt[o][0]+wn.e[1]*jt[o][1]+wn.e[2]*jt[o][2],Math.abs(Zn[o])>i+r)return!1;for(let o=0;o<3;o++)if(i=dn.e[0]*jt[0][o]+dn.e[1]*jt[1][o]+dn.e[2]*jt[2][o],r=wn.e[o],Math.abs(Zn[0]*oi[0][o]+Zn[1]*oi[1][o]+Zn[2]*oi[2][o])>i+r)return!1;return i=dn.e[1]*jt[2][0]+dn.e[2]*jt[1][0],r=wn.e[1]*jt[0][2]+wn.e[2]*jt[0][1],!(Math.abs(Zn[2]*oi[1][0]-Zn[1]*oi[2][0])>i+r||(i=dn.e[1]*jt[2][1]+dn.e[2]*jt[1][1],r=wn.e[0]*jt[0][2]+wn.e[2]*jt[0][0],Math.abs(Zn[2]*oi[1][1]-Zn[1]*oi[2][1])>i+r)||(i=dn.e[1]*jt[2][2]+dn.e[2]*jt[1][2],r=wn.e[0]*jt[0][1]+wn.e[1]*jt[0][0],Math.abs(Zn[2]*oi[1][2]-Zn[1]*oi[2][2])>i+r)||(i=dn.e[0]*jt[2][0]+dn.e[2]*jt[0][0],r=wn.e[1]*jt[1][2]+wn.e[2]*jt[1][1],Math.abs(Zn[0]*oi[2][0]-Zn[2]*oi[0][0])>i+r)||(i=dn.e[0]*jt[2][1]+dn.e[2]*jt[0][1],r=wn.e[0]*jt[1][2]+wn.e[2]*jt[1][0],Math.abs(Zn[0]*oi[2][1]-Zn[2]*oi[0][1])>i+r)||(i=dn.e[0]*jt[2][2]+dn.e[2]*jt[0][2],r=wn.e[0]*jt[1][1]+wn.e[1]*jt[1][0],Math.abs(Zn[0]*oi[2][2]-Zn[2]*oi[0][2])>i+r)||(i=dn.e[0]*jt[1][0]+dn.e[1]*jt[0][0],r=wn.e[1]*jt[2][2]+wn.e[2]*jt[2][1],Math.abs(Zn[1]*oi[0][0]-Zn[0]*oi[1][0])>i+r)||(i=dn.e[0]*jt[1][1]+dn.e[1]*jt[0][1],r=wn.e[0]*jt[2][2]+wn.e[2]*jt[2][0],Math.abs(Zn[1]*oi[0][1]-Zn[0]*oi[1][1])>i+r)||(i=dn.e[0]*jt[1][2]+dn.e[1]*jt[0][2],r=wn.e[0]*jt[2][1]+wn.e[1]*jt[2][0],Math.abs(Zn[1]*oi[0][2]-Zn[0]*oi[1][2])>i+r))}intersectsPlane(e){this.rotation.extractBasis(Nd,zd,Vd);const t=this.halfSize.x*Math.abs(e.normal.dot(Nd))+this.halfSize.y*Math.abs(e.normal.dot(zd))+this.halfSize.z*Math.abs(e.normal.dot(Vd)),i=e.normal.dot(this.center)-e.constant;return Math.abs(i)<=t}intersectRay(e,t){return this.getSize(rV),sV.setFromCenterAndSize(er.set(0,0,0),rV),Iw.setFromMatrix3(this.rotation),Iw.setPosition(this.center),aV.copy(Iw).invert(),lV.copy(e).applyMatrix4(aV),lV.intersectBox(sV,t)?t.applyMatrix4(Iw):null}intersectsRay(e){return this.intersectRay(e,er)!==null}fromBox3(e){return e.getCenter(this.center),e.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(e){return e.center.equals(this.center)&&e.halfSize.equals(this.halfSize)&&e.rotation.equals(this.rotation)}applyMatrix4(e){const t=e.elements;let i=er.set(t[0],t[1],t[2]).length();const r=er.set(t[4],t[5],t[6]).length(),o=er.set(t[8],t[9],t[10]).length();e.determinant()<0&&(i=-i),wa.setFromMatrix4(e);const s=1/i,a=1/r,l=1/o;return wa.elements[0]*=s,wa.elements[1]*=s,wa.elements[2]*=s,wa.elements[3]*=a,wa.elements[4]*=a,wa.elements[5]*=a,wa.elements[6]*=l,wa.elements[7]*=l,wa.elements[8]*=l,this.rotation.multiply(wa),this.halfSize.x*=i,this.halfSize.y*=r,this.halfSize.z*=o,er.setFromMatrixPosition(e),this.center.add(er),this}}const Qce=new _k,xs={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`};class Ul{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const $ce=new ax(-1,1,1,-1,0,1),yk=new ei;yk.setAttribute("position",new Zt([-1,3,0,-1,-1,0,3,-1,0],3));yk.setAttribute("uv",new Zt([0,2,0,0,2,0],2));class qp{constructor(e){this._mesh=new Fr(yk,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,$ce)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class Uv extends Ul{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof Mn?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=zr.clone(e.uniforms),this.material=new Mn({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new qp(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class uV extends Ul{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const r=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0);let s,a;this.inverse?(s=0,a=1):(s=1,a=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),o.buffers.stencil.setFunc(r.ALWAYS,s,4294967295),o.buffers.stencil.setClear(a),o.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(r.EQUAL,1,4294967295),o.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),o.buffers.stencil.setLocked(!0)}}class ehe extends Ul{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class cR{constructor(e,t){if(this.renderer=e,t===void 0){const i=e.getSize(new ze);this._pixelRatio=e.getPixelRatio(),this._width=i.width,this._height=i.height,t=new Qn(this._width*this._pixelRatio,this._height*this._pixelRatio),t.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],xs===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),Uv===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new Uv(xs),this.clock=new ik}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let r=0,o=this.passes.length;r<o;r++){const s=this.passes[r];if(s.enabled!==!1){if(s.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),s.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),s.needsSwap){if(i){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}uV!==void 0&&(s instanceof uV?i=!0:s instanceof ehe&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new ze);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(let o=0;o<this.passes.length;o++)this.passes[o].setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new ax(-1,1,1,-1,0,1);const eW=new ei;eW.setAttribute("position",new Zt([-1,3,0,-1,-1,0,3,-1,0],3));eW.setAttribute("uv",new Zt([0,2,0,0,2,0],2));const[the,Ap]=Qe(1),xk=375,bk=667,wk=-5e-4,tW=5,nW=175,Nw=5.7,Eg=.1,yl=1e4,Sk="https://unpkg.com/lingo3d-dummy@1.0.4/assets/",Gm=Sk+"ybot.fbx",iW="https://unpkg.com/lingo3d-textures@1.0.2/assets/",[nhe,Eo]=Qe([xk,bk]),ihe=([n,e])=>nhe([Math.max(n,1),Math.max(e,1)]),[rhe,jv]=Qe(void 0);Vt(()=>{const n=fi();if(!n)return;const e=new cR(n);e.renderToScreen=!1,rhe(e)},[fi]);Vt(()=>{const n=jv();if(!n)return;const[e,t]=Eo();n.setSize(e,t),n.setPixelRatio(Math.min(Ap(),1))},[jv,Eo,Ap]);const rW=[!1],oW=n=>{n.userData.bloom=!0,rW[0]=!0},sW=n=>{n.userData.bloom=!1};let hR;const ohe=new yg({color:0});let dR=[];const aW=n=>{for(const e of n)e.userData.bloom||!e.visible||(aW(e.children),e.material&&(dR.push([e.material,e]),e.material=ohe))},she=()=>{aW(St.children),St.background&&(hR=St.background,St.background=null)},ahe=()=>{for(const[n,e]of dR)e.material=n;dR=[],hR&&(St.background=hR)},lhe=()=>{var n;she(),(n=jv())==null||n.render(),ahe()},[uhe,pR]=Qe(1),[nRe,Hv]=Qe(!1),[che,fR]=Qe(!1),[hhe,b2]=Qe(void 0),w2={createButton(n,e){e&&console.error('THREE.VRButton: The "options" parameter has been removed. Please set the reference space type via renderer.xr.setReferenceSpaceType() instead.');const t=document.createElement("button");function i(){let l=null;async function u(h){h.addEventListener("end",c),await n.xr.setSession(h),t.textContent="EXIT VR",l=h}function c(){l.removeEventListener("end",c),t.textContent="ENTER VR",l=null}t.style.display="",t.style.cursor="pointer",t.style.left="calc(50% - 50px)",t.style.width="100px",t.textContent="ENTER VR",t.onmouseenter=function(){t.style.opacity="1.0"},t.onmouseleave=function(){t.style.opacity="0.5"},t.onclick=function(){if(l===null){const h={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]};navigator.xr.requestSession("immersive-vr",h).then(u)}else l.end()}}function r(){t.style.display="",t.style.cursor="auto",t.style.left="calc(50% - 75px)",t.style.width="150px",t.onmouseenter=null,t.onmouseleave=null,t.onclick=null}function o(){r(),t.textContent="VR NOT SUPPORTED"}function s(l){r(),console.warn("Exception when trying to call xr.isSessionSupported",l),t.textContent="VR NOT ALLOWED"}function a(l){l.style.position="absolute",l.style.bottom="20px",l.style.padding="12px 6px",l.style.border="1px solid #fff",l.style.borderRadius="4px",l.style.background="rgba(0,0,0,0.1)",l.style.color="#fff",l.style.font="normal 13px sans-serif",l.style.textAlign="center",l.style.opacity="0.5",l.style.outline="none",l.style.zIndex="999"}if("xr"in navigator)return t.id="VRButton",t.style.display="none",a(t),navigator.xr.isSessionSupported("immersive-vr").then(function(l){l?i():o(),l&&w2.xrSessionIsGranted&&t.click()}).catch(s),t;{const l=document.createElement("a");return window.isSecureContext===!1?(l.href=document.location.href.replace(/^http:/,"https:"),l.innerHTML="WEBXR NEEDS HTTPS"):(l.href="https://immersiveweb.dev/",l.innerHTML="WEBXR NOT AVAILABLE"),l.style.left="calc(50% - 90px)",l.style.width="180px",l.style.textDecoration="none",a(l),l}},xrSessionIsGranted:!1,registerSessionGrantedListener(){if("xr"in navigator){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",()=>{w2.xrSessionIsGranted=!0})}}};w2.registerSessionGrantedListener();const[dhe,mR]=Qe(!1),[Mk,ta]=Qe(0),WC=()=>Mk(ta()+1),GC=()=>Mk(ta()-1),pl=document.createElement("div");Object.assign(pl.style,{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"});const Vn=document.createElement("div");Object.assign(Vn.style,{position:"absolute",left:"0px",top:"0px",width:"100%"});pl.appendChild(Vn);b2(n=>Vn.style.height=n?"50%":"100%");const Ck=[Vn.getBoundingClientRect()],fA=n=>{Ey(()=>{const e=()=>{Ck[0]=Vn.getBoundingClientRect(),ihe(n===document.body?[window.innerWidth,window.innerHeight]:[n.clientWidth,n.clientHeight])};e();const t=qa(e,100,"both");window.addEventListener("resize",t);const i=ta(t);return()=>{window.removeEventListener("resize",e),i.cancel()}},[n])};Vt(()=>{const n=mR();if(n){if(typeof n=="string"){const e=document.querySelector(n);return e?(e.prepend(pl),fA(e),()=>{e.removeChild(pl)}):void 0}return n===!0?(document.body.prepend(pl),fA(document.body),()=>{document.body.removeChild(pl)}):(n.prepend(pl),fA(n),()=>{n.removeChild(pl)})}},[mR]);Vt(()=>{const n=fi();if(!n)return;const e=n.domElement;return pl.prepend(e),Object.assign(e.style,{position:"absolute",left:"0px",top:"0px"}),()=>{pl.removeChild(e)}},[fi]);Vt(()=>{const n=fi();if(!n)return;const[e,t]=Eo();n.setSize(e,t),n.setPixelRatio(Math.min(Ap(),devicePixelRatio))},[fi,Eo,Ap]);Vt(()=>{const n=fi();!n||(n.physicallyCorrectLights=fR())},[fi,fR]);Vt(()=>{const n=fi();if(!n)return;const e=pR();n.toneMapping=e!==1?Zj:Cl,n.toneMappingExposure=e},[pR,fi]);Vt(()=>{if(Hv()!=="webxr")return;const n=fi();if(!n)return;n.xr.enabled=!0;const e=w2.createButton(n);return Vn.appendChild(e),e.ontouchstart=()=>{var t;return(t=e.onclick)==null?void 0:t.call(e,new MouseEvent("click"))},()=>{n.xr.enabled=!1,Vn.removeChild(e)}},[Hv,fi]);const Sa=new or(75,1,Eg,yl),di=new or(75,1,Eg,yl),[Ek,Lp]=Qe([di]),phe=mg(Ek,Lp),cV=vg(Ek,Lp),[fhe,mhe]=Qe(void 0),zw=new WeakMap,Dh=n=>{if(n.parent===St)return n.quaternion.clone();if(zw.has(n))return zw.get(n).clone();const e=n.getWorldQuaternion(new Mo);return zw.set(n,e.clone()),Cg(()=>zw.delete(n),!0),e},Dp=n=>Math.min(n*cl[0],1),[gM,dt]=Qe(di),vR=n=>{const[e,t]=Eo(),i=e/t;return n instanceof or&&!Hv()?(n.aspect=i,n.updateProjectionMatrix()):n instanceof ax&&([n.left,n.right,n.top,n.bottom]=[i*Nw*-.5,i*Nw*.5,Nw*.5,Nw*-.5],n.updateProjectionMatrix()),[e,t,i]},hV=(n,e,t)=>n+(e-n)*t;Vt(()=>{const n=dt()===Sa?Sa:mhe(),e=Rv(Lp()),t=e.userData.transition;if(!n||!t||n===e){gM(e);return}gM(Sa);const i=Dn(n),r=Dh(n);Sa.zoom=n.zoom,Sa.fov=n.fov,vR(Sa);let o=0;const s=typeof t=="number"?t:1/0,a=Yn(()=>{const l=Dn(e),u=Dh(e);Sa.position.lerpVectors(i,l,o),Sa.quaternion.slerpQuaternions(r,u,o),Sa.zoom=hV(n.zoom,e.zoom,o),Sa.fov=hV(n.fov,e.fov,o),Sa.updateProjectionMatrix(),o=Math.min((1-o)*Dp(.1),s)+o,!(o<.9999)&&(gM(e),vR(e),a.cancel())});return()=>{a.cancel()}},[Lp]);const Vw=new WeakMap,dV=n=>{if(Vw.has(n))return Vw.get(n);const e=hx(n),t=dt();e.project(t);const i=(e.x*.5+.5)*Vn.clientWidth,r=(e.y*-.5+.5)*Vn.clientHeight,o={x:i,y:r};return Vw.set(n,o),Cg(()=>Vw.delete(n),!0),o};class ch extends Ul{constructor(e,t,i,r){super(),this.renderScene=t,this.renderCamera=i,this.selectedObjects=r!==void 0?r:[],this.visibleEdgeColor=new vt(1,1,1),this.hiddenEdgeColor=new vt(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=e!==void 0?new ze(e.x,e.y):new ze(256,256);const o=Math.round(this.resolution.x/this.downSampleRatio),s=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new Qn(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new OC,this.depthMaterial.side=Qu,this.depthMaterial.depthPacking=LC,this.depthMaterial.blending=ji,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=Qu,this.prepareMaskMaterial.fragmentShader=c(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new Qn(this.resolution.x,this.resolution.y),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new Qn(o,s),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new Qn(o,s),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new Qn(Math.round(o/2),Math.round(s/2)),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new Qn(o,s),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new Qn(Math.round(o/2),Math.round(s/2)),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;const a=4,l=4;this.separableBlurMaterial1=this.getSeperableBlurMaterial(a),this.separableBlurMaterial1.uniforms.texSize.value.set(o,s),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(l),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(o/2),Math.round(s/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=l,this.overlayMaterial=this.getOverlayMaterial(),xs===void 0&&console.error("THREE.OutlinePass relies on CopyShader");const u=xs;this.copyUniforms=zr.clone(u.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Mn({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:ji,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new vt,this.oldClearAlpha=1,this.fsQuad=new qp(null),this.tempPulseColor1=new vt,this.tempPulseColor2=new vt,this.textureMatrix=new Bt;function c(h,p){const m=p.isPerspectiveCamera?"perspective":"orthographic";return h.replace(/DEPTH_TO_VIEW_Z/g,m+"DepthToViewZ")}}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let i=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,r),this.renderTargetBlurBuffer1.setSize(i,r),this.renderTargetEdgeBuffer1.setSize(i,r),this.separableBlurMaterial1.uniforms.texSize.value.set(i,r),i=Math.round(i/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(i,r),this.renderTargetEdgeBuffer2.setSize(i,r),this.separableBlurMaterial2.uniforms.texSize.value.set(i,r)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function i(r){r.isMesh&&(e===!0?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(let r=0;r<this.selectedObjects.length;r++)this.selectedObjects[r].traverse(i)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,i=[];function r(s){s.isMesh&&i.push(s)}for(let s=0;s<this.selectedObjects.length;s++)this.selectedObjects[s].traverse(r);function o(s){if(s.isMesh||s.isSprite){let a=!1;for(let l=0;l<i.length;l++)if(i[l].id===s.id){a=!0;break}if(a===!1){const l=s.visible;(e===!1||t.get(s)===!0)&&(s.visible=e),t.set(s,l)}}else(s.isPoints||s.isLine)&&(e===!0?s.visible=t.get(s):(t.set(s,s.visible),s.visible=e))}this.renderScene.traverse(o)}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,i,r,o){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const s=e.autoClear;e.autoClear=!1,o&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const l=.625+Math.cos(performance.now()*.01/this.pulsePeriod)*.75/2;this.tempPulseColor1.multiplyScalar(l),this.tempPulseColor2.multiplyScalar(l)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=ch.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=ch.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=ch.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=ch.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,o&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(i),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=s}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new Mn({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new ze(.5,.5)},textureMatrix:{value:null}},vertexShader:`#include <morphtarget_pars_vertex>
				#include <skinning_pars_vertex>

				varying vec4 projTexCoord;
				varying vec4 vPosition;
				uniform mat4 textureMatrix;

				void main() {

					#include <skinbase_vertex>
					#include <begin_vertex>
					#include <morphtarget_vertex>
					#include <skinning_vertex>
					#include <project_vertex>

					vPosition = mvPosition;
					vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );
					projTexCoord = textureMatrix * worldPosition;

				}`,fragmentShader:`#include <packing>
				varying vec4 vPosition;
				varying vec4 projTexCoord;
				uniform sampler2D depthTexture;
				uniform vec2 cameraNearFar;

				void main() {

					float depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));
					float viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );
					float depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;
					gl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);

				}`})}getEdgeDetectionMaterial(){return new Mn({uniforms:{maskTexture:{value:null},texSize:{value:new ze(.5,.5)},visibleEdgeColor:{value:new K(1,1,1)},hiddenEdgeColor:{value:new K(1,1,1)}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform vec2 texSize;
				uniform vec3 visibleEdgeColor;
				uniform vec3 hiddenEdgeColor;

				void main() {
					vec2 invSize = 1.0 / texSize;
					vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);
					vec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);
					vec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);
					vec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);
					vec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);
					float diff1 = (c1.r - c2.r)*0.5;
					float diff2 = (c3.r - c4.r)*0.5;
					float d = length( vec2(diff1, diff2) );
					float a1 = min(c1.g, c2.g);
					float a2 = min(c3.g, c4.g);
					float visibilityFactor = min(a1, a2);
					vec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;
					gl_FragColor = vec4(edgeColor, 1.0) * vec4(d);
				}`})}getSeperableBlurMaterial(e){return new Mn({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new ze(.5,.5)},direction:{value:new ze(.5,.5)},kernelRadius:{value:1}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;
				uniform float kernelRadius;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}

				void main() {
					vec2 invSize = 1.0 / texSize;
					float sigma = kernelRadius/2.0;
					float weightSum = gaussianPdf(0.0, sigma);
					vec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;
					vec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);
					vec2 uvOffset = delta;
					for( int i = 1; i <= MAX_RADIUS; i ++ ) {
						float x = kernelRadius * float(i) / float(MAX_RADIUS);
						float w = gaussianPdf(x, sigma);
						vec4 sample1 = texture2D( colorTexture, vUv + uvOffset);
						vec4 sample2 = texture2D( colorTexture, vUv - uvOffset);
						diffuseSum += ((sample1 + sample2) * w);
						weightSum += (2.0 * w);
						uvOffset += delta;
					}
					gl_FragColor = diffuseSum/weightSum;
				}`})}getOverlayMaterial(){return new Mn({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform sampler2D edgeTexture1;
				uniform sampler2D edgeTexture2;
				uniform sampler2D patternTexture;
				uniform float edgeStrength;
				uniform float edgeGlow;
				uniform bool usePatternTexture;

				void main() {
					vec4 edgeValue1 = texture2D(edgeTexture1, vUv);
					vec4 edgeValue2 = texture2D(edgeTexture2, vUv);
					vec4 maskColor = texture2D(maskTexture, vUv);
					vec4 patternColor = texture2D(patternTexture, 6.0 * vUv);
					float visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;
					vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;
					vec4 finalColor = edgeStrength * maskColor.r * edgeValue;
					if(usePatternTexture)
						finalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);
					gl_FragColor = finalColor;
				}`,blending:d2,depthTest:!1,depthWrite:!1,transparent:!0})}}ch.BlurDirectionX=new ze(1,0);ch.BlurDirectionY=new ze(0,1);const[vhe,gR]=Qe("#ffffff"),[ghe,_R]=Qe(void 0),[_he,yR]=Qe(void 0),[yhe,lW]=Qe(0),[xhe,uW]=Qe(3),[bhe,cW]=Qe(1),hW=[!1],Tk=[],dW=n=>{n.userData.outline||(n.userData.outline=!0,Tk.push(n),hW[0]=!0)},pW=n=>{!n.userData.outline||(n.userData.outline=!1,kj(Tk,n))},El=new ch(new ze,St,dt(),Tk);dt(n=>El.renderCamera=n);lW(n=>El.pulsePeriod=n*.001);uW(n=>El.edgeStrength=n);cW(n=>El.edgeThickness=n);Vt(()=>{var n;const e=gR(),t=(n=_R())!=null?n:e;El.visibleEdgeColor=new vt(e),El.hiddenEdgeColor=new vt(t)},[gR,_R]);Vt(()=>{const n=yR();if(n)return El.patternTexture=to(n),El.usePatternTexture=!0,()=>{El.usePatternTexture=!1}},[yR]);const whe=["name","blending","side","vertexColors","opacity","transparent","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","depthTest","depthWrite","stencilWriteMask","stencilFunc","stencilRef","stencilFuncMask","stencilFail","stencilZFail","stencilZPass","stencilWrite","clipIntersection","clipShadows","shadowSide","colorWrite","precision","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","dithering","alphaTest","alphaToCoverage","premultipliedAlpha","visible","toneMapped"],fW=(n,e)=>{for(const r of whe){const o=n[r];o!=null&&(e[r]=o)}const t=n.clippingPlanes;let i=null;if(t){const r=t.length;i=new Array(r);for(let o=0;o!==r;++o)i[o]=t[o].clone()}e.clippingPlanes=i},She=["map","gradientMap","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveMap","emissiveIntensity","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","alphaMap","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","fog"],Mhe=(n,e)=>{fW(n,e);for(const t of She){const i=n[t];i!=null&&(e[t]=i)}n.color&&e.color.copy(n.color),n.emissive&&e.emissive.copy(n.emissive),n.normalScale&&e.normalScale.copy(n.normalScale)},Che=(n,e)=>n.clone().multiply(e.clone().invert()),Fw=new WeakMap,mW=n=>{if(Fw.has(n))return Fw.get(n).clone();const e=n.getWorldDirection(new K);return Fw.set(n,e.clone()),Cg(()=>Fw.delete(n),!0),e},vW=new Set,gW=new Set,_W=new Set,yW=new Set,xW=new Set,bW=new Set;class xR{constructor(e,t,i,r,o,s,a){q(this,"clientX"),q(this,"clientY"),q(this,"xNorm"),q(this,"yNorm"),q(this,"point"),q(this,"distance"),q(this,"target"),this.clientX=e,this.clientY=t,this.xNorm=i,this.yNorm=r,this.point=o,this.distance=s,this.target=a}}const Ehe={...Uh,onClick:Function,onRightClick:Function,onMouseMove:Function,onMouseDown:Function,onMouseUp:Function,onMousePress:Function},The={...jh,onClick:void 0,onRightClick:void 0,onMouseMove:void 0,onMouseDown:void 0,onMouseUp:void 0,onMousePress:void 0},[iRe,Phe]=Qe(void 0),Ahe=n=>{const e=Ck[0],t=n.clientX-e.x,i=n.clientY-e.y,r=500;if(Phe())return new xR(t,i,0,0,new vp(0,0,0),r,void 0);const o=t/e.width*2-1,s=-(i/e.height)*2+1,a=dt();Ci.set(o,s,.5),Ci.unproject(a);const l=Dn(a);Ci.sub(l).normalize();const u=l.add(Ci.multiplyScalar(r*rn));return new xR(t,i,o,s,Ba(u),r,void 0)},[$c,Qs]=Qe("play");Vt(()=>{$c(dt()===di&&ta()?"translate":"play")},[dt,ta]);const[Lhe,ao]=Qe(!1);Qs(n=>Lhe(n!=="play"));const br=new Bj;let bR=0,wR=0,SR=0,MR=!1;Vn.addEventListener("contextmenu",n=>{n.preventDefault(),MR=!0});Vn.addEventListener("touchstart",n=>{n.preventDefault()});br.on("down",n=>{bR=Date.now(),wR=n.clientX,SR=n.clientY});br.on("up",n=>{const e=Date.now(),t=e-bR,i=Math.abs(n.clientX-wR),r=Math.abs(n.clientY-SR);bR=e,wR=n.clientX,SR=n.clientY,t<300&&i<5&&r<5&&br.emit(MR?"rightClick":"click",n),MR=!1});const Pk=Ij(Ahe,0,"leading");Vn.addEventListener("pointermove",n=>{br.emit("move",Pk(n))});let CR=!1;Vn.addEventListener("pointerdown",n=>{CR=!0;const e=Pk(n);br.emit("down",e),br.emit("move",e)});const Ak=n=>{CR&&br.emit("up",Pk(n)),CR=!1};Vn.addEventListener("pointerup",Ak);Vn.addEventListener("pointercancel",Ak);Vn.addEventListener("pointerleave",Ak);class W_ extends nc{constructor(){super(),q(this,"onClick"),q(this,"onRightClick"),q(this,"onMouseMove"),q(this,"onMouseDown"),q(this,"onMouseUp"),q(this,"onMousePress");let e={clientX:0,clientY:0};const[t,i]=Qe(!1);this.createEffect(()=>{const r=this.onMousePress;if(!i()||!r)return;const o=Yn(()=>r(e));return()=>{o.cancel()}},[i]),this.createEffect(()=>{if(ao()||ta()&&dt()===di)return;const r=br.on("move",u=>{var c;(c=this.onMouseMove)==null||c.call(this,u),e=u}),o=br.on("click",u=>{var c;(c=this.onClick)==null||c.call(this,u),e=u}),s=br.on("rightClick",u=>{var c;(c=this.onRightClick)==null||c.call(this,u),e=u}),a=br.on("down",u=>{var c;(c=this.onMouseDown)==null||c.call(this,u),e=u,t(!0)}),l=br.on("up",u=>{var c;(c=this.onMouseUp)==null||c.call(this,u),e=u,t(!1)});return()=>{r.cancel(),o.cancel(),s.cancel(),a.cancel(),l.cancel()}},[ao,ta,dt])}}q(W_,"componentName","mouse"),q(W_,"defaults",The),q(W_,"schema",Ehe);const Dhe=new W_;Ii.delete(Dhe);const pV=new vce,Rhe=(n,e,t)=>(pV.setFromCamera({x:n,y:e},dt()),pV.intersectObjects([...t])[0]),eh=(n,e,t)=>br.on(n,i=>{if(!e.size)return;const r=Rhe(i.xNorm,i.yNorm,e);if(!r)return;const o=Ba(r.point),s=r.distance*Wi;t(r.object.userData.manager,new xR(i.clientX,i.clientY,i.xNorm,i.yNorm,o,s,r.object.userData.manager))}),Ohe=()=>{Ey(()=>{if(ao())return;sk(),Fv(void 0);const n=eh("click",vW,(u,c)=>{var h;return(h=u.onClick)==null?void 0:h.call(u,c)}),e=eh("down",gW,(u,c)=>{var h;return(h=u.onMouseDown)==null?void 0:h.call(u,c)}),t=eh("up",_W,(u,c)=>{var h;return(h=u.onMouseUp)==null?void 0:h.call(u,c)});let i=new Set,r=new Set;const o=eh("move",yW,(u,c)=>{i.add(u),u.outerObject3d.userData.eMove=c}),s=eh("move",xW,(u,c)=>{i.add(u),u.outerObject3d.userData.eMove=c}),a=eh("move",bW,(u,c)=>{i.add(u),u.outerObject3d.userData.eMove=c}),l=br.on("move",()=>{var u,c,h;for(const p of i)r.has(p)||(u=p.onMouseOver)==null||u.call(p,p.outerObject3d.userData.eMove),(c=p.onMouseMove)==null||c.call(p,p.outerObject3d.userData.eMove);for(const p of r)i.has(p)||(h=p.onMouseOut)==null||h.call(p,p.outerObject3d.userData.eMove);r=i,i=new Set});return()=>{n.cancel(),e.cancel(),t.cancel(),o.cancel(),s.cancel(),a.cancel(),l.cancel()}},[ao])},[wW,SW]=lo(),[khe,Hh]=lo(),Ei=qa((n,e)=>!UH()&&khe({target:n,rightClick:e}),0,"trailing");Vt(()=>{const n=Ti();if(!n)return;const e=Mg(()=>{!n.outerObject3d.parent&&Ei()});return()=>{e.cancel()}},[Ti]);const[Ihe,na]=Qe(!1),[Lk,XC]=Qe([new Set]),Nhe=n=>{const[e]=XC();e.add(n),Lk([e]),wW()},zhe=()=>{const[n]=XC();n.clear(),Lk([n]),wW()},G_=new Set,ov=qa(n=>{const[e]=XC();if(G_.clear(),n){for(const t of n){const{manager:i}=t.userData;i&&!e.has(i)&&G_.add(i.nativeObject3d)}return}St.traverse(t=>{const{manager:i}=t.userData;i&&!e.has(i)&&G_.add(i.nativeObject3d)})},0,"trailing");let nm=[];const Vhe=()=>{Ey(()=>{if(!ao()||na()||Qs()!=="path")return;ov(nm);const n=Mg(()=>ov(nm)),e=SW(()=>{ov(nm),Ei()}),t=new Cn;Promise.all([Promise.resolve().then(()=>hpe),ki(()=>import("./Curve.a61e2957.362d6e02.js"),[])]).then(([{default:s},{default:a}])=>{if(t.done)return;const l=new a;t.then(()=>l.dispose()),t.watch(br.on("click",u=>{setTimeout(()=>{if(t.done||Ti())return;const c=new s;c.scale=.1,c.placeAt(u.point),c.name="point"+nm.length,nm.push(c.outerObject3d),Ei(c),l.addPoint(Ba(c.outerObject3d.position))})}))});const i=br.on("click",()=>Ei()),r=eh("click",G_,s=>Ei(s)),o=Hh(({target:s})=>{sk(),Fv(s)});return()=>{t.cancel(),n.cancel(),e.cancel(),t.cancel(),i.cancel(),r.cancel(),o.cancel(),Qs()!=="path"&&(nm=[])}},[ao,na,Qs])},[mA,Dk]=Qe(!1),Fhe=()=>{const n=Dk(),e=Gne(!0);Ey(()=>{!n&&(e.current=!0)},[n]),Ey(()=>{const t=Qs();if(!ao()||na()||t!=="rotate"&&t!=="scale"&&t!=="select"&&t!=="translate")return;ov();const i=Mg(()=>ov()),r=SW(()=>{ov(),Ei()}),o=br.on("click",()=>Ei());let s=!1;const a=br.on("rightClick",()=>{s=!0,queueMicrotask(()=>{!s||(s=!1,Ei(void 0,!0))})}),l=eh(["click","rightClick"],G_,c=>{Ei(c,s),s=!1}),u=Hh(({target:c,rightClick:h})=>{if(n){if(!Pp(c)||h)return;if(e.current){const p=Ti();Pp(p)&&tV(p)}e.current=!1,Wa().includes(c)?Mce(c):tV(c);return}sk(),Fv(h?c:c===Ti()?void 0:c)});return()=>{i.cancel(),r.cancel(),o.cancel(),a.cancel(),l.cancel(),u.cancel()}},[ao,na,Qs,n])};Vt(()=>{Ohe(),Vhe(),Fhe()},[ao,Qs,na,Dk]);const vA=new _k,X0=new _k,Bhe=Ij(()=>{const n=dt();JH.setFromProjectionMatrix(Wce.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse))},200,"leading"),gA=(n,e,t)=>{var i,r;const o=(r=(i=n.userData)[e])!=null?r:i[e]=n.material[e];n.material[e]=t===void 0?o:Math.max(o||0,.25)*t},Uhe=(n,e,t)=>{var i,r;const o=(r=(i=n.userData)[e])!=null?r:i[e]=n.material[e];n.material[e]=t===void 0?o:t},jhe=(n,e,t)=>{var i,r;const o=(r=(i=n.userData)[e])!=null?r:i[e]=n.material[e];n.material[e]=t===void 0?o:t},bh=new Map,Hhe=()=>new Set;class MW extends nc{constructor(){super(...arguments),q(this,"_id"),q(this,"_onClick"),q(this,"_onMouseDown"),q(this,"_onMouseUp"),q(this,"_onMouseOver"),q(this,"_onMouseOut"),q(this,"_onMouseMove"),q(this,"_visible"),q(this,"_castShadow"),q(this,"_receiveShadow"),q(this,"_metalnessFactor"),q(this,"_roughnessFactor"),q(this,"_opacityFactor"),q(this,"_adjustColor"),q(this,"_toon"),q(this,"onLookToEnd")}dispose(){return this.done?this:(super.dispose(),this._id!==void 0&&bh.get(this._id).delete(this),this)}get id(){return this._id}set id(e){this._id!==void 0&&bh.get(this._id).delete(this),this._id=e,e!==void 0&&zl(bh,e,Hhe).add(this)}addToRaycastSet(e){return e.add(this.nativeObject3d),new Cn(()=>e.delete(this.nativeObject3d))}get onClick(){return this._onClick}set onClick(e){this._onClick=e,this.cancelHandle("onClick",e&&(()=>this.addToRaycastSet(vW)))}get onMouseDown(){return this._onMouseDown}set onMouseDown(e){this._onMouseDown=e,this.cancelHandle("onMouseDown",e&&(()=>this.addToRaycastSet(gW)))}get onMouseUp(){return this._onMouseUp}set onMouseUp(e){this._onMouseUp=e,this.cancelHandle("onMouseUp",e&&(()=>this.addToRaycastSet(_W)))}get onMouseOver(){return this._onMouseOver}set onMouseOver(e){this._onMouseOver=e,this.cancelHandle("onMouseOver",e&&(()=>this.addToRaycastSet(yW)))}get onMouseOut(){return this._onMouseOut}set onMouseOut(e){this._onMouseOut=e,this.cancelHandle("onMouseOut",e&&(()=>this.addToRaycastSet(xW)))}get onMouseMove(){return this._onMouseMove}set onMouseMove(e){this._onMouseMove=e,this.cancelHandle("onMouseMove",e&&(()=>this.addToRaycastSet(bW)))}get name(){return this.outerObject3d.name}set name(e){this.outerObject3d.name=Sn.sanitizeNodeName(e)}getRay(){return ZH.set(Dn(this.nativeObject3d),mW(this.nativeObject3d))}pointAt(e){return Ba(this.getRay().at(e*rn,Ci))}rayIntersectsAt(e,t){if(this.done||e.done||this===e)return;X0.set(Dn(e.nativeObject3d),KH,new Vr().setFromMatrix4(e.nativeObject3d.matrixWorld));const i=X0.intersectRay(this.getRay(),Ci);if(i){if(t){const{x:r,y:o,z:s}=Dn(this.nativeObject3d);if(ak(i.x,i.y,i.z,r,o,s)*Wi>t)return}return Ba(i)}}rayIntersects(e){return!!this.rayIntersectsAt(e)}intersects(e){return this.done||e.done||this===e?!1:(vA.set(Dn(this.nativeObject3d),sR.clone(),new Vr),vA.applyMatrix4(this.nativeObject3d.matrixWorld),X0.set(Dn(e.nativeObject3d),sR.clone(),new Vr),X0.applyMatrix4(e.nativeObject3d.matrixWorld),vA.intersectsOBB(X0,0))}get clientX(){return dV(this.nativeObject3d).x}get clientY(){return dV(this.nativeObject3d).y}get bloom(){return!!this.outerObject3d.userData.bloom}set bloom(e){e&&oW(this.outerObject3d),this.cancelHandle("bloom",e&&(()=>new Cn(()=>sW(this.outerObject3d))))}get outline(){return!!this.nativeObject3d.userData.outline}set outline(e){e&&dW(this.nativeObject3d),this.cancelHandle("outline",e&&(()=>new Cn(()=>pW(this.nativeObject3d))))}get visible(){return this._visible!==!1}set visible(e){this._visible=e,this.outerObject3d.visible=e}get frustumCulled(){return this.outerObject3d.frustumCulled}set frustumCulled(e){this.outerObject3d.frustumCulled=e}get castShadow(){var e;return(e=this._castShadow)!=null?e:!0}set castShadow(e){this._castShadow=e,this.outerObject3d.traverse(t=>t.castShadow=e)}get receiveShadow(){var e;return(e=this._receiveShadow)!=null?e:!0}set receiveShadow(e){this._receiveShadow=e,this.outerObject3d.traverse(t=>t.receiveShadow=e)}refreshFactors(){this.cancelHandle("refreshFactors",()=>{const e=new Cn;return queueMicrotask(()=>{if(e.done)return;const{_toon:t,_metalnessFactor:i,_roughnessFactor:r,_opacityFactor:o,_adjustColor:s}=this;this.outerObject3d.traverse(a=>{let{material:l}=a;!l||(Array.isArray(l)&&(l=l[0]),t&&(a.material=new Pue,Mhe(l,a.material),e.then(()=>{a.material.dispose(),a.material=l})),i!==void 0&&gA(a,"metalness",i!==0?i:void 0),r!==void 0&&gA(a,"roughness",r!==1?r:void 0),o!==void 0&&(gA(a,"opacity",o),Uhe(a,"transparent",o<=1?!0:void 0)),s!==void 0&&jhe(a,"color",s!=="#ffffff"?new vt(s):void 0))})}),e})}get metalnessFactor(){return this._metalnessFactor}set metalnessFactor(e){this._metalnessFactor=e,this.refreshFactors()}get roughnessFactor(){return this._roughnessFactor}set roughnessFactor(e){this._roughnessFactor=e,this.refreshFactors()}get opacityFactor(){return this._opacityFactor}set opacityFactor(e){this._opacityFactor=e,this.refreshFactors()}get adjustColor(){return this._adjustColor}set adjustColor(e){this._adjustColor=e,this.refreshFactors()}get toon(){var e;return(e=this._toon)!=null?e:!1}set toon(e){this._toon=e,this.refreshFactors()}get frustumVisible(){return Bhe(),JH.containsPoint(hx(this.nativeObject3d))}lookAt(e,t,i){if(typeof e=="number"){this.lookAt(new vp(e,t===void 0?this.outerObject3d.position.y*Wi:t,i));return}"outerObject3d"in e?this.outerObject3d.lookAt(Dn(e.nativeObject3d)):this.outerObject3d.lookAt(vk(e))}lookTo(e,t,i,r){if(typeof e=="number"){this.lookTo(new vp(e,t===void 0?this.outerObject3d.position.y*Wi:t,i),r);return}const{quaternion:o}=this.outerObject3d,s=o.clone();this.lookAt(e);const a=o.clone();o.copy(s),this.cancelHandle("lookTo",()=>Yn(()=>{var l;o.slerp(a,Dp(t));const{x:u,y:c,z:h}=Che(o,a);Math.abs(u)+Math.abs(c)+Math.abs(h)<.001&&(this.cancelHandle("lookTo",void 0),(l=this.onLookToEnd)==null||l.call(this),o.copy(a))}))}getWorldPosition(){return Ba(Dn(this.nativeObject3d))}}const[Whe,Rh]=Qe(!1),Ghe=new WeakMap,fV=new WeakMap,_A=new WeakMap;class Iy extends Fj{constructor(e,t){super(),q(this,"clip"),q(this,"name"),q(this,"mixer"),q(this,"action"),this.mixer=zl(Ghe,t,()=>new mce(t)),typeof e=="string"?this.name=e:(this.name=e.name,this.loadClip(e))}retarget(e){const t=this.clip.clone(),i=e.name+".";return t.tracks=t.tracks.filter(r=>r.name.startsWith(i)),new Iy(t,e)}dispose(){return this.done?this:(super.dispose(),this.stop(),this)}get duration(){var e,t;return(t=(e=this.clip)==null?void 0:e.duration)!=null?t:0}loadClip(e){this.clip=e,this.action=this.mixer.clipAction(e)}setTracks(e){const t=Object.entries(e).map(([i,r])=>new Oy("."+i,Object.keys(r).map(o=>Number(o)),Object.values(r)));this.clip&&this.mixer.uncacheClip(this.clip),this.loadClip(new rR(this.name,-1,t))}play({crossFade:e=.25,repeat:t=!0,onFinish:i}={}){var r,o;const[s,a]=(r=fV.get(this.mixer))!=null?r:[];if((s==null?void 0:s.isRunning())&&this.action===s){t!==a&&s.setLoop(t?KD:YD,1/0);return}(o=_A.get(this.mixer))==null||o.cancel();const l=this.watch(Yn(()=>this.mixer.update(HC[0])));_A.set(this.mixer,l);const{action:u}=this;if(!u)return;s&&e?(u.time=0,u.enabled=!0,u.crossFadeFrom(s,e,!0)):this.mixer.stopAllAction(),fV.set(this.mixer,[u,t]),u.setLoop(t?KD:YD,1/0),u.clampWhenFinished=!0;const c=()=>i==null?void 0:i();this.mixer.addEventListener("finished",c),l.then(()=>this.mixer.removeEventListener("finished",c)),u.paused&&u.stop(),u.play()}stop(){var e;this.action&&(this.action.paused=!0),(e=_A.get(this.mixer))==null||e.cancel()}getPaused(){var e;return(e=this.action)==null?void 0:e.paused}setPaused(e){this.action&&(this.action.paused=e)}update(e){this.mixer.time=0,this.action&&(this.action.time=0),this.mixer.update(e)}}const Xhe=qa(n=>{const e=Object.entries(n);let t=0;for(const[,{length:o}]of e)o>t&&(t=o);const i=1e3*.001/t,r={};for(const[o,s]of e)r[o]=Object.fromEntries(s.map((a,l)=>[(l*i).toFixed(2),a]));return r},0,"trailingPromise");class qhe extends MW{constructor(){super(...arguments),q(this,"animationManagers"),q(this,"animationManager"),q(this,"_animationPaused"),q(this,"animationRepeat"),q(this,"onAnimationFinish"),q(this,"serializeAnimation"),q(this,"_animation")}get animations(){var e;return(e=this.animationManagers)!=null?e:this.animationManagers={}}set animations(e){this.animationManagers=e}createAnimation(e){if(e in this.animations){const i=this.animations[e];if(typeof i!="string")return i}const t=this.watch(new Iy(e,this));return this.animations[e]=t,t}buildAnimation(e){Xhe(e).then(t=>{const i="lingo3d-animation";this.createAnimation(i).setTracks(t),this.playAnimation(i)})}makeAnimationProxy(e){return new Proxy(e,{get:(t,i)=>t[i],set:(t,i,r)=>(t[i]=r,this.buildAnimation(t),!0)})}get animationPaused(){return this._animationPaused}set animationPaused(e){var t;this._animationPaused=e,(t=this.animationManager)==null||t.setPaused(!!e)}playAnimation(e,t){const i=this.animationManager=typeof e=="string"?this.animations[e]:Object.values(this.animations)[e!=null?e:0];!i||(i.play(t),this._animationPaused&&i.setPaused(!0))}stopAnimation(){var e;(e=this.animationManager)==null||e.stop()}setAnimation(e,t){if(this._animation=e,typeof e=="string"||typeof e=="number"){this.serializeAnimation=e,this.playAnimation(e,t);return}if(typeof e=="boolean"){e?this.playAnimation(void 0,t):this.stopAnimation();return}if(!e){this.stopAnimation();return}this._animation=this.makeAnimationProxy(e),this.buildAnimation(e)}get animation(){return this._animation}set animation(e){if(Array.isArray(e)){let t=0;const i={onFinish:()=>{var r;if(++t>=e.length){if(this.animationRepeat===!1){(r=this.onAnimationFinish)==null||r.call(this);return}t=0}this.setAnimation(e[t],i)},repeat:!1};this.setAnimation(e[0],i);return}this.queueMicrotask(()=>this.setAnimation(e,{repeat:this.animationRepeat,onFinish:this.onAnimationFinish}))}}const Bw=new WeakMap,ic=n=>{if(Bw.has(n))return Bw.get(n).clone();const e=n.nativeObject3d.scale.clone().multiply(n.outerObject3d.scale);return Bw.set(n,e.clone()),Cg(()=>Bw.delete(n),!0),e},mV=new WeakMap,vV=(n,e)=>{const t=mV.get(n);if(t)return t;const i=ak(n.x,n.y,n.z,e.x*Wi,e.y*Wi,e.z*Wi);return mV.set(n,i),i};class Yp extends qhe{constructor(){super(...arguments),q(this,"onIntersectState"),q(this,"onIntersectOutState"),q(this,"intersectIdsState"),q(this,"onMoveToEnd")}getRayIntersectionsAt(e,t){var i;const r=[];for(const s of(i=bh.get(e))!=null?i:[]){if(s===this)continue;const a=this.rayIntersectsAt(s,t);a&&r.push([s,a])}const o=Dn(this.nativeObject3d);return r.sort((s,a)=>vV(s[1],o)-vV(a[1],o))}getRayIntersections(e,t){return this.getRayIntersectionsAt(e,t).map(i=>i[0])}listenToRayIntersection(e,t,i){return this.beforeRender(()=>{for(const[r,o]of this.getRayIntersectionsAt(e,i))t(r,o)})}getIntersections(e){var t;const i=[];for(const r of(t=bh.get(e))!=null?t:[])r!==this&&this.intersects(r)&&i.push(r);return i}listenToIntersection(e,t,i){let r=[];return this.beforeRender(()=>{const o=this.getIntersections(e);if(t)for(const s of o)r.includes(s)||t(s);if(i)for(const s of r)o.includes(s)||i(s);r=o})}initIntersect(){this.onIntersectState||(this.onIntersectState=new Pt(void 0),this.onIntersectOutState=new Pt(void 0),this.intersectIdsState=new Pt(void 0),this.createEffect(()=>{const{onIntersect:e,onIntersectOut:t,intersectIds:i}=this;if(!i||!e&&!t)return;const r=[];for(const o of i)r.push(this.listenToIntersection(o,e,t));return()=>{for(const o of r)o.cancel()}},[this.onIntersectState.get,this.onIntersectOutState.get,this.intersectIdsState.get]))}get onIntersect(){var e;return(e=this.onIntersectState)==null?void 0:e.get()}set onIntersect(e){var t;this.initIntersect(),(t=this.onIntersectState)==null||t.set(e)}get onIntersectOut(){var e;return(e=this.onIntersectOutState)==null?void 0:e.get()}set onIntersectOut(e){var t;this.initIntersect(),(t=this.onIntersectOutState)==null||t.set(e)}get intersectIds(){var e;return(e=this.intersectIdsState)==null?void 0:e.get()}set intersectIds(e){var t;this.initIntersect(),(t=this.intersectIdsState)==null||t.set(e)}get scaleX(){return this.outerObject3d.scale.x}set scaleX(e){this.outerObject3d.scale.x=e}get scaleY(){return this.outerObject3d.scale.y}set scaleY(e){this.outerObject3d.scale.y=e}get scaleZ(){return this.outerObject3d.scale.z}set scaleZ(e){this.outerObject3d.scale.z=e}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e,this.scaleZ=e}get rotationX(){return this.outerObject3d.rotation.x*gp}set rotationX(e){this.outerObject3d.rotation.x=e*yr}get rotationY(){return this.outerObject3d.rotation.y*gp}set rotationY(e){this.outerObject3d.rotation.y=e*yr}get rotationZ(){return this.outerObject3d.rotation.z*gp}set rotationZ(e){this.outerObject3d.rotation.z=e*yr}get rotation(){return this.rotationZ}set rotation(e){this.rotationZ=e}translateX(e){this.outerObject3d.translateX(e*rn*cl[0])}translateY(e){this.outerObject3d.translateY(e*rn*cl[0])}translateZ(e){this.outerObject3d.translateZ(e*rn*cl[0])}placeAt(e){var t;if(typeof e=="string"){const[i]=(t=bh.get(e))!=null?t:[void 0];if(!i)return;e=i}if("outerObject3d"in e){"isSpawnPoint"in e&&(e.object3d.position.y=ic(this).y*.5),this.outerObject3d.position.copy(hx(e.nativeObject3d)),this.outerObject3d.quaternion.copy(Dh(e.outerObject3d));return}this.outerObject3d.position.copy(vk(e))}moveForward(e){Rh()?this.translateZ(-e):(Ci.setFromMatrixColumn(this.outerObject3d.matrix,0),Ci.crossVectors(this.outerObject3d.up,Ci),this.outerObject3d.position.addScaledVector(Ci,e*rn*cl[0]))}moveRight(e){Rh()?this.translateX(e):(Ci.setFromMatrixColumn(this.outerObject3d.matrix,0),this.outerObject3d.position.addScaledVector(Ci,e*rn*cl[0]))}lerpTo(e,t,i,r,o){const s=new K(this.x,this.y,this.z),a=new K(e,t,i);this.cancelHandle("lerpTo",()=>Yn(()=>{var l;const{x:u,y:c,z:h}=s.lerp(a,Dp(r));Math.abs(this.x-u)<.1&&Math.abs(this.y-c)<.1&&Math.abs(this.z-h)<.1&&(this.cancelHandle("lerpTo",void 0),(l=this.onMoveToEnd)==null||l.call(this)),this.x=u,this.y=c,this.z=h,o==null||o()}))}moveTo(e,t,i,r,o){const{x:s,y:a,z:l}=new K(e-this.x,t===void 0?0:t-this.y,i-this.z).normalize(),u=r*s,c=r*a,h=r*l;let p=1/0;this.cancelHandle("lerpTo",()=>Yn(()=>{var m;this.x+=u*cl[0],t!==void 0&&(this.y+=c*cl[0]),this.z+=h*cl[0];let y=ak(this.x,t===void 0?0:this.y,this.z,e,t===void 0?0:t,i);y>=p&&(this.cancelHandle("lerpTo",void 0),(m=this.onMoveToEnd)==null||m.call(this),this.x=e,t!==void 0&&(this.y=t),this.z=i),p=y,o==null||o(t)}))}}ix(Yp,[gk]);class Nu extends Yp{constructor(e){var t;super(e),q(this,"material"),q(this,"model"),q(this,"managerSet"),this.material=(t=e.material)!=null?t:e.material=x2,Ii.delete(this)}retargetAnimations(){var e;if((e=this.model)!=null&&e.animationManagers){for(const t of Object.values(this.model.animationManagers))this.animations[t.name]=this.watch(t.retarget(this.nativeObject3d));this.model=void 0}}get animation(){return super.animation}set animation(e){this.retargetAnimations(),super.animation=e}addToRaycastSet(e){return this.managerSet||(this.managerSet=!0,this.nativeObject3d.traverse(t=>t.userData.manager=this)),super.addToRaycastSet(e)}}q(Nu,"componentName","find"),q(Nu,"defaults",Rce),q(Nu,"schema",Dce);ix(Nu,[cx,fk]);const[Yhe,CW]=Qe(20),[Khe,gV]=Qe(void 0),Tg=Up(async()=>{const{World:n,GSSolver:e,SplitSolver:t,NaiveBroadphase:i,Material:r,ContactMaterial:o,Body:s,Vec3:a,Box:l,Sphere:u,Cylinder:c}=await ki(()=>import("./cannon-es.9b610247.c06cecb3.js"),[]),h=new n;CW(_=>h.gravity.set(0,-_,0)),h.quatNormalizeSkip=0,h.quatNormalizeFast=!1;const p=new e;h.defaultContactMaterial.contactEquationStiffness=1e9,h.defaultContactMaterial.contactEquationRelaxation=4,p.iterations=7,p.tolerance=.1,h.solver=new t(p),h.broadphase=new i;const[m]=h.defaultContactMaterial.materials,y=new r("slipperyMaterial");return h.addContactMaterial(new o(y,y,{friction:0,restitution:0})),h.addContactMaterial(new o(y,m,{friction:.001,restitution:0})),Khe(h),{world:h,defaultMaterial:m,slipperyMaterial:y,Body:s,Vec3:a,Box:l,Sphere:u,Cylinder:c}});async function EW(){const{Box:n}=await Tg();this.cannonBody.addShape(new n(ic(this).multiplyScalar(.5)))}const _V=new Map,Zhe=new Set,S2=new Map,yV=new WeakSet,Jhe=()=>new WeakSet;Vt(function(){if(ao())return;const n=gV();if(!n)return;const e=Yn(()=>{for(const t of Zhe){const i=t.cannonBody;if("_mAV"in t){const{x:s,y:a,z:l}=t._mAV,{angularVelocity:u}=i;u.x>s?u.x=s:u.x<-s&&(u.x=-s),u.y>a?u.y=a:u.y<-a&&(u.y=-a),u.z>l?u.z=l:u.z<-l&&(u.z=-l)}if("_mV"in t){const{x:s,y:a,z:l}=t._mV,{velocity:u}=i;u.x>s?u.x=s:u.x<-s&&(u.x=-s),u.y>a?u.y=a:u.y<-a&&(u.y=-a),u.z>l?u.z=l:u.z<-l&&(u.z=-l)}const r=t.positionUpdate;r.x&&(i.position.x=t.outerObject3d.position.x,i.velocity.x=0,i.force.x=0),r.y&&(i.position.y=t.outerObject3d.position.y,i.velocity.y=0,i.force.y=0),r.z&&(i.position.z=t.outerObject3d.position.z,i.velocity.z=0,i.force.z=0),r.reset(),t.outerObject3d.position.copy(i.position);const o=t.rotationUpdate;o?(o.x&&(i.angularVelocity.x=0,i.torque.x=0),o.y&&(i.angularVelocity.y=0,i.torque.y=0),o.z&&(i.angularVelocity.z=0,i.torque.z=0),i.quaternion.copy(t.outerObject3d.quaternion)):t.outerObject3d.quaternion.copy(i.quaternion),o.reset}n.step(HC[0]),S2.clear();for(const t of n.contacts)zl(S2,t.bi,Jhe).add(t.bj)});return()=>{e.cancel()}},[gV,ao]);const ER=new WeakSet;class Rk extends Yp{constructor(){super(...arguments),q(this,"_mAV"),q(this,"_mV"),q(this,"cannonBody"),q(this,"positionUpdate"),q(this,"rotationUpdate"),q(this,"_noTumble"),q(this,"_slippery"),q(this,"_mass"),q(this,"_physicsGroup"),q(this,"_ignorePhysicsGroups"),q(this,"_physicsShape"),q(this,"bvhVelocity"),q(this,"bvhOnGround"),q(this,"bvhRadius"),q(this,"bvhHalfHeight"),q(this,"bvhMap"),q(this,"bvhCharacter"),q(this,"_physics"),q(this,"_gravity")}getMAV(){var e;return(e=this._mAV)!=null?e:this._mAV=new vp(1/0,1/0,1/0)}get maxAngularVelocityX(){var e,t;return(t=(e=this._mAV)==null?void 0:e.x)!=null?t:1/0}set maxAngularVelocityX(e){this.getMAV().x=e}get maxAngularVelocityY(){var e,t;return(t=(e=this._mAV)==null?void 0:e.y)!=null?t:1/0}set maxAngularVelocityY(e){this.getMAV().y=e}get maxAngularVelocityZ(){var e,t;return(t=(e=this._mAV)==null?void 0:e.z)!=null?t:1/0}set maxAngularVelocityZ(e){this.getMAV().z=e}getMV(){var e;return(e=this._mV)!=null?e:this._mV=new vp(1/0,1/0,1/0)}get maxVelocityX(){var e,t;return(t=(e=this._mV)==null?void 0:e.x)!=null?t:1/0}set maxVelocityX(e){this.getMV().x=e}get maxVelocityY(){var e,t;return(t=(e=this._mV)==null?void 0:e.y)!=null?t:1/0}set maxVelocityY(e){this.getMV().y=e}get maxVelocityZ(){var e,t;return(t=(e=this._mV)==null?void 0:e.z)!=null?t:1/0}set maxVelocityZ(e){this.getMV().z=e}applyForce(e,t,i){setTimeout(()=>{var r;return(r=this.cannonBody)==null?void 0:r.applyForce({x:e,y:t,z:i})})}applyImpulse(e,t,i){setTimeout(()=>{var r;return(r=this.cannonBody)==null?void 0:r.applyImpulse({x:e,y:t,z:i})})}applyLocalForce(e,t,i){setTimeout(()=>{var r;return(r=this.cannonBody)==null?void 0:r.applyLocalForce({x:e,y:t,z:i})})}applyLocalImpulse(e,t,i){setTimeout(()=>{var r;return(r=this.cannonBody)==null?void 0:r.applyLocalImpulse({x:e,y:t,z:i})})}applyTorque(e,t,i){setTimeout(()=>{var r;return(r=this.cannonBody)==null?void 0:r.applyTorque({x:e,y:t,z:i})})}get velocity(){return this.bvhVelocity?this.bvhVelocity:this.cannonBody?this.cannonBody.velocity:new vp(0,0,0)}set velocity(e){this.bvhVelocity?Object.assign(this.bvhVelocity,e):this.cannonBody&&Object.assign(this.cannonBody.velocity,e)}refreshCannon(){var e;this.positionUpdate&&(this.physics=(e=this._physics)!=null?e:!1)}get noTumble(){return this._noTumble}set noTumble(e){this._noTumble=e,this.refreshCannon()}get slippery(){return this._slippery}set slippery(e){this._slippery=e,this.refreshCannon()}get mass(){return this._mass}set mass(e){this._mass=e,this.refreshCannon()}get physicsGroup(){return this._physicsGroup}set physicsGroup(e){this._physicsGroup=e,this.refreshCannon()}get ignorePhysicsGroups(){return this._ignorePhysicsGroups}set ignorePhysicsGroups(e){this._ignorePhysicsGroups=e,this.refreshCannon()}get physicsShape(){var e;return(e=this._physicsShape)!=null?e:this._physicsShape=EW}set physicsShape(e){this._physicsShape=e,this.refreshCannon()}initPhysics(e,t){if(!(!e||t.done))switch(e){case!0:case"2d":ki(()=>import("./enableCannon.12ff8a49.c0755f57.js"),["assets/enableCannon.12ff8a49.c0755f57.js","assets/PhysicsUpdate.ec7ea27a.0d0fdcd8.js"]).then(i=>i.default.call(this,t));break;case"map":this.bvhMap=!0,ki(()=>import("./enableBVHMap.0d05766c.3b23cbc4.js"),["assets/enableBVHMap.0d05766c.3b23cbc4.js","assets/useBVHMap.03386216.7cafaa26.js"]).then(i=>i.default.call(this,t,!1));break;case"map-debug":this.bvhMap=!0,ki(()=>import("./enableBVHMap.0d05766c.3b23cbc4.js"),["assets/enableBVHMap.0d05766c.3b23cbc4.js","assets/useBVHMap.03386216.7cafaa26.js"]).then(i=>i.default.call(this,t,!0));break;case"character":this.bvhCharacter=!0,ki(()=>import("./enableBVHCharacter.ac58f182.c4a7067a.js"),["assets/enableBVHCharacter.ac58f182.c4a7067a.js","assets/useBVHMap.03386216.7cafaa26.js","assets/PhysicsUpdate.ec7ea27a.0d0fdcd8.js"]).then(i=>i.default.call(this,t));break;default:Vne(e)}}get physics(){var e;return(e=this._physics)!=null?e:!1}set physics(e){this._physics=e,this.initPhysics(e,this.cancelHandle("physics",()=>new Cn))}get gravity(){var e;return(e=this._gravity)!=null?e:!0}set gravity(e){this._gravity=e}intersects(e){var t,i,r,o;if(this.done||e.done||this===e)return!1;if(e instanceof Rk){if(this.bvhMap&&e.bvhCharacter||this.bvhCharacter&&e.bvhMap)return((t=_V.get(this))==null?void 0:t.has(e))||((i=_V.get(e))==null?void 0:i.has(this))||!1;if(this.cannonBody&&e.cannonBody)return yV.add(this.cannonBody),yV.add(e.cannonBody),((r=S2.get(this.cannonBody))==null?void 0:r.has(e.cannonBody))||((o=S2.get(e.cannonBody))==null?void 0:o.has(this.cannonBody))||!1}return super.intersects(e)}get x(){return super.x}set x(e){var t;super.x=e,(t=this.positionUpdate)==null||t.updateX()}get y(){return super.y}set y(e){var t;super.y=e,(t=this.positionUpdate)==null||t.updateY()}get z(){return super.z}set z(e){var t;super.z=e,(t=this.positionUpdate)==null||t.updateZ()}get rotationX(){return super.rotationX}set rotationX(e){var t;super.rotationX=e,(t=this.rotationUpdate)==null||t.updateX()}get rotationY(){return super.rotationY}set rotationY(e){var t;super.rotationY=e,(t=this.rotationUpdate)==null||t.updateY()}get rotationZ(){return super.rotationZ}set rotationZ(e){var t;super.rotationZ=e,(t=this.rotationUpdate)==null||t.updateZ()}lookAt(e,t,i){var r;super.lookAt(e,t,i),(r=this.rotationUpdate)==null||r.updateXYZ()}placeAt(e){var t,i;super.placeAt(e),(t=this.positionUpdate)==null||t.updateXYZ(),(i=this.rotationUpdate)==null||i.updateXYZ(),ER.add(this)}lerpTo(e,t,i,r){super.lerpTo(e,t,i,r,()=>{var o;return(o=this.positionUpdate)==null?void 0:o.updateXYZ()})}moveTo(e,t,i,r){super.moveTo(e,t,i,r,o=>{var s,a;return o===void 0?(s=this.positionUpdate)==null?void 0:s.updateXZ():(a=this.positionUpdate)==null?void 0:a.updateXYZ()})}}class ia extends Rk{constructor(e=new An,t){super(e),q(this,"object3d"),this.object3d=e,this.nativeObject3d=e;const i=this.outerObject3d=new An;i.userData.manager=this,!t&&St.add(i),i.add(e)}get innerRotationX(){return this.object3d.rotation.x*gp}set innerRotationX(e){this.object3d.rotation.x=e*yr}get innerRotationY(){return this.object3d.rotation.y*gp}set innerRotationY(e){this.object3d.rotation.y=e*yr}get innerRotationZ(){return this.object3d.rotation.z*gp}set innerRotationZ(e){this.object3d.rotation.z=e*yr}get innerRotation(){return this.innerRotationZ}set innerRotation(e){this.innerRotationZ=e}get innerX(){return this.object3d.position.x*Wi}set innerX(e){this.object3d.position.x=e*rn}get innerY(){return this.object3d.position.y*Wi}set innerY(e){this.object3d.position.y=e*rn}get innerZ(){return this.object3d.position.z*Wi}set innerZ(e){this.object3d.position.z=e*rn}get width(){return this.object3d.scale.x*Wi}set width(e){this.object3d.scale.x=e*rn}get height(){return this.object3d.scale.y*Wi}set height(e){this.object3d.scale.y=e*rn}get depth(){return this.object3d.scale.z*Wi}set depth(e){this.object3d.scale.z=e*rn}get innerVisible(){return this.object3d.visible}set innerVisible(e){this.object3d.visible=e}find(e,t){var i,r;const o=this.outerObject3d.getObjectByName(Sn.sanitizeNodeName(e));if(!o)return;const s=(r=(i=o.userData).manager)!=null?r:i.manager=new Nu(o);return!t&&this._append(s),s}findAll(e){const t=[];return e===void 0?this.outerObject3d.traverse(i=>{var r,o;t.push((o=(r=i.userData).manager)!=null?o:r.manager=new Nu(i))}):typeof e=="string"?this.outerObject3d.traverse(i=>{var r,o;i.name===e&&t.push((o=(r=i.userData).manager)!=null?o:r.manager=new Nu(i))}):typeof e=="function"?this.outerObject3d.traverse(i=>{var r,o;e(i.name)&&t.push((o=(r=i.userData).manager)!=null?o:r.manager=new Nu(i))}):this.outerObject3d.traverse(i=>{var r,o;e.test(i.name)&&t.push((o=(r=i.userData).manager)!=null?o:r.manager=new Nu(i))}),t}}const Qhe={...GH,maxAngularVelocityX:Number,maxAngularVelocityY:Number,maxAngularVelocityZ:Number,maxVelocityX:Number,maxVelocityY:Number,maxVelocityZ:Number,velocity:Object,gravity:Boolean,noTumble:Boolean,slippery:Boolean,mass:Number,physicsGroup:Number,ignorePhysicsGroups:Array,physics:[String,Boolean],physicsShape:Function};FC(["maxAngularVelocityX","maxAngularVelocityY","maxAngularVelocityZ","maxVelocityX","maxVelocityY","maxVelocityZ","velocity","noTumble","slippery","mass","physicsGroup","ignorePhysicsGroups","physicsShape"]);const $he={...XH,maxAngularVelocityX:1/0,maxAngularVelocityY:1/0,maxAngularVelocityZ:1/0,maxVelocityX:1/0,maxVelocityY:1/0,maxVelocityZ:1/0,velocity:{x:0,y:0,z:0},gravity:!0,noTumble:new ci(!1),slippery:new ci(!1),mass:new ci(1),physicsGroup:void 0,ignorePhysicsGroups:void 0,physics:!1,physicsShape:EW},rc={...Qhe,innerRotationX:Number,innerRotationY:Number,innerRotationZ:Number,innerRotation:Number,innerX:Number,innerY:Number,innerZ:Number,width:Number,height:Number,depth:Number,innerVisible:Boolean},oc={...$he,innerRotationX:0,innerRotationY:0,innerRotationZ:0,innerRotation:0,innerX:0,innerY:0,innerZ:0,width:100,height:100,depth:100,innerVisible:!0},Ok={...rc,...BC,...ck},kk={...oc,...UC,...hk};class Cs extends ia{constructor(e){const t=new Fr(e,x2);t.castShadow=!0,t.receiveShadow=!0,super(t),q(this,"material",x2)}}q(Cs,"defaults",kk),q(Cs,"schema",Ok);ix(Cs,[cx,fk]);const TW=new Wp(ws,ws,ws,1,1,1);class qC extends Cs{constructor(){super(TW)}}q(qC,"componentName","cube");const _M=new WeakMap,PW=n=>{_M.has(n)&&(_M.get(n)(),_M.delete(n))},xV=(n,e)=>{PW(n);const t=n(e);t&&_M.set(n,t)};class ede{constructor(){q(this,"done"),q(this,"value"),q(this,"callbacks",[])}then(e){return this.callbacks.push(e),this.done&&xV(e,this.value),new Cn(()=>{kj(this.callbacks,e),PW(e)})}resolve(e){this.done=!0,this.value=e;for(const t of this.callbacks)xV(t,e)}}const tde=n=>{const e=new Vj;return n.then(t=>{e.resolve(t)}),e};class dx extends ia{constructor(e){super(new Fr(TW,QH),e),q(this,"loadedGroup",new Ys),q(this,"loaded",new ede),q(this,"_src"),q(this,"_onLoad"),q(this,"widthSet"),q(this,"heightSet"),q(this,"depthSet"),q(this,"_boxVisible"),q(this,"_outline"),q(this,"_bloom"),q(this,"managerSet"),this.outerObject3d.add(this.loadedGroup)}get src(){return this._src}set src(e){this._src=e,this.loaded.done&&this.loadedGroup.clear(),this.cancelHandle("src",e&&(()=>tde(this.load(e)).then(t=>{const i=this.resolveLoaded(t,e);this.loadedGroup.add(i),this.loaded.resolve(i),this.object3d.visible=!!this._boxVisible})))}get onLoad(){return this._onLoad}set onLoad(e){this._onLoad=e,this.cancelHandle("onLoad",e&&(()=>this.loaded.then(()=>void e())))}get width(){return super.width}set width(e){super.width=e,this.widthSet=!0}get height(){return super.height}set height(e){super.height=e,this.heightSet=!0}get depth(){return super.depth}set depth(e){super.depth=e,this.depthSet=!0}get innerRotationX(){return super.innerRotationX}set innerRotationX(e){super.innerRotationX=e,this.loadedGroup.rotation.x=this.object3d.rotation.x}get innerRotationY(){return super.innerRotationY}set innerRotationY(e){super.innerRotationY=e,this.loadedGroup.rotation.y=this.object3d.rotation.y}get innerRotationZ(){return super.innerRotationZ}set innerRotationZ(e){super.innerRotationZ=e,this.loadedGroup.rotation.z=this.object3d.rotation.z}get innerX(){return super.innerX}set innerX(e){super.innerX=e,this.loadedGroup.position.x=this.object3d.position.x}get innerY(){return super.innerY}set innerY(e){super.innerY=e,this.loadedGroup.position.y=this.object3d.position.y}get innerZ(){return super.innerZ}set innerZ(e){super.innerZ=e,this.loadedGroup.position.z=this.object3d.position.z}get innerVisible(){return this.loadedGroup.visible}set innerVisible(e){this.loadedGroup.visible=e}get castShadow(){return super.castShadow}set castShadow(e){this._castShadow=e,this.cancelHandle("castShadow",()=>this.loaded.then(()=>{super.castShadow=e}))}get receiveShadow(){return super.receiveShadow}set receiveShadow(e){this._receiveShadow=e,this.cancelHandle("receiveShadow",()=>this.loaded.then(()=>{super.receiveShadow=e}))}get physics(){return super.physics}set physics(e){this._physics=e;const t=this.cancelHandle("physics",()=>this.loaded.then(()=>{this.initPhysics(e,t)}))}get boxVisible(){var e;return(e=this._boxVisible)!=null?e:this.object3d.visible}set boxVisible(e){this._boxVisible=e,this.object3d.visible=e}get outline(){return!!this._outline}set outline(e){this._outline=e,this.cancelHandle("outline",()=>this.loaded.then(t=>{if(e)return dW(t),()=>{pW(t)}}))}get bloom(){return!!this._bloom}set bloom(e){this._bloom=e,this.cancelHandle("bloom",()=>this.loaded.then(t=>{if(e)return oW(t),()=>{sW(t)}}))}addToRaycastSet(e){const t=new Cn;return queueMicrotask(()=>{t.done||(this._physics==="map"||this._physics==="map-debug"?t.watch(this.loaded.then(i=>(this.managerSet||(this.managerSet=!0,i.traverse(r=>{var o,s;return(s=(o=r.userData).manager)!=null?s:o.manager=this})),e.add(i),()=>{e.delete(i)}))):t.watch(super.addToRaycastSet(e)))}),t}refreshFactors(){this.cancelHandle("refreshFactorsLoaded",()=>this.loaded.then(()=>void super.refreshFactors()))}placeAt(e){this.cancelHandle("placeAt",()=>this.loaded.then(()=>void super.placeAt(e)))}}const nde=n=>"loadedGroup"in n?n.loadedGroup:"object3d"in n?n.object3d:n.outerObject3d;function ide(n){const e=new Map,t=new Map,i=n.clone();return AW(n,i,function(r,o){e.set(o,r),t.set(r,o)}),i.traverse(function(r){if(!r.isSkinnedMesh)return;const o=r,s=e.get(r),a=s.skeleton.bones;o.skeleton=s.skeleton.clone(),o.bindMatrix.copy(s.bindMatrix),o.skeleton.bones=a.map(function(l){return t.get(l)}),o.bind(o.skeleton,o.bindMatrix)}),i}function AW(n,e,t){t(n,e);for(let i=0;i<n.children.length;i++)AW(n.children[i],e.children[i],t)}const LW=new WeakSet,rRe=(n,e,t=n.animations)=>{const i=e?n.clone():ide(n);return!e&&LW.add(i),i.animations=t,i};Vt(()=>{const n=Ti();if(!(n instanceof dx)||dt()!==di)return;const e=n.loadedGroup.children[0];if(!LW.has(e))return;const t=new _ce(e);return St.add(t),()=>{St.remove(t)}},[Ti,dt]);const[bV,Ny]=Qe(!1),[Uw,YC]=Qe({}),KC=!1,[DW,TR]=Qe(KC);Vt(()=>{var n;DW((n=dt().userData.bokeh)!=null?n:KC)},[dt,YC]);const ZC=.03,[RW,OW]=Qe(ZC);Vt(()=>{var n;RW((n=dt().userData.bokehAperture)!=null?n:ZC)},[dt,YC]);const JC=1,[kW,IW]=Qe(JC);Vt(()=>{var n;kW((n=dt().userData.bokehFocus)!=null?n:JC)},[dt,YC]);const QC=.01,[NW,zW]=Qe(QC);Vt(()=>{var n;NW((n=dt().userData.bokehMaxBlur)!=null?n:QC)},[dt,YC]);const Ik={...rc,mouseControl:[Boolean,String],fov:Number,zoom:Number,near:Number,far:Number,active:Boolean,transition:[Boolean,Number],bokeh:Boolean,bokehFocus:Number,bokehMaxBlur:Number,bokehAperture:Number,minPolarAngle:Number,maxPolarAngle:Number,minAzimuthAngle:Number,maxAzimuthAngle:Number,polarAngle:Number,azimuthAngle:Number,enableDamping:Boolean},Nk={...oc,mouseControl:!1,fov:75,zoom:1,near:Eg,far:yl,active:!1,transition:new ci(!1),bokeh:KC,bokehFocus:JC,bokehMaxBlur:QC,bokehAperture:ZC,minPolarAngle:tW,maxPolarAngle:nW,minAzimuthAngle:-1/0,maxAzimuthAngle:1/0,polarAngle:new ci(0),azimuthAngle:new ci(0),enableDamping:!1},rde={...Ik,targetId:String,enableZoom:Boolean,enableFly:Boolean,autoRotate:[Boolean,Number]},ode={...Nk,innerZ:500,mouseControl:"drag",targetId:void 0,enableZoom:!1,enableFly:!1,autoRotate:!1},[Pg,$C]=lo();window.addEventListener("blur",()=>Pg());window.addEventListener("focus",()=>Pg());document.addEventListener("visibilitychange",()=>Pg());const yM=new Set;$C(()=>yM.clear());let PR=!1;const VW=()=>{!PR||(PR=!1,Pg())};document.addEventListener("keydown",n=>{VW(),(n.key==="Shift"||n.key==="Meta")&&yM.add(n.key),yM.has("Meta")&&yM.has("Shift")&&(Pg(),PR=!0)});document.addEventListener("keyup",n=>{(n.key==="Shift"||n.key==="Meta")&&Pg()});document.addEventListener("mousedown",VW);async function sde(){const{Sphere:n,Cylinder:e,Vec3:t}=await Tg(),{x:i,y:r}=ic(this),o=i*.5,s=r*.5,a=new n(o),l=new n(o),u=new e(o,o,Math.abs(r-i));this.cannonBody.addShape(a,new t(0,-s+o,0)),this.cannonBody.addShape(l,new t(0,s-o,0)),this.cannonBody.addShape(u)}const[zk,Vk]=Qe([]),ade=mg(zk,Vk),lde=vg(zk,Vk),ude={...rc,...BC},cde={...oc,...UC,scaleZ:0,depth:0},wV=new gH({transparent:!0});class Wu extends ia{constructor(){super(new Gle(wV)),q(this,"material",wV)}get depth(){return 0}set depth(e){}get scaleZ(){return 0}set scaleZ(e){}}q(Wu,"componentName","sprite"),q(Wu,"defaults",cde),q(Wu,"schema",ude);ix(Wu,[cx]);const hde=()=>{const n=new Wu;return n.texture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAABnNJREFUaEPtWVmoVlUU/r5zNItModEGQinLMkqbyDLqoR6K0gZMEsxIkh6iEYSEZiR9iDTyoZEkqeylsoFeKmkwKOhGRaE5VIo0kVOIej37i3XY62f7e+//n//e44DcA//DvXuftde3hm+tvQ5xiDzcVzgk5QBMvno4w/8fSPa03rFatQORZDJJMlTRRlJWdW8rebUCSZWSdHUI4SoAx0XPmB5mfTtzW5ZlKwAsNY+Y90gWVYD3tqc2IOYJV0rSGwCmVFCsi+Qkkhv665k6gZQhEkJ4G8ANALoBDG4BZieAIQB+JjmO5C43RgUD7LWlFiAeGpKuk/QegF0ADgNglv4IwKB4sp23yxQHcBGAHQAOJ3kfyYWSBpHcfSCBDCbZHUJ4B8BkV1DSk3meP9KsmKTxkr4FYHlh7Laa5BkxNMsQ7RTMXh6xWAVgPxfWTqglareksZJ+iMlchhXJOSSfkmTesf9Z+BWSxkj6Ke41D5gnHiI5L9K2E0MznpIRTbdmctgDSF/ZQ9JwSR8AuCxa2RTIJb2eZdl0AEdEwxiQ/yTdImkpAKNoV844expJI4q2T6R5e6c0dAOIs4akU41xQgjnkTzWYjihzd4OOBfAMVEx82b6/BVDLfXyCTGHfJ/Tsv1tIbcpRkXz+k5JG7Mse5+kkQqcIEogSbLeFKnTQqHTx6zbDCJVsJ08D+FKBCRpSZ7n0xtAEv4/WtKvAI6KrGNKVRIaAaR7DZT9nK2aQfi6tzHpuq21yktbs5/l4N0kF5Vs55QnaaqkNyvwfzvLlsmbbFoHYCOALQCOB3AKgBHJujNXO7npur/TlWXZ+aUzJJXUKelhSU8AaFak6gFp4q4j+SyAjwGstGLXCHZpGIBxIYSpJO+K3uz0TA/ZP0iONgJpeKQoimesMPURSCM/JM3PsuxRkla5y2SMHrJQtW7XaLh8JI2W9AKAKzs814FsJjmK5OYUyAKS93YosNQn4fYbSb4blTS26+6pGbRwNnp2sEVRvEzyjqRAtouCfQKk9AbJ6SSXxOJnBau0vKRLAFwAYDiAfwF8TdIo1taGOJikR6sSZg5kC8mRdXikPFTSK3mez7R8i1V3d2xDFgGY0IN5l1t+kFzpYCQNlbQagNWYnqg8FVMrEBe2neRZJH83b8Qu1ptHO9yp1hXxFmgnyQkkuyRZ47hD0ixJz1cIsVqBuDcW53l+ewJilKSVsYXvrZX37ng9ybEkt3leRa+c3MYrtQIpuZzkZJLLPESKoniV5IwK9agE4x2ye6UoipdIzmxDOrUBcUE7Yvu9Plp0mKRfYuFr1554HqwhOcY7Wkl3RkpulfS1AXElNpA8k+T2COQcSd8n05NWLY4rY7kyhqS1R8ZkkyQZhbeq+LUDsQpuie7Fb5ykrnZFwOthBGw3xrNJrolArpH04f4C0piGxBbhz6jECEmrYuPZLrR8/W+Sp5PcGmXcJmnx/gLSqOgkLyX5lfdsIYRPK7YcJaPZtSHP82kJWcy1m+X+SnYD4vT7eJ7njyW1wGuIrXvNaI62RsEjOZ7kd96FhxCs6o/fn/Trylh3a7XA7uLloK0oiqdJPhC1L+/qCQHYe+WYiOT9JBck1X2ipM8r3EhrS3a3sA8O/ILT6J0kzZY0r5fLmSX4gySfi8MOm5wUIYTPAFze38relzY+bVMsRFaZdePsykaho0MIs0hOBHAkgK2SlmdZ9iLJ3+LExLxowzkDPr8CiLTjrrWNT2dTF5PcFJtHs3J6odpjXmU5BcBqiAGeIumtJlpuxeItQ2s+ydl9uI80Et8miyRvJflFpFLLDRtkGFjLjfKO7nUn7pkjaW4HIFKP/EPyNKPu9M5+j6SFfQRiwhuV2CYcWZZZqJb3juZHkoXZtZKMZm18mipXpZ460ayNXUG3ASmZRtKFkr6JQHqablQ9oDFwA/CjpBVZltkAYlMI4SQANhq9AsCJUaAZoJOJjb1WDsAlvZbnuRXQQT7XKuM3hLAMwPWR/tqNZVoBc+XaTePt/OZZWBWD2VXZ8stam7XlcDHGqX/bGBpCsPvzzTGeqwg9EHusY55B8kuPqL1GphHYSAA2BjX3G7tUHdTta1D2GWItgE/s80M6q24eYnf0/W9fa92Sf5s+1/Voaa+2B5EnUkxWQ/b6GnywhEy/nTsApN8mrFnAgEdqNmi/xQ14pN8mrFnAgEdqNmi/xR0yHvkfVPFBbg9BWmoAAAAASUVORK5CYII=",Ii.delete(n),n.scale=.5,n},FW=class extends ia{constructor(n){super(),q(this,"camera"),q(this,"_physicsShape",sde),q(this,"midObject3d",this.outerObject3d),q(this,"orbitMode"),q(this,"gyrateHandle"),q(this,"_minPolarAngle",tW),q(this,"_maxPolarAngle",nW),q(this,"_minAzimuthAngle",-1/0),q(this,"_maxAzimuthAngle",1/0),q(this,"_polarAngle"),q(this,"_azimuthAngle"),q(this,"enableDamping",!1),q(this,"mouseControlState",new Pt(!1)),q(this,"mouseControlInit"),q(this,"_gyroControl"),this.camera=n,this.object3d.add(n),n.userData.manager=this,ade(n),this.then(()=>{cV(n),lde(n)}),this.createEffect(()=>{if(dt()!==di||dt()===n)return;const e=new xce(n);St.add(e);const t=hde();e.add(t.outerObject3d);const i=Hh(({target:r})=>{r===t&&Ei(this)});return()=>{e.dispose(),St.remove(e),t.dispose(),i.cancel()}},[dt])}lookAt(n,e,t){super.lookAt(n,e,t);const i=ai.setFromQuaternion(this.outerObject3d.quaternion);i.x+=Math.PI,i.z+=Math.PI,this.outerObject3d.setRotationFromEuler(i)}get fov(){return this.camera.fov}set fov(n){var e,t;this.camera.fov=n,(t=(e=this.camera).updateProjectionMatrix)==null||t.call(e)}get zoom(){return this.camera.zoom}set zoom(n){var e,t;this.camera.zoom=n,(t=(e=this.camera).updateProjectionMatrix)==null||t.call(e)}get near(){return this.camera.near}set near(n){var e,t;this.camera.near=n,(t=(e=this.camera).updateProjectionMatrix)==null||t.call(e)}get far(){return this.camera.far}set far(n){var e,t;this.camera.far=n,(t=(e=this.camera).updateProjectionMatrix)==null||t.call(e)}activate(){this.active=!0}get active(){return Rv(Lp())===this.camera}set active(n){if(this.active===n)return;const e=Rv(Lp());cV(this.camera),n&&phe(this.camera),fhe(e)}get transition(){return this.camera.userData.transition}set transition(n){this.camera.userData.transition=n}get bokeh(){var n;return(n=this.camera.userData.bokeh)!=null?n:KC}set bokeh(n){this.camera.userData.bokeh=n,Uw({})}get bokehFocus(){var n;return(n=this.camera.userData.bokehFocus)!=null?n:JC}set bokehFocus(n){this.camera.userData.bokehFocus=n,Uw({})}get bokehMaxBlur(){var n;return(n=this.camera.userData.bokehMaxBlur)!=null?n:QC}set bokehMaxBlur(n){this.camera.userData.bokehMaxBlur=n,Uw({})}get bokehAperture(){var n;return(n=this.camera.userData.bokehAperture)!=null?n:ZC}set bokehAperture(n){this.camera.userData.bokehAperture=n,Uw({})}getRay(){return ZH.set(Dn(this.camera),mW(this.camera))}append(n){this._append(n),this.camera.add(n.outerObject3d)}attach(n){this._append(n),this.camera.attach(n.outerObject3d)}get width(){return super.width}set width(n){const e=n*rn;this.object3d.scale.x=e,this.camera.scale.x=1/e}get height(){return super.height}set height(n){const e=n*rn;this.object3d.scale.y=e,this.camera.scale.y=1/e}get depth(){return super.depth}set depth(n){const e=n*rn;this.object3d.scale.z=e,this.camera.scale.z=1/e}_gyrate(n,e,t){var i;const r=t?this.object3d:this.midObject3d;ai.setFromQuaternion(r.quaternion),ai.y-=n*.002,ai.y=Math.max(y_-this._maxAzimuthAngle*yr,Math.min(y_-this._minAzimuthAngle*yr,ai.y)),ai.x-=e*.002,ai.x=Math.max(y_-this._maxPolarAngle*yr,Math.min(y_-this._minPolarAngle*yr,ai.x)),r.setRotationFromEuler(ai),!t&&((i=this.rotationUpdate)==null||i.updateXYZ())}gyrate(n,e,t){var i;if(this.enableDamping&&(n*=.5,e*=.5),this.orbitMode?this._gyrate(n,e):(this._gyrate(n,0),this._gyrate(0,e,!0)),!this.enableDamping||t||!(n||e))return;(i=this.gyrateHandle)==null||i.cancel();let r=1;const o=this.gyrateHandle=this.beforeRender(()=>{r*=.95,this._gyrate(n*r,e*r),r<=.001&&o.cancel()})}updateAngle(){FW.updateAngle(this,this)}get minPolarAngle(){return this._minPolarAngle}set minPolarAngle(n){this._minPolarAngle=n,this.updateAngle()}get maxPolarAngle(){return this._maxPolarAngle}set maxPolarAngle(n){this._maxPolarAngle=n,this.updateAngle()}get minAzimuthAngle(){return this._minAzimuthAngle}set minAzimuthAngle(n){this._minAzimuthAngle=n,this.updateAngle()}get maxAzimuthAngle(){return this._maxAzimuthAngle}set maxAzimuthAngle(n){this._maxAzimuthAngle=n,this.updateAngle()}setPolarAngle(n){const{_minPolarAngle:e,_maxPolarAngle:t}=this;this.minPolarAngle=this.maxPolarAngle=n,this.queueMicrotask(()=>{this.minPolarAngle=e,this.maxPolarAngle=t})}setAzimuthAngle(n){const{_minAzimuthAngle:e,_maxAzimuthAngle:t}=this;this.minAzimuthAngle=this.maxAzimuthAngle=n,this.queueMicrotask(()=>{this.minAzimuthAngle=e,this.maxAzimuthAngle=t})}get polarAngle(){return this._polarAngle}set polarAngle(n){this._polarAngle=n,n&&this.setPolarAngle(n)}get azimuthAngle(){return this._azimuthAngle}set azimuthAngle(n){this._azimuthAngle=n,n&&this.setAzimuthAngle(n)}get mouseControl(){return this.mouseControlState.get()}set mouseControl(n){this.mouseControlState.set(n),!(!n||this.mouseControlInit)&&(this.mouseControlInit=!0,ki(()=>import("./enableMouseControl.cc5e485c.34d5b540.js"),[]).then(e=>e.default.call(this)))}get gyroControl(){return!!this._gyroControl}set gyroControl(n){this._gyroControl=n;const e=ai,t=Jd,i=jce,r=new Mo(-Math.sqrt(.5),0,0,Math.sqrt(.5)),o=Dh(this.object3d),s=0,a=l=>{var u,c,h;this.object3d.quaternion.copy(o),e.set(((u=l.beta)!=null?u:0)*yr,((c=l.alpha)!=null?c:0)*yr,-((h=l.gamma)!=null?h:0)*yr,"YXZ"),this.object3d.quaternion.multiply(t.setFromEuler(e));const p=-s*.5;i.set(0,Math.sin(p),0,Math.cos(p)),this.object3d.quaternion.multiply(i),this.object3d.quaternion.multiply(r)};n&&window.addEventListener("deviceorientation",a),this.cancelHandle("gyroControl",n&&(()=>new Cn(()=>window.removeEventListener("deviceorientation",a))))}};let Fk=FW;q(Fk,"updateAngle",zj(n=>n.gyrate(0,0),0,"trailing"));const BW=n=>!!n&&(Pp(n)||n instanceof MW),M2=new WeakSet,UW=class extends Fk{constructor(n){super(n),q(this,"manualTarget"),q(this,"targetState",new Pt(void 0)),this.createEffect(()=>{const e=this.targetState.get();if(!e)return;const t=Mg(()=>e.parent!==this&&this.retarget());return()=>{t.cancel()}},[this.targetState.get])}retarget(){UW.retaget(this,this)}append(n){this._append(n),M2.delete(n),this.retarget()}attach(n){this._append(n),M2.add(n),this.retarget()}};let Bk=UW;q(Bk,"retaget",zj(n=>{var e;let t=n.manualTarget;for(const i of(e=n.children)!=null?e:[])if(t)i.outerObject3d.parent!==n.camera&&n.camera[M2.has(i)?"attach":"add"](i.outerObject3d);else if(BW(i)){t=i;const{parent:r}=n.outerObject3d;r&&i.outerObject3d.parent!==r&&r[M2.has(t)?"attach":"add"](t.outerObject3d)}n.targetState.set(t)},0,"trailing"));class sv extends Bk{constructor(e=new or(75,1,Eg,yl)){super(e),q(this,"targetIdState",new Pt(void 0)),q(this,"enableZoomState",new Pt(!1)),q(this,"enableFlyState",new Pt(!1)),q(this,"autoRotateState",new Pt(!1)),this.innerZ=500,this.orbitMode=!0,this.mouseControl="drag",this.camera.rotation.y=0,this.createEffect(()=>{const t=this.targetIdState.get();if(!t)return;const i=new Cn,r=setTimeout(()=>{const o=()=>{var s;const[a]=(s=bh.get(t))!=null?s:[void 0];return a&&(this.manualTarget=a,this.targetState.set(a)),a};o()||i.watch(Mg(()=>setTimeout(()=>o()&&i.cancel())))});return()=>{clearTimeout(r),i.cancel()}},[this.targetIdState.get]),this.createEffect(()=>{const t=this.targetState.get();if(!t)return;const i=Yn(()=>{this.placeAt(Ba(hx(t.nativeObject3d)))});return()=>{i.cancel()}},[this.targetState.get]),this.createEffect(()=>{const t=this.autoRotateState.get();if(dt()!==e||!t)return;const i=typeof t=="number"?t:2,r=Yn(()=>{this.gyrate(i,0,!0)});return()=>{r.cancel()}},[dt,this.autoRotateState.get]),this.createEffect(()=>{if(na()||dt()!==e||!this.mouseControlState.get())return;const t=new Cn;if(this.enableZoomState.get()){const i=r=>{r.preventDefault(),this.innerZ+=r.deltaY,this.innerZ<0&&(this.innerZ=0)};Vn.addEventListener("wheel",i),t.then(()=>Vn.removeEventListener("wheel",i))}if(this.enableFlyState.get()){const i=new Set;t.watch(Yn(()=>{const s=i.has("Shift")?50:10;if(i.has("w")?this.translateZ(-s):i.has("s")&&this.translateZ(s),i.has("a")||i.has("ArrowLeft")?this.moveRight(-s):(i.has("d")||i.has("ArrowRight"))&&this.moveRight(s),i.has("w")||i.has("s")||i.has("a")||i.has("d")){const a=Ba(Dn(this.object3d));this.innerZ=0,this.placeAt(a)}i.has("Meta")||i.has("Control")||(i.has("ArrowDown")?this.y-=s:i.has("ArrowUp")&&(this.y+=s))}));const r=s=>{i.add(s.key.length===1?s.key.toLowerCase():s.key)},o=s=>{i.delete(s.key.length===1?s.key.toLowerCase():s.key)};document.addEventListener("keydown",r),document.addEventListener("keyup",o),t.watch($C(()=>i.clear())),t.then(()=>{document.removeEventListener("keydown",r),document.removeEventListener("keyup",o)})}return()=>{t.cancel()}},[dt,na,this.enableZoomState.get,this.enableFlyState.get,this.mouseControlState.get])}get targetId(){return this.targetIdState.get()}set targetId(e){this.targetIdState.set(e)}get enableZoom(){return this.enableZoomState.get()}set enableZoom(e){this.enableZoomState.set(e)}get enableFly(){return this.enableFlyState.get()}set enableFly(e){this.enableFlyState.set(e)}get autoRotate(){return this.autoRotateState.get()}set autoRotate(e){this.autoRotateState.set(e)}}q(sv,"componentName","orbitCamera"),q(sv,"defaults",ode),q(sv,"schema",rde);const[dde,pde]=lo(),[SV,fde]=Qe(0),Xo=new sv(di);Xo.enableZoom=!0;Xo.enableFly=!0;Xo.mouseControl=!1;Ii.delete(Xo);pde(n=>{const e=n.getWorldPosition();Xo.x=e.x,Xo.y=e.y,Xo.z=e.z;const t=ic(n);Xo.innerZ=Math.max(t.x,t.y,t.z,1)*Wi+50});Ny(n=>{n||(Xo.setPolarAngle(90),Xo.setAzimuthAngle(90))});Vt(()=>{if(!(!Ny()||dt()!==di||na()))return Xo.mouseControl="drag",Vn.style.cursor="grab",()=>{Xo.mouseControl=!1,Vn.style.cursor="auto"}},[Ny,na,dt]);Vt(()=>{if(dt()!==di||Ny())return;const n=fde(e=>Xo.innerZ=e);return()=>{n.cancel()}},[dt,Ny]);const[MV,jW]=lo(),[oRe,CV]=Qe(null),[b_,Rp]=Qe(Qs());Vt(()=>{const n=Ti(),e=Qs();if(!n||e==="select"){b_(e);return}if(!Pp(n)){b_("select");return}if(!(n instanceof Yp)){b_("translate");return}b_(e)},[Qs,Ti]);const[AR,LR]=Qe("world"),[DR,RR]=Qe(LR());Vt(()=>{Qs()==="scale"?DR("local"):DR(LR())},[LR,Qs]);const mde=Up(async()=>{const{TransformControls:n}=await ki(()=>import("./TransformControls.588d57da.dec0fb04.js"),[]),e=new n(dt(),Vn);dt(i=>e.camera=i),e.enabled=!1;let t=!1;return e.addEventListener("dragging-changed",({value:i})=>{t=i,Ihe(t),MV(t?"start":"stop")}),e.addEventListener("change",()=>t&&MV("move")),e});Vt(()=>{const n=Ti();if(!n)return;let e=Rp();e==="path"&&(e="translate");const t=RR(),i=CV(),r=new Cn;return mde().then(o=>{r.done||!n.outerObject3d.parent||e!=="translate"&&e!=="rotate"&&e!=="scale"||(o.setMode(e),o.setSpace(t),o.setScaleSnap(i),o.setRotationSnap(i),o.setTranslationSnap(i),St.add(o),o.attach(n.outerObject3d),o.enabled=!0,r.then(()=>{St.remove(o),o.detach(),o.enabled=!1}))}),()=>{r.cancel()}},[Ti,Rp,RR,CV]);const[OR,kR]=Qe(!1),[vde,IR]=Qe(10);Vt(()=>{if(!kR())return;const n=IR(),e=new yce(n,n);return St.add(e),()=>{St.remove(e)}},[kR,IR]);const[sRe,C2]=Qe(void 0),[aRe,EV]=Qe(!1),Fd=new Fr(new sx(ws,ws,4,4),QH);Vt(()=>{var n;if(!EV()||dt()!==di)return;St.add(Fd);const[e,t]=(n=C2())!=null?n:Eo();Fd.scale.x=e*rn,Fd.scale.y=t*rn;const i=Yn(()=>{Fd.quaternion.copy(di.quaternion),Fd.position.copy(di.position),Fd.translateZ(-4.9)});return()=>{i.cancel(),St.remove(Fd)}},[EV,C2,Eo,dt]);const[lRe,gde]=Qe({turbidity:10,rayleigh:3,mieCoefficient:.005,mieDirectionalG:.5,inclination:.49,azimuth:.25});class e3 extends Fr{constructor(){const e=e3.SkyShader,t=new Mn({name:"SkyShader",fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:zr.clone(e.uniforms),side:Zo,depthWrite:!1});super(new Wp(1,1,1),t),this.isSky=!0}}e3.SkyShader={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new K},up:{value:new K(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPos );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <encodings_fragment>

		}`};const[uRe,_de]=Qe(!1),TV=Up(()=>{const n=new e3;return n.scale.setScalar(45e4),gde(e=>{const{uniforms:t}=n.material;t.turbidity.value=e.turbidity,t.rayleigh.value=e.rayleigh,t.mieCoefficient.value=e.mieCoefficient,t.mieDirectionalG.value=e.mieDirectionalG;const i=Math.PI*(e.inclination-.5),r=2*Math.PI*(e.azimuth-.5);Ci.x=Math.cos(r),Ci.y=Math.sin(r)*Math.sin(i),Ci.z=Math.sin(r)*Math.cos(i),t.sunPosition.value.copy(Ci)}),n});let PV=!1;_de(n=>{PV!==n&&(PV=n,n?St.add(TV()):St.remove(TV()))});const[yde,AV]=Qe(!1),[xde,LV]=Qe(!1),DV=(n,e)=>Math.abs(n*.5/Math.cos(e.fov*.6*yr));Vt(()=>{var n;const[e,t]=(n=C2())!=null?n:Eo(),[i,r,o]=vR(dt()),s={width:i,height:t-(e-i)*t/e},a={width:e-(t-r)*e/t,height:r},l=Math.min(i-s.width,r-s.height),u=Math.min(i-a.width,r-a.height);l>u?SV(DV(e/o,di)):SV(DV(t,di))},[Eo,C2,dt,Hv]);const[bde,NR]=Qe(!1),RV={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new vt(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class Wv extends Ul{constructor(e,t,i,r){super(),this.strength=t!==void 0?t:1,this.radius=i,this.threshold=r,this.resolution=e!==void 0?new ze(e.x,e.y):new ze(256,256),this.clearColor=new vt(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let o=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2);this.renderTargetBright=new Qn(o,s),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let h=0;h<this.nMips;h++){const p=new Qn(o,s);p.texture.name="UnrealBloomPass.h"+h,p.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(p);const m=new Qn(o,s);m.texture.name="UnrealBloomPass.v"+h,m.texture.generateMipmaps=!1,this.renderTargetsVertical.push(m),o=Math.round(o/2),s=Math.round(s/2)}RV===void 0&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const a=RV;this.highPassUniforms=zr.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Mn({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const l=[3,5,7,9,11];o=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2);for(let h=0;h<this.nMips;h++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(l[h])),this.separableBlurMaterials[h].uniforms.texSize.value=new ze(o,s),o=Math.round(o/2),s=Math.round(s/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const u=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=u,this.bloomTintColors=[new K(1,1,1),new K(1,1,1),new K(1,1,1),new K(1,1,1),new K(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,xs===void 0&&console.error("THREE.UnrealBloomPass relies on CopyShader");const c=xs;this.copyUniforms=zr.clone(c.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Mn({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:d2,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new vt,this.oldClearAlpha=1,this.basic=new yg,this.fsQuad=new qp(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,t){let i=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(i,r);for(let o=0;o<this.nMips;o++)this.renderTargetsHorizontal[o].setSize(i,r),this.renderTargetsVertical[o].setSize(i,r),this.separableBlurMaterials[o].uniforms.texSize.value=new ze(i,r),i=Math.round(i/2),r=Math.round(r/2)}render(e,t,i,r,o){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const s=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),o&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let l=0;l<this.nMips;l++)this.fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[l].uniforms.direction.value=Wv.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=Wv.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[l];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,o&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=s}getSeperableBlurMaterial(e){return new Mn({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new ze(.5,.5)},direction:{value:new ze(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new Mn({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}Wv.BlurDirectionX=new ze(1,0);Wv.BlurDirectionY=new ze(0,1);const[wde,Uk]=Qe(0),[Sde,jk]=Qe(.5),[Mde,Hk]=Qe(0),Gv=new Wv(new ze,jk(),Uk(),Hk());Uk(n=>Gv.radius=n);jk(n=>Gv.strength=n);Hk(n=>Gv.threshold=n);class Cde extends Ul{constructor(e,t,i,r,o){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=o!==void 0?o:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new vt}render(e,t,i){const r=e.autoClear;e.autoClear=!1;let o,s;this.overrideMaterial!==void 0&&(s=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),o=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,o),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=s),e.autoClear=r}}const E2=new Cde(St,dt());dt(n=>E2.camera=n);Vt(()=>{const n=jv();if(n)return n.addPass(E2),n.addPass(Gv),()=>{n.removePass(E2),n.removePass(Gv)}},[jv]);const HW=new Uv(new Mn({uniforms:{baseTexture:{value:null},bloomTexture:{value:null}},vertexShader:`
            varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
        `,fragmentShader:`
            uniform sampler2D baseTexture;
            uniform sampler2D bloomTexture;
            varying vec2 vUv;
            void main() {
                gl_FragColor = texture2D(baseTexture, vUv) + texture2D(bloomTexture, vUv);
            }
        `,defines:{}}),"baseTexture"),{uniforms:Ede}=HW;jv(n=>n&&(Ede.bloomTexture.value=n.renderTarget2.texture));const[Tde,WW]=Qe(.8),[Pde,GW]=Qe(.01),XW=new Uv(new Mn({defines:{BAND_MODE:2,CHROMA_SAMPLES:1},uniforms:{tDiffuse:{value:null},baseIor:{value:.8},bandOffset:{value:.01},jitterIntensity:{value:1},jitterOffset:{value:0}},vertexShader:`

		varying vec2 vUv;
		varying vec3 viewDir;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			viewDir = normalize( ( modelViewMatrix * vec4( position, 1.0 ) ).xyz );

		}

	`,fragmentShader:`

		varying vec2 vUv;
		varying vec3 viewDir;
		uniform float baseIor;
		uniform float bandOffset;
		uniform float jitterIntensity;
		uniform float jitterOffset;
		uniform sampler2D tDiffuse;

		#include <common>
		void main() {

			vec3 normal = vec3( ( 2.0 * vUv - vec2( 1.0 ) ), 1.0 );
			normal.z = 1.0;
			normal = normalize( normal );

			vec3 color;

			// if NO BANDS
			#if BAND_MODE == 0

			vec3 refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor );
			color = texture2D( tDiffuse, vUv + refracted.xy ).rgb;

			// if RGB or RYGCBV BANDS
			#else

			float index, randValue, offsetValue;
			float r, g, b, r_ior, g_ior, b_ior;
			vec3 r_refracted, g_refracted, b_refracted;
			vec4 r_sample, g_sample, b_sample;

			#if BAND_MODE == 2
			float y, c, v, y_ior, c_ior, v_ior;
			vec3 y_refracted, c_refracted, v_refracted;
			vec4 y_sample, c_sample, v_sample;
			#endif

			for ( int i = 0; i < CHROMA_SAMPLES; i ++ ) {

				index = float( i );
				randValue = rand( sin( index + 1. ) * gl_FragCoord.xy + vec2( jitterOffset, - jitterOffset ) ) - 0.5;
				offsetValue = index / float( CHROMA_SAMPLES ) + randValue * jitterIntensity;
				#if BAND_MODE == 1
				randValue *= 2.0;
				#endif

				// Paper describing functions for creating yellow, cyan, and violet bands and reforming
				// them into RGB:
				// https://web.archive.org/web/20061108181225/http://home.iitk.ac.in/~shankars/reports/dispersionraytrace.pdf
				r_ior = 1.0 + bandOffset * ( 0.0 + offsetValue );
				g_ior = 1.0 + bandOffset * ( 2.0 + offsetValue );
				b_ior = 1.0 + bandOffset * ( 4.0 + offsetValue );

				r_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / r_ior );
				g_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / g_ior );
				b_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / b_ior );

				r_sample = texture2D( tDiffuse, vUv + r_refracted.xy );
				g_sample = texture2D( tDiffuse, vUv + g_refracted.xy );
				b_sample = texture2D( tDiffuse, vUv + b_refracted.xy );

				#if BAND_MODE == 2
				y_ior = 1.0 + bandOffset * ( 1.0 + offsetValue );
				c_ior = 1.0 + bandOffset * ( 3.0 + offsetValue );
				v_ior = 1.0 + bandOffset * ( 5.0 + offsetValue );

				y_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / y_ior );
				c_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / c_ior );
				v_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / v_ior );

				y_sample = texture2D( tDiffuse, vUv + y_refracted.xy );
				c_sample = texture2D( tDiffuse, vUv + c_refracted.xy );
				v_sample = texture2D( tDiffuse, vUv + v_refracted.xy );

				r = r_sample.r / 2.0;
				y = ( 2.0 * y_sample.r + 2.0 * y_sample.g - y_sample.b ) / 6.0;
				g = g_sample.g / 2.0;
				c = ( 2.0 * c_sample.g + 2.0 * c_sample.b - c_sample.r ) / 6.0;
				b = b_sample.b / 2.0;
				v = ( 2.0 * v_sample.b + 2.0 * v_sample.r - v_sample.g ) / 6.0;

				color.r += r + ( 2.0 * v + 2.0 * y - c ) / 3.0;
				color.g += g + ( 2.0 * y + 2.0 * c - v ) / 3.0;
				color.b += b + ( 2.0 * c + 2.0 * v - y ) / 3.0;
				#else
				color.r += r_sample.r;
				color.g += g_sample.g;
				color.b += b_sample.b;
				#endif

			}

			color /= float( CHROMA_SAMPLES );

			#endif

			gl_FragColor = vec4( color, 1.0 );

		}

	`})),{uniforms:qW}=XW;WW(n=>qW.baseIor.value=n);GW(n=>qW.bandOffset.value=n);const[Ade,zR]=Qe(!1),[Lde,zy]=Qe("MSAA"),[OV,Xv]=Qe(void 0);Vt(()=>{const n=fi();if(!n)return;if(zy()!=="MSAA"||!n.capabilities.isWebGL2){OV(new cR(n));return}const e=new Qn(xk,bk,{samples:4}),t=Eo(([i,r])=>e.setSize(i,r));return OV(new cR(n,e)),()=>{e.dispose(),t.cancel()}},[fi,zy]);Vt(()=>{const n=Xv();if(!n)return;const[e,t]=Eo();n.setSize(e,t),n.setPixelRatio(Math.min(Ap(),devicePixelRatio))},[Xv,Eo,Ap]);class Dde extends Ul{constructor(e){super(),xs===void 0&&console.error("THREE.SavePass relies on CopyShader");const t=xs;this.textureID="tDiffuse",this.uniforms=zr.clone(t.uniforms),this.material=new Mn({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.renderTarget=e,this.renderTarget===void 0&&(this.renderTarget=new Qn(window.innerWidth,window.innerHeight),this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.fsQuad=new qp(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),e.setRenderTarget(this.renderTarget),this.clear&&e.clear(),this.fsQuad.render(e)}}const Rde={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:.5},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;
		uniform float mixRatio;

		uniform sampler2D tDiffuse1;
		uniform sampler2D tDiffuse2;

		varying vec2 vUv;

		void main() {

			vec4 texel1 = texture2D( tDiffuse1, vUv );
			vec4 texel2 = texture2D( tDiffuse2, vUv );
			gl_FragColor = mix( texel1, texel2, mixRatio );
			gl_FragColor.a *= opacity;

		}`},[Ode,YW]=Qe(.5),KW=new Dde,Wk=new Uv(Rde,"tDiffuse1");Wk.uniforms.tDiffuse2.value=KW.renderTarget.texture;YW(n=>Wk.uniforms.mixRatio.value=n);const ZW=new Uv(xs);ZW.renderToScreen=!0;const kde=[Wk,KW,ZW],[Ide,VR]=Qe(!1),[Nde,T2]=Qe(!1),q0={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new ze(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Bt},cameraInverseProjectionMatrix:{value:new Bt},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		#include <common>

		varying vec2 vUv;

		#if DIFFUSE_TEXTURE == 1
		uniform sampler2D tDiffuse;
		#endif

		uniform sampler2D tDepth;

		#if NORMAL_TEXTURE == 1
		uniform sampler2D tNormal;
		#endif

		uniform float cameraNear;
		uniform float cameraFar;
		uniform mat4 cameraProjectionMatrix;
		uniform mat4 cameraInverseProjectionMatrix;

		uniform float scale;
		uniform float intensity;
		uniform float bias;
		uniform float kernelRadius;
		uniform float minResolution;
		uniform vec2 size;
		uniform float randomSeed;

		// RGBA depth

		#include <packing>

		vec4 getDefaultColor( const in vec2 screenPosition ) {
			#if DIFFUSE_TEXTURE == 1
			return texture2D( tDiffuse, vUv );
			#else
			return vec4( 1.0 );
			#endif
		}

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
			return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}

		vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {
			float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];
			vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );
			clipPosition *= clipW; // unprojection.

			return ( cameraInverseProjectionMatrix * clipPosition ).xyz;
		}

		vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {
			#if NORMAL_TEXTURE == 1
			return unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );
			#else
			return normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );
			#endif
		}

		float scaleDividedByCameraFar;
		float minResolutionMultipliedByCameraFar;

		float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {
			vec3 viewDelta = sampleViewPosition - centerViewPosition;
			float viewDistance = length( viewDelta );
			float scaledScreenDistance = scaleDividedByCameraFar * viewDistance;

			return max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );
		}

		// moving costly divides into consts
		const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );
		const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );

		float getAmbientOcclusion( const in vec3 centerViewPosition ) {
			// precompute some variables require in getOcclusion.
			scaleDividedByCameraFar = scale / cameraFar;
			minResolutionMultipliedByCameraFar = minResolution * cameraFar;
			vec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );

			// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/
			float angle = rand( vUv + randomSeed ) * PI2;
			vec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;
			vec2 radiusStep = radius;

			float occlusionSum = 0.0;
			float weightSum = 0.0;

			for( int i = 0; i < NUM_SAMPLES; i ++ ) {
				vec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;
				radius += radiusStep;
				angle += ANGLE_STEP;

				float sampleDepth = getDepth( sampleUv );
				if( sampleDepth >= ( 1.0 - EPSILON ) ) {
					continue;
				}

				float sampleViewZ = getViewZ( sampleDepth );
				vec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );
				occlusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );
				weightSum += 1.0;
			}

			if( weightSum == 0.0 ) discard;

			return occlusionSum * ( intensity / weightSum );
		}

		void main() {
			float centerDepth = getDepth( vUv );
			if( centerDepth >= ( 1.0 - EPSILON ) ) {
				discard;
			}

			float centerViewZ = getViewZ( centerDepth );
			vec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );

			float ambientOcclusion = getAmbientOcclusion( viewPosition );

			gl_FragColor = getDefaultColor( vUv );
			gl_FragColor.xyz *=  1.0 - ambientOcclusion;
		}`},xu={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new ze(512,512)},sampleUvOffsets:{value:[new ze(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:`

		#include <common>

		uniform vec2 size;

		varying vec2 vUv;
		varying vec2 vInvSize;

		void main() {
			vUv = uv;
			vInvSize = 1.0 / size;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		#include <common>
		#include <packing>

		uniform sampler2D tDiffuse;
		uniform sampler2D tDepth;

		uniform float cameraNear;
		uniform float cameraFar;
		uniform float depthCutoff;

		uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];
		uniform float sampleWeights[ KERNEL_RADIUS + 1 ];

		varying vec2 vUv;
		varying vec2 vInvSize;

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
			return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}

		void main() {
			float depth = getDepth( vUv );
			if( depth >= ( 1.0 - EPSILON ) ) {
				discard;
			}

			float centerViewZ = -getViewZ( depth );
			bool rBreak = false, lBreak = false;

			float weightSum = sampleWeights[0];
			vec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;

			for( int i = 1; i <= KERNEL_RADIUS; i ++ ) {

				float sampleWeight = sampleWeights[i];
				vec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;

				vec2 sampleUv = vUv + sampleUvOffset;
				float viewZ = -getViewZ( getDepth( sampleUv ) );

				if( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;

				if( ! rBreak ) {
					diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;
					weightSum += sampleWeight;
				}

				sampleUv = vUv - sampleUvOffset;
				viewZ = -getViewZ( getDepth( sampleUv ) );

				if( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;

				if( ! lBreak ) {
					diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;
					weightSum += sampleWeight;
				}

			}

			gl_FragColor = diffuseSum / weightSum;
		}`},P2={createSampleWeights:function(n,e){const t=[];for(let i=0;i<=n;i++)t.push(zde(i,e));return t},createSampleOffsets:function(n,e){const t=[];for(let i=0;i<=n;i++)t.push(e.clone().multiplyScalar(i));return t},configure:function(n,e,t,i){n.defines.KERNEL_RADIUS=e,n.uniforms.sampleUvOffsets.value=P2.createSampleOffsets(e,i),n.uniforms.sampleWeights.value=P2.createSampleWeights(e,t),n.needsUpdate=!0}};function zde(n,e){return Math.exp(-(n*n)/(2*(e*e)))/(Math.sqrt(2*Math.PI)*e)}const jw={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		#include <packing>

		void main() {

			float depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );
			gl_FragColor = vec4( vec3( depth ), opacity );

		}`};class JW extends Ul{constructor(e,t,i=!1,r=!1,o=new ze(256,256)){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=i,this.supportsNormalTexture=r,this.originalClearColor=new vt,this._oldClearColor=new vt,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=new ze(o.x,o.y),this.saoRenderTarget=new Qn(this.resolution.x,this.resolution.y),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new Qn(this.resolution.x,this.resolution.y,{minFilter:Mi,magFilter:Mi}),this.depthRenderTarget=this.normalRenderTarget.clone();let s;this.supportsDepthTextureExtension&&(s=new mH,s.type=FO,this.beautyRenderTarget.depthTexture=s,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new OC,this.depthMaterial.depthPacking=LC,this.depthMaterial.blending=ji,this.normalMaterial=new Aue,this.normalMaterial.blending=ji,q0===void 0&&console.error("THREE.SAOPass relies on SAOShader"),this.saoMaterial=new Mn({defines:Object.assign({},q0.defines),fragmentShader:q0.fragmentShader,vertexShader:q0.vertexShader,uniforms:zr.clone(q0.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?s:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=ji,xu===void 0&&console.error("THREE.SAOPass relies on DepthLimitedBlurShader"),this.vBlurMaterial=new Mn({uniforms:zr.clone(xu.uniforms),defines:Object.assign({},xu.defines),vertexShader:xu.vertexShader,fragmentShader:xu.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?s:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=ji,this.hBlurMaterial=new Mn({uniforms:zr.clone(xu.uniforms),defines:Object.assign({},xu.defines),vertexShader:xu.vertexShader,fragmentShader:xu.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?s:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=ji,xs===void 0&&console.error("THREE.SAOPass relies on CopyShader"),this.materialCopy=new Mn({uniforms:zr.clone(xs.uniforms),vertexShader:xs.vertexShader,fragmentShader:xs.fragmentShader,blending:ji}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=HD,this.materialCopy.blendSrc=Yj,this.materialCopy.blendDst=WD,this.materialCopy.blendEquation=rh,this.materialCopy.blendSrcAlpha=qj,this.materialCopy.blendDstAlpha=WD,this.materialCopy.blendEquationAlpha=rh,jw===void 0&&console.error("THREE.SAOPass relies on UnpackDepthRGBAShader"),this.depthCopy=new Mn({uniforms:zr.clone(jw.uniforms),vertexShader:jw.vertexShader,fragmentShader:jw.fragmentShader,blending:ji}),this.fsQuad=new qp(null)}render(e,t,i){if(this.renderToScreen&&(this.materialCopy.blending=ji,this.materialCopy.uniforms.tDiffuse.value=i.texture,this.materialCopy.needsUpdate=!0,this.renderPass(e,this.materialCopy,null)),this.params.output===1)return;e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const r=e.autoClear;e.autoClear=!1,e.setRenderTarget(this.depthRenderTarget),e.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;const o=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=o,this.hBlurMaterial.uniforms.depthCutoff.value=o,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),(this.prevStdDev!==this.params.saoBlurStdDev||this.prevNumSamples!==this.params.saoBlurRadius)&&(P2.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new ze(0,1)),P2.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new ze(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),e.setClearColor(0),e.setRenderTarget(this.beautyRenderTarget),e.clear(),e.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(e,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(e,this.hBlurMaterial,this.saoRenderTarget,16777215,1));let s=this.materialCopy;this.params.output===3?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,s=this.depthCopy):this.params.output===4?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),this.params.output===0?s.blending=HD:s.blending=ji,this.renderPass(e,s,this.renderToScreen?null:i),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=r}renderPass(e,t,i,r,o){e.getClearColor(this.originalClearColor);const s=e.getClearAlpha(),a=e.autoClear;e.setRenderTarget(i),e.autoClear=!1,r!=null&&(e.setClearColor(r),e.setClearAlpha(o||0),e.clear()),this.fsQuad.material=t,this.fsQuad.render(e),e.autoClear=a,e.setClearColor(this.originalClearColor),e.setClearAlpha(s)}renderOverride(e,t,i,r,o){e.getClearColor(this.originalClearColor);const s=e.getClearAlpha(),a=e.autoClear;e.setRenderTarget(i),e.autoClear=!1,r=t.clearColor||r,o=t.clearAlpha||o,r!=null&&(e.setClearColor(r),e.setClearAlpha(o||0),e.clear()),this.scene.overrideMaterial=t,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=a,e.setClearColor(this.originalClearColor),e.setClearAlpha(s)}setSize(e,t){this.beautyRenderTarget.setSize(e,t),this.saoRenderTarget.setSize(e,t),this.blurIntermediateRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.depthRenderTarget.setSize(e,t),this.saoMaterial.uniforms.size.value.set(e,t),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(e,t),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(e,t),this.hBlurMaterial.needsUpdate=!0}}JW.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4};const fl=new JW(St,dt(),!1,!0);fl.params.saoKernelRadius=80;fl.params.saoBlurStdDev=5;T2(n=>fl.params.saoScale=n==="light"?3e3:2e3);dt(n=>{fl.camera=n,fl.saoMaterial.defines.PERSPECTIVE_CAMERA=n.isPerspectiveCamera?1:0,fl.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(n.projectionMatrixInverse),fl.saoMaterial.uniforms.cameraProjectionMatrix.value=n.projectionMatrix,fl.vBlurMaterial.defines.PERSPECTIVE_CAMERA=n.isPerspectiveCamera?1:0,fl.hBlurMaterial.defines.PERSPECTIVE_CAMERA=n.isPerspectiveCamera?1:0});const kV={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#include <common>

		varying vec2 vUv;

		uniform sampler2D tColor;
		uniform sampler2D tDepth;

		uniform float maxblur; // max blur amount
		uniform float aperture; // aperture - bigger values for shallower depth of field

		uniform float nearClip;
		uniform float farClip;

		uniform float focus;
		uniform float aspect;

		#include <packing>

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, nearClip, farClip );
			#else
			return orthographicDepthToViewZ( depth, nearClip, farClip );
			#endif
		}


		void main() {

			vec2 aspectcorrect = vec2( 1.0, aspect );

			float viewZ = getViewZ( getDepth( vUv ) );

			float factor = ( focus + viewZ ); // viewZ is <= 0, so this is a difference equation

			vec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );

			vec2 dofblur9 = dofblur * 0.9;
			vec2 dofblur7 = dofblur * 0.7;
			vec2 dofblur4 = dofblur * 0.4;

			vec4 col = vec4( 0.0 );

			col += texture2D( tColor, vUv.xy );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );

			gl_FragColor = col / 41.0;
			gl_FragColor.a = 1.0;

		}`};class Vde extends Ul{constructor(e,t,i){super(),this.scene=e,this.camera=t;const r=i.focus!==void 0?i.focus:1,o=i.aspect!==void 0?i.aspect:t.aspect,s=i.aperture!==void 0?i.aperture:.025,a=i.maxblur!==void 0?i.maxblur:1,l=i.width||window.innerWidth||1,u=i.height||window.innerHeight||1;this.renderTargetDepth=new Qn(l,u,{minFilter:Mi,magFilter:Mi}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new OC,this.materialDepth.depthPacking=LC,this.materialDepth.blending=ji,kV===void 0&&console.error("THREE.BokehPass relies on BokehShader");const c=kV,h=zr.clone(c.uniforms);h.tDepth.value=this.renderTargetDepth.texture,h.focus.value=r,h.aspect.value=o,h.aperture.value=s,h.maxblur.value=a,h.nearClip.value=t.near,h.farClip.value=t.far,this.materialBokeh=new Mn({defines:Object.assign({},c.defines),uniforms:h,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}),this.uniforms=h,this.needsSwap=!1,this.fsQuad=new qp(this.materialBokeh),this._oldClearColor=new vt}render(e,t,i){this.scene.overrideMaterial=this.materialDepth,e.getClearColor(this._oldClearColor);const r=e.getClearAlpha(),o=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=i.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this._oldClearColor),e.setClearAlpha(r),e.autoClear=o}}const Gk=new Vde(St,dt(),{}),av=Gk.uniforms;dt(n=>{Gk.camera=n,av.aspect.value=n.aspect,av.nearClip.value=n.near,av.farClip.value=n.far});IW(n=>av.focus.value=n);OW(n=>av.aperture.value=n);zW(n=>av.maxblur.value=n);const Y0={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new ze(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];

		void SMAAEdgeDetectionVS( vec2 texcoord ) {
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component
		}

		void main() {

			vUv = uv;

			SMAAEdgeDetectionVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];

		vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {
			vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );

			// Calculate color deltas:
			vec4 delta;
			vec3 C = texture2D( colorTex, texcoord ).rgb;

			vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
			vec3 t = abs( C - Cleft );
			delta.x = max( max( t.r, t.g ), t.b );

			vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
			t = abs( C - Ctop );
			delta.y = max( max( t.r, t.g ), t.b );

			// We do the usual threshold:
			vec2 edges = step( threshold, delta.xy );

			// Then discard if there is no edge:
			if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
				discard;

			// Calculate right and bottom deltas:
			vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
			t = abs( C - Cright );
			delta.z = max( max( t.r, t.g ), t.b );

			vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
			t = abs( C - Cbottom );
			delta.w = max( max( t.r, t.g ), t.b );

			// Calculate the maximum delta in the direct neighborhood:
			float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );

			// Calculate left-left and top-top deltas:
			vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
			t = abs( C - Cleftleft );
			delta.z = max( max( t.r, t.g ), t.b );

			vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
			t = abs( C - Ctoptop );
			delta.w = max( max( t.r, t.g ), t.b );

			// Calculate the final maximum delta:
			maxDelta = max( max( maxDelta, delta.z ), delta.w );

			// Local contrast adaptation in action:
			edges.xy *= step( 0.5 * maxDelta, delta.xy );

			return vec4( edges, 0.0, 0.0 );
		}

		void main() {

			gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );

		}`},Hw={defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new ze(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];
		varying vec2 vPixcoord;

		void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
			vPixcoord = texcoord / resolution;

			// We will use these offsets for the searches later on (see @PSEUDO_GATHER4):
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components

			// And these for the searches, they indicate the ends of the loops:
			vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );

		}

		void main() {

			vUv = uv;

			SMAABlendingWeightCalculationVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )

		uniform sampler2D tDiffuse;
		uniform sampler2D tArea;
		uniform sampler2D tSearch;
		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[3];
		varying vec2 vPixcoord;

		#if __VERSION__ == 100
		vec2 round( vec2 x ) {
			return sign( x ) * floor( abs( x ) + 0.5 );
		}
		#endif

		float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
			// Not required if searchTex accesses are set to point:
			// float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);
			// e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +
			//     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;
			e.r = bias + e.r * scale;
			return 255.0 * texture2D( searchTex, e, 0.0 ).r;
		}

		float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			/**
				* @PSEUDO_GATHER4
				* This texcoord has been offset by (-0.25, -0.125) in the vertex shader to
				* sample between edge, thus fetching four edges in a row.
				* Sampling with different offsets in each direction allows to disambiguate
				* which edges are active from the four fetched ones.
				*/
			vec2 e = vec2( 0.0, 1.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord -= vec2( 2.0, 0.0 ) * resolution;
				if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
			}

			// We correct the previous (-0.25, -0.125) offset we applied:
			texcoord.x += 0.25 * resolution.x;

			// The searches are bias by 1, so adjust the coords accordingly:
			texcoord.x += resolution.x;

			// Disambiguate the length added by the last step:
			texcoord.x += 2.0 * resolution.x; // Undo last step
			texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);

			return texcoord.x;
		}

		float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 0.0, 1.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord += vec2( 2.0, 0.0 ) * resolution;
				if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
			}

			texcoord.x -= 0.25 * resolution.x;
			texcoord.x -= resolution.x;
			texcoord.x -= 2.0 * resolution.x;
			texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );

			return texcoord.x;
		}

		float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 1.0, 0.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord += vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign
				if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
			}

			texcoord.y -= 0.25 * resolution.y; // WebGL port note: Changed sign
			texcoord.y -= resolution.y; // WebGL port note: Changed sign
			texcoord.y -= 2.0 * resolution.y; // WebGL port note: Changed sign
			texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign

			return texcoord.y;
		}

		float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 1.0, 0.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord -= vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign
				if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
			}

			texcoord.y += 0.25 * resolution.y; // WebGL port note: Changed sign
			texcoord.y += resolution.y; // WebGL port note: Changed sign
			texcoord.y += 2.0 * resolution.y; // WebGL port note: Changed sign
			texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign

			return texcoord.y;
		}

		vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
			// Rounding prevents precision errors of bilinear filtering:
			vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;

			// We do a scale and bias for mapping to texel space:
			texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );

			// Move to proper place, according to the subpixel offset:
			texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;

			return texture2D( areaTex, texcoord, 0.0 ).rg;
		}

		vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
			vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );

			vec2 e = texture2D( edgesTex, texcoord ).rg;

			if ( e.g > 0.0 ) { // Edge at north
				vec2 d;

				// Find the distance to the left:
				vec2 coords;
				coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
				coords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * resolution.y (@CROSSING_OFFSET)
				d.x = coords.x;

				// Now fetch the left crossing edges, two at a time using bilinear
				// filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to
				// discern what value each edge has:
				float e1 = texture2D( edgesTex, coords, 0.0 ).r;

				// Find the distance to the right:
				coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
				d.y = coords.x;

				// We want the distances to be in pixel units (doing this here allow to
				// better interleave arithmetic and memory accesses):
				d = d / resolution.x - pixcoord.x;

				// SMAAArea below needs a sqrt, as the areas texture is compressed
				// quadratically:
				vec2 sqrt_d = sqrt( abs( d ) );

				// Fetch the right crossing edges:
				coords.y -= 1.0 * resolution.y; // WebGL port note: Added
				float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;

				// Ok, we know how this pattern looks like, now it is time for getting
				// the actual area:
				weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
			}

			if ( e.r > 0.0 ) { // Edge at west
				vec2 d;

				// Find the distance to the top:
				vec2 coords;

				coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
				coords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * resolution.x;
				d.x = coords.y;

				// Fetch the top crossing edges:
				float e1 = texture2D( edgesTex, coords, 0.0 ).g;

				// Find the distance to the bottom:
				coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
				d.y = coords.y;

				// We want the distances to be in pixel units:
				d = d / resolution.y - pixcoord.y;

				// SMAAArea below needs a sqrt, as the areas texture is compressed
				// quadratically:
				vec2 sqrt_d = sqrt( abs( d ) );

				// Fetch the bottom crossing edges:
				coords.y -= 1.0 * resolution.y; // WebGL port note: Added
				float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;

				// Get the area for this direction:
				weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );
			}

			return weights;
		}

		void main() {

			gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );

		}`},yA={uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new ze(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 2 ];

		void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component
		}

		void main() {

			vUv = uv;

			SMAANeighborhoodBlendingVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform sampler2D tColor;
		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 2 ];

		vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
			// Fetch the blending weights for current pixel:
			vec4 a;
			a.xz = texture2D( blendTex, texcoord ).xz;
			a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
			a.w = texture2D( blendTex, offset[ 1 ].xy ).a;

			// Is there any blending weight with a value greater than 0.0?
			if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
				return texture2D( colorTex, texcoord, 0.0 );
			} else {
				// Up to 4 lines can be crossing a pixel (one through each edge). We
				// favor blending by choosing the line with the maximum weight for each
				// direction:
				vec2 offset;
				offset.x = a.a > a.b ? a.a : -a.b; // left vs. right
				offset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs

				// Then we go in the direction that has the maximum weight:
				if ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical
					offset.y = 0.0;
				} else {
					offset.x = 0.0;
				}

				// Fetch the opposite color and lerp by hand:
				vec4 C = texture2D( colorTex, texcoord, 0.0 );
				texcoord += sign( offset ) * resolution;
				vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
				float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );

				// WebGL port note: Added gamma correction
				C.xyz = pow(C.xyz, vec3(2.2));
				Cop.xyz = pow(Cop.xyz, vec3(2.2));
				vec4 mixed = mix(C, Cop, s);
				mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));

				return mixed;
			}
		}

		void main() {

			gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );

		}`};class Fde extends Ul{constructor(e,t){super(),this.edgesRT=new Qn(e,t,{depthBuffer:!1}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new Qn(e,t,{depthBuffer:!1}),this.weightsRT.texture.name="SMAAPass.weights";const i=this,r=new Image;r.src=this.getAreaTexture(),r.onload=function(){i.areaTexture.needsUpdate=!0},this.areaTexture=new so,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=r,this.areaTexture.minFilter=Hi,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;const o=new Image;o.src=this.getSearchTexture(),o.onload=function(){i.searchTexture.needsUpdate=!0},this.searchTexture=new so,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=o,this.searchTexture.magFilter=Mi,this.searchTexture.minFilter=Mi,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,Y0===void 0&&console.error("THREE.SMAAPass relies on SMAAShader"),this.uniformsEdges=zr.clone(Y0.uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new Mn({defines:Object.assign({},Y0.defines),uniforms:this.uniformsEdges,vertexShader:Y0.vertexShader,fragmentShader:Y0.fragmentShader}),this.uniformsWeights=zr.clone(Hw.uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new Mn({defines:Object.assign({},Hw.defines),uniforms:this.uniformsWeights,vertexShader:Hw.vertexShader,fragmentShader:Hw.fragmentShader}),this.uniformsBlend=zr.clone(yA.uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new Mn({uniforms:this.uniformsBlend,vertexShader:yA.vertexShader,fragmentShader:yA.fragmentShader}),this.needsSwap=!1,this.fsQuad=new qp(null)}render(e,t,i){this.uniformsEdges.tDiffuse.value=i.texture,this.fsQuad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),this.fsQuad.render(e),this.uniformsBlend.tColor.value=i.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}setSize(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)}getAreaTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="}getSearchTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}}const Bde=new Fde(xk,bk);Vt(()=>{var n;const e=Xv();if(!e)return;const t=[E2];if(T2()&&t.push(fl),NR()&&t.push(Gv),LV()&&t.push(HW),TR()&&t.push(Gk),AV()&&t.push(El),zR()&&t.push(XW),VR())for(const r of kde)t.push(r);const i=zy();(i==="SMAA"||i==="MSAA"&&!((n=fi())!=null&&n.capabilities.isWebGL2))&&t.push(Bde);for(const r of t)e.addPass(r);return()=>{for(const r of t)e.removePass(r)}},[Xv,T2,NR,LV,TR,AV,zR,VR,zy,fi]);const[Ww,QW]=lo();Vt(()=>{const n=fi();if(!n)return;const e=dt(),t=b2();if(t){const[l,u]=Eo(),c=l*1,h=u*.5;t.aspect=e.aspect=c/h,e.updateProjectionMatrix(),t.updateProjectionMatrix();const p=x_(()=>{Dw(),Ww(),n.setViewport(0,0,c,h),n.setScissor(0,0,c,h),n.setScissorTest(!0),n.render(St,t),n.setViewport(0,h,c,h),n.setScissor(0,h,c,h),n.render(St,e),Rw()});return()=>{p.cancel(),n.setViewport(0,0,l,u),n.setScissor(0,0,l,u),n.setScissorTest(!1),e.aspect=l/u,e.updateProjectionMatrix()}}const i=Hv();if(i==="webxr"){const l=x_(()=>{Dw(),Ww(),n.render(St,e),Rw()});return()=>{l.cancel()}}if(i){const l=new qC;l.scale=.5,l.visible=!1;const u=1e3,c=-u*.5,[h,p]=Eo(),m=h*.5,y=p*1;e.aspect=m/y,e.updateProjectionMatrix();const _=new Yp(e),g=x_(()=>{Dw(),Ww(),n.setViewport(0,0,m,y),n.setScissor(0,0,m,y),n.setScissorTest(!0),l.outerObject3d.position.copy(Dn(e)),l.outerObject3d.quaternion.copy(e.quaternion),l.translateZ(-u);const b=l.outerObject3d.position.clone(),w=e.quaternion.clone(),M=e.position.clone();l.moveRight(c),_.moveRight(-3),e.lookAt(l.outerObject3d.position),n.render(St,e),l.outerObject3d.position.copy(b),e.quaternion.copy(w),e.position.copy(M),n.setViewport(m,0,m,y),n.setScissor(m,0,m,y),l.moveRight(-c),_.moveRight(3),e.lookAt(l.outerObject3d.position),n.render(St,e),l.outerObject3d.position.copy(b),e.quaternion.copy(w),e.position.copy(M),Rw()});return()=>{l.dispose(),g.cancel(),n.setViewport(0,0,h,p),n.setScissor(0,0,h,p),n.setScissorTest(!1),e.aspect=h/p,e.updateProjectionMatrix()}}const r=Xv();if(!r)return;let o=!1,s=!1;const a=x_(()=>{Dw(),Ww(),rW[0]&&(o||(xde(!0),o=!0),lhe()),hW[0]&&!s&&(yde(!0),s=!0),r.render(),Rw()});return()=>{a.cancel()}},[Hv,dt,b2,Eo,fi,Xv]);const Ude=new Map,jde=new Fue,Hde=n=>zl(Ude,n.join(","),()=>(dk(),jde.load(n,Bv,pk(n.join(",")),Bv))),[Wde,FR]=Qe(void 0),[Xk,Vy]=Qe([]),Gde=mg(Xk,Vy),Xde=vg(Xk,Vy);Vt(()=>{var n;const e=FR(),t=ky(),i=(n=Rv(Vy()))==null?void 0:n.texture;if(i)if(Array.isArray(i))St.background=Hde(i);else{let r=!0;const o=to(i,()=>r&&(St.background=o));return o.mapping=Ty,()=>{r=!1}}else e?St.background=to(e):t?t==="transparent"?St.background=null:St.background=new vt(t):St.background=new vt("black")},[ky,FR,Vy]);const[qk,Fy]=Qe([]),qde=mg(qk,Fy),Yde=vg(qk,Fy),Kde=Uj(qk,Fy),Zde={...Uh,texture:String},Jde={...jh,texture:"studio"};class lv extends nc{constructor(){super(),q(this,"_texture","studio"),qde(this)}dispose(){return this.done?this:(super.dispose(),Yde(this),this)}get texture(){return this._texture}set texture(e){this._texture=e,Kde()}}q(lv,"componentName","environment"),q(lv,"defaults",Jde),q(lv,"schema",Zde);const[Qde,BR]=Qe("default"),X_=new lv;X_.texture=void 0;Ii.delete(X_);const $W=new lH(256),xA=new aH(1,1e5,$W);Vt(()=>{var n;const e=(n=Rv(Fy()))==null?void 0:n.texture;if(!e)return;if(e==="dynamic"){const r=Yn(()=>{const o=dt(),s=fi();xA.position.copy(Dn(o)),xA.matrixWorld.copy(o.matrixWorld),xA.update(s,St),s.render(St,o)});return St.environment=$W.texture,()=>{r.cancel(),St.environment=null}}let t=!0;const i=to(e==="studio"?iW+"studio.jpg":e,()=>t&&(St.environment=i));return i.mapping=Ty,()=>{t=!1,St.environment=null}},[Fy]);Vt(()=>{const n=BR();if(!n)return;if(typeof n=="string"&&n!=="default")return n==="dynamic"?X_.texture="dynamic":X_.texture=n,()=>{X_.texture=void 0};const e=new Cn;return Promise.resolve().then(()=>oMe).then(t=>{const i=t.default,r=new i;Ii.delete(r),r.helper=!1,r.groundColor="#666666",e.then(()=>r.dispose())}),Promise.resolve().then(()=>nMe).then(t=>{const i=t.default,r=new i;if(Ii.delete(r),r.helper=!1,r.y=yl,r.z=yl,r.intensity=.5,e.then(()=>r.dispose()),!Rh())return;const o=new i;Ii.delete(o),o.helper=!1,o.y=-yl,o.z=-yl,o.intensity=.5,e.then(()=>o.dispose())}),()=>{e.cancel()}},[BR,Rh]);const[eG,$de]=Qe(!1),epe={...Uh,texture:[String,Array]},tpe={...jh,texture:void 0};class uv extends nc{constructor(){super(),q(this,"_texture"),Gde(this)}dispose(){return this.done?this:(super.dispose(),Xde(this),this)}get texture(){return this._texture}set texture(e){this._texture=e,Xk([...Vy()])}}q(uv,"componentName","skybox"),q(uv,"defaults",tpe),q(uv,"schema",epe);const[npe,ipe]=Qe(0),[rpe,UR]=Qe(void 0),[ope,jR]=Qe(void 0),[spe,HR]=Qe(void 0),WR=new uv;Ii.delete(WR);const Yk={get defaultLight(){return BR()},set defaultLight(n){Qde(n)},get shadowResolution(){return HR()},set shadowResolution(n){spe(n)},get shadowBias(){return UR()},set shadowBias(n){rpe(n)},get shadowDistance(){return jR()},set shadowDistance(n){ope(n)},get skybox(){return WR.texture},set skybox(n){WR.texture=n},get gridHelper(){return kR()},set gridHelper(n){OR(n)},get gridHelperSize(){return IR()},set gridHelperSize(n){vde(n)},get gravity(){return CW()},set gravity(n){Yhe(n)},get repulsion(){return ipe()},set repulsion(n){npe(n)},get centripetal(){return Rh()},set centripetal(n){Whe(n)},get antiAlias(){return zy()},set antiAlias(n){Lde(n)},get pixelRatio(){return Ap()},set pixelRatio(n){the(n)},get fps(){return lR()},set fps(n){Zce(n)},get logarithmicDepth(){return aR()},set logarithmicDepth(n){Yce(n)},get exposure(){return pR()},set exposure(n){uhe(n)},get pbr(){return fR()},set pbr(n){che(n)},get bloom(){return NR()},set bloom(n){bde(n)},get bloomStrength(){return jk()},set bloomStrength(n){Sde(n)},get bloomRadius(){return Uk()},set bloomRadius(n){wde(n)},get bloomThreshold(){return Hk()},set bloomThreshold(n){Mde(n)},get ambientOcclusion(){return T2()},set ambientOcclusion(n){Nde(n)},get outlineColor(){return gR()},set outlineColor(n){vhe(n)},get outlineHiddenColor(){return _R()},set outlineHiddenColor(n){ghe(n)},get outlinePattern(){return yR()},set outlinePattern(n){_he(n)},get outlinePulse(){return lW()},set outlinePulse(n){yhe(n)},get outlineStrength(){return uW()},set outlineStrength(n){xhe(n)},get outlineThickness(){return cW()},set outlineThickness(n){bhe(n)},get bokeh(){return TR()},set bokeh(n){DW(n)},get bokehAperture(){return OW()},set bokehAperture(n){RW(n)},get bokehFocus(){return IW()},set bokehFocus(n){kW(n)},get bokehMaxBlur(){return zW()},set bokehMaxBlur(n){NW(n)},get lensDistortion(){return zR()},set lensDistortion(n){Ade(n)},get lensIor(){return WW()},set lensIor(n){Tde(n)},get lensBand(){return GW()},set lensBand(n){Pde(n)},get motionBlur(){return VR()},set motionBlur(n){Ide(n)},get motionBlurStrength(){return YW()},set motionBlurStrength(n){Ode(n)},get texture(){return FR()},set texture(n){Wde(n)},get color(){return ky()},set color(n){qce(n)}},t3={skybox:[String,Array],defaultLight:[String,Boolean],shadowDistance:Number,shadowResolution:Number,shadowBias:Number,gridHelper:Boolean,gridHelperSize:Number,gravity:Number,repulsion:Number,centripetal:Boolean,antiAlias:[Boolean,String],logarithmicDepth:Boolean,pixelRatio:Number,fps:Number,exposure:Number,pbr:Boolean,bloom:Boolean,bloomStrength:Number,bloomRadius:Number,bloomThreshold:Number,ambientOcclusion:[Boolean,String],outlineColor:String,outlineHiddenColor:String,outlinePattern:String,outlinePulse:Number,outlineStrength:Number,outlineThickness:Number,bokeh:Boolean,bokehAperture:Number,bokehFocus:Number,bokehMaxBlur:Number,lensDistortion:Boolean,lensIor:Number,lensBand:Number,motionBlur:Boolean,motionBlurStrength:Number,texture:String,color:String},hl={...Yk,shadowDistance:new ci(2e3),shadowResolution:new ci(1024),shadowBias:new ci(wk)},[Kk,By]=Qe([]),ape=mg(Kk,By),lpe=vg(Kk,By),tG=qa(Uj(Kk,By),0,"trailing"),fs={get autoMount(){return mR()},set autoMount(n){dhe(n)}},nG={};for(const n of Object.keys(t3))Object.defineProperty(fs,n,{get(){return Yk[n]},set(e){nG[n]=e,tG()},enumerable:!0});const upe=Object.fromEntries(Object.entries(hl).map(([n,e])=>[n,e instanceof ci?void 0:e]));Vt(function(){const n={};for(const e of[upe,...By(),nG])for(const[t,i]of Object.entries(e))i!==void 0&&(n[t]=i);Object.assign(Yk,n)},[By]);const Uy=window;"__THREE__"in Uy&&(Uy.__THREE__+=" - Lingo3D Beta");Uy.setDebug=eG;"__LINGO3D__"in Uy&&console.warn("multiple versions of Lingo3D detected");Uy.__LINGO3D__=!0;async function cpe(){const{Sphere:n}=await Tg(),e=new n(ic(this).x*.5);this.cannonBody.addShape(e)}const Zk=new $O(Hu,32,32);class px extends Cs{constructor(){super(Zk),q(this,"_physicsShape",cpe)}}q(px,"componentName","sphere");const hpe=Object.freeze(Object.defineProperty({__proto__:null,sphereGeometry:Zk,default:px},Symbol.toStringTag,{value:"Module"})),dpe=new JO(Hu,ws,16);class Jk extends Cs{constructor(){super(dpe)}}q(Jk,"componentName","cone");async function ppe(){const{Cylinder:n}=await Tg(),{x:e,y:t}=ic(this),i=e*.5,r=new n(i,i,t);this.cannonBody.addShape(r)}const fpe=new kC(Hu,Hu,ws,16);class fx extends Cs{constructor(){super(fpe),q(this,"_physicsShape",ppe)}}q(fx,"componentName","cylinder");const mpe=new QO(Hu);class Qk extends Cs{constructor(){super(mpe)}}q(Qk,"componentName","octahedron");const n3=new ek(61*rn);n3.rotateY(45*yr);n3.rotateX(125*yr);n3.translate(0,-.2,.2);class $k extends Cs{constructor(){super(n3)}}q($k,"componentName","tetrahedron");async function vpe(){const{Box:n,Vec3:e}=await Tg(),t=ic(this),i=t.clone().multiply(Ci.set(.15,.5,.1)),r=t.clone().multiply(Uce.set(.5,.15,.1)),o=new n(i),s=new n(r);this.cannonBody.addShape(o,new e(-r.x,0,0)),this.cannonBody.addShape(o,new e(r.x,0,0)),this.cannonBody.addShape(s,new e(0,-i.y,0)),this.cannonBody.addShape(s,new e(0,i.y,0))}const gpe=new tk(40*rn,10*rn,8,16);class eI extends Cs{constructor(){super(gpe),q(this,"_physicsShape",vpe)}}q(eI,"componentName","torus");const iG={...Ok},rG={...kk,scaleZ:0,depth:0},oG=new sx(ws,ws,1,1);class cv extends Cs{constructor(){super(oG),this.object3d.scale.z=HH}get depth(){return 0}set depth(e){}get scaleZ(){return 0}set scaleZ(e){}}q(cv,"componentName","plane"),q(cv,"defaults",rG),q(cv,"schema",iG);async function _pe(){const{Sphere:n}=await Tg();this.cannonBody.addShape(new n(ic(this).x*.5))}const ype={...Ok},xpe={...kk,scaleZ:0,depth:0},bpe=new ZO(Hu,32);class q_ extends Cs{constructor(){super(bpe),q(this,"_physicsShape",_pe),this.object3d.scale.z=HH}get depth(){return 0}set depth(e){}get scaleZ(){return 0}set scaleZ(e){}}q(q_,"componentName","circle"),q(q_,"defaults",xpe),q(q_,"schema",ype);const bA=new Map,tI=(n,e)=>{if(bA.has(e))return bA.get(e);const t=new K;return rv.setFromObject(n).getSize(t),Object.freeze(t),bA.set(e,t),t},wA=new Map,sG=(n,e)=>{if(wA.has(e)){const[o,s,a]=wA.get(e);return n.scale.multiplyScalar(o),n.position.copy(s).multiplyScalar(-1),a}const t=tI(n,e).clone(),i=1/t.y;n.scale.multiplyScalar(i);const r=hx(n);return n.position.copy(r).multiplyScalar(-1),t.multiplyScalar(i),Object.freeze(t),wA.set(e,[i,r,t]),t},aG={...rc,src:String,onLoad:Function,boxVisible:Boolean},lG={...oc,src:void 0,onLoad:void 0,boxVisible:!1},nI={...aG,resize:Boolean},iI={...lG,resize:!0},wpe=Up(()=>ki(()=>import("./loadFBX.f50be137.8ef55543.js"),[])),Spe=Up(()=>ki(()=>import("./loadGLTF.47cd64eb.afc46574.js"),[]));class Tl extends dx{constructor(e){super(e),q(this,"unmounted"),q(this,"loadingState",new Pt(0)),q(this,"serializeAnimations"),q(this,"_resize"),this.unmounted=e}playAnimation(e,t){setTimeout(()=>this.cancelHandle("playAnimation",()=>this.loadingState.get((i,r)=>{i||(r.cancel(),super.playAnimation(e,t))})))}stopAnimation(){setTimeout(()=>this.cancelHandle("stopAnimation",()=>this.loadingState.get((e,t)=>{e||(t.cancel(),super.stopAnimation())})))}async loadAnimation(e,t=e){var i;((i=this.serializeAnimations)!=null?i:this.serializeAnimations={})[t]=e;const r=(await this.load(e)).animations[0];!r||(this.animations[t]=this.watch(new Iy(r,await this.loaded)))}get animations(){return super.animations}set animations(e){for(const[t,i]of Object.entries(e))typeof i=="string"?this.loadAnimation(i,t):this.animations[t]=i}async load(e){var t;const i=new Vj;this.loadingState.set(this.loadingState.get()+1);const r=(t=Fne(e)[1])==null?void 0:t.toLowerCase();if(!r||!["fbx","glb","gltf"].includes(r))return i.resolve(),setTimeout(()=>this.loadingState.set(this.loadingState.get()-1)),new Ys;let o;try{o=r==="fbx"?await(await wpe()).default(e,!this.unmounted):await(await Spe()).default(e,!this.unmounted)}catch{return i.resolve(),setTimeout(()=>this.loadingState.set(this.loadingState.get()-1)),new Ys}return i.resolve(),setTimeout(()=>this.loadingState.set(this.loadingState.get()-1)),o}get resize(){var e;return(e=this._resize)!=null?e:!0}set resize(e){this._resize=e,this.loaded.done&&(this.src=this._src)}resolveLoaded(e,t){for(const r of e.animations)this.animations[r.name]=this.watch(new Iy(r,e));const i=this._resize===!1?tI(e,t):sG(e,t);return!this.widthSet&&(this.object3d.scale.x=i.x),!this.heightSet&&(this.object3d.scale.y=i.y),!this.depthSet&&(this.object3d.scale.z=i.z),e}find(e,t){const i=super.find(e,t);return i&&(i.model=this),i}findAll(e){const t=super.findAll(e);for(const i of t)i.model=this;return t}}q(Tl,"componentName","model"),q(Tl,"defaults",iI),q(Tl,"schema",nI);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var lt=function(){return lt=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},lt.apply(this,arguments)};function rI(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function cn(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function un(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),r,o=[],s;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(s)throw s.error}}return o}function Hn(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,o;i<r;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))}var Fn;(function(n){n.Start="xstate.start",n.Stop="xstate.stop",n.Raise="xstate.raise",n.Send="xstate.send",n.Cancel="xstate.cancel",n.NullEvent="",n.Assign="xstate.assign",n.After="xstate.after",n.DoneState="done.state",n.DoneInvoke="done.invoke",n.Log="xstate.log",n.Init="xstate.init",n.Invoke="xstate.invoke",n.ErrorExecution="error.execution",n.ErrorCommunication="error.communication",n.ErrorPlatform="error.platform",n.ErrorCustom="xstate.error",n.Update="xstate.update",n.Pure="xstate.pure",n.Choose="xstate.choose"})(Fn||(Fn={}));var Oh;(function(n){n.Parent="#_parent",n.Internal="#_internal"})(Oh||(Oh={}));var GR=Fn.Start,oI=Fn.Stop,qv=Fn.Raise,Yv=Fn.Send,uG=Fn.Cancel,Mpe=Fn.NullEvent,cG=Fn.Assign;Fn.After;Fn.DoneState;var hG=Fn.Log,Cpe=Fn.Init,XR=Fn.Invoke;Fn.ErrorExecution;var IV=Fn.ErrorPlatform,Epe=Fn.ErrorCustom,dG=Fn.Update,Tpe=Fn.Choose,Ppe=Fn.Pure,pG=".",NV={},qR="xstate.guard",Ape="",SA;function sI(n,e,t){t===void 0&&(t=pG);var i=Y_(n,t),r=Y_(e,t);return Pn(r)?Pn(i)?r===i:!1:Pn(i)?i in r:Object.keys(i).every(function(o){return o in r?sI(i[o],r[o]):!1})}function fG(n){try{return Pn(n)||typeof n=="number"?"".concat(n):n.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function YR(n,e){try{return Ag(n)?n:n.toString().split(e)}catch{throw new Error("'".concat(n,"' is not a valid state path."))}}function Lpe(n){return typeof n=="object"&&"value"in n&&"context"in n&&"event"in n&&"_event"in n}function Y_(n,e){if(Lpe(n))return n.value;if(Ag(n))return A2(n);if(typeof n!="string")return n;var t=YR(n,e);return A2(t)}function A2(n){if(n.length===1)return n[0];for(var e={},t=e,i=0;i<n.length-1;i++)i===n.length-2?t[n[i]]=n[i+1]:(t[n[i]]={},t=t[n[i]]);return e}function w_(n,e){for(var t={},i=Object.keys(n),r=0;r<i.length;r++){var o=i[r];t[o]=e(n[o],o,n,r)}return t}function zV(n,e,t){var i,r,o={};try{for(var s=cn(Object.keys(n)),a=s.next();!a.done;a=s.next()){var l=a.value,u=n[l];!t(u)||(o[l]=e(u,l,n))}}catch(c){i={error:c}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}var Dpe=function(n){return function(e){var t,i,r=e;try{for(var o=cn(n),s=o.next();!s.done;s=o.next()){var a=s.value;r=r[a]}}catch(l){t={error:l}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}return r}};function Rpe(n,e){return function(t){var i,r,o=t;try{for(var s=cn(n),a=s.next();!a.done;a=s.next()){var l=a.value;o=o[e][l]}}catch(u){i={error:u}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}}function xM(n){if(!n)return[[]];if(Pn(n))return[[n]];var e=si(Object.keys(n).map(function(t){var i=n[t];return typeof i!="string"&&(!i||!Object.keys(i).length)?[[t]]:xM(n[t]).map(function(r){return[t].concat(r)})}));return e}function si(n){var e;return(e=[]).concat.apply(e,Hn([],un(n),!1))}function mG(n){return Ag(n)?n:[n]}function La(n){return n===void 0?[]:mG(n)}function L2(n,e,t){var i,r;if(Nn(n))return n(e,t.data);var o={};try{for(var s=cn(Object.keys(n)),a=s.next();!a.done;a=s.next()){var l=a.value,u=n[l];Nn(u)?o[l]=u(e,t.data):o[l]=u}}catch(c){i={error:c}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function Ope(n){return/^(done|error)\./.test(n)}function VV(n){return!!(n instanceof Promise||n!==null&&(Nn(n)||typeof n=="object")&&Nn(n.then))}function kpe(n){return n!==null&&typeof n=="object"&&"transition"in n&&typeof n.transition=="function"}function Ipe(n,e){var t,i,r=un([[],[]],2),o=r[0],s=r[1];try{for(var a=cn(n),l=a.next();!l.done;l=a.next()){var u=l.value;e(u)?o.push(u):s.push(u)}}catch(c){t={error:c}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}return[o,s]}function vG(n,e){return w_(n.states,function(t,i){if(t){var r=(Pn(e)?void 0:e[i])||(t?t.current:void 0);if(r)return{current:r,states:vG(t,r)}}})}function Npe(n,e){return{current:e,states:vG(n,e)}}function FV(n,e,t,i){var r=n&&t.reduce(function(o,s){var a,l,u=s.assignment,c={state:i,action:s,_event:e},h={};if(Nn(u))h=u(o,e.data,c);else try{for(var p=cn(Object.keys(u)),m=p.next();!m.done;m=p.next()){var y=m.value,_=u[y];h[y]=Nn(_)?_(o,e.data,c):_}}catch(g){a={error:g}}finally{try{m&&!m.done&&(l=p.return)&&l.call(p)}finally{if(a)throw a.error}}return Object.assign({},o,h)},n);return r}var zpe=function(){};function Ag(n){return Array.isArray(n)}function Nn(n){return typeof n=="function"}function Pn(n){return typeof n=="string"}function gG(n,e){if(n)return Pn(n)?{type:qR,name:n,predicate:e?e[n]:void 0}:Nn(n)?{type:qR,name:n.name,predicate:n}:n}function Vpe(n){try{return"subscribe"in n&&Nn(n.subscribe)}catch{return!1}}var oh=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();SA={},SA[oh]=function(){return this},SA[Symbol.observable]=function(){return this};function Kv(n){return!!n&&"__xstatenode"in n}function Fpe(n){return!!n&&typeof n.send=="function"}function aI(n,e){return Pn(n)||typeof n=="number"?lt({type:n},e):n}function Nr(n,e){if(!Pn(n)&&"$$type"in n&&n.$$type==="scxml")return n;var t=aI(n);return lt({name:t.type,data:t,$$type:"scxml",type:"external"},e)}function im(n,e){var t=mG(e).map(function(i){return typeof i>"u"||typeof i=="string"||Kv(i)?{target:i,event:n}:lt(lt({},i),{event:n})});return t}function Bpe(n){if(!(n===void 0||n===Ape))return La(n)}function _G(n,e,t,i,r){var o=n.options.guards,s={state:r,cond:e,_event:i};if(e.type===qR)return((o==null?void 0:o[e.name])||e.predicate)(t,i.data,s);var a=o==null?void 0:o[e.type];if(!a)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(n.id,"'."));return a(t,i.data,s)}function yG(n){return typeof n=="string"?{type:n}:n}function bM(n,e,t){var i=function(){},r=typeof n=="object",o=r?n:null;return{next:((r?n.next:n)||i).bind(o),error:((r?n.error:e)||i).bind(o),complete:((r?n.complete:t)||i).bind(o)}}function Gw(n,e){return"".concat(n,":invocation[").concat(e,"]")}var hv=Nr({type:Cpe});function KR(n,e){return e&&e[n]||void 0}function jy(n,e){var t;if(Pn(n)||typeof n=="number"){var i=KR(n,e);Nn(i)?t={type:n,exec:i}:i?t=i:t={type:n,exec:void 0}}else if(Nn(n))t={type:n.name||n.toString(),exec:n};else{var i=KR(n.type,e);if(Nn(i))t=lt(lt({},n),{exec:i});else if(i){var r=i.type||n.type;t=lt(lt(lt({},i),n),{type:r})}else t=n}return t}var sh=function(n,e){if(!n)return[];var t=Ag(n)?n:[n];return t.map(function(i){return jy(i,e)})};function lI(n){var e=jy(n);return lt(lt({id:Pn(n)?n:e.id},e),{type:e.type})}function Upe(n){return Pn(n)?{type:qv,event:n}:xG(n,{to:Oh.Internal})}function jpe(n){return{type:qv,_event:Nr(n.event)}}function xG(n,e){return{to:e?e.to:void 0,type:Yv,event:Nn(n)?n:aI(n),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:Nn(n)?n.name:fG(n)}}function Hpe(n,e,t,i){var r={_event:t},o=Nr(Nn(n.event)?n.event(e,t.data,r):n.event),s;if(Pn(n.delay)){var a=i&&i[n.delay];s=Nn(a)?a(e,t.data,r):a}else s=Nn(n.delay)?n.delay(e,t.data,r):n.delay;var l=Nn(n.to)?n.to(e,t.data,r):n.to;return lt(lt({},n),{to:l,_event:o,event:o.data,delay:s})}var Wpe=function(n,e,t){return lt(lt({},n),{value:Pn(n.expr)?n.expr:n.expr(e,t.data,{_event:t})})},Gpe=function(n){return{type:uG,sendId:n}};function Xpe(n){var e=lI(n);return{type:Fn.Start,activity:e,exec:void 0}}function qpe(n){var e=Nn(n)?n:lI(n);return{type:Fn.Stop,activity:e,exec:void 0}}function Ype(n,e,t){var i=Nn(n.activity)?n.activity(e,t.data):n.activity,r=typeof i=="string"?{id:i}:i,o={type:Fn.Stop,activity:r};return o}function Kpe(n,e){var t=e?"#".concat(e):"";return"".concat(Fn.After,"(").concat(n,")").concat(t)}function Xw(n,e){var t="".concat(Fn.DoneState,".").concat(n),i={type:t,data:e};return i.toString=function(){return t},i}function wM(n,e){var t="".concat(Fn.DoneInvoke,".").concat(n),i={type:t,data:e};return i.toString=function(){return t},i}function S_(n,e){var t="".concat(Fn.ErrorPlatform,".").concat(n),i={type:t,data:e};return i.toString=function(){return t},i}var Zpe=function(n){var e,t,i=[];try{for(var r=cn(n),o=r.next();!o.done;o=r.next())for(var s=o.value,a=0;a<s.length;){if(s[a].type===cG){i.push(s[a]),s.splice(a,1);continue}a++}}catch(l){e={error:l}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i};function D2(n,e,t,i,r,o,s){s===void 0&&(s=!1);var a=s?[]:Zpe(r),l=a.length?FV(t,i,a,e):t,u=s?[t]:void 0,c=[];function h(y){var _;switch(y.type){case qv:return jpe(y);case Yv:var g=Hpe(y,l,i,n.options.delays);return o&&g.to!==Oh.Internal&&c.push(g),g;case hG:{var b=Wpe(y,l,i);return o==null||o(b,l,i),b}case Tpe:{var w=y,M=(_=w.conds.find(function(ee){var H=gG(ee.cond,n.options.guards);return!H||_G(n,H,l,i,o?void 0:e)}))===null||_===void 0?void 0:_.actions;if(!M)return[];var C=un(D2(n,e,l,i,[sh(La(M),n.options.actions)],o,s),2),P=C[0],L=C[1];return l=L,u==null||u.push(l),P}case Ppe:{var M=y.get(l,i.data);if(!M)return[];var R=un(D2(n,e,l,i,[sh(La(M),n.options.actions)],o,s),2),E=R[0],D=R[1];return l=D,u==null||u.push(l),E}case oI:{var b=Ype(y,l,i);return o==null||o(b,t,i),b}case cG:{l=FV(l,i,[y],o?void 0:e),u==null||u.push(l);break}default:var N=jy(y,n.options.actions),j=N.exec;if(o)o(N,l,i);else if(j&&u){var te=u.length-1;N=lt(lt({},N),{exec:function(ee){for(var H=[],Q=1;Q<arguments.length;Q++)H[Q-1]=arguments[Q];j.apply(void 0,Hn([u[te]],un(H),!1))}})}return N}}function p(y){var _,g,b=[];try{for(var w=cn(y),M=w.next();!M.done;M=w.next()){var C=M.value,P=h(C);P&&(b=b.concat(P))}}catch(L){_={error:L}}finally{try{M&&!M.done&&(g=w.return)&&g.call(w)}finally{if(_)throw _.error}}return c.forEach(function(L){o(L,l,i)}),c.length=0,b}var m=si(r.map(p));return[m,l]}var Em=function(n,e){var t=e(n);return t};function bG(n){var e;return e={id:n,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:n}}},e[oh]=function(){return this},e}function Jpe(n,e,t,i){var r,o=yG(n.src),s=(r=e==null?void 0:e.options.services)===null||r===void 0?void 0:r[o.type],a=n.data?L2(n.data,t,i):void 0,l=s?wG(s,n.id,a):bG(n.id);return l.meta=n,l}function wG(n,e,t){var i=bG(e);if(i.deferred=!0,Kv(n)){var r=i.state=Em(void 0,function(){return(t?n.withContext(t):n).initialState});i.getSnapshot=function(){return r}}return i}function Qpe(n){try{return typeof n.send=="function"}catch{return!1}}function $pe(n){return Qpe(n)&&"id"in n}function efe(n){var e;return lt((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[oh]=function(){return this},e),n)}var R2=function(n){return n.type==="atomic"||n.type==="final"};function SG(n){return Object.keys(n.states).map(function(e){return n.states[e]})}function Hy(n){return SG(n).filter(function(e){return e.type!=="history"})}function MG(n){var e=[n];return R2(n)?e:e.concat(si(Hy(n).map(MG)))}function M_(n,e){var t,i,r,o,s,a,l,u,c=new Set(n),h=ZR(c),p=new Set(e);try{for(var m=cn(p),y=m.next();!y.done;y=m.next())for(var _=y.value,g=_.parent;g&&!p.has(g);)p.add(g),g=g.parent}catch(D){t={error:D}}finally{try{y&&!y.done&&(i=m.return)&&i.call(m)}finally{if(t)throw t.error}}var b=ZR(p);try{for(var w=cn(p),M=w.next();!M.done;M=w.next()){var _=M.value;if(_.type==="compound"&&(!b.get(_)||!b.get(_).length))h.get(_)?h.get(_).forEach(function(N){return p.add(N)}):_.initialStateNodes.forEach(function(N){return p.add(N)});else if(_.type==="parallel")try{for(var C=(s=void 0,cn(Hy(_))),P=C.next();!P.done;P=C.next()){var L=P.value;p.has(L)||(p.add(L),h.get(L)?h.get(L).forEach(function(N){return p.add(N)}):L.initialStateNodes.forEach(function(N){return p.add(N)}))}}catch(N){s={error:N}}finally{try{P&&!P.done&&(a=C.return)&&a.call(C)}finally{if(s)throw s.error}}}}catch(D){r={error:D}}finally{try{M&&!M.done&&(o=w.return)&&o.call(w)}finally{if(r)throw r.error}}try{for(var R=cn(p),E=R.next();!E.done;E=R.next())for(var _=E.value,g=_.parent;g&&!p.has(g);)p.add(g),g=g.parent}catch(D){l={error:D}}finally{try{E&&!E.done&&(u=R.return)&&u.call(R)}finally{if(l)throw l.error}}return p}function CG(n,e){var t=e.get(n);if(!t)return{};if(n.type==="compound"){var i=t[0];if(i){if(R2(i))return i.key}else return{}}var r={};return t.forEach(function(o){r[o.key]=CG(o,e)}),r}function ZR(n){var e,t,i=new Map;try{for(var r=cn(n),o=r.next();!o.done;o=r.next()){var s=o.value;i.has(s)||i.set(s,[]),s.parent&&(i.has(s.parent)||i.set(s.parent,[]),i.get(s.parent).push(s))}}catch(a){e={error:a}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i}function tfe(n,e){var t=M_([n],e);return CG(n,ZR(t))}function C_(n,e){return Array.isArray(n)?n.some(function(t){return t===e}):n instanceof Set?n.has(e):!1}function nfe(n){return Hn([],un(new Set(si(Hn([],un(n.map(function(e){return e.ownEvents})),!1)))),!1)}function SM(n,e){return e.type==="compound"?Hy(e).some(function(t){return t.type==="final"&&C_(n,t)}):e.type==="parallel"?Hy(e).every(function(t){return SM(n,t)}):!1}function ife(n){return n===void 0&&(n=[]),n.reduce(function(e,t){return t.meta!==void 0&&(e[t.id]=t.meta),e},{})}function BV(n){return new Set(si(n.map(function(e){return e.tags})))}function EG(n,e){if(n===e)return!0;if(n===void 0||e===void 0)return!1;if(Pn(n)||Pn(e))return n===e;var t=Object.keys(n),i=Object.keys(e);return t.length===i.length&&t.every(function(r){return EG(n[r],e[r])})}function rfe(n){return typeof n!="object"||n===null?!1:"value"in n&&"_event"in n}function ofe(n,e){var t=n.exec,i=lt(lt({},n),{exec:t!==void 0?function(){return t(e.context,e.event,{action:n,state:e,_event:e._event})}:void 0});return i}var dl=function(){function n(e){var t=this,i;this.actions=[],this.activities=NV,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||NV,this.meta=ife(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(i=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&i!==void 0?i:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return nfe(t.configuration)}})}return n.from=function(e,t){if(e instanceof n)return e.context!==t?new n({value:e.value,context:t,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var i=hv;return new n({value:e,context:t,_event:i,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},n.create=function(e){return new n(e)},n.inert=function(e,t){if(e instanceof n){if(!e.actions.length)return e;var i=hv;return new n({value:e.value,context:t,_event:i,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return n.from(e,t)},n.prototype.toStrings=function(e,t){var i=this;if(e===void 0&&(e=this.value),t===void 0&&(t="."),Pn(e))return[e];var r=Object.keys(e);return r.concat.apply(r,Hn([],un(r.map(function(o){return i.toStrings(e[o],t).map(function(s){return o+t+s})})),!1))},n.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var t=e.tags;e.machine;var i=rI(e,["configuration","transitions","tags","machine"]);return lt(lt({},i),{tags:Array.from(t)})},n.prototype.matches=function(e){return sI(e,this.value)},n.prototype.hasTag=function(e){return this.tags.has(e)},n.prototype.can=function(e){var t;zpe(!!this.machine);var i=(t=this.machine)===null||t===void 0?void 0:t.getTransitionData(this,e);return!!(i!=null&&i.transitions.length)&&i.transitions.some(function(r){return r.target!==void 0||r.actions.length})},n}(),sfe={deferEvents:!1},UV=function(){function n(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=lt(lt({},sfe),e)}return n.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},n.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},n.prototype.clear=function(){this.queue=[]},n.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},n.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(t){throw this.clear(),t}finally{this.processingEvent=!1}},n}(),MA=new Map,afe=0,qw={bookId:function(){return"x:".concat(afe++)},register:function(n,e){return MA.set(n,e),n},get:function(n){return MA.get(n)},free:function(n){MA.delete(n)}};function uI(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function lfe(){var n=uI();if(n&&"__xstate__"in n)return n.__xstate__}function ufe(n){if(uI()){var e=lfe();e&&e.register(n)}}function cfe(n,e){e===void 0&&(e={});var t=n.initialState,i=new Set,r=[],o=!1,s=function(){if(!o){for(o=!0;r.length>0;){var u=r.shift();t=n.transition(t,u,l),i.forEach(function(c){return c.next(t)})}o=!1}},a=efe({id:e.id,send:function(u){r.push(u),s()},getSnapshot:function(){return t},subscribe:function(u,c,h){var p=bM(u,c,h);return i.add(p),p.next(t),{unsubscribe:function(){i.delete(p)}}}}),l={parent:e.parent,self:a,id:e.id||"anonymous",observers:i};return t=n.start?n.start(l):t,a}var hfe={sync:!1,autoForward:!1},kr;(function(n){n[n.NotStarted=0]="NotStarted",n[n.Running=1]="Running",n[n.Stopped=2]="Stopped"})(kr||(kr={}));var dfe=function(){function n(e,t){var i=this;t===void 0&&(t=n.defaultOptions),this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=kr.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(c,h){if(Ag(c))return i.batch(c),i.state;var p=Nr(aI(c,h));if(i.status===kr.Stopped)return i.state;if(i.status!==kr.Running&&!i.options.deferEvents)throw new Error('Event "'.concat(p.name,'" was sent to uninitialized service "').concat(i.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(p.data)));return i.scheduler.schedule(function(){i.forward(p);var m=i._nextState(p);i.update(m,p)}),i._state},this.sendTo=function(c,h,p){var m=i.parent&&(h===Oh.Parent||i.parent.id===h),y=m?i.parent:Pn(h)?i.children.get(h)||qw.get(h):Fpe(h)?h:void 0;if(!y){if(!m)throw new Error("Unable to send event to child '".concat(h,"' from service '").concat(i.id,"'."));return}if("machine"in y){if(i.status!==kr.Stopped||i.parent!==y||i.state.done){var _=lt(lt({},c),{name:c.name===Epe?"".concat(S_(i.id)):c.name,origin:i.sessionId});!p&&i.machine.config.predictableActionArguments?i._outgoingQueue.push([y,_]):y.send(_)}}else!p&&i.machine.config.predictableActionArguments?i._outgoingQueue.push([y,c.data]):y.send(c.data)},this._exec=function(c,h,p,m){m===void 0&&(m=i.machine.options.actions);var y=c.exec||KR(c.type,m),_=Nn(y)?y:y?y.exec:c.exec;if(_)try{return _(h,p.data,i.machine.config.predictableActionArguments?{action:c,_event:p}:{action:c,state:i.state,_event:p})}catch(te){throw i.parent&&i.parent.send({type:"xstate.error",data:te}),te}switch(c.type){case Yv:var g=c;if(typeof g.delay=="number"){i.defer(g);return}else g.to?i.sendTo(g._event,g.to,p===hv):i.send(g._event);break;case uG:i.cancel(c.sendId);break;case GR:{if(i.status!==kr.Running)return;var b=c.activity;if(!i.machine.config.predictableActionArguments&&!i.state.activities[b.id||b.type])break;if(b.type===Fn.Invoke){var w=yG(b.src),M=i.machine.options.services?i.machine.options.services[w.type]:void 0,C=b.id,P=b.data,L="autoForward"in b?b.autoForward:!!b.forward;if(!M)return;var R=P?L2(P,h,p):void 0;if(typeof M=="string")return;var E=Nn(M)?M(h,p.data,{data:R,src:w,meta:b.meta}):M;if(!E)return;var D=void 0;Kv(E)&&(E=R?E.withContext(R):E,D={autoForward:L}),i.spawn(E,C,D)}else i.spawnActivity(b);break}case oI:{i.stopChild(c.activity.id);break}case hG:var N=c.label,j=c.value;N?i.logger(N,j):i.logger(j);break}};var r=lt(lt({},n.defaultOptions),t),o=r.clock,s=r.logger,a=r.parent,l=r.id,u=l!==void 0?l:e.id;this.id=u,this.logger=s,this.clock=o,this.parent=a,this.options=r,this.scheduler=new UV({deferEvents:this.options.deferEvents}),this.sessionId=qw.bookId()}return Object.defineProperty(n.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:Em(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),n.prototype.execute=function(e,t){var i,r;try{for(var o=cn(e.actions),s=o.next();!s.done;s=o.next()){var a=s.value;this.exec(a,e,t)}}catch(l){i={error:l}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}},n.prototype.update=function(e,t){var i,r,o,s,a,l,u,c,h=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||t===hv)&&this.options.execute)this.execute(this.state);else for(var p=void 0;p=this._outgoingQueue.shift();)p[0].send(p[1]);if(this.children.forEach(function(D){h.state.children[D.id]=D}),this.devTools&&this.devTools.send(t.data,e),e.event)try{for(var m=cn(this.eventListeners),y=m.next();!y.done;y=m.next()){var _=y.value;_(e.event)}}catch(D){i={error:D}}finally{try{y&&!y.done&&(r=m.return)&&r.call(m)}finally{if(i)throw i.error}}try{for(var g=cn(this.listeners),b=g.next();!b.done;b=g.next()){var _=b.value;_(e,e.event)}}catch(D){o={error:D}}finally{try{b&&!b.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}try{for(var w=cn(this.contextListeners),M=w.next();!M.done;M=w.next()){var C=M.value;C(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(D){a={error:D}}finally{try{M&&!M.done&&(l=w.return)&&l.call(w)}finally{if(a)throw a.error}}if(this.state.done){var P=e.configuration.find(function(D){return D.type==="final"&&D.parent===h.machine}),L=P&&P.doneData?L2(P.doneData,e.context,t):void 0;try{for(var R=cn(this.doneListeners),E=R.next();!E.done;E=R.next()){var _=E.value;_(wM(this.id,L))}}catch(D){u={error:D}}finally{try{E&&!E.done&&(c=R.return)&&c.call(R)}finally{if(u)throw u.error}}this._stop(),this._stopChildren()}},n.prototype.onTransition=function(e){return this.listeners.add(e),this.status===kr.Running&&e(this.state,this.state.event),this},n.prototype.subscribe=function(e,t,i){var r=this,o=bM(e,t,i);this.listeners.add(o.next),this.status!==kr.NotStarted&&o.next(this.state);var s=function(){r.doneListeners.delete(s),r.stopListeners.delete(s),o.complete()};return this.status===kr.Stopped?o.complete():(this.onDone(s),this.onStop(s)),{unsubscribe:function(){r.listeners.delete(o.next),r.doneListeners.delete(s),r.stopListeners.delete(s)}}},n.prototype.onEvent=function(e){return this.eventListeners.add(e),this},n.prototype.onSend=function(e){return this.sendListeners.add(e),this},n.prototype.onChange=function(e){return this.contextListeners.add(e),this},n.prototype.onStop=function(e){return this.stopListeners.add(e),this},n.prototype.onDone=function(e){return this.doneListeners.add(e),this},n.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},n.prototype.start=function(e){var t=this;if(this.status===kr.Running)return this;this.machine._init(),qw.register(this.sessionId,this),this.initialized=!0,this.status=kr.Running;var i=e===void 0?this.initialState:Em(this,function(){return rfe(e)?t.machine.resolveState(e):t.machine.resolveState(dl.from(e,t.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){t.update(i,hv)}),this},n.prototype._stopChildren=function(){this.children.forEach(function(e){Nn(e.stop)&&e.stop()}),this.children.clear()},n.prototype._stop=function(){var e,t,i,r,o,s,a,l,u,c;try{for(var h=cn(this.listeners),p=h.next();!p.done;p=h.next()){var m=p.value;this.listeners.delete(m)}}catch(R){e={error:R}}finally{try{p&&!p.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}try{for(var y=cn(this.stopListeners),_=y.next();!_.done;_=y.next()){var m=_.value;m(),this.stopListeners.delete(m)}}catch(R){i={error:R}}finally{try{_&&!_.done&&(r=y.return)&&r.call(y)}finally{if(i)throw i.error}}try{for(var g=cn(this.contextListeners),b=g.next();!b.done;b=g.next()){var m=b.value;this.contextListeners.delete(m)}}catch(R){o={error:R}}finally{try{b&&!b.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}try{for(var w=cn(this.doneListeners),M=w.next();!M.done;M=w.next()){var m=M.value;this.doneListeners.delete(m)}}catch(R){a={error:R}}finally{try{M&&!M.done&&(l=w.return)&&l.call(w)}finally{if(a)throw a.error}}if(!this.initialized)return this;this.initialized=!1,this.status=kr.Stopped,this._initialState=void 0;try{for(var C=cn(Object.keys(this.delayedEventsMap)),P=C.next();!P.done;P=C.next()){var L=P.value;this.clock.clearTimeout(this.delayedEventsMap[L])}}catch(R){u={error:R}}finally{try{P&&!P.done&&(c=C.return)&&c.call(C)}finally{if(u)throw u.error}}this.scheduler.clear(),this.scheduler=new UV({deferEvents:this.options.deferEvents})},n.prototype.stop=function(){var e=this,t=this.scheduler;return this._stop(),t.schedule(function(){var i=Nr({type:"xstate.stop"}),r=Em(e,function(){var o=si(Hn([],un(e.state.configuration),!1).sort(function(c,h){return h.order-c.order}).map(function(c){return sh(c.onExit,e.machine.options.actions)})),s=un(D2(e.machine,e.state,e.state.context,i,[o],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),a=s[0],l=s[1],u=new dl({value:e.state.value,context:l,_event:i,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:a.filter(function(c){return c.type!==qv&&(c.type!==Yv||!!c.to&&c.to!==Oh.Internal)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return u.changed=!0,u});e.update(r,i),e._stopChildren(),qw.free(e.sessionId)}),this},n.prototype.batch=function(e){var t=this;if(!(this.status===kr.NotStarted&&this.options.deferEvents)){if(this.status!==kr.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'))}this.scheduler.schedule(function(){var i,r,o=t.state,s=!1,a=[],l=function(p){var m=Nr(p);t.forward(m),o=Em(t,function(){return t.machine.transition(o,m)}),a.push.apply(a,Hn([],un(o.actions.map(function(y){return ofe(y,o)})),!1)),s=s||!!o.changed};try{for(var u=cn(e),c=u.next();!c.done;c=u.next()){var h=c.value;l(h)}}catch(p){i={error:p}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(i)throw i.error}}o.changed=s,o.actions=a,t.update(o,Nr(e[e.length-1]))})},n.prototype.sender=function(e){return this.send.bind(this,e)},n.prototype._nextState=function(e,t){var i=this;t===void 0&&(t=!!this.machine.config.predictableActionArguments&&this._exec);var r=Nr(e);if(r.name.indexOf(IV)===0&&!this.state.nextEvents.some(function(s){return s.indexOf(IV)===0}))throw r.data.data;var o=Em(this,function(){return i.machine.transition(i.state,r,void 0,t||void 0)});return o},n.prototype.nextState=function(e){return this._nextState(e,!1)},n.prototype.forward=function(e){var t,i;try{for(var r=cn(this.forwardTo),o=r.next();!o.done;o=r.next()){var s=o.value,a=this.children.get(s);if(!a)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(s,"'."));a.send(e)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},n.prototype.defer=function(e){var t=this;this.delayedEventsMap[e.id]=this.clock.setTimeout(function(){e.to?t.sendTo(e._event,e.to,!0):t.send(e._event)},e.delay)},n.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},n.prototype.exec=function(e,t,i){i===void 0&&(i=this.machine.options.actions),this._exec(e,t.context,t._event,i)},n.prototype.removeChild=function(e){var t;this.children.delete(e),this.forwardTo.delete(e),(t=this.state)===null||t===void 0||delete t.children[e]},n.prototype.stopChild=function(e){var t=this.children.get(e);!t||(this.removeChild(e),Nn(t.stop)&&t.stop())},n.prototype.spawn=function(e,t,i){if(this.status!==kr.Running)return wG(e,t);if(VV(e))return this.spawnPromise(Promise.resolve(e),t);if(Nn(e))return this.spawnCallback(e,t);if($pe(e))return this.spawnActor(e,t);if(Vpe(e))return this.spawnObservable(e,t);if(Kv(e))return this.spawnMachine(e,lt(lt({},i),{id:t}));if(kpe(e))return this.spawnBehavior(e,t);throw new Error('Unable to spawn entity "'.concat(t,'" of type "').concat(typeof e,'".'))},n.prototype.spawnMachine=function(e,t){var i=this;t===void 0&&(t={});var r=new n(e,lt(lt({},this.options),{parent:this,id:t.id||e.id})),o=lt(lt({},hfe),t);o.sync&&r.onTransition(function(a){i.send(dG,{state:a,id:r.id})});var s=r;return this.children.set(r.id,s),o.autoForward&&this.forwardTo.add(r.id),r.onDone(function(a){i.removeChild(r.id),i.send(Nr(a,{origin:r.id}))}).start(),s},n.prototype.spawnBehavior=function(e,t){var i=cfe(e,{id:t,parent:this});return this.children.set(t,i),i},n.prototype.spawnPromise=function(e,t){var i,r=this,o=!1,s;e.then(function(l){o||(s=l,r.removeChild(t),r.send(Nr(wM(t,l),{origin:t})))},function(l){if(!o){r.removeChild(t);var u=S_(t,l);try{r.send(Nr(u,{origin:t}))}catch{r.devTools&&r.devTools.send(u,r.state),r.machine.strict&&r.stop()}}});var a=(i={id:t,send:function(){},subscribe:function(l,u,c){var h=bM(l,u,c),p=!1;return e.then(function(m){p||(h.next(m),!p&&h.complete())},function(m){p||h.error(m)}),{unsubscribe:function(){return p=!0}}},stop:function(){o=!0},toJSON:function(){return{id:t}},getSnapshot:function(){return s}},i[oh]=function(){return this},i);return this.children.set(t,a),a},n.prototype.spawnCallback=function(e,t){var i,r=this,o=!1,s=new Set,a=new Set,l,u=function(p){l=p,a.forEach(function(m){return m(p)}),!o&&r.send(Nr(p,{origin:t}))},c;try{c=e(u,function(p){s.add(p)})}catch(p){this.send(S_(t,p))}if(VV(c))return this.spawnPromise(c,t);var h=(i={id:t,send:function(p){return s.forEach(function(m){return m(p)})},subscribe:function(p){var m=bM(p);return a.add(m.next),{unsubscribe:function(){a.delete(m.next)}}},stop:function(){o=!0,Nn(c)&&c()},toJSON:function(){return{id:t}},getSnapshot:function(){return l}},i[oh]=function(){return this},i);return this.children.set(t,h),h},n.prototype.spawnObservable=function(e,t){var i,r=this,o,s=e.subscribe(function(l){o=l,r.send(Nr(l,{origin:t}))},function(l){r.removeChild(t),r.send(Nr(S_(t,l),{origin:t}))},function(){r.removeChild(t),r.send(Nr(wM(t),{origin:t}))}),a=(i={id:t,send:function(){},subscribe:function(l,u,c){return e.subscribe(l,u,c)},stop:function(){return s.unsubscribe()},getSnapshot:function(){return o},toJSON:function(){return{id:t}}},i[oh]=function(){return this},i);return this.children.set(t,a),a},n.prototype.spawnActor=function(e,t){return this.children.set(t,e),e},n.prototype.spawnActivity=function(e){var t=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(!!t){var i=t(this.state.context,e);this.spawnEffect(e.id,i)}},n.prototype.spawnEffect=function(e,t){var i;this.children.set(e,(i={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:t||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},i[oh]=function(){return this},i))},n.prototype.attachDev=function(){var e=uI();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var t=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(lt(lt({name:this.id,autoPause:!0,stateSanitizer:function(i){return{value:i.value,context:i.context,actions:i.actions}}},t),{features:lt({jump:!1,skip:!1},t?t.features:void 0)}),this.machine),this.devTools.init(this.state)}ufe(this)}},n.prototype.toJSON=function(){return{id:this.id}},n.prototype[oh]=function(){return this},n.prototype.getSnapshot=function(){return this.status===kr.NotStarted?this.initialState:this._state},n.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},n.interpret=TG,n}();function TG(n,e){var t=new dfe(n,e);return t}function pfe(n){if(typeof n=="string"){var e={type:n};return e.toString=function(){return n},e}return n}function Yw(n){return lt(lt({type:XR},n),{toJSON:function(){n.onDone,n.onError;var e=rI(n,["onDone","onError"]);return lt(lt({},e),{type:XR,src:pfe(n.src)})}})}var Kw="",JR="#",CA="*",rm={},om=function(n){return n[0]===JR},ffe=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},mfe=function(){function n(e,t,i,r){var o=this;i===void 0&&(i="context"in e?e.context:void 0);var s;this.config=e,this._context=i,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(ffe(),t),this.parent=r==null?void 0:r.parent,this.key=this.config.key||(r==null?void 0:r.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:pG),this.id=this.config.id||Hn([this.machine.key],un(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(s=this.config.schema)!==null&&s!==void 0?s:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?w_(this.config.states,function(u,c){var h,p=new n(u,{},void 0,{parent:o,key:c});return Object.assign(o.idMap,lt((h={},h[p.id]=p,h),p.idMap)),p}):rm;var a=0;function l(u){var c,h;u.order=a++;try{for(var p=cn(SG(u)),m=p.next();!m.done;m=p.next()){var y=m.value;l(y)}}catch(_){c={error:_}}finally{try{m&&!m.done&&(h=p.return)&&h.call(p)}finally{if(c)throw c.error}}}l(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(u){var c=u.event;return c===Kw}):Kw in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=La(this.config.entry||this.config.onEntry).map(function(u){return jy(u)}),this.onExit=La(this.config.exit||this.config.onExit).map(function(u){return jy(u)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=La(this.config.invoke).map(function(u,c){var h,p;if(Kv(u)){var m=Gw(o.id,c);return o.machine.options.services=lt((h={},h[m]=u,h),o.machine.options.services),Yw({src:m,id:m})}else if(Pn(u.src)){var m=u.id||Gw(o.id,c);return Yw(lt(lt({},u),{id:m,src:u.src}))}else if(Kv(u.src)||Nn(u.src)){var m=u.id||Gw(o.id,c);return o.machine.options.services=lt((p={},p[m]=u.src,p),o.machine.options.services),Yw(lt(lt({id:m},u),{src:m}))}else{var y=u.src;return Yw(lt(lt({id:Gw(o.id,c)},u),{src:y}))}}),this.activities=La(this.config.activities).concat(this.invoke).map(function(u){return lI(u)}),this.transition=this.transition.bind(this),this.tags=La(this.config.tags)}return n.prototype._init=function(){this.__cache.transitions||MG(this).forEach(function(e){return e.on})},n.prototype.withConfig=function(e,t){var i=this.options,r=i.actions,o=i.activities,s=i.guards,a=i.services,l=i.delays;return new n(this.config,{actions:lt(lt({},r),e.actions),activities:lt(lt({},o),e.activities),guards:lt(lt({},s),e.guards),services:lt(lt({},a),e.services),delays:lt(lt({},l),e.delays)},t!=null?t:this.context)},n.prototype.withContext=function(e){return new n(this.config,this.options,e)},Object.defineProperty(n.prototype,"context",{get:function(){return Nn(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:w_(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return this.definition},Object.defineProperty(n.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(t,i){return t[i.eventType]=t[i.eventType]||[],t[i.eventType].push(i),t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),n.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=e===Kw,i=this.transitions.filter(function(r){var o=r.eventType===e;return t?o:o||r.eventType===CA});return this.__cache.candidates[e]=i,i},n.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var i=function(o,s){var a=Nn(o)?"".concat(e.id,":delay[").concat(s,"]"):o,l=Kpe(a,e.id);return e.onEntry.push(xG(l,{delay:o})),e.onExit.push(Gpe(l)),l},r=Ag(t)?t.map(function(o,s){var a=i(o.delay,s);return lt(lt({},o),{event:a})}):si(Object.keys(t).map(function(o,s){var a=t[o],l=Pn(a)?{target:a}:a,u=isNaN(+o)?o:+o,c=i(u,s);return La(l).map(function(h){return lt(lt({},h),{event:c,delay:u})})}));return r.map(function(o){var s=o.delay;return lt(lt({},e.formatTransition(o)),{delay:s})})},n.prototype.getStateNodes=function(e){var t,i=this;if(!e)return[];var r=e instanceof dl?e.value:Y_(e,this.delimiter);if(Pn(r)){var o=this.getStateNode(r).initial;return o!==void 0?this.getStateNodes((t={},t[r]=o,t)):[this,this.states[r]]}var s=Object.keys(r),a=[this];return a.push.apply(a,Hn([],un(si(s.map(function(l){return i.getStateNode(l).getStateNodes(r[l])}))),!1)),a},n.prototype.handles=function(e){var t=fG(e);return this.events.includes(t)},n.prototype.resolveState=function(e){var t=e instanceof dl?e:dl.create(e),i=Array.from(M_([],this.getStateNodes(t.value)));return new dl(lt(lt({},t),{value:this.resolve(t.value),configuration:i,done:SM(i,this),tags:BV(i),machine:this.machine}))},n.prototype.transitionLeafNode=function(e,t,i){var r=this.getStateNode(e),o=r.next(t,i);return!o||!o.transitions.length?this.next(t,i):o},n.prototype.transitionCompoundNode=function(e,t,i){var r=Object.keys(e),o=this.getStateNode(r[0]),s=o._transition(e[r[0]],t,i);return!s||!s.transitions.length?this.next(t,i):s},n.prototype.transitionParallelNode=function(e,t,i){var r,o,s={};try{for(var a=cn(Object.keys(e)),l=a.next();!l.done;l=a.next()){var u=l.value,c=e[u];if(c){var h=this.getStateNode(u),p=h._transition(c,t,i);p&&(s[u]=p)}}}catch(w){r={error:w}}finally{try{l&&!l.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}var m=Object.keys(s).map(function(w){return s[w]}),y=si(m.map(function(w){return w.transitions})),_=m.some(function(w){return w.transitions.length>0});if(!_)return this.next(t,i);var g=si(m.map(function(w){return w.entrySet})),b=si(Object.keys(s).map(function(w){return s[w].configuration}));return{transitions:y,entrySet:g,exitSet:si(m.map(function(w){return w.exitSet})),configuration:b,source:t,actions:si(Object.keys(s).map(function(w){return s[w].actions}))}},n.prototype._transition=function(e,t,i){return Pn(e)?this.transitionLeafNode(e,t,i):Object.keys(e).length===1?this.transitionCompoundNode(e,t,i):this.transitionParallelNode(e,t,i)},n.prototype.getTransitionData=function(e,t){return this._transition(e.value,e,Nr(t))},n.prototype.next=function(e,t){var i,r,o=this,s=t.name,a=[],l=[],u;try{for(var c=cn(this.getCandidates(s)),h=c.next();!h.done;h=c.next()){var p=h.value,m=p.cond,y=p.in,_=e.context,g=y?Pn(y)&&om(y)?e.matches(Y_(this.getStateNodeById(y).path,this.delimiter)):sI(Y_(y,this.delimiter),Dpe(this.path.slice(0,-2))(e.value)):!0,b=!1;try{b=!m||_G(this.machine,m,_,t,e)}catch(P){throw new Error("Unable to evaluate guard '".concat(m.name||m.type,"' in transition for event '").concat(s,"' in state node '").concat(this.id,`':
`).concat(P.message))}if(b&&g){p.target!==void 0&&(l=p.target),a.push.apply(a,Hn([],un(p.actions),!1)),u=p;break}}}catch(P){i={error:P}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(i)throw i.error}}if(u){if(!l.length)return{transitions:[u],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:a};var w=si(l.map(function(P){return o.getRelativeStateNodes(P,e.historyValue)})),M=!!u.internal,C=[];return M||l.forEach(function(P){C.push.apply(C,Hn([],un(o.getExternalReentryNodes(P)),!1))}),{transitions:[u],entrySet:C,exitSet:M?[]:[this],configuration:w,source:e,actions:a}}},n.prototype.getExternalReentryNodes=function(e){for(var t=[],i=un(e.order>this.order?[e,this]:[this,e],2),r=i[0],o=i[1];r&&r!==o;)t.push(r),r=r.parent;return r!==o?[]:(t.push(o),t)},n.prototype.getActions=function(e,t,i,r,o,s,a){var l,u,c,h,p=this,m=M_([],s?this.getStateNodes(s.value):[this]);try{for(var y=cn(e),_=y.next();!_.done;_=y.next()){var g=_.value;(!C_(m,g)||C_(i.entrySet,g.parent))&&i.entrySet.push(g)}}catch(N){l={error:N}}finally{try{_&&!_.done&&(u=y.return)&&u.call(y)}finally{if(l)throw l.error}}try{for(var b=cn(m),w=b.next();!w.done;w=b.next()){var g=w.value;(!C_(e,g)||C_(i.exitSet,g.parent))&&i.exitSet.push(g)}}catch(N){c={error:N}}finally{try{w&&!w.done&&(h=b.return)&&h.call(b)}finally{if(c)throw c.error}}var M=si(i.entrySet.map(function(N){var j=[];if(N.type!=="final")return j;var te=N.parent;if(!te.parent)return j;j.push(Xw(N.id,N.doneData),Xw(te.id,N.doneData?L2(N.doneData,r,o):void 0));var ee=te.parent;return ee.type==="parallel"&&Hy(ee).every(function(H){return SM(i.configuration,H)})&&j.push(Xw(ee.id)),j}));i.exitSet.sort(function(N,j){return j.order-N.order}),i.entrySet.sort(function(N,j){return N.order-j.order});var C=new Set(i.entrySet),P=new Set(i.exitSet),L=Array.from(C).map(function(N){var j=N.onEntry,te=N.activities.map(function(ee){return Xpe(ee)});return sh(a?Hn(Hn([],un(j),!1),un(te),!1):Hn(Hn([],un(te),!1),un(j),!1),p.machine.options.actions)}).concat([M.map(Upe)]),R=Array.from(P).map(function(N){return sh(Hn(Hn([],un(N.onExit),!1),un(N.activities.map(function(j){return qpe(j)})),!1),p.machine.options.actions)}),E=R.concat([sh(i.actions,this.machine.options.actions)]).concat(L);if(t){var D=sh(si(Hn([],un(e),!1).sort(function(N,j){return j.order-N.order}).map(function(N){return N.onExit})),this.machine.options.actions).filter(function(N){return N.type!==qv&&(N.type!==Yv||!!N.to&&N.to!==Oh.Internal)});return E.concat([D])}return E},n.prototype.transition=function(e,t,i,r){e===void 0&&(e=this.initialState);var o=Nr(t),s;if(e instanceof dl)s=i===void 0?e:this.resolveState(dl.from(e,i));else{var a=Pn(e)?this.resolve(A2(this.getResolvedPath(e))):this.resolve(e),l=i!=null?i:this.machine.context;s=this.resolveState(dl.from(a,l))}if(this.strict&&!this.events.includes(o.name)&&!Ope(o.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(o.name,"'"));var u=this._transition(s.value,s,o)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:s,actions:[]},c=M_([],this.getStateNodes(s.value)),h=u.configuration.length?M_(c,u.configuration):c;return u.configuration=Hn([],un(h),!1),this.resolveTransition(u,s,s.context,r,o)},n.prototype.resolveRaisedTransition=function(e,t,i,r){var o,s=e.actions;return e=this.transition(e,t,void 0,r),e._event=i,e.event=i.data,(o=e.actions).unshift.apply(o,Hn([],un(s),!1)),e},n.prototype.resolveTransition=function(e,t,i,r,o){var s,a,l,u,c=this;o===void 0&&(o=hv);var h=e.configuration,p=!t||e.transitions.length>0,m=p?e.configuration:t?t.configuration:[],y=SM(m,this),_=p?tfe(this.machine,h):void 0,g=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,b=this.getActions(new Set(m),y,e,i,o,t,r),w=t?lt({},t.activities):{};try{for(var M=cn(b),C=M.next();!C.done;C=M.next()){var P=C.value;try{for(var L=(l=void 0,cn(P)),R=L.next();!R.done;R=L.next()){var E=R.value;E.type===GR?w[E.activity.id||E.activity.type]=E:E.type===oI&&(w[E.activity.id||E.activity.type]=!1)}}catch(we){l={error:we}}finally{try{R&&!R.done&&(u=L.return)&&u.call(L)}finally{if(l)throw l.error}}}}catch(we){s={error:we}}finally{try{C&&!C.done&&(a=M.return)&&a.call(M)}finally{if(s)throw s.error}}var D=un(D2(this,t,i,o,b,r,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),N=D[0],j=D[1],te=un(Ipe(N,function(we){return we.type===qv||we.type===Yv&&we.to===Oh.Internal}),2),ee=te[0],H=te[1],Q=N.filter(function(we){var Be;return we.type===GR&&((Be=we.activity)===null||Be===void 0?void 0:Be.type)===XR}),Z=Q.reduce(function(we,Be){return we[Be.activity.id]=Jpe(Be.activity,c.machine,j,o),we},t?lt({},t.children):{}),de=new dl({value:_||t.value,context:j,_event:o,_sessionid:t?t._sessionid:null,historyValue:_?g?Npe(g,_):void 0:t?t.historyValue:void 0,history:!_||e.source?t:void 0,actions:_?H:[],activities:_?w:t?t.activities:{},events:[],configuration:m,transitions:e.transitions,children:Z,done:y,tags:BV(m),machine:this}),X=i!==j;de.changed=o.name===dG||X;var B=de.history;B&&delete B.history;var U=!y&&(this._transient||h.some(function(we){return we._transient}));if(!p&&(!U||o.name===Kw))return de;var le=de;if(!y)for(U&&(le=this.resolveRaisedTransition(le,{type:Mpe},o,r));ee.length;){var ne=ee.shift();le=this.resolveRaisedTransition(le,ne._event,o,r)}var fe=le.changed||(B?!!le.actions.length||X||typeof B.value!=typeof le.value||!EG(le.value,B.value):void 0);return le.changed=fe,le.history=B,le},n.prototype.getStateNode=function(e){if(om(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var t=this.states[e];if(!t)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return t},n.prototype.getStateNodeById=function(e){var t=om(e)?e.slice(JR.length):e;if(t===this.id)return this;var i=this.machine.idMap[t];if(!i)throw new Error("Child state node '#".concat(t,"' does not exist on machine '").concat(this.id,"'"));return i},n.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&om(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var t=YR(e,this.delimiter).slice(),i=this;t.length;){var r=t.shift();if(!r.length)break;i=i.getStateNode(r)}return i},n.prototype.resolve=function(e){var t,i=this;if(!e)return this.initialStateValue||rm;switch(this.type){case"parallel":return w_(this.initialStateValue,function(o,s){return o?i.getStateNode(s).resolve(e[s]||o):rm});case"compound":if(Pn(e)){var r=this.getStateNode(e);return r.type==="parallel"||r.type==="compound"?(t={},t[e]=r.initialStateValue,t):e}return Object.keys(e).length?w_(e,function(o,s){return o?i.getStateNode(s).resolve(o):rm}):this.initialStateValue||{};default:return e||rm}},n.prototype.getResolvedPath=function(e){if(om(e)){var t=this.machine.idMap[e.slice(JR.length)];if(!t)throw new Error("Unable to find state node '".concat(e,"'"));return t.path}return YR(e,this.delimiter)},Object.defineProperty(n.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var t;if(this.type==="parallel")t=zV(this.states,function(i){return i.initialStateValue||rm},function(i){return i.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));t=R2(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),n.prototype.getInitialState=function(e,t){this._init();var i=this.getStateNodes(e);return this.resolveTransition({configuration:i,entrySet:Hn([],un(i),!1),exitSet:[],transitions:[],source:void 0,actions:[]},void 0,t!=null?t:this.machine.context,void 0)},Object.defineProperty(n.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"target",{get:function(){var e;if(this.type==="history"){var t=this.config;Pn(t.target)?e=om(t.target)?A2(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target:e=t.target}return e},enumerable:!1,configurable:!0}),n.prototype.getRelativeStateNodes=function(e,t,i){return i===void 0&&(i=!0),i?e.type==="history"?e.resolveHistory(t):e.initialStateNodes:[e]},Object.defineProperty(n.prototype,"initialStateNodes",{get:function(){var e=this;if(R2(this))return[this];if(this.type==="compound"&&!this.initial)return[this];var t=xM(this.initialStateValue);return si(t.map(function(i){return e.getFromRelativePath(i)}))},enumerable:!1,configurable:!0}),n.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=un(e),i=t[0],r=t.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(i,"' from node with no states"));var o=this.getStateNode(i);if(o.type==="history")return o.resolveHistory();if(!this.states[i])throw new Error("Child state '".concat(i,"' does not exist on '").concat(this.id,"'"));return this.states[i].getFromRelativePath(r)},n.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:zV(this.states,function(t,i){if(!e)return t.historyValue();var r=Pn(e)?void 0:e[i];return t.historyValue(r||t.initialStateValue)},function(t){return!t.history})}},n.prototype.resolveHistory=function(e){var t=this;if(this.type!=="history")return[this];var i=this.parent;if(!e){var r=this.target;return r?si(xM(r).map(function(s){return i.getFromRelativePath(s)})):i.initialStateNodes}var o=Rpe(i.path,"states")(e).current;return Pn(o)?[i.getStateNode(o)]:si(xM(o).map(function(s){return t.history==="deep"?i.getFromRelativePath(s):[i.states[s[0]]]}))},Object.defineProperty(n.prototype,"stateIds",{get:function(){var e=this,t=si(Object.keys(this.states).map(function(i){return e.states[i].stateIds}));return[this.id].concat(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"events",{get:function(){var e,t,i,r;if(this.__cache.events)return this.__cache.events;var o=this.states,s=new Set(this.ownEvents);if(o)try{for(var a=cn(Object.keys(o)),l=a.next();!l.done;l=a.next()){var u=l.value,c=o[u];if(c.states)try{for(var h=(i=void 0,cn(c.events)),p=h.next();!p.done;p=h.next()){var m=p.value;s.add("".concat(m))}}catch(y){i={error:y}}finally{try{p&&!p.done&&(r=h.return)&&r.call(h)}finally{if(i)throw i.error}}}}catch(y){e={error:y}}finally{try{l&&!l.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(s)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(t){return!(!t.target&&!t.actions.length&&t.internal)}).map(function(t){return t.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),n.prototype.resolveTarget=function(e){var t=this;if(e!==void 0)return e.map(function(i){if(!Pn(i))return i;var r=i[0]===t.delimiter;if(r&&!t.parent)return t.getStateNodeByPath(i.slice(1));var o=r?t.key+i:i;if(t.parent)try{var s=t.parent.getStateNodeByPath(o);return s}catch(a){throw new Error("Invalid transition definition for state node '".concat(t.id,`':
`).concat(a.message))}else return t.getStateNodeByPath(o)})},n.prototype.formatTransition=function(e){var t=this,i=Bpe(e.target),r="internal"in e?e.internal:i?i.some(function(l){return Pn(l)&&l[0]===t.delimiter}):!0,o=this.machine.options.guards,s=this.resolveTarget(i),a=lt(lt({},e),{actions:sh(La(e.actions)),cond:gG(e.cond,o),target:s,source:this,internal:r,eventType:e.event,toJSON:function(){return lt(lt({},a),{target:a.target?a.target.map(function(l){return"#".concat(l.id)}):void 0,source:"#".concat(t.id)})}});return a},n.prototype.formatTransitions=function(){var e,t,i=this,r;if(!this.config.on)r=[];else if(Array.isArray(this.config.on))r=this.config.on;else{var o=this.config.on,s=CA,a=o[s],l=a===void 0?[]:a,u=rI(o,[typeof s=="symbol"?s:s+""]);r=si(Object.keys(u).map(function(w){var M=im(w,u[w]);return M}).concat(im(CA,l)))}var c=this.config.always?im("",this.config.always):[],h=this.config.onDone?im(String(Xw(this.id)),this.config.onDone):[],p=si(this.invoke.map(function(w){var M=[];return w.onDone&&M.push.apply(M,Hn([],un(im(String(wM(w.id)),w.onDone)),!1)),w.onError&&M.push.apply(M,Hn([],un(im(String(S_(w.id)),w.onError)),!1)),M})),m=this.after,y=si(Hn(Hn(Hn(Hn([],un(h),!1),un(p),!1),un(r),!1),un(c),!1).map(function(w){return La(w).map(function(M){return i.formatTransition(M)})}));try{for(var _=cn(m),g=_.next();!g.done;g=_.next()){var b=g.value;y.push(b)}}catch(w){e={error:w}}finally{try{g&&!g.done&&(t=_.return)&&t.call(_)}finally{if(e)throw e.error}}return y},n}();function vfe(n,e){return new mfe(n,e)}const gfe={...nI,spineName:String,preset:String,strideForward:Number,strideRight:Number,strideMove:Boolean,strideMode:String},PG={...iI,spineName:void 0,preset:"default",strideForward:0,strideRight:0,strideMove:!1,strideMode:"aim",scale:1.7,scaleX:1.7,scaleY:1.7,scaleZ:1.7,width:20,depth:20,animation:"idle",src:Gm},_fe=vfe({predictableActionArguments:!0,states:{idle:{on:{RUN_START:"running",RUN_BACKWARDS_START:"runningBackwards",JUMP_START:"jumping"}},running:{on:{RUN_STOP:"idle",RUN_BACKWARDS_START:"runningBackwards",JUMP_START:"jumping"}},runningBackwards:{on:{RUN_STOP:"idle",RUN_START:"running",JUMP_START:"jumping"}},jumping:{on:{JUMP_STOP:"idle"}}},initial:"idle"}),tp=new WeakMap;class dv extends Tl{constructor(){super(),q(this,"poseService",TG(_fe)),q(this,"spineNameState",new Pt(void 0)),q(this,"srcState",new Pt(Gm)),q(this,"animationsState",new Pt({})),q(this,"presetState",new Pt("default")),q(this,"strideForwardState",new Pt(0)),q(this,"strideRightState",new Pt(0)),q(this,"strideMoveState",new Pt(!1)),q(this,"strideModeState",new Pt("aim")),q(this,"jumpHeight",10),this.width=20,this.depth=20,this.scale=1.7;const[e,t]=Qe(void 0),[i,r]=Qe(void 0);this.createEffect(()=>{const l=this.spineNameState.get(),u=super.src=this.srcState.get();i(void 0),e(void 0),tp.delete(this);const c=this.loaded.then(h=>{if(e("other"),l){i(this.find(l,!0)),l==="mixamorigSpine"?(e("mixamo"),u===Gm&&tp.set(this,"dummy")):l==="Spine"&&(h.getObjectByName("Wolf3D_Body")||h.getObjectByName("Wolf3D_Avatar"))&&(e("readyplayerme"),tp.set(this,"readyplayerme"));return}if(h.getObjectByName("Wolf3D_Body")||h.getObjectByName("Wolf3D_Avatar")){i(this.find("Spine",!0)),e("readyplayerme"),tp.set(this,"readyplayerme");return}const p=this.find("mixamorigSpine",!0);i(p),p&&(e("mixamo"),u===Gm&&tp.set(this,"dummy"))});return()=>{c.cancel()}},[this.srcState.get,this.spineNameState.get]);const[o,s]=Qe("idle");this.createEffect(()=>{const l=t();if(!l)return;const u=this.presetState.get()==="rifle"?"rifle-":"",c=this.srcState.get(),h=c.split("/");h.pop();let p=h.join("/")+"/";if(l==="readyplayerme")p=Sk+"readyplayerme/";else if(c!==Gm)return super.animations=this.animationsState.get(),this.animation=s(),()=>{this.animation=void 0};return super.animations={idle:p+u+"idle.fbx",running:p+u+"running.fbx",runningBackwards:p+u+"running-backwards.fbx",jumping:p+u+"falling.fbx",death:p+"death.fbx",...this.animationsState.get()},this.animation=s(),()=>{this.animation=void 0,super.animations={}}},[this.presetState.get,this.srcState.get,t,this.animationsState.get]);const{poseService:a}=this;this.createEffect(()=>{if((this.animation=s())!=="jumping")return;this.velocity.y=this.jumpHeight;const l=Yn(()=>{this.velocity.y===0&&a.send("JUMP_STOP")});return()=>{l.cancel()}},[s]),a.onTransition(l=>l.changed&&o(l.value)).start(),this.then(()=>a.stop()),this.createEffect(()=>{const l=this.loadedGroup.children[0];if(!l)return;const{strideForward:u,strideRight:c,strideMove:h}=this;if(!u&&!c){a.send("RUN_STOP");return}let p=this.strideModeState.get();p==="aim"&&!("runningBackwards"in this.animations)&&(p="free");const m=p==="aim"?u>0:!1,y=m?-u:u,_=m?c:-c,g=90-Math.atan2(-y,-_)*gp,b=r(),w=b==null?void 0:b.outerObject3d.quaternion.clone(),M=l.quaternion.clone(),C=QW(()=>{a.send(m?"RUN_BACKWARDS_START":"RUN_START");const P=l.quaternion.clone();let L;p==="aim"&&b&&w&&(l.quaternion.copy(M),b.outerObject3d.quaternion.copy(w),L=b.pointAt(1e3)),l.quaternion.setFromEuler(ai.set(0,g*yr,0));const R=l.quaternion.clone();if(l.quaternion.copy(P).slerp(R,Dp(.2)),L&&(b==null||b.lookAt(L)),!h)return;const{x:E,y:D}=Ece(0,0,g+90,Math.max(Math.abs(u),Math.abs(c)));this.moveForward(m?D:-D),this.moveRight(m?E:-E)});return()=>{p==="aim"&&!this.strideForward&&!this.strideRight&&l.quaternion.set(0,0,0,0),C.cancel()}},[this.animationsState.get,this.strideModeState.get,this.strideMoveState.get,this.strideForwardState.get,this.strideRightState.get,r])}get spineName(){return this.spineNameState.get()}set spineName(e){this.spineNameState.set(e)}get resize(){return super.resize}set resize(e){}get src(){return this.srcState.get()}set src(e){this.srcState.set(e)}get animations(){return super.animations}set animations(e){this.animationsState.set(e)}get preset(){return this.presetState.get()}set preset(e){this.presetState.set(e)}get strideForward(){return this.strideForwardState.get()}set strideForward(e){this.strideForwardState.set(e)}get strideRight(){return this.strideRightState.get()}set strideRight(e){this.strideRightState.set(e)}get strideMove(){return this.strideMoveState.get()}set strideMove(e){this.strideMoveState.set(e)}get strideMode(){return this.strideModeState.get()}set strideMode(e){this.strideModeState.set(e)}jump(e=10){this.jumpHeight=e,this.poseService.send("JUMP_START")}}q(dv,"componentName","dummy"),q(dv,"defaults",PG),q(dv,"schema",gfe);const yfe={...rc,preset:String,repeatX:Number,repeatZ:Number},xfe={...oc,preset:"industrial0",repeatX:1,repeatZ:1},bfe={...yfe,repeatY:Number},wfe={...xfe,repeatY:1},Sfe="https://unpkg.com/lingo3d-facade@1.0.0/assets/",Zw=(n,e,t)=>{const i=new Tl;return i.src=n,i.rotationY=t,e.append(i),i},Jw=(n,e,t,i,r,o)=>{const s=t*n.length*.5-e;let a=0;if(o){for(const l of n)l.z+=e*i,l.x+=a++*t-s;return}for(const l of n)l.x+=e*r,l.z+=a++*t-s};class Mfe extends ia{constructor(e){super(),q(this,"presetState",new Pt("industrial0")),q(this,"repeatXState",new Pt(1)),q(this,"repeatZState",new Pt(1)),e.append(this),jC.add(this),this.createEffect(()=>{const t=Math.max(Math.floor(this.repeatXState.get()),1),i=Math.max(Math.floor(this.repeatZState.get()),1),r=Sfe+this.presetState.get()+".glb",o=ro.exports.range(t).map(()=>Zw(r,this,0)),s=ro.exports.range(t).map(()=>Zw(r,this,180)),a=ro.exports.range(i).map(()=>Zw(r,this,90)),l=ro.exports.range(i).map(()=>Zw(r,this,270)),u=o[0].loaded.then(()=>{const c=o[0].depth,h=c*.5;Jw(o,h,c,t,i,!1),Jw(s,-h,-c,t,i,!1),Jw(a,-h,-c,t,i,!0),Jw(l,h,c,t,i,!0)});return()=>{u.cancel();for(const c of o)c.dispose();for(const c of s)c.dispose();for(const c of a)c.dispose();for(const c of l)c.dispose()}},[this.presetState.get,this.repeatXState.get,this.repeatZState.get])}get preset(){return this.presetState.get()}set preset(e){this.presetState.set(e)}get repeatX(){return this.repeatXState.get()}set repeatX(e){this.repeatXState.set(e)}get repeatZ(){return this.repeatZState.get()}set repeatZ(e){this.repeatZState.set(e)}}class MM extends ia{constructor(){super(),q(this,"presetState",new Pt("industrial0")),q(this,"repeatXState",new Pt(1)),q(this,"repeatZState",new Pt(1)),q(this,"repeatYState",new Pt(1)),this.scale=10,this.createEffect(()=>{const e=this.presetState.get(),t=this.repeatXState.get(),i=this.repeatZState.get(),r=Math.max(Math.floor(this.repeatYState.get()),1),o=ro.exports.range(r).map(s=>{const a=new Mfe(this);return a.preset=e,a.repeatX=t,a.repeatZ=i,a.y=s*100,a});return()=>{for(const s of o)s.dispose()}},[this.presetState.get,this.repeatXState.get,this.repeatZState.get,this.repeatYState.get])}get preset(){return this.presetState.get()}set preset(e){this.presetState.set(e)}get repeatX(){return this.repeatXState.get()}set repeatX(e){this.repeatXState.set(e)}get repeatZ(){return this.repeatZState.get()}set repeatZ(e){this.repeatZState.set(e)}get repeatY(){return this.repeatYState.get()}set repeatY(e){this.repeatYState.set(e)}}q(MM,"componentName","building"),q(MM,"defaults",wfe),q(MM,"schema",bfe);const Cfe={...nI,preset:String},Efe={...iI,preset:"tree1",scale:4},Tfe="https://unpkg.com/lingo3d-forest@1.0.0/assets/";class CM extends Tl{constructor(){super(),q(this,"_preset",""),this.scale=4,this.preset="tree1"}get preset(){return this._preset}set preset(e){this.src=Tfe+e+".glb"}}q(CM,"componentName","tree"),q(CM,"defaults",Efe),q(CM,"schema",Cfe);const Pfe={...aG,...BC,...ck},Afe={...lG,...UC,...hk},Lfe=Up(()=>ki(()=>import("./loadSVG.1e12e00a.f174d7d6.js"),[])),Dfe=new WeakMap;class pv extends dx{constructor(){super(...arguments),q(this,"material",x2)}load(e){return Lfe().then(t=>t.default(e))}resolveLoaded(e,t){const i=new Ys;i.scale.y*=-1;const r=zl(Dfe,e,()=>{const s=[];for(const c of e.paths)for(const h of c.toShapes(!0))s.push(h);if(!s.length)return[];const a=new Ys;for(const c of s){const h=new _2(c,{depth:0,bevelEnabled:!1});h.dispose(),a.add(new Fr(h))}const l=tI(a,t),u=[];for(const c of s)u.push(new _2(c,{depth:l.y,bevelEnabled:!1}));return u});for(const s of r){const a=new Fr(s,this.material);a.castShadow=!0,a.receiveShadow=!0,i.add(a)}const o=sG(i,t);return!this.widthSet&&(this.object3d.scale.x=o.x),!this.heightSet&&(this.object3d.scale.y=o.y),!this.depthSet&&(this.object3d.scale.z=o.z),i}}q(pv,"componentName","svgMesh"),q(pv,"defaults",Afe),q(pv,"schema",Pfe);ix(pv,[cx,fk]);const Rfe={...iG,resolution:Number,blur:Number,contrast:Number,mirror:Number},Ofe={...rG,resolution:256,blur:512,contrast:1.5,mirror:1,rotationX:-90},kfe=["roughness","metalness","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveMap","emissiveIntensity","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","roughnessMap","metalnessMap","alphaMap","envMap","envMapIntensity","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","flatShading","fog"],Ife=(n,e)=>{fW(n,e);for(const t of kfe){const i=n[t];i!=null&&(e[t]=i)}e.defines={STANDARD:""},n.color&&e.color.copy(n.color),n.emissive&&e.emissive.copy(n.emissive),n.normalScale&&e.normalScale.copy(n.normalScale)};class K_ extends cv{constructor(){super(),q(this,"resolutionState",new Pt(256)),q(this,"blurState",new Pt(512)),q(this,"contrastState",new Pt(1.5)),q(this,"mirrorState",new Pt(1)),this.rotationX=-90,this.materialCloned=!0,ki(()=>import("./MeshReflectorMaterial.06418f21.5e2b8558.js"),[]).then(e=>{this.createEffect(()=>{const t=fi();if(!t||this.done)return;const i=dt(),r=e.default,o=new r(t,i,St,this.object3d,{resolution:this.resolutionState.get(),blur:[this.blurState.get(),this.blurState.get()],mixBlur:2.5,mixContrast:this.contrastState.get(),mirror:this.mirrorState.get(),distortionMap:void 0});Ife(this.material,o),this.material=this.object3d.material=o;const s=QW(()=>{i.updateWorldMatrix(!0,!1),o.update()});return()=>{o.dispose(),s.cancel()}},[fi,dt,this.resolutionState.get,this.blurState.get,this.contrastState.get,this.mirrorState.get])})}get resolution(){return this.resolutionState.get()}set resolution(e){this.resolutionState.set(e)}get blur(){return this.blurState.get()}set blur(e){this.blurState.set(e)}get contrast(){return this.contrastState.get()}set contrast(e){this.contrastState.set(e)}get mirror(){return this.mirrorState.get()}set mirror(e){this.mirrorState.set(e)}}q(K_,"componentName","reflector"),q(K_,"defaults",Ofe),q(K_,"schema",Rfe);const Nfe={...rc,shape:String,normalMap:String,resolution:Number,speed:Number},zfe={...oc,shape:"plane",normalMap:void 0,resolution:512,speed:1};class Z_ extends ia{constructor(){super(),q(this,"shapeState",new Pt("plane")),q(this,"normalMapState",new Pt(void 0)),q(this,"resolutionState",new Pt(512)),q(this,"speedState",new Pt(1)),this.createEffect(()=>{const e=this.normalMapState.get();if(!e)return;const t=new Cn;return ki(()=>import("./Water.4002a736.bcdaf6f0.js"),[]).then(({Water:i})=>{const r=this.shapeState.get()==="plane",o=r?oG:Zk,s=this.resolutionState.get(),a=new i(o,{textureWidth:s,textureHeight:s,waterNormals:to(e),sunColor:16777215,waterColor:7695,distortionScale:3.7});r&&(a.rotation.x=-Math.PI/2);const l=this.speedState.get();this.outerObject3d.add(a);const u=Yn(()=>{a.material.uniforms.time.value+=HC[0]*l});t.then(()=>{this.outerObject3d.remove(a),u.cancel()})}),()=>{t.cancel()}},[this.shapeState.get,this.normalMapState.get,this.resolutionState.get,this.speedState.get])}get shape(){return this.shapeState.get()}set shape(e){this.shapeState.set(e)}get normalMap(){return this.normalMapState.get()}set normalMap(e){this.normalMapState.set(e)}get resolution(){return this.resolutionState.get()}set resolution(e){this.resolutionState.set(e)}get speed(){return this.speedState.get()}set speed(e){this.speedState.set(e)}}q(Z_,"componentName","water"),q(Z_,"defaults",zfe),q(Z_,"schema",Nfe);new Hr;new K;at.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new ze(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Oa.line={uniforms:zr.merge([at.common,at.fog,at.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				// get the offset direction as perpendicular to the view vector
				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 offset;
				if ( position.y < 0.5 ) {

					offset = normalize( cross( start.xyz, worldDir ) );

				} else {

					offset = normalize( cross( end.xyz, worldDir ) );

				}

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// extend the line bounds to encompass  endcaps
					start.xyz += - worldDir * linewidth * 0.5;
					end.xyz += worldDir * linewidth * 0.5;

					// shift the position of the quad so it hugs the forward edge of the line
					offset.xy -= dir * forwardOffset;
					offset.z += 0.5;

				#endif

				// endcaps
				if ( position.y > 1.0 || position.y < 0.0 ) {

					offset.xy += dir * 2.0 * forwardOffset;

				}

				// adjust for linewidth
				offset *= linewidth * 0.5;

				// set the world position
				worldPos = ( position.y < 0.5 ) ? start : end;
				worldPos.xyz += offset;

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <encodings_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};new K;new K;new _n;new _n;new _n;new K;new Bt;new Fa;new K;new Hr;new Hp;new _n;const Vfe={...lk,onEnter:Function,onExit:Function,targetIds:[String,Array],pad:Boolean,radius:Number,interval:Number,helper:Boolean},Ffe={...uk,onEnter:void 0,onExit:void 0,targetIds:void 0,pad:!1,radius:50,interval:300,helper:!0},jV=n=>{var e;return(e=bh.get(n))!=null?e:[]};class J_ extends gk{constructor(){const e=new An;super(e),q(this,"refresh",new Pt({})),q(this,"onEnter"),q(this,"onExit"),q(this,"_pad",!1),q(this,"_radius",50),q(this,"_interval",300),q(this,"_helper",!0),q(this,"_targetIds"),St.add(e);let t;this.createEffect(()=>{const{_radius:i,_interval:r,_targetIds:o,_pad:s}=this;if(!o)return;const a=i*rn,l=a*.2;let u=!1;const c=$H(r,-1,()=>{var h,p;const{x:m,y,z:_}=Dn(e),g=typeof o=="string"?jV(o):o.map(M=>[...jV(M)]).flat();let b=!1,w;for(const M of g){const{x:C,y:P,z:L}=Dn(M.nativeObject3d);if(s){const{y:R}=ic(M);b=Math.abs(m-C)<a&&Math.abs(y-(P-R*.5))<l&&Math.abs(_-L)<a}else b=Math.abs(m-C)<a&&Math.abs(y-P)<a&&Math.abs(_-L)<a;if(b){w=M;break}}u!==b&&(b&&w?((h=this.onEnter)==null||h.call(this,w),t&&(t.color="blue")):((p=this.onExit)==null||p.call(this),t&&(t.color="white"))),u=b});return()=>{c.cancel()}},[this.refresh.get]),this.createEffect(()=>{const{_radius:i,_helper:r,_pad:o}=this;if(!r||dt()!==di)return;const s=t=o?new fx:new px;Ii.delete(s),e.add(s.outerObject3d),s.scale=i*rn*2,s.opacity=.5,s.height=o?10:100;const a=Hh(({target:l})=>l===s&&Ei(this));return()=>{s.dispose(),t=void 0,a.cancel()}},[this.refresh.get,dt])}get pad(){return this._pad}set pad(e){this._pad=e,this.refresh.set({})}get radius(){return this._radius}set radius(e){this._radius=e,this.refresh.set({})}get interval(){return this._interval}set interval(e){this._interval=e,this.refresh.set({})}get helper(){return this._helper}set helper(e){this._helper=e,this.refresh.set({})}get targetIds(){return this._targetIds}set targetIds(e){this._targetIds=e,this.refresh.set({})}}q(J_,"componentName","trigger"),q(J_,"defaults",Ffe),q(J_,"schema",Vfe);const Bfe={...rc,helper:Boolean},Ufe={...oc,helper:!0};class Q_ extends ia{constructor(){super(),q(this,"helperState",new Pt(!0)),q(this,"isSpawnPoint",!0),this.createEffect(()=>{if(!this.helperState.get()||dt()!==di)return;const e=new fx;Ii.delete(e),this.outerObject3d.add(e.outerObject3d),e.opacity=.5,e.height=10;const t=Hh(({target:i})=>i===e&&Ei(this));return()=>{e.dispose(),t.cancel()}},[this.helperState.get,dt])}get helper(){return this.helperState.get()}set helper(e){this.helperState.set(e)}append(e){this._append(e),e.placeAt(this)}}q(Q_,"componentName","spawnPoint"),q(Q_,"defaults",Ufe),q(Q_,"schema",Bfe);const jfe={...lk,src:String,autoplay:Boolean,paused:Boolean,stopped:Boolean,loop:Boolean,volume:Number,playbackRate:Number,distance:Number,distanceModel:String,maxDistance:Number,rolloffFactor:Number},Hfe={...uk,src:void 0,autoplay:!1,paused:!1,stopped:!1,loop:!1,volume:1,playbackRate:1,distance:1,maxDistance:1e4,distanceModel:"inverse",rolloffFactor:1},Wfe=()=>{const n=new Wu;return n.texture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAABINJREFUaEPtWkuIXEUUPad7Jkr8Jiq6iBJFkmACUdGFohFMXCioqBhJVBCJTBR1oSDGhYofJH5QF2KMuBMjKvhbGhcK7gVDEI0LUXEluIqS2HXkvtxqipea7pqelrwKPmhmmKmuV6fuuZ86t4hj+EiaIfmPLUHSpZJ2kLyP5J+SSFKly2PpwGmOk9QDYAsdSFoSQniC5FMA/iC5guTfnQZiiwNgVjjsVrhJ0qsALvCN+pnkRSQPdhZIi0bnS3oFwC0O4BCAJQB+Ibma5F+dA+I06pkvuEUel/QkgBMBDIxiyad7QHzR/cSZN0l6DcBat4I5+Yz/HgCY33QLiCQDYLtt0eicEMJLJO9KAPTdCjGGdAtISiMH8ZCk5wCcCsAWa+HUQLSfLBC3UigJw1MLvy1nvlLS6wAuy9AoF8mPApIOSi08XxpYNBB7ie00ySBpWQjhBZJzI2g0DsgaD78nA7ie5Idu3WHyzE0wMZCMM98raSeAM51Ctss5GpUCWSrpdwA/kdxM8kBq9fYkEwFp0ehip9GGQhqVAjlJ0j4AKwEcJnkHyY/nA3MUEN/p+ahoITLSaGkI4VmSjyQA7P/2WeiT+kik1gmSfgRwrlvYSpoHSL6ZAzME4hHHCiCbdOQjabNn5hU+0EJtKY2KLOJ+sUrS2wDM2k3eIbmN5DttMA0QAxEBSDrFE5WFygjUflp9dJ6kFwHc4Kuxv1lSm4iiCaJc+B2uaTAYvEvyzgTMVSS/SaMZIwhJF0raDWBdknHju2yhtuvLfdGxtJiERuMsMqy1zMqxMgghfAFgk395f6/XayqEWJNFi8xI+g7AmnG0ckCLoVExEEuEcdetQpD0PYDTbIK2v0QgN0v6BIBVobNjwCyWRgsC4rs+a6W/pDlJu3wCK/ktMBw5u/jAhz2EpoVcgXGmNmRkrRXpI2lW0g8eks0qt5P8qHH8GoD4GpvMPhgMdpJ8zP/2fr/f31IbkKailrRB0lfOhd9IrrKSpiaLNGKEpOVOrzPc6deS3F8NkNQbQwjfAljvQK4jubcqIDHnhRC+BHCtA9lKck9tQBo/CSF8BuBGB3I/yV3/A5laBjkyUdGZ/bihVty8qp09ye7LPPzaSdSye13hNyker5b0tVvnV1cmq0qIuRJlT7/f31pNibKQotFU8U+PhzK+/oNVRUfdvQA2jjvqdl18eI/klpHiQ0wyE8hBL7vmZFP8V3LQaklvuCWiHDRHcndWDkrLjQUKdM+QfNS/by+atkB3AIBpZ400RXI7ybdyovZEQkJLMl3v5/1rEkCxgVNakuWUxrZkehvJz4sl09I3Z0Tse1y8O6saEbtFxbStcLq3FbYn1ml3p8bJQVH7NcXT2gofpOLDfBs9EbVyk7XodoXT7fJCuh37Rk8mUKQN0AclPV9V6y1Dt6b3J+lsb4bePYJuRQerUf47NWoV0G2jt6dNJLen++3plnWa3JL02+3CgN07qePCQNtCrWCw0htFt/q47l/hyASDui/VZOg2vOYEYIekp6u55jSGbpdIsntbE108+xeZO79vduBVJgAAAABJRU5ErkJggg==",Ii.delete(n),n.scale=.5,n},Gfe=new Map,Xfe=new Jue,qfe=n=>zl(Gfe,n,()=>new Promise((e,t)=>{dk(),Xfe.load(n,i=>{Bv(),e(Object.freeze(i))},pk(n),()=>{Bv(),t()})})),[Yfe,O2]=Qe(void 0);Vt(()=>{const n=O2();if(!n)return;const e=dt();return e.add(n),()=>{e.remove(n)}},[dt,O2]);class $_ extends gk{constructor(){!O2()&&Yfe(new $ue);const e=new nce(O2());super(e),q(this,"srcState",new Pt(void 0)),q(this,"autoplayState",new Pt(!1)),q(this,"pausedState",new Pt(!1)),q(this,"stoppedState",new Pt(!1)),St.add(e),this.createEffect(()=>{if(dt()!==di)return;const r=Wfe();this.outerObject3d.add(r.outerObject3d);const o=Hh(({target:s})=>{s===r&&Ei(this)});return()=>{r.dispose(),o.cancel()}},[dt]);const[t,i]=Qe(!1);this.createEffect(()=>{const r=this.srcState.get();if(!r)return;let o=!0;return qfe(r).then(s=>{!o||(e.setBuffer(s),t(!0))}),()=>{o=!1,t(!1)}},[this.srcState.get]),this.createEffect(()=>{if(!(!i()||!this.autoplayState.get()||this.pausedState.get()||this.stoppedState.get()))return e.play(),()=>{this.stoppedState.get()?e.stop():e.pause()}},[i,this.autoplayState.get,this.pausedState.get,this.stoppedState.get])}dispose(){return this.done?this:(super.dispose(),this.outerObject3d.buffer&&this.outerObject3d.disconnect(),this)}play(){this.autoplay=!0,this.paused=!1,this.stopped=!1}pause(){this.paused=!0}stop(){this.stopped=!0}get src(){return this.srcState.get()}set src(e){this.srcState.set(e)}get autoplay(){return this.autoplayState.get()}set autoplay(e){this.autoplayState.set(e)}get paused(){return this.pausedState.get()}set paused(e){this.pausedState.set(e)}get stopped(){return this.stoppedState.get()}set stopped(e){this.stoppedState.set(e)}get loop(){return this.outerObject3d.loop}set loop(e){this.outerObject3d.loop=e}get volume(){return this.outerObject3d.getVolume()}set volume(e){this.outerObject3d.setVolume(e)}get playbackRate(){return this.outerObject3d.playbackRate}set playbackRate(e){this.outerObject3d.playbackRate=e}get distance(){return this.outerObject3d.getRefDistance()}set distance(e){this.outerObject3d.setRefDistance(e)}get distanceModel(){return this.outerObject3d.getDistanceModel()}set distanceModel(e){this.outerObject3d.setDistanceModel(e)}get maxDistance(){return this.outerObject3d.getMaxDistance()}set maxDistance(e){this.outerObject3d.setMaxDistance(e)}get rolloffFactor(){return this.outerObject3d.getRolloffFactor()}set rolloffFactor(e){this.outerObject3d.setRolloffFactor(e)}}q($_,"componentName","audio"),q($_,"defaults",Hfe),q($_,"schema",jfe);const[Kfe,Zfe]=lo(),Jfe={...rc},Qfe={...oc};class fv extends ia{constructor(){super(new Ys)}}q(fv,"componentName","group"),q(fv,"defaults",Qfe),q(fv,"schema",Jfe);Vt(()=>{const n=Wa();if(!n.length)return;const e=new Ys;St.add(e);const t=new Yp(e);BH.add(t),Fv(t);const i=[];for(const{outerObject3d:s}of n)!s.parent||(i.push([s,s.parent]),e.attach(s));rv.setFromObject(e);for(const[s,a]of i)a.attach(s);e.position.copy(rv.getCenter(Ci));for(const[s]of i)e.attach(s);let r=!1;const o=Zfe(()=>{if(!n.length||r)return;r=!0;const s=new fv;s.outerObject3d.position.copy(e.position);for(const a of n)s.attach(a);Ei(s)});return()=>{if(Ei(),!t.done&&!r)for(const[s,a]of i)a.attach(s);Fv(void 0),t.dispose(),St.remove(e),o.cancel()}},[Wa]);class wh extends mk{constructor(e){super(),q(this,"noEffect"),q(this,"data",{}),this.noEffect=e,!e&&(ape(this.data),this.then(()=>lpe(this.data)))}}q(wh,"componentName","setup"),q(wh,"defaults",hl),q(wh,"schema",t3);for(const n of Object.keys(t3))Object.defineProperty(wh.prototype,n,{get(){return this.data[n]},set(e){this.data[n]=e,!this.noEffect&&tG()}});const $fe={...Ik},eme={...Nk};class ey extends Fk{constructor(){super(new or(75,1,Eg,yl))}}q(ey,"componentName","camera"),q(ey,"defaults",eme),q(ey,"schema",$fe);const[cRe,tme]=lo(),AG={...Ik,lockTargetRotation:[Boolean,String]},LG={...Nk,lockTargetRotation:!0},nme={...AG},ime={...LG,innerZ:300};class rme{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const i=t.slice(0);for(let r=0,o=i.length;r<o;r++)i[r].call(this,e);e.target=null}}}const Jr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function ome(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Jr[n&255]+Jr[n>>8&255]+Jr[n>>16&255]+Jr[n>>24&255]+"-"+Jr[e&255]+Jr[e>>8&255]+"-"+Jr[e>>16&15|64]+Jr[e>>24&255]+"-"+Jr[t&63|128]+Jr[t>>8&255]+"-"+Jr[t>>16&255]+Jr[t>>24&255]+Jr[i&255]+Jr[i>>8&255]+Jr[i>>16&255]+Jr[i>>24&255]).toLowerCase()}function th(n,e,t){return Math.max(e,Math.min(t,n))}class cI{constructor(){cI.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,o,s,a,l,u){const c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=o,c[5]=l,c[6]=i,c[7]=s,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[3],l=i[6],u=i[1],c=i[4],h=i[7],p=i[2],m=i[5],y=i[8],_=r[0],g=r[3],b=r[6],w=r[1],M=r[4],C=r[7],P=r[2],L=r[5],R=r[8];return o[0]=s*_+a*w+l*P,o[3]=s*g+a*M+l*L,o[6]=s*b+a*C+l*R,o[1]=u*_+c*w+h*P,o[4]=u*g+c*M+h*L,o[7]=u*b+c*C+h*R,o[2]=p*_+m*w+y*P,o[5]=p*g+m*M+y*L,o[8]=p*b+m*C+y*R,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t*s*c-t*a*u-i*o*c+i*a*l+r*o*u-r*s*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*s-a*u,p=a*l-c*o,m=u*o-s*l,y=t*h+i*p+r*m;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/y;return e[0]=h*_,e[1]=(r*u-c*i)*_,e[2]=(a*i-r*s)*_,e[3]=p*_,e[4]=(c*t-r*l)*_,e[5]=(r*o-a*t)*_,e[6]=m*_,e[7]=(i*l-u*t)*_,e[8]=(s*t-i*o)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,o,s,a){const l=Math.cos(o),u=Math.sin(o);return this.set(i*l,i*u,-i*(l*s+u*a)+s+e,-r*u,r*l,-r*(-u*s+l*a)+a+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,o=r[0],s=r[3],a=r[6],l=r[1],u=r[4],c=r[7];return r[0]=t*o+i*l,r[3]=t*s+i*u,r[6]=t*a+i*c,r[1]=-i*o+t*l,r[4]=-i*s+t*u,r[7]=-i*a+t*c,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}class mx{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,o,s,a){let l=i[r+0],u=i[r+1],c=i[r+2],h=i[r+3];const p=o[s+0],m=o[s+1],y=o[s+2],_=o[s+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h;return}if(a===1){e[t+0]=p,e[t+1]=m,e[t+2]=y,e[t+3]=_;return}if(h!==_||l!==p||u!==m||c!==y){let g=1-a;const b=l*p+u*m+c*y+h*_,w=b>=0?1:-1,M=1-b*b;if(M>Number.EPSILON){const P=Math.sqrt(M),L=Math.atan2(P,b*w);g=Math.sin(g*L)/P,a=Math.sin(a*L)/P}const C=a*w;if(l=l*g+p*C,u=u*g+m*C,c=c*g+y*C,h=h*g+_*C,g===1-a){const P=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=P,u*=P,c*=P,h*=P}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,o,s){const a=i[r],l=i[r+1],u=i[r+2],c=i[r+3],h=o[s],p=o[s+1],m=o[s+2],y=o[s+3];return e[t]=a*y+c*h+l*m-u*p,e[t+1]=l*y+c*p+u*h-a*m,e[t+2]=u*y+c*m+a*p-l*h,e[t+3]=c*y-a*h-l*p-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,o=e._z,s=e._order,a=Math.cos,l=Math.sin,u=a(i/2),c=a(r/2),h=a(o/2),p=l(i/2),m=l(r/2),y=l(o/2);switch(s){case"XYZ":this._x=p*c*h+u*m*y,this._y=u*m*h-p*c*y,this._z=u*c*y+p*m*h,this._w=u*c*h-p*m*y;break;case"YXZ":this._x=p*c*h+u*m*y,this._y=u*m*h-p*c*y,this._z=u*c*y-p*m*h,this._w=u*c*h+p*m*y;break;case"ZXY":this._x=p*c*h-u*m*y,this._y=u*m*h+p*c*y,this._z=u*c*y+p*m*h,this._w=u*c*h-p*m*y;break;case"ZYX":this._x=p*c*h-u*m*y,this._y=u*m*h+p*c*y,this._z=u*c*y-p*m*h,this._w=u*c*h+p*m*y;break;case"YZX":this._x=p*c*h+u*m*y,this._y=u*m*h+p*c*y,this._z=u*c*y-p*m*h,this._w=u*c*h-p*m*y;break;case"XZY":this._x=p*c*h-u*m*y,this._y=u*m*h-p*c*y,this._z=u*c*y+p*m*h,this._w=u*c*h+p*m*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],o=t[8],s=t[1],a=t[5],l=t[9],u=t[2],c=t[6],h=t[10],p=i+a+h;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(c-l)*m,this._y=(o-u)*m,this._z=(s-r)*m}else if(i>a&&i>h){const m=2*Math.sqrt(1+i-a-h);this._w=(c-l)/m,this._x=.25*m,this._y=(r+s)/m,this._z=(o+u)/m}else if(a>h){const m=2*Math.sqrt(1+a-i-h);this._w=(o-u)/m,this._x=(r+s)/m,this._y=.25*m,this._z=(l+c)/m}else{const m=2*Math.sqrt(1+h-i-a);this._w=(s-r)/m,this._x=(o+u)/m,this._y=(l+c)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(th(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,o=e._z,s=e._w,a=t._x,l=t._y,u=t._z,c=t._w;return this._x=i*c+s*a+r*u-o*l,this._y=r*c+s*l+o*a-i*u,this._z=o*c+s*u+i*l-r*a,this._w=s*c-i*a-r*l-o*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,o=this._z,s=this._w;let a=s*e._w+i*e._x+r*e._y+o*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=i,this._y=r,this._z=o,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*s+t*this._w,this._x=m*i+t*this._x,this._y=m*r+t*this._y,this._z=m*o+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),h=Math.sin((1-t)*c)/u,p=Math.sin(t*c)/u;return this._w=s*h+this._w*p,this._x=i*h+this._x*p,this._y=r*h+this._y*p,this._z=o*h+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(o),i*Math.cos(o),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class lr{constructor(e=0,t=0,i=0){lr.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(HV.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(HV.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*r,this.y=o[1]*t+o[4]*i+o[7]*r,this.z=o[2]*t+o[5]*i+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=e.elements,s=1/(o[3]*t+o[7]*i+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*r+o[12])*s,this.y=(o[1]*t+o[5]*i+o[9]*r+o[13])*s,this.z=(o[2]*t+o[6]*i+o[10]*r+o[14])*s,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,o=e.x,s=e.y,a=e.z,l=e.w,u=l*t+s*r-a*i,c=l*i+a*t-o*r,h=l*r+o*i-s*t,p=-o*t-s*i-a*r;return this.x=u*l+p*-o+c*-a-h*-s,this.y=c*l+p*-s+h*-o-u*-a,this.z=h*l+p*-a+u*-s-c*-o,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r,this.y=o[1]*t+o[5]*i+o[9]*r,this.z=o[2]*t+o[6]*i+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,o=e.z,s=t.x,a=t.y,l=t.z;return this.x=r*l-o*a,this.y=o*s-i*l,this.z=i*a-r*s,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return EA.copy(this).projectOnVector(e),this.sub(EA)}reflect(e){return this.sub(EA.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(th(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const EA=new lr,HV=new mx;class Gu{constructor(){Gu.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,r,o,s,a,l,u,c,h,p,m,y,_,g){const b=this.elements;return b[0]=e,b[4]=t,b[8]=i,b[12]=r,b[1]=o,b[5]=s,b[9]=a,b[13]=l,b[2]=u,b[6]=c,b[10]=h,b[14]=p,b[3]=m,b[7]=y,b[11]=_,b[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Gu().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/sm.setFromMatrixColumn(e,0).length(),o=1/sm.setFromMatrixColumn(e,1).length(),s=1/sm.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,o=e.z,s=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),c=Math.cos(o),h=Math.sin(o);if(e.order==="XYZ"){const p=s*c,m=s*h,y=a*c,_=a*h;t[0]=l*c,t[4]=-l*h,t[8]=u,t[1]=m+y*u,t[5]=p-_*u,t[9]=-a*l,t[2]=_-p*u,t[6]=y+m*u,t[10]=s*l}else if(e.order==="YXZ"){const p=l*c,m=l*h,y=u*c,_=u*h;t[0]=p+_*a,t[4]=y*a-m,t[8]=s*u,t[1]=s*h,t[5]=s*c,t[9]=-a,t[2]=m*a-y,t[6]=_+p*a,t[10]=s*l}else if(e.order==="ZXY"){const p=l*c,m=l*h,y=u*c,_=u*h;t[0]=p-_*a,t[4]=-s*h,t[8]=y+m*a,t[1]=m+y*a,t[5]=s*c,t[9]=_-p*a,t[2]=-s*u,t[6]=a,t[10]=s*l}else if(e.order==="ZYX"){const p=s*c,m=s*h,y=a*c,_=a*h;t[0]=l*c,t[4]=y*u-m,t[8]=p*u+_,t[1]=l*h,t[5]=_*u+p,t[9]=m*u-y,t[2]=-u,t[6]=a*l,t[10]=s*l}else if(e.order==="YZX"){const p=s*l,m=s*u,y=a*l,_=a*u;t[0]=l*c,t[4]=_-p*h,t[8]=y*h+m,t[1]=h,t[5]=s*c,t[9]=-a*c,t[2]=-u*c,t[6]=m*h+y,t[10]=p-_*h}else if(e.order==="XZY"){const p=s*l,m=s*u,y=a*l,_=a*u;t[0]=l*c,t[4]=-h,t[8]=u*c,t[1]=p*h+_,t[5]=s*c,t[9]=m*h-y,t[2]=y*h-m,t[6]=a*c,t[10]=_*h+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(sme,e,ame)}lookAt(e,t,i){const r=this.elements;return us.subVectors(e,t),us.lengthSq()===0&&(us.z=1),us.normalize(),zc.crossVectors(i,us),zc.lengthSq()===0&&(Math.abs(i.z)===1?us.x+=1e-4:us.z+=1e-4,us.normalize(),zc.crossVectors(i,us)),zc.normalize(),Qw.crossVectors(us,zc),r[0]=zc.x,r[4]=Qw.x,r[8]=us.x,r[1]=zc.y,r[5]=Qw.y,r[9]=us.y,r[2]=zc.z,r[6]=Qw.z,r[10]=us.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[4],l=i[8],u=i[12],c=i[1],h=i[5],p=i[9],m=i[13],y=i[2],_=i[6],g=i[10],b=i[14],w=i[3],M=i[7],C=i[11],P=i[15],L=r[0],R=r[4],E=r[8],D=r[12],N=r[1],j=r[5],te=r[9],ee=r[13],H=r[2],Q=r[6],Z=r[10],de=r[14],X=r[3],B=r[7],U=r[11],le=r[15];return o[0]=s*L+a*N+l*H+u*X,o[4]=s*R+a*j+l*Q+u*B,o[8]=s*E+a*te+l*Z+u*U,o[12]=s*D+a*ee+l*de+u*le,o[1]=c*L+h*N+p*H+m*X,o[5]=c*R+h*j+p*Q+m*B,o[9]=c*E+h*te+p*Z+m*U,o[13]=c*D+h*ee+p*de+m*le,o[2]=y*L+_*N+g*H+b*X,o[6]=y*R+_*j+g*Q+b*B,o[10]=y*E+_*te+g*Z+b*U,o[14]=y*D+_*ee+g*de+b*le,o[3]=w*L+M*N+C*H+P*X,o[7]=w*R+M*j+C*Q+P*B,o[11]=w*E+M*te+C*Z+P*U,o[15]=w*D+M*ee+C*de+P*le,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],o=e[12],s=e[1],a=e[5],l=e[9],u=e[13],c=e[2],h=e[6],p=e[10],m=e[14],y=e[3],_=e[7],g=e[11],b=e[15];return y*(+o*l*h-r*u*h-o*a*p+i*u*p+r*a*m-i*l*m)+_*(+t*l*m-t*u*p+o*s*p-r*s*m+r*u*c-o*l*c)+g*(+t*u*h-t*a*m-o*s*h+i*s*m+o*a*c-i*u*c)+b*(-r*a*c-t*l*h+t*a*p+r*s*h-i*s*p+i*l*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],m=e[11],y=e[12],_=e[13],g=e[14],b=e[15],w=h*g*u-_*p*u+_*l*m-a*g*m-h*l*b+a*p*b,M=y*p*u-c*g*u-y*l*m+s*g*m+c*l*b-s*p*b,C=c*_*u-y*h*u+y*a*m-s*_*m-c*a*b+s*h*b,P=y*h*l-c*_*l-y*a*p+s*_*p+c*a*g-s*h*g,L=t*w+i*M+r*C+o*P;if(L===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const R=1/L;return e[0]=w*R,e[1]=(_*p*o-h*g*o-_*r*m+i*g*m+h*r*b-i*p*b)*R,e[2]=(a*g*o-_*l*o+_*r*u-i*g*u-a*r*b+i*l*b)*R,e[3]=(h*l*o-a*p*o-h*r*u+i*p*u+a*r*m-i*l*m)*R,e[4]=M*R,e[5]=(c*g*o-y*p*o+y*r*m-t*g*m-c*r*b+t*p*b)*R,e[6]=(y*l*o-s*g*o-y*r*u+t*g*u+s*r*b-t*l*b)*R,e[7]=(s*p*o-c*l*o+c*r*u-t*p*u-s*r*m+t*l*m)*R,e[8]=C*R,e[9]=(y*h*o-c*_*o-y*i*m+t*_*m+c*i*b-t*h*b)*R,e[10]=(s*_*o-y*a*o+y*i*u-t*_*u-s*i*b+t*a*b)*R,e[11]=(c*a*o-s*h*o-c*i*u+t*h*u+s*i*m-t*a*m)*R,e[12]=P*R,e[13]=(c*_*r-y*h*r+y*i*p-t*_*p-c*i*g+t*h*g)*R,e[14]=(y*a*r-s*_*r-y*i*l+t*_*l+s*i*g-t*a*g)*R,e[15]=(s*h*r-c*a*r+c*i*l-t*h*l-s*i*p+t*a*p)*R,this}scale(e){const t=this.elements,i=e.x,r=e.y,o=e.z;return t[0]*=i,t[4]*=r,t[8]*=o,t[1]*=i,t[5]*=r,t[9]*=o,t[2]*=i,t[6]*=r,t[10]*=o,t[3]*=i,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),o=1-i,s=e.x,a=e.y,l=e.z,u=o*s,c=o*a;return this.set(u*s+i,u*a-r*l,u*l+r*a,0,u*a+r*l,c*a+i,c*l-r*s,0,u*l-r*a,c*l+r*s,o*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,o,s){return this.set(1,i,o,0,e,1,s,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,o=t._x,s=t._y,a=t._z,l=t._w,u=o+o,c=s+s,h=a+a,p=o*u,m=o*c,y=o*h,_=s*c,g=s*h,b=a*h,w=l*u,M=l*c,C=l*h,P=i.x,L=i.y,R=i.z;return r[0]=(1-(_+b))*P,r[1]=(m+C)*P,r[2]=(y-M)*P,r[3]=0,r[4]=(m-C)*L,r[5]=(1-(p+b))*L,r[6]=(g+w)*L,r[7]=0,r[8]=(y+M)*R,r[9]=(g-w)*R,r[10]=(1-(p+_))*R,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let o=sm.set(r[0],r[1],r[2]).length();const s=sm.set(r[4],r[5],r[6]).length(),a=sm.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],Ma.copy(this);const l=1/o,u=1/s,c=1/a;return Ma.elements[0]*=l,Ma.elements[1]*=l,Ma.elements[2]*=l,Ma.elements[4]*=u,Ma.elements[5]*=u,Ma.elements[6]*=u,Ma.elements[8]*=c,Ma.elements[9]*=c,Ma.elements[10]*=c,t.setFromRotationMatrix(Ma),i.x=o,i.y=s,i.z=a,this}makePerspective(e,t,i,r,o,s){const a=this.elements,l=2*o/(t-e),u=2*o/(i-r),c=(t+e)/(t-e),h=(i+r)/(i-r),p=-(s+o)/(s-o),m=-2*s*o/(s-o);return a[0]=l,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=m,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,o,s){const a=this.elements,l=1/(t-e),u=1/(i-r),c=1/(s-o),h=(t+e)*l,p=(i+r)*u,m=(s+o)*c;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-m,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const sm=new lr,Ma=new Gu,sme=new lr(0,0,0),ame=new lr(1,1,1),zc=new lr,Qw=new lr,us=new lr,WV=new Gu,GV=new mx;class vx{constructor(e=0,t=0,i=0,r=vx.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,o=r[0],s=r[4],a=r[8],l=r[1],u=r[5],c=r[9],h=r[2],p=r[6],m=r[10];switch(t){case"XYZ":this._y=Math.asin(th(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,m),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(p,u),this._z=0);break;case"YXZ":this._x=Math.asin(-th(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(th(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-th(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,u));break;case"YZX":this._z=Math.asin(th(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-th(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(p,u),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-c,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return WV.makeRotationFromQuaternion(e),this.setFromRotationMatrix(WV,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return GV.setFromEuler(this),this.setFromQuaternion(GV,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}vx.DefaultOrder="XYZ";vx.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class lme{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let ume=0;const XV=new lr,am=new mx,bu=new Gu,$w=new lr,K0=new lr,cme=new lr,hme=new mx,qV=new lr(1,0,0),YV=new lr(0,1,0),KV=new lr(0,0,1),dme={type:"added"},ZV={type:"removed"};class Zv extends rme{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ume++}),this.uuid=ome(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zv.DefaultUp.clone();const e=new lr,t=new vx,i=new mx,r=new lr(1,1,1);function o(){i.setFromEuler(t,!1)}function s(){t.setFromQuaternion(i,void 0,!1)}t._onChange(o),i._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Gu},normalMatrix:{value:new cI}}),this.matrix=new Gu,this.matrixWorld=new Gu,this.matrixAutoUpdate=Zv.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new lme,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return am.setFromAxisAngle(e,t),this.quaternion.multiply(am),this}rotateOnWorldAxis(e,t){return am.setFromAxisAngle(e,t),this.quaternion.premultiply(am),this}rotateX(e){return this.rotateOnAxis(qV,e)}rotateY(e){return this.rotateOnAxis(YV,e)}rotateZ(e){return this.rotateOnAxis(KV,e)}translateOnAxis(e,t){return XV.copy(e).applyQuaternion(this.quaternion),this.position.add(XV.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(qV,e)}translateY(e){return this.translateOnAxis(YV,e)}translateZ(e){return this.translateOnAxis(KV,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(bu.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?$w.copy(e):$w.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),K0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?bu.lookAt(K0,$w,this.up):bu.lookAt($w,K0,this.up),this.quaternion.setFromRotationMatrix(bu),r&&(bu.extractRotation(r.matrixWorld),am.setFromRotationMatrix(bu),this.quaternion.premultiply(am.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(dme)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(ZV)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(ZV)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),bu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),bu.multiply(e.parent.matrixWorld)),e.applyMatrix4(bu),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(K0,e,cme),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(K0,hme,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let o=0,s=r.length;o<s;o++)r[o].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function o(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];o(e.shapes,h)}else o(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(o(e.materials,this.material[l]));r.material=a}else r.material=o(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(o(e.animations,l))}}if(t){const a=s(e.geometries),l=s(e.materials),u=s(e.textures),c=s(e.images),h=s(e.shapes),p=s(e.skeletons),m=s(e.animations),y=s(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),c.length>0&&(i.images=c),h.length>0&&(i.shapes=h),p.length>0&&(i.skeletons=p),m.length>0&&(i.animations=m),y.length>0&&(i.nodes=y)}return i.object=r,i;function s(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Zv.DefaultUp=new lr(0,1,0);Zv.DefaultMatrixAutoUpdate=!0;const TA=new Zv,DG=n=>{const e=Dn(n.outerObject3d).normalize();return TA.lookAt(e),TA.rotateX(y_),n.outerObject3d.quaternion.copy(TA.quaternion)};class k2 extends Bk{constructor(){super(new or(75,1,Eg,yl)),q(this,"lockTargetRotation",!0);const e=this.midObject3d=new An;this.outerObject3d.add(e),e.add(this.object3d);const t=this.camera;St.attach(t),this.then(()=>St.remove(t));const i=(s,a)=>{ai.setFromQuaternion(s.outerObject3d.quaternion),ai.y+=Math.PI,a?(Jd.setFromEuler(ai),e.quaternion.slerp(Jd,Dp(.1))):e.setRotationFromEuler(ai),this.updateAngle()},r=(s,a,l)=>{if(ai.setFromQuaternion(this.midObject3d.quaternion),ai.x=0,ai.z=0,ai.y+=Math.PI,l){const c=nde(s);Jd.copy(s.outerObject3d.quaternion);const h=c.rotation.y;s.outerObject3d.quaternion.copy(l),c.rotation.y=ai.y,ai.setFromQuaternion(Dh(c)),c.rotation.y=h,s.outerObject3d.quaternion.copy(Jd)}const u=ER.has(s);if(a&&!u){Jd.setFromEuler(ai),s.outerObject3d.quaternion.slerp(Jd,Dp(.1));return}s.outerObject3d.setRotationFromEuler(ai),l&&u&&ER.delete(s)};let o=!1;this.createEffect(()=>{const s=this.targetState.get();if(!s)return;i(s,!1);let[a,l,u]=[0,0,0];const c=()=>{const{x:m,y,z:_}=s.outerObject3d.position,g=m!==a||y!==l||_!==u;return[a,l,u]=[m,y,_],g},h=Rh(),p=Yn(()=>{this.outerObject3d.position.copy(s.outerObject3d.position);const m=h?DG(this):void 0;if(this.lockTargetRotation){if(this.lockTargetRotation==="follow"||o){i(s,!1);return}if(this.lockTargetRotation==="dynamic-lock"){c()&&r(s,!0,m);return}if(this.lockTargetRotation==="dynamic-follow"){c()&&i(s,!0);return}r(s,!1,m)}});return()=>{p.cancel()}},[this.targetState.get,Rh]),this.createEffect(()=>{const s=this.targetState.get(),a=Ti(),l=na(),u=Rp();if(s&&s===a&&l&&u==="rotate")return o=!0,()=>{o=!1}},[this.targetState.get,Ti,na,Rp])}}q(k2,"defaults",LG),q(k2,"schema",AG);const JV=new Set,QV=(n,e)=>{"visible"in n&&(n.visible=e)};let RG=!1;Vt(()=>{RG=ao()||!!ta()&&dt()===di},[ao,ta,dt]);class ty extends k2{constructor(){super(),this.innerZ=300,this.orbitMode=!0;const e=this.camera;ki(()=>import("./bvhCameraLoop.376aa89c.01f8d8bb.js"),["assets/bvhCameraLoop.376aa89c.01f8d8bb.js","assets/useBVHMap.03386216.7cafaa26.js"]).then(()=>{this.createEffect(()=>{const t=this.targetState.get();if(!t){const s=Yn(()=>{e.position.copy(Dn(this.object3d)),e.quaternion.copy(Dh(this.object3d))});return()=>{s.cancel()}}JV.add(e);let i=!0;QV(t,!i);let r=!0;const o=tme(()=>{const s=Dn(this.outerObject3d),a=Dn(this.object3d),l=a.distanceTo(s);e.position.lerp(a,r?1:Dp(.1));const u=r?1:e.position.distanceTo(s)/l;e.position.lerpVectors(s,a,u),e.quaternion.copy(Dh(this.object3d));const c=RG?!1:u<.35;c!==i&&QV(t,!c),i=c,r=!1});return()=>{o.cancel(),JV.delete(e)}},[this.targetState.get])})}}q(ty,"componentName","thirdPersonCamera"),q(ty,"defaults",ime),q(ty,"schema",nme);class hI extends k2{constructor(){super(),q(this,"innerYSetState",new Pt(!1));const e=this.camera;this.watch(Yn(()=>{e.position.copy(Dn(this.object3d)),e.quaternion.copy(Dh(this.object3d))})),this.createEffect(()=>{const t=this.targetState.get(),i=this.innerYSetState.get();if(!(!t||!("height"in t)||i))return super.innerY=t.height*.4,()=>{super.innerY=0}},[this.targetState.get,this.innerYSetState.get])}get innerY(){return super.innerY}set innerY(e){super.innerY=e,this.innerYSetState.set(!0)}}q(hI,"componentName","firstPersonCamera");const pme=()=>{const n=new Wu;return n.texture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAABjVJREFUaEPtWmvLVUUYXWu2VlaGUGGgZUWl3cvILhqlplYWkWVlfsofkHQhyEjRSCK64Q+wT2kkWpGWl7QIpRvZzUKxgi6SRUEX0yz3XvFsZl7G43vOmTnnmEEdEF/Onj3zrFnPZc0zh+jhRxJzpiOpnPGtxmYt3GoiSQXJMsewTt5pNn9PgBgTYXclDQBQAWg2t7HgSO4zo+J3czahcWzXQCSZUZWkWZLuB2CstJvXwBiDj5FcHOY4ZEDCbkoaImkHgCMzjdlNchjJn7tlpt3OtbQrYmOEpM88kGRGABiQs0h+1S0rvQIyXNI2D8Tcpt28YYwBGUny238LkBM9kEEWvxlA9ngg3/wPxDt/OxdoFyN12pVkjGzt0LXOJPn1oWakLoIeyBcABma61l6Sp5D87pAB8XLEakhZluUCkg/5GlIkpmDLbrYRD5B81Kq8FdJOZUtHrhXn/AhEov19w/qSgqQFRVHM66bSdwqkruZlWT5J8u5IkuTOZ2BqySLpqaIo7unUxXIXNm00wHSSpHslPQ7gLwCmr7Ln8twYENNdA0neR/KJsEYOxVmLB7UqabSk9yNDsubpx8A+NyN5EcnNuco4y4AQG1VVbQQw1u+ksdGLj7Fic21yzo3L1V7JQCI2Jklam5mhUoGGTDaZ5LocVrKBlGW5lOTtPWYjAK1ZkfRcURQzeg4kkuuDJW0HMDSx8KUyEcaFWPme5Okkf0t1sSRGIrl+vqQPc63rZDzJC0h+lJqOU4EEKXKNpFcPUnwEvCFOriW5OtW9UoGE2nGHpGf/ISAzSS5JrSn/OSDBtSZIWu8lievE9xPesQ6MSaCJJDf02rVCp2SYPwkedZCz1u/+5Lijp8Eeq9Kqqt4FcPFBipM60AG855wbk5p6zb6kGPFAQsDPlTTfi0U7SPXyYwLUxOM8kgtSAz0XSHCvk/yxNrXRkAo0FENrSIzKPf4mMxKzUpblIyTn9JiVmg1JC4uieDCHjSxG4jiRdJikjwGM7BGYGgSAbSTPI/lnTnx0AsRSrnWsrXNyoSQLfJPewZBUN4rHhXf3kRxD8gPfD7AOjaXipE+ya0V6y2LjWN8dHCtpHQD7Lvek2HcyBGBxMYnkJknDAfxEck9q6k1mJJ6wqqqVAM4hOYHkl5JGSVpm3/mtMyluGxT+xTsazuj2fziQbSE5neRWSadK2gBgi3Pueu/OdZJpR0tbRhpArABwk1/gmaIoZvm/LffPkXQXgOPaLeqf/0hyEYCF4YKoLMvFJO/0z19wzk1LBdMSSDMQANaTnEpyryTL++ZW1pg4BsB0SVMBnAvgBABHeMP+ALATwCckVwFYRvJX/149h6TDJdmziblgmgJpAeIN71YW8EGDjQAwjqQp4/pjAC2WABztv9rlfb8G7cfMBLDRXyuEuSyTmHtdlQOmXyBx6quqajmAmmIA+4GwOLDWUFmW80nOBbCZpJ0jfmjlXpKGSnoFgHVj6uacv7KzjGgt2EYwK5xzN3vwfdd88RoHAGkA8TKAOugaQQS/9jXlUwCn2e46566ImLrUzt/2sp3zSb4dnlVVtQnA5QA+J3m21Q5vaDNmVjrnbmgGpiUjkoKu2uCcq/02MjJoL4uJ572xt5Bcbr7u4+dqn54NiKXX16Jnt0UgbyW5LGr+9d0QV1VlxwbLkEF/pTHSiFiS+fEqf8/Xt0CIoaqq1gCYDGA7SUvLVpUDyPHe3w2IGfN69GyQv647GcBa59yUOC6jDRsCwBJLHX/NKn5y1mpYJAhIa0Zs9gehuSQfbvD1/oBYqg6xFTSbdeFHNzYb+luzWeyl1JED2v1hV8uyfJrkbAC7vJ/XFzbeUAvaZkAsqO1K+wyv2SztLiqKYnajWIyvL1olkLZAGl+OpIqdFrcAsKvpJUVRzIzcIQRsv0B8ZqrHVFX1IoAbAfziNyP5VNgya7VC3RDsl0l6CcDxJK8k+WYnQCRd54vgTpLTSL6Vo7GCvdmMxAEnaTCA8QBWh/TZALa/rLXfb1Yk2Y8MpgBYQ3J3rnzvCkir7NEA5BJJS31qnkHynVZdkU5B1PO3c6U2Fdrer+8R+xsXAtU/a3o/2O39YddAutmEXr/bFSMpxoQfo3V6W5uyho35G4LD428xBkRwAAAAAElFTkSuQmCC",Ii.delete(n),n.scale=.5,n};class gx extends ia{constructor(e,t){const i=new Ys;super(i),q(this,"lightState",new Pt(void 0)),q(this,"defaultShadowResolution",256),q(this,"defaultShadowBias",wk),q(this,"shadowResolutionComputedState",new Pt(void 0)),q(this,"shadowBiasComputedState",new Pt(void 0)),q(this,"helperState",new Pt(!0)),q(this,"castShadowState",new Pt(!0)),q(this,"shadowResolutionState",new Pt(void 0)),q(this,"shadowBiasState",new Pt(void 0)),this.createEffect(()=>{var r,o,s,a;const l=new e;if(this.lightState.set(l),i.add(l),l.shadow&&this.castShadowState.get()){const u=(o=(r=this.shadowResolutionState.get())!=null?r:HR())!=null?o:this.defaultShadowResolution,c=(a=(s=this.shadowBiasState.get())!=null?s:UR())!=null?a:this.defaultShadowBias;this.shadowBiasComputedState.set(c),this.shadowResolutionComputedState.set(u),l.castShadow=!0,l.shadow.bias=c,l.shadow.mapSize.width=u,l.shadow.mapSize.height=u}return()=>{i.remove(l),l.dispose()}},[this.castShadowState.get,this.shadowResolutionState.get,this.shadowBiasState.get,HR,UR]),this.createEffect(()=>{const r=this.lightState.get();if(dt()!==di||!this.helperState.get()||!r)return;const o=new Cn,s=pme();if(o.watch(Hh(({target:a})=>{a===s&&Ei(this)})),t){const a=new t(r);St.add(a),a.add(s.outerObject3d),"update"in a&&o.watch(Yn(()=>a.update())),o.then(()=>{a.dispose(),St.remove(a)})}else this.outerObject3d.add(s.outerObject3d);return()=>{s.dispose(),o.cancel()}},[dt,this.helperState.get,this.lightState.get])}get helper(){return this.helperState.get()}set helper(e){this.helperState.set(e)}get castShadow(){return this.castShadowState.get()}set castShadow(e){this.castShadowState.set(e)}get shadowResolution(){return this.shadowResolutionState.get()}set shadowResolution(e){this.shadowResolutionState.set(e)}get shadowBias(){return this.shadowBiasState.get()}set shadowBias(e){this.shadowBiasState.set(e)}get color(){const e=this.lightState.get();return e?"#"+e.color.getHexString():"#ffffff"}set color(e){this.cancelHandle("color",()=>this.lightState.get(t=>t&&(t.color=new vt(e))))}get intensity(){const e=this.lightState.get();return e?e.intensity:1}set intensity(e){this.cancelHandle("intensity",()=>this.lightState.get(t=>t&&(t.intensity=e)))}}const _x={...rc,color:String,intensity:Number,shadowResolution:Number,shadowBias:Number,helper:Boolean},yx={...oc,color:"#ffffff",intensity:1,shadowResolution:new ci(256),shadowBias:new ci(wk),helper:!0},OG={..._x},kG={...yx},fme={...OG},mme={...kG,castShadow:!1};class ny extends gx{constructor(){super(Kue)}get castShadow(){return!1}set castShadow(e){}}q(ny,"componentName","ambientLight"),q(ny,"defaults",mme),q(ny,"schema",fme);class vme extends XO{constructor(e,t){const i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],r=new ei;r.setAttribute("position",new Zt(i,3)),r.computeBoundingSphere();const o=new Gp({fog:!1});super(r,o),this.light=e,this.color=t,this.type="RectAreaLightHelper";const s=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],a=new ei;a.setAttribute("position",new Zt(s,3)),a.computeBoundingSphere(),this.add(new Fr(a,new yg({side:Zo,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const gme={..._x},_me={...yx,depth:0,scaleZ:0,castShadow:!1},yme=Up(async()=>{const{RectAreaLightUniformsLib:n}=await ki(()=>import("./RectAreaLightUniformsLib.8222929b.2b877f92.js"),[]);n.init()});class iy extends ia{constructor(){super(),q(this,"light"),q(this,"shadowResolution"),q(this,"shadowBias"),q(this,"helperState",new Pt(!0)),q(this,"_color"),q(this,"_intensity"),q(this,"_width"),q(this,"_height"),q(this,"_scaleX"),q(this,"_scaleY"),yme().then(()=>{if(this.done)return;const e=this.light=new Zue(this._color,this._intensity,this.width*this.scaleX*rn,this.height*this.scaleY*rn);this.object3d.add(e),this.then(()=>e.dispose()),this.createEffect(()=>{if(Rp()!=="scale"||Ti()!==this)return;const t=jW(()=>{const{x:i,y:r}=this.outerObject3d.scale;this.scaleX=i,this.scaleY=r});return()=>{t.cancel()}},[Rp,Ti]),this.createEffect(()=>{if(dt()!==di||!this.helperState.get())return;const t=new vme(e);return St.add(t),()=>{t.dispose(),St.remove(t)}},[dt,this.helperState.get])})}get castShadow(){return!1}set castShadow(e){}get helper(){return this.helperState.get()}set helper(e){this.helperState.set(e)}get color(){var e;return(e=this._color)!=null?e:"#ffffff"}set color(e){this._color=e,this.light&&(this.light.color=new vt(e))}get intensity(){var e;return(e=this._intensity)!=null?e:1}set intensity(e){this._intensity=e,this.light&&(this.light.intensity=e)}get width(){var e;return(e=this._width)!=null?e:100}set width(e){this._width=e,this.light&&(this.light.width=e*this.scaleX*rn)}get height(){var e;return(e=this._height)!=null?e:100}set height(e){this._height=e,this.light&&(this.light.height=e*this.scaleY*rn)}get scaleX(){var e;return(e=this._scaleX)!=null?e:1}set scaleX(e){this._scaleX=e,this.light&&(this.light.width=e*this.width*rn)}get scaleY(){var e;return(e=this._scaleY)!=null?e:1}set scaleY(e){this._scaleY=e,this.light&&(this.light.height=e*this.height*rn)}get depth(){return 0}set depth(e){}get scaleZ(){return 0}set scaleZ(e){}}q(iy,"componentName","areaLight"),q(iy,"defaults",_me),q(iy,"schema",gme);var IG={},jl={};Object.defineProperty(jl,"__esModule",{value:!0});jl.BladeApi=void 0;var xme=function(){function n(e){this.controller_=e}return Object.defineProperty(n.prototype,"element",{get:function(){return this.controller_.view.element},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"disabled",{get:function(){return this.controller_.viewProps.get("disabled")},set:function(e){this.controller_.viewProps.set("disabled",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hidden",{get:function(){return this.controller_.viewProps.get("hidden")},set:function(e){this.controller_.viewProps.set("hidden",e)},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this.controller_.viewProps.set("disposed",!0)},n}();jl.BladeApi=xme;var NG={};Object.defineProperty(NG,"__esModule",{value:!0});var zG={};Object.defineProperty(zG,"__esModule",{value:!0});var wr={},i3=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(wr,"__esModule",{value:!0});wr.TpTabSelectEvent=wr.TpFoldEvent=wr.TpUpdateEvent=wr.TpChangeEvent=wr.TpEvent=void 0;var xx=function(){function n(e){this.target=e}return n}();wr.TpEvent=xx;var bme=function(n){i3(e,n);function e(t,i,r,o){var s=n.call(this,t)||this;return s.value=i,s.presetKey=r,s.last=o!=null?o:!0,s}return e}(xx);wr.TpChangeEvent=bme;var wme=function(n){i3(e,n);function e(t,i,r){var o=n.call(this,t)||this;return o.value=i,o.presetKey=r,o}return e}(xx);wr.TpUpdateEvent=wme;var Sme=function(n){i3(e,n);function e(t,i){var r=n.call(this,t)||this;return r.expanded=i,r}return e}(xx);wr.TpFoldEvent=Sme;var Mme=function(n){i3(e,n);function e(t,i){var r=n.call(this,t)||this;return r.index=i,r}return e}(xx);wr.TpTabSelectEvent=Mme;var bx={},es={},Jt={};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.deepEqualsArray=Jt.isEmpty=Jt.forceCast=void 0;function Cme(n){return n}Jt.forceCast=Cme;function Eme(n){return n==null}Jt.isEmpty=Eme;function Tme(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}Jt.deepEqualsArray=Tme;Object.defineProperty(es,"__esModule",{value:!0});es.TpError=void 0;var Pme=Jt,Ame={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(n){return"Invalid parameters for '"+n.name+"'"},nomatchingcontroller:function(n){return"No matching controller for '"+n.key+"'"},nomatchingview:function(n){return"No matching view for '"+JSON.stringify(n.params)+"'"},notbindable:function(){return"Value is not bindable"},propertynotfound:function(n){return"Property '"+n.name+"' not found"},shouldneverhappen:function(){return"This error should never happen"}},Lme=function(){function n(e){var t;this.message=(t=Ame[e.type]((0,Pme.forceCast)(e.context)))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}return n.alreadyDisposed=function(){return new n({type:"alreadydisposed"})},n.notBindable=function(){return new n({type:"notbindable"})},n.propertyNotFound=function(e){return new n({type:"propertynotfound",context:{name:e}})},n.shouldNeverHappen=function(){return new n({type:"shouldneverhappen"})},n}();es.TpError=Lme;Object.defineProperty(bx,"__esModule",{value:!0});bx.BindingTarget=void 0;var $V=es,Dme=function(){function n(e,t,i){this.obj_=e,this.key_=t,this.presetKey_=i!=null?i:t}return n.isBindable=function(e){return!(e===null||typeof e!="object")},Object.defineProperty(n.prototype,"key",{get:function(){return this.key_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"presetKey",{get:function(){return this.presetKey_},enumerable:!1,configurable:!0}),n.prototype.read=function(){return this.obj_[this.key_]},n.prototype.write=function(e){this.obj_[this.key_]=e},n.prototype.writeProperty=function(e,t){var i=this.read();if(!n.isBindable(i))throw $V.TpError.notBindable();if(!(e in i))throw $V.TpError.propertyNotFound(e);i[e]=t},n}();bx.BindingTarget=Dme;var wx={},Rme=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(wx,"__esModule",{value:!0});wx.ButtonApi=void 0;var Ome=jl,kme=wr,Ime=function(n){Rme(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){var t;return(t=this.controller_.valueController.props.get("title"))!==null&&t!==void 0?t:""},set:function(t){this.controller_.valueController.props.set("title",t)},enumerable:!1,configurable:!0}),e.prototype.on=function(t,i){var r=this,o=i.bind(this),s=this.controller_.valueController.emitter;return s.on(t,function(){o(new kme.TpEvent(r))}),this},e}(Ome.BladeApi);wx.ButtonApi=Ime;var Sx={},zi={};Object.defineProperty(zi,"__esModule",{value:!0});zi.Emitter=void 0;var Nme=function(){function n(){this.observers_={}}return n.prototype.on=function(e,t){var i=this.observers_[e];return i||(i=this.observers_[e]=[]),i.push({handler:t}),this},n.prototype.off=function(e,t){var i=this.observers_[e];return i&&(this.observers_[e]=i.filter(function(r){return r.handler!==t})),this},n.prototype.emit=function(e,t){var i=this.observers_[e];!i||i.forEach(function(r){r.handler(t)})},n}();zi.Emitter=Nme;var Mx={},pn={};Object.defineProperty(pn,"__esModule",{value:!0});pn.ClassName=void 0;var zme="tp";function Vme(n){var e=function(t,i){return[zme,"-",n,"v",t?"_"+t:"",i?"-"+i:""].join("")};return e}pn.ClassName=Vme;var $o={},ur={};Object.defineProperty(ur,"__esModule",{value:!0});ur.bindValueMap=ur.bindValue=void 0;function Fme(n,e){return function(t){return e(n(t))}}function Bme(n){return n.rawValue}function VG(n,e){n.emitter.on("change",Fme(Bme,e)),e(n.rawValue)}ur.bindValue=VG;function Ume(n,e,t){VG(n.value(e),t)}ur.bindValueMap=Ume;Object.defineProperty($o,"__esModule",{value:!0});$o.bindValueToTextContent=$o.valueToClassName=void 0;var jme=ur;function Hme(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function Wme(n,e){return function(t){Hme(n,e,t)}}$o.valueToClassName=Wme;function Gme(n,e){(0,jme.bindValue)(n,function(t){e.textContent=t!=null?t:""})}$o.bindValueToTextContent=Gme;Object.defineProperty(Mx,"__esModule",{value:!0});Mx.ButtonView=void 0;var Xme=pn,qme=$o,PA=(0,Xme.ClassName)("btn"),Yme=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(PA()),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("button");i.classList.add(PA("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;var r=e.createElement("div");r.classList.add(PA("t")),(0,qme.bindValueToTextContent)(t.props.value("title"),r),this.buttonElement.appendChild(r)}return n}();Mx.ButtonView=Yme;Object.defineProperty(Sx,"__esModule",{value:!0});Sx.ButtonController=void 0;var Kme=zi,Zme=Mx,Jme=function(){function n(e,t){this.emitter=new Kme.Emitter,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new Zme.ButtonView(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return n.prototype.onClick_=function(){this.emitter.emit("click",{sender:this})},n}();Sx.ButtonController=Jme;var Cx={},mi={},Oo={},r3={};Object.defineProperty(r3,"__esModule",{value:!0});r3.BoundValue=void 0;var Qme=zi,$me=function(){function n(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:function(r,o){return r===o},this.emitter=new Qme.Emitter,this.rawValue_=e}return Object.defineProperty(n.prototype,"constraint",{get:function(){return this.constraint_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rawValue",{get:function(){return this.rawValue_},set:function(e){this.setRawValue(e,{forceEmit:!1,last:!0})},enumerable:!1,configurable:!0}),n.prototype.setRawValue=function(e,t){var i=t!=null?t:{forceEmit:!1,last:!0},r=this.constraint_?this.constraint_.constrain(e):e,o=!this.equals_(this.rawValue_,r);!o&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=r,this.emitter.emit("change",{options:i,rawValue:r,sender:this}))},n}();r3.BoundValue=$me;var o3={};Object.defineProperty(o3,"__esModule",{value:!0});o3.PrimitiveValue=void 0;var eve=zi,tve=function(){function n(e){this.emitter=new eve.Emitter,this.value_=e}return Object.defineProperty(n.prototype,"rawValue",{get:function(){return this.value_},set:function(e){this.setRawValue(e,{forceEmit:!1,last:!0})},enumerable:!1,configurable:!0}),n.prototype.setRawValue=function(e,t){var i=t!=null?t:{forceEmit:!1,last:!0};this.value_===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,rawValue:this.value_,sender:this}))},n}();o3.PrimitiveValue=tve;Object.defineProperty(Oo,"__esModule",{value:!0});Oo.createValue=void 0;var nve=r3,ive=o3;function rve(n,e){var t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new ive.PrimitiveValue(n):new nve.BoundValue(n,e)}Oo.createValue=rve;Object.defineProperty(mi,"__esModule",{value:!0});mi.ValueMap=void 0;var ove=zi,sve=Oo,ave=function(){function n(e){var t=this;this.emitter=new ove.Emitter,this.valMap_=e;var i=function(s){var a=r.valMap_[s];a.emitter.on("change",function(){t.emitter.emit("change",{key:s,sender:t})})},r=this;for(var o in this.valMap_)i(o)}return n.createCore=function(e){var t=Object.keys(e);return t.reduce(function(i,r){var o;return Object.assign(i,(o={},o[r]=(0,sve.createValue)(e[r]),o))},{})},n.fromObject=function(e){var t=this.createCore(e);return new n(t)},n.prototype.get=function(e){return this.valMap_[e].rawValue},n.prototype.set=function(e,t){this.valMap_[e].rawValue=t},n.prototype.value=function(e){return this.valMap_[e]},n}();mi.ValueMap=ave;var Yi={};(function(n){var e=it&&it.__assign||function(){return e=Object.assign||function(c){for(var h,p=1,m=arguments.length;p<m;p++){h=arguments[p];for(var y in h)Object.prototype.hasOwnProperty.call(h,y)&&(c[y]=h[y])}return c},e.apply(this,arguments)},t=it&&it.__spreadArray||function(c,h,p){if(p||arguments.length===2)for(var m=0,y=h.length,_;m<y;m++)(_||!(m in h))&&(_||(_=Array.prototype.slice.call(h,0,m)),_[m]=h[m]);return c.concat(_||Array.prototype.slice.call(h))};Object.defineProperty(n,"__esModule",{value:!0}),n.parseParams=n.ParamsParsers=void 0;var i=Jt;function r(c,h){var p=Object.keys(h),m=p.reduce(function(y,_){var g;if(y!==void 0){var b=h[_],w=b(c[_]);return w.succeeded?e(e({},y),(g={},g[_]=w.value,g)):void 0}},{});return(0,i.forceCast)(m)}function o(c,h){return c.reduce(function(p,m){if(p!==void 0){var y=h(m);if(!(!y.succeeded||y.value===void 0))return t(t([],p,!0),[y.value],!1)}},[])}function s(c){return c===null?!1:typeof c=="object"}function a(c){return function(h){return function(p){if(!h&&p===void 0)return{succeeded:!1,value:void 0};if(h&&p===void 0)return{succeeded:!0,value:void 0};var m=c(p);return m!==void 0?{succeeded:!0,value:m}:{succeeded:!1,value:void 0}}}}function l(c){return{custom:function(h){return a(h)(c)},boolean:a(function(h){return typeof h=="boolean"?h:void 0})(c),number:a(function(h){return typeof h=="number"?h:void 0})(c),string:a(function(h){return typeof h=="string"?h:void 0})(c),function:a(function(h){return typeof h=="function"?h:void 0})(c),constant:function(h){return a(function(p){return p===h?h:void 0})(c)},raw:a(function(h){return h})(c),object:function(h){return a(function(p){if(s(p))return r(p,h)})(c)},array:function(h){return a(function(p){if(Array.isArray(p))return o(p,h)})(c)}}}n.ParamsParsers={optional:l(!0),required:l(!1)};function u(c,h){var p=n.ParamsParsers.required.object(h)(c);return p.succeeded?p.value:void 0}n.parseParams=u})(Yi);var Kp={},sc={},s3={};Object.defineProperty(s3,"__esModule",{value:!0});s3.disposeElement=void 0;function lve(n){return n&&n.parentElement&&n.parentElement.removeChild(n),null}s3.disposeElement=lve;var Ex={};Object.defineProperty(Ex,"__esModule",{value:!0});Ex.getAllBladePositions=void 0;function uve(){return["veryfirst","first","last","verylast"]}Ex.getAllBladePositions=uve;Object.defineProperty(sc,"__esModule",{value:!0});sc.BladeController=void 0;var cve=s3,hve=pn,dve=Ex,eF=(0,hve.ClassName)(""),tF={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"},pve=function(){function n(e){var t=this;this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;var i=this.view.element;this.blade.value("positions").emitter.on("change",function(){(0,dve.getAllBladePositions)().forEach(function(r){i.classList.remove(eF(void 0,tF[r]))}),t.blade.get("positions").forEach(function(r){i.classList.add(eF(void 0,tF[r]))})}),this.viewProps.handleDispose(function(){(0,cve.disposeElement)(i)})}return Object.defineProperty(n.prototype,"parent",{get:function(){return this.parent_},enumerable:!1,configurable:!0}),n}();sc.BladeController=pve;var Lg={},Wr={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.findNextTarget=n.indexOfChildElement=n.removeChildNodes=n.removeChildElements=n.removeElement=n.insertElementAt=n.createSvgIconElement=n.getCanvasContext=n.getWindowDocument=n.supportsTouch=n.disableTransitionTemporarily=n.forceReflow=n.SVG_NS=void 0;var e=Jt;n.SVG_NS="http://www.w3.org/2000/svg";function t(g){g.offsetHeight}n.forceReflow=t;function i(g,b){var w=g.style.transition;g.style.transition="none",b(),g.style.transition=w}n.disableTransitionTemporarily=i;function r(g){return g.ontouchstart!==void 0}n.supportsTouch=r;function o(){return new Function("return this")()}function s(){var g=(0,e.forceCast)(o());return g.document}n.getWindowDocument=s;function a(g){var b=g.ownerDocument.defaultView;if(!b)return null;var w="document"in b;return w?g.getContext("2d"):null}n.getCanvasContext=a;var l={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function u(g,b){var w=g.createElementNS(n.SVG_NS,"svg");return w.innerHTML=l[b],w}n.createSvgIconElement=u;function c(g,b,w){g.insertBefore(b,g.children[w])}n.insertElementAt=c;function h(g){g.parentElement&&g.parentElement.removeChild(g)}n.removeElement=h;function p(g){for(;g.children.length>0;)g.removeChild(g.children[0])}n.removeChildElements=p;function m(g){for(;g.childNodes.length>0;)g.removeChild(g.childNodes[0])}n.removeChildNodes=m;function y(g){var b=g.parentElement;if(!b)return-1;var w=Array.prototype.slice.call(b.children);return w.indexOf(g)}n.indexOfChildElement=y;function _(g){return g.relatedTarget?(0,e.forceCast)(g.relatedTarget):"explicitOriginalTarget"in g?g.explicitOriginalTarget:null}n.findNextTarget=_})(Wr);Object.defineProperty(Lg,"__esModule",{value:!0});Lg.LabelView=void 0;var fve=Wr,mve=ur,vve=pn,gve=Jt,Z0=(0,vve.ClassName)("lbl");function _ve(n,e){var t=n.createDocumentFragment(),i=e.split(`
`).map(function(r){return n.createTextNode(r)});return i.forEach(function(r,o){o>0&&t.appendChild(n.createElement("br")),t.appendChild(r)}),t}var yve=function(){function n(e,t){var i=this;this.element=e.createElement("div"),this.element.classList.add(Z0()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(Z0("l")),(0,mve.bindValueMap)(t.props,"label",function(s){(0,gve.isEmpty)(s)?i.element.classList.add(Z0(void 0,"nol")):(i.element.classList.remove(Z0(void 0,"nol")),(0,fve.removeChildNodes)(r),r.appendChild(_ve(e,s)))}),this.element.appendChild(r),this.labelElement=r;var o=e.createElement("div");o.classList.add(Z0("v")),this.element.appendChild(o),this.valueElement=o}return n}();Lg.LabelView=yve;var xve=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),I2=it&&it.__assign||function(){return I2=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},I2.apply(this,arguments)};Object.defineProperty(Kp,"__esModule",{value:!0});Kp.LabelController=void 0;var bve=sc,wve=Lg,Sve=function(n){xve(e,n);function e(t,i){var r=this,o=i.valueController.viewProps;return r=n.call(this,I2(I2({},i),{view:new wve.LabelView(t,{props:i.props,viewProps:o}),viewProps:o}))||this,r.props=i.props,r.valueController=i.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return e}(bve.BladeController);Kp.LabelController=Sve;Object.defineProperty(Cx,"__esModule",{value:!0});Cx.ButtonBladePlugin=void 0;var nF=mi,iF=Yi,rF=Kp,Mve=wx,oF=Sx;Cx.ButtonBladePlugin={id:"button",type:"blade",accept:function(n){var e=iF.ParamsParsers,t=(0,iF.parseParams)(n,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return t?{params:t}:null},controller:function(n){return new rF.LabelController(n.document,{blade:n.blade,props:nF.ValueMap.fromObject({label:n.params.label}),valueController:new oF.ButtonController(n.document,{props:nF.ValueMap.fromObject({title:n.params.title}),viewProps:n.viewProps})})},api:function(n){return!(n.controller instanceof rF.LabelController)||!(n.controller.valueController instanceof oF.ButtonController)?null:new Mve.ButtonApi(n.controller)}};var Zp={},Cve=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Zp,"__esModule",{value:!0});Zp.ValueBladeController=void 0;var Eve=sc,Tve=function(n){Cve(e,n);function e(t){var i=n.call(this,t)||this;return i.value=t.value,i}return e}(Eve.BladeController);Zp.ValueBladeController=Tve;var Wh={};Object.defineProperty(Wh,"__esModule",{value:!0});Wh.createBlade=void 0;var Pve=mi,Ave=Oo,Lve=Jt;function Dve(){return new Pve.ValueMap({positions:(0,Ave.createValue)([],{equals:Lve.deepEqualsArray})})}Wh.createBlade=Dve;var wo={},Rve=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(wo,"__esModule",{value:!0});wo.bindFoldable=wo.getFoldableStyleHeight=wo.getFoldableStyleExpanded=wo.createFoldable=wo.Foldable=void 0;var EM=Wr,sF=ur,aF=mi,FG=Jt,BG=function(n){Rve(e,n);function e(t){return n.call(this,t)||this}return e.create=function(t){var i={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},r=aF.ValueMap.createCore(i);return new e(r)},Object.defineProperty(e.prototype,"styleExpanded",{get:function(){var t;return(t=this.get("temporaryExpanded"))!==null&&t!==void 0?t:this.get("expanded")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"styleHeight",{get:function(){if(!this.styleExpanded)return"0";var t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!(0,FG.isEmpty)(t)?t+"px":"auto"},enumerable:!1,configurable:!0}),e.prototype.bindExpandedClass=function(t,i){var r=this,o=function(){var s=r.styleExpanded;s?t.classList.add(i):t.classList.remove(i)};(0,sF.bindValueMap)(this,"expanded",o),(0,sF.bindValueMap)(this,"temporaryExpanded",o)},e.prototype.cleanUpTransition=function(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)},e}(aF.ValueMap);wo.Foldable=BG;function Ove(n){return BG.create(n)}wo.createFoldable=Ove;function kve(n,e){var t=0;return(0,EM.disableTransitionTemporarily)(e,function(){n.set("expandedHeight",null),n.set("temporaryExpanded",!0),(0,EM.forceReflow)(e),t=e.clientHeight,n.set("temporaryExpanded",null),(0,EM.forceReflow)(e)}),t}function Ive(n){return n.styleExpanded}wo.getFoldableStyleExpanded=Ive;function Nve(n){return n.styleHeight}wo.getFoldableStyleHeight=Nve;function lF(n,e){e.style.height=n.styleHeight}function zve(n,e){n.value("expanded").emitter.on("beforechange",function(){n.set("completed",!1),(0,FG.isEmpty)(n.get("expandedHeight"))&&n.set("expandedHeight",kve(n,e)),n.set("shouldFixHeight",!0),(0,EM.forceReflow)(e)}),n.emitter.on("change",function(){lF(n,e)}),lF(n,e),e.addEventListener("transitionend",function(t){t.propertyName==="height"&&n.cleanUpTransition()})}wo.bindFoldable=zve;var Tx={},Dg={},Vve=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Dg,"__esModule",{value:!0});Dg.RackLikeApi=void 0;var Fve=jl,Bve=function(n){Vve(e,n);function e(t,i){var r=n.call(this,t)||this;return r.rackApi_=i,r}return e}(Fve.BladeApi);Dg.RackLikeApi=Bve;var kh={},xl={},Ol=it&&it.__assign||function(){return Ol=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ol.apply(this,arguments)};Object.defineProperty(xl,"__esModule",{value:!0});xl.addTabAsBlade=xl.addSeparatorAsBlade=xl.addFolderAsBlade=xl.addButtonAsBlade=void 0;function Uve(n,e){return n.addBlade(Ol(Ol({},e),{view:"button"}))}xl.addButtonAsBlade=Uve;function jve(n,e){return n.addBlade(Ol(Ol({},e),{view:"folder"}))}xl.addFolderAsBlade=jve;function Hve(n,e){var t=e!=null?e:{};return n.addBlade(Ol(Ol({},t),{view:"separator"}))}xl.addSeparatorAsBlade=Hve;function Wve(n,e){return n.addBlade(Ol(Ol({},e),{view:"tab"}))}xl.addTabAsBlade=Wve;var Rg={};Object.defineProperty(Rg,"__esModule",{value:!0});Rg.NestedOrderedSet=void 0;var Gve=zi,Xve=es,qve=function(){function n(e){this.emitter=new Gve.Emitter,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}return Object.defineProperty(n.prototype,"items",{get:function(){return this.items_},enumerable:!1,configurable:!0}),n.prototype.allItems=function(){return Array.from(this.cache_)},n.prototype.find=function(e){for(var t=0,i=this.allItems();t<i.length;t++){var r=i[t];if(e(r))return r}return null},n.prototype.includes=function(e){return this.cache_.has(e)},n.prototype.add=function(e,t){var i=this;if(this.includes(e))throw Xve.TpError.shouldNeverHappen();var r=t!==void 0?t:this.items_.length;this.items_.splice(r,0,e),this.cache_.add(e);var o=this.extract_(e);o&&(o.emitter.on("add",this.onSubListAdd_),o.emitter.on("remove",this.onSubListRemove_),o.allItems().forEach(function(s){i.cache_.add(s)})),this.emitter.emit("add",{index:r,item:e,root:this,target:this})},n.prototype.remove=function(e){var t=this.items_.indexOf(e);if(!(t<0)){this.items_.splice(t,1),this.cache_.delete(e);var i=this.extract_(e);i&&(i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}},n.prototype.onSubListAdd_=function(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})},n.prototype.onSubListRemove_=function(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})},n}();Rg.NestedOrderedSet=qve;var Og={},Yve=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Og,"__esModule",{value:!0});Og.InputBindingApi=void 0;var Kve=zi,Zve=Jt,Jve=jl,Qve=wr,$ve=function(n){Yve(e,n);function e(t){var i=n.call(this,t)||this;return i.onBindingChange_=i.onBindingChange_.bind(i),i.emitter_=new Kve.Emitter,i.controller_.binding.emitter.on("change",i.onBindingChange_),i}return Object.defineProperty(e.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)},enumerable:!1,configurable:!0}),e.prototype.on=function(t,i){var r=i.bind(this);return this.emitter_.on(t,function(o){r(o.event)}),this},e.prototype.refresh=function(){this.controller_.binding.read()},e.prototype.onBindingChange_=function(t){var i=t.sender.target.read();this.emitter_.emit("change",{event:new Qve.TpChangeEvent(this,(0,Zve.forceCast)(i),this.controller_.binding.target.presetKey,t.options.last)})},e}(Jve.BladeApi);Og.InputBindingApi=$ve;var Gh={},ege=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Gh,"__esModule",{value:!0});Gh.InputBindingController=void 0;var tge=Kp,nge=function(n){ege(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.binding=i.binding,r}return e}(tge.LabelController);Gh.InputBindingController=nge;var kg={},ige=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(kg,"__esModule",{value:!0});kg.MonitorBindingApi=void 0;var rge=zi,oge=Jt,sge=jl,age=wr,lge=function(n){ige(e,n);function e(t){var i=n.call(this,t)||this;return i.onBindingUpdate_=i.onBindingUpdate_.bind(i),i.emitter_=new rge.Emitter,i.controller_.binding.emitter.on("update",i.onBindingUpdate_),i}return Object.defineProperty(e.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)},enumerable:!1,configurable:!0}),e.prototype.on=function(t,i){var r=i.bind(this);return this.emitter_.on(t,function(o){r(o.event)}),this},e.prototype.refresh=function(){this.controller_.binding.read()},e.prototype.onBindingUpdate_=function(t){var i=t.sender.target.read();this.emitter_.emit("update",{event:new age.TpUpdateEvent(this,(0,oge.forceCast)(i),this.controller_.binding.target.presetKey)})},e}(sge.BladeApi);kg.MonitorBindingApi=lge;var Xh={},uge=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Xh,"__esModule",{value:!0});Xh.MonitorBindingController=void 0;var cge=Kp,hge=function(n){uge(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.binding=i.binding,r.viewProps.bindDisabled(r.binding.ticker),r.viewProps.handleDispose(function(){r.binding.dispose()}),r}return e}(cge.LabelController);Xh.MonitorBindingController=hge;var dge=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(kh,"__esModule",{value:!0});kh.RackApi=kh.findSubBladeApiSet=void 0;var uF=bx,pge=zi,dI=es,AA=Jt,fge=jl,eS=xl,mge=Dg,LA=wr,vge=Zp,gge=Rg,_ge=Og,yge=Gh,xge=kg,bge=Xh;function UG(n){return n instanceof jG?n.apiSet_:n instanceof mge.RackLikeApi?n.rackApi_.apiSet_:null}kh.findSubBladeApiSet=UG;function J0(n,e){var t=n.find(function(i){return i.controller_===e});if(!t)throw dI.TpError.shouldNeverHappen();return t}function cF(n,e,t){if(!uF.BindingTarget.isBindable(n))throw dI.TpError.notBindable();return new uF.BindingTarget(n,e,t)}var jG=function(n){dge(e,n);function e(t,i){var r=n.call(this,t)||this;r.onRackAdd_=r.onRackAdd_.bind(r),r.onRackRemove_=r.onRackRemove_.bind(r),r.onRackInputChange_=r.onRackInputChange_.bind(r),r.onRackMonitorUpdate_=r.onRackMonitorUpdate_.bind(r),r.emitter_=new pge.Emitter,r.apiSet_=new gge.NestedOrderedSet(UG),r.pool_=i;var o=r.controller_.rack;return o.emitter.on("add",r.onRackAdd_),o.emitter.on("remove",r.onRackRemove_),o.emitter.on("inputchange",r.onRackInputChange_),o.emitter.on("monitorupdate",r.onRackMonitorUpdate_),o.children.forEach(function(s){r.setUpApi_(s)}),r}return Object.defineProperty(e.prototype,"children",{get:function(){var t=this;return this.controller_.rack.children.map(function(i){return J0(t.apiSet_,i)})},enumerable:!1,configurable:!0}),e.prototype.addInput=function(t,i,r){var o=r!=null?r:{},s=this.controller_.view.element.ownerDocument,a=this.pool_.createInput(s,cF(t,i,o.presetKey),o),l=new _ge.InputBindingApi(a);return this.add(l,o.index)},e.prototype.addMonitor=function(t,i,r){var o=r!=null?r:{},s=this.controller_.view.element.ownerDocument,a=this.pool_.createMonitor(s,cF(t,i),o),l=new xge.MonitorBindingApi(a);return(0,AA.forceCast)(this.add(l,o.index))},e.prototype.addFolder=function(t){return(0,eS.addFolderAsBlade)(this,t)},e.prototype.addButton=function(t){return(0,eS.addButtonAsBlade)(this,t)},e.prototype.addSeparator=function(t){return(0,eS.addSeparatorAsBlade)(this,t)},e.prototype.addTab=function(t){return(0,eS.addTabAsBlade)(this,t)},e.prototype.add=function(t,i){this.controller_.rack.add(t.controller_,i);var r=this.apiSet_.find(function(o){return o.controller_===t.controller_});return r&&this.apiSet_.remove(r),this.apiSet_.add(t),t},e.prototype.remove=function(t){this.controller_.rack.remove(t.controller_)},e.prototype.addBlade=function(t){var i=this.controller_.view.element.ownerDocument,r=this.pool_.createBlade(i,t),o=this.pool_.createBladeApi(r);return this.add(o,t.index)},e.prototype.on=function(t,i){var r=i.bind(this);return this.emitter_.on(t,function(o){r(o.event)}),this},e.prototype.setUpApi_=function(t){var i=this.apiSet_.find(function(r){return r.controller_===t});i||this.apiSet_.add(this.pool_.createBladeApi(t))},e.prototype.onRackAdd_=function(t){this.setUpApi_(t.bladeController)},e.prototype.onRackRemove_=function(t){if(t.isRoot){var i=J0(this.apiSet_,t.bladeController);this.apiSet_.remove(i)}},e.prototype.onRackInputChange_=function(t){var i=t.bladeController;if(i instanceof yge.InputBindingController){var r=J0(this.apiSet_,i),o=i.binding;this.emitter_.emit("change",{event:new LA.TpChangeEvent(r,(0,AA.forceCast)(o.target.read()),o.target.presetKey,t.options.last)})}else if(i instanceof vge.ValueBladeController){var r=J0(this.apiSet_,i);this.emitter_.emit("change",{event:new LA.TpChangeEvent(r,i.value.rawValue,void 0,t.options.last)})}},e.prototype.onRackMonitorUpdate_=function(t){if(!(t.bladeController instanceof bge.MonitorBindingController))throw dI.TpError.shouldNeverHappen();var i=J0(this.apiSet_,t.bladeController),r=t.bladeController.binding;this.emitter_.emit("update",{event:new LA.TpUpdateEvent(i,(0,AA.forceCast)(r.target.read()),r.target.presetKey)})},e}(fge.BladeApi);kh.RackApi=jG;var wge=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Tx,"__esModule",{value:!0});Tx.FolderApi=void 0;var Sge=zi,Mge=Dg,Cge=wr,Ege=kh,Tge=function(n){wge(e,n);function e(t,i){var r=n.call(this,t,new Ege.RackApi(t.rackController,i))||this;return r.emitter_=new Sge.Emitter,r.controller_.foldable.value("expanded").emitter.on("change",function(o){r.emitter_.emit("fold",{event:new Cge.TpFoldEvent(r,o.sender.rawValue)})}),r.rackApi_.on("change",function(o){r.emitter_.emit("change",{event:o})}),r.rackApi_.on("update",function(o){r.emitter_.emit("update",{event:o})}),r}return Object.defineProperty(e.prototype,"expanded",{get:function(){return this.controller_.foldable.get("expanded")},set:function(t){this.controller_.foldable.set("expanded",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.controller_.props.get("title")},set:function(t){this.controller_.props.set("title",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.rackApi_.children},enumerable:!1,configurable:!0}),e.prototype.addInput=function(t,i,r){return this.rackApi_.addInput(t,i,r)},e.prototype.addMonitor=function(t,i,r){return this.rackApi_.addMonitor(t,i,r)},e.prototype.addFolder=function(t){return this.rackApi_.addFolder(t)},e.prototype.addButton=function(t){return this.rackApi_.addButton(t)},e.prototype.addSeparator=function(t){return this.rackApi_.addSeparator(t)},e.prototype.addTab=function(t){return this.rackApi_.addTab(t)},e.prototype.add=function(t,i){return this.rackApi_.add(t,i)},e.prototype.remove=function(t){this.rackApi_.remove(t)},e.prototype.addBlade=function(t){return this.rackApi_.addBlade(t)},e.prototype.on=function(t,i){var r=i.bind(this);return this.emitter_.on(t,function(o){r(o.event)}),this},e}(Mge.RackLikeApi);Tx.FolderApi=Tge;var Px={},Ig={},Pge=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Ig,"__esModule",{value:!0});Ig.RackLikeController=void 0;var Age=sc,Lge=function(n){Pge(e,n);function e(t){var i=n.call(this,{blade:t.blade,view:t.view,viewProps:t.rackController.viewProps})||this;return i.rackController=t.rackController,i}return e}(Age.BladeController);Ig.RackLikeController=Lge;var Q0={},Ax={};Object.defineProperty(Ax,"__esModule",{value:!0});Ax.PlainView=void 0;var Dge=pn,Rge=function(){function n(e,t){var i=(0,Dge.ClassName)(t.viewName);this.element=e.createElement("div"),this.element.classList.add(i()),t.viewProps.bindClassModifiers(this.element)}return n}();Ax.PlainView=Rge;var $0={},hF;function Oge(){if(hF)return $0;hF=1,Object.defineProperty($0,"__esModule",{value:!0}),$0.BladeRack=void 0;var n=zi,e=es,t=Jt,i=Gh,r=Xh,o=Lx(),s=Ig,a=Zp,l=Rg;function u(_,g){for(var b=0;b<_.length;b++){var w=_[b];if(w instanceof i.InputBindingController&&w.binding===g)return w}return null}function c(_,g){for(var b=0;b<_.length;b++){var w=_[b];if(w instanceof r.MonitorBindingController&&w.binding===g)return w}return null}function h(_,g){for(var b=0;b<_.length;b++){var w=_[b];if(w instanceof a.ValueBladeController&&w.value===g)return w}return null}function p(_){return _ instanceof o.RackController?_.rack:_ instanceof s.RackLikeController?_.rackController.rack:null}function m(_){var g=p(_);return g?g.bcSet_:null}var y=function(){function _(g){var b;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new n.Emitter,this.blade_=g!=null?g:null,(b=this.blade_)===null||b===void 0||b.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new l.NestedOrderedSet(m),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}return Object.defineProperty(_.prototype,"children",{get:function(){return this.bcSet_.items},enumerable:!1,configurable:!0}),_.prototype.add=function(g,b){g.parent&&g.parent.remove(g),g.parent_=this,this.bcSet_.add(g,b)},_.prototype.remove=function(g){g.parent_=null,this.bcSet_.remove(g)},_.prototype.find=function(g){return(0,t.forceCast)(this.bcSet_.allItems().filter(function(b){return b instanceof g}))},_.prototype.onSetAdd_=function(g){this.updatePositions_();var b=g.target===g.root;if(this.emitter.emit("add",{bladeController:g.item,index:g.index,isRoot:b,sender:this}),!!b){var w=g.item;if(w.viewProps.emitter.on("change",this.onChildViewPropsChange_),w.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),w.viewProps.handleDispose(this.onChildDispose_),w instanceof i.InputBindingController)w.binding.emitter.on("change",this.onChildInputChange_);else if(w instanceof r.MonitorBindingController)w.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(w instanceof a.ValueBladeController)w.value.emitter.on("change",this.onChildValueChange_);else{var M=p(w);if(M){var C=M.emitter;C.on("layout",this.onDescendantLayout_),C.on("inputchange",this.onDescendantInputChange_),C.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}},_.prototype.onSetRemove_=function(g){this.updatePositions_();var b=g.target===g.root;if(this.emitter.emit("remove",{bladeController:g.item,isRoot:b,sender:this}),!!b){var w=g.item;if(w instanceof i.InputBindingController)w.binding.emitter.off("change",this.onChildInputChange_);else if(w instanceof r.MonitorBindingController)w.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(w instanceof a.ValueBladeController)w.value.emitter.off("change",this.onChildValueChange_);else{var M=p(w);if(M){var C=M.emitter;C.off("layout",this.onDescendantLayout_),C.off("inputchange",this.onDescendantInputChange_),C.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}},_.prototype.updatePositions_=function(){var g=this,b=this.bcSet_.items.filter(function(C){return!C.viewProps.get("hidden")}),w=b[0],M=b[b.length-1];this.bcSet_.items.forEach(function(C){var P=[];C===w&&(P.push("first"),(!g.blade_||g.blade_.get("positions").includes("veryfirst"))&&P.push("veryfirst")),C===M&&(P.push("last"),(!g.blade_||g.blade_.get("positions").includes("verylast"))&&P.push("verylast")),C.blade.set("positions",P)})},_.prototype.onChildPositionsChange_=function(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},_.prototype.onChildViewPropsChange_=function(g){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},_.prototype.onChildDispose_=function(){var g=this,b=this.bcSet_.items.filter(function(w){return w.viewProps.get("disposed")});b.forEach(function(w){g.bcSet_.remove(w)})},_.prototype.onChildInputChange_=function(g){var b=u(this.find(i.InputBindingController),g.sender);if(!b)throw e.TpError.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:b,options:g.options,sender:this})},_.prototype.onChildMonitorUpdate_=function(g){var b=c(this.find(r.MonitorBindingController),g.sender);if(!b)throw e.TpError.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:b,sender:this})},_.prototype.onChildValueChange_=function(g){var b=h(this.find(a.ValueBladeController),g.sender);if(!b)throw e.TpError.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:b,options:g.options,sender:this})},_.prototype.onDescendantLayout_=function(g){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},_.prototype.onDescendantInputChange_=function(g){this.emitter.emit("inputchange",{bladeController:g.bladeController,options:g.options,sender:this})},_.prototype.onDescendantMonitorUpdate_=function(g){this.emitter.emit("monitorupdate",{bladeController:g.bladeController,sender:this})},_.prototype.onBladePositionsChange_=function(){this.updatePositions_()},_}();return $0.BladeRack=y,$0}var dF;function Lx(){if(dF)return Q0;dF=1;var n=it&&it.__extends||function(){var a=function(l,u){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,h){c.__proto__=h}||function(c,h){for(var p in h)Object.prototype.hasOwnProperty.call(h,p)&&(c[p]=h[p])},a(l,u)};return function(l,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");a(l,u);function c(){this.constructor=l}l.prototype=u===null?Object.create(u):(c.prototype=u.prototype,new c)}}(),e=it&&it.__assign||function(){return e=Object.assign||function(a){for(var l,u=1,c=arguments.length;u<c;u++){l=arguments[u];for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(a[h]=l[h])}return a},e.apply(this,arguments)};Object.defineProperty(Q0,"__esModule",{value:!0}),Q0.RackController=void 0;var t=Wr,i=Ax,r=sc,o=Oge(),s=function(a){n(l,a);function l(u,c){var h=a.call(this,e(e({},c),{view:new i.PlainView(u,{viewName:"brk",viewProps:c.viewProps})}))||this;h.onRackAdd_=h.onRackAdd_.bind(h),h.onRackRemove_=h.onRackRemove_.bind(h);var p=new o.BladeRack(c.root?void 0:c.blade);return p.emitter.on("add",h.onRackAdd_),p.emitter.on("remove",h.onRackRemove_),h.rack=p,h.viewProps.handleDispose(function(){for(var m=h.rack.children.length-1;m>=0;m--){var y=h.rack.children[m];y.viewProps.set("disposed",!0)}}),h}return l.prototype.onRackAdd_=function(u){!u.isRoot||(0,t.insertElementAt)(this.view.element,u.bladeController.view.element,u.index)},l.prototype.onRackRemove_=function(u){!u.isRoot||(0,t.removeElement)(u.bladeController.view.element)},l}(r.BladeController);return Q0.RackController=s,Q0}var Dx={},Rx={};Object.defineProperty(Rx,"__esModule",{value:!0});Rx.bladeContainerClassName=void 0;var kge=pn;Rx.bladeContainerClassName=(0,kge.ClassName)("cnt");Object.defineProperty(Dx,"__esModule",{value:!0});Dx.FolderView=void 0;var pF=ur,Ige=pn,fF=$o,Nge=Jt,zge=Rx,Vge=function(){function n(e,t){var i=this,r;this.className_=(0,Ige.ClassName)((r=t.viewName)!==null&&r!==void 0?r:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),(0,zge.bladeContainerClassName)()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),(0,pF.bindValueMap)(this.foldable_,"completed",(0,fF.valueToClassName)(this.element,this.className_(void 0,"cpl")));var o=e.createElement("button");o.classList.add(this.className_("b")),(0,pF.bindValueMap)(t.props,"title",function(u){(0,Nge.isEmpty)(u)?i.element.classList.add(i.className_(void 0,"not")):i.element.classList.remove(i.className_(void 0,"not"))}),t.viewProps.bindDisabled(o),this.element.appendChild(o),this.buttonElement=o;var s=e.createElement("div");s.classList.add(this.className_("t")),(0,fF.bindValueToTextContent)(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s;var a=e.createElement("div");a.classList.add(this.className_("m")),this.buttonElement.appendChild(a);var l=t.containerElement;l.classList.add(this.className_("c")),this.element.appendChild(l),this.containerElement=l}return n}();Dx.FolderView=Vge;var Fge=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),N2=it&&it.__assign||function(){return N2=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},N2.apply(this,arguments)};Object.defineProperty(Px,"__esModule",{value:!0});Px.FolderController=void 0;var Bge=Ig,mF=wo,Uge=Lx(),jge=Dx,Hge=function(n){Fge(e,n);function e(t,i){var r,o=this,s=mF.Foldable.create((r=i.expanded)!==null&&r!==void 0?r:!0),a=new Uge.RackController(t,{blade:i.blade,root:i.root,viewProps:i.viewProps});return o=n.call(this,N2(N2({},i),{rackController:a,view:new jge.FolderView(t,{containerElement:a.view.element,foldable:s,props:i.props,viewName:i.root?"rot":void 0,viewProps:i.viewProps})}))||this,o.onTitleClick_=o.onTitleClick_.bind(o),o.props=i.props,o.foldable=s,(0,mF.bindFoldable)(o.foldable,o.view.containerElement),o.rackController.rack.emitter.on("add",function(){o.foldable.cleanUpTransition()}),o.rackController.rack.emitter.on("remove",function(){o.foldable.cleanUpTransition()}),o.view.buttonElement.addEventListener("click",o.onTitleClick_),o}return Object.defineProperty(e.prototype,"document",{get:function(){return this.view.element.ownerDocument},enumerable:!1,configurable:!0}),e.prototype.onTitleClick_=function(){this.foldable.set("expanded",!this.foldable.get("expanded"))},e}(Bge.RackLikeController);Px.FolderController=Hge;var Ox={};Object.defineProperty(Ox,"__esModule",{value:!0});Ox.FolderBladePlugin=void 0;var Wge=mi,vF=Yi,Gge=Tx,gF=Px;Ox.FolderBladePlugin={id:"folder",type:"blade",accept:function(n){var e=vF.ParamsParsers,t=(0,vF.parseParams)(n,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return t?{params:t}:null},controller:function(n){return new gF.FolderController(n.document,{blade:n.blade,expanded:n.params.expanded,props:Wge.ValueMap.fromObject({title:n.params.title}),viewProps:n.viewProps})},api:function(n){return n.controller instanceof gF.FolderController?new Gge.FolderApi(n.controller,n.pool):null}};var a3={},Xge=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),z2=it&&it.__assign||function(){return z2=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},z2.apply(this,arguments)};Object.defineProperty(a3,"__esModule",{value:!0});a3.LabeledValueController=void 0;var qge=Zp,Yge=Lg,Kge=function(n){Xge(e,n);function e(t,i){var r=this,o=i.valueController.viewProps;return r=n.call(this,z2(z2({},i),{value:i.valueController.value,view:new Yge.LabelView(t,{props:i.props,viewProps:o}),viewProps:o}))||this,r.props=i.props,r.valueController=i.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return e}(qge.ValueBladeController);a3.LabeledValueController=Kge;var kx={},Zge=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(kx,"__esModule",{value:!0});kx.SeparatorApi=void 0;var Jge=jl,Qge=function(n){Zge(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Jge.BladeApi);kx.SeparatorApi=Qge;var Ix={},l3={};Object.defineProperty(l3,"__esModule",{value:!0});l3.SeparatorView=void 0;var $ge=pn,_F=(0,$ge.ClassName)("spr"),e0e=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(_F()),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("hr");i.classList.add(_F("r")),this.element.appendChild(i)}return n}();l3.SeparatorView=e0e;var t0e=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),V2=it&&it.__assign||function(){return V2=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},V2.apply(this,arguments)};Object.defineProperty(Ix,"__esModule",{value:!0});Ix.SeparatorController=void 0;var n0e=sc,i0e=l3,r0e=function(n){t0e(e,n);function e(t,i){return n.call(this,V2(V2({},i),{view:new i0e.SeparatorView(t,{viewProps:i.viewProps})}))||this}return e}(n0e.BladeController);Ix.SeparatorController=r0e;var Nx={};Object.defineProperty(Nx,"__esModule",{value:!0});Nx.SeparatorBladePlugin=void 0;var yF=Yi,o0e=kx,xF=Ix;Nx.SeparatorBladePlugin={id:"separator",type:"blade",accept:function(n){var e=yF.ParamsParsers,t=(0,yF.parseParams)(n,{view:e.required.constant("separator")});return t?{params:t}:null},controller:function(n){return new xF.SeparatorController(n.document,{blade:n.blade,viewProps:n.viewProps})},api:function(n){return n.controller instanceof xF.SeparatorController?new o0e.SeparatorApi(n.controller):null}};var zx={},Ng={},qh={},s0e=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(qh,"__esModule",{value:!0});qh.ViewProps=void 0;var a0e=pn,l0e=$o,tS=ur,bF=mi,u0e=(0,a0e.ClassName)("");function wF(n,e){return(0,l0e.valueToClassName)(n,u0e(void 0,e))}var c0e=function(n){s0e(e,n);function e(t){return n.call(this,t)||this}return e.create=function(t){var i,r,o=t!=null?t:{},s={disabled:(i=o.disabled)!==null&&i!==void 0?i:!1,disposed:!1,hidden:(r=o.hidden)!==null&&r!==void 0?r:!1},a=bF.ValueMap.createCore(s);return new e(a)},e.prototype.bindClassModifiers=function(t){(0,tS.bindValueMap)(this,"disabled",wF(t,"disabled")),(0,tS.bindValueMap)(this,"hidden",wF(t,"hidden"))},e.prototype.bindDisabled=function(t){(0,tS.bindValueMap)(this,"disabled",function(i){t.disabled=i})},e.prototype.bindTabIndex=function(t){(0,tS.bindValueMap)(this,"disabled",function(i){t.tabIndex=i?-1:0})},e.prototype.handleDispose=function(t){this.value("disposed").emitter.on("change",function(i){i&&t()})},e}(bF.ValueMap);qh.ViewProps=c0e;var u3={},c3={};Object.defineProperty(c3,"__esModule",{value:!0});c3.TabItemView=void 0;var h0e=ur,d0e=pn,p0e=$o,e_=(0,d0e.ClassName)("tbi"),f0e=function(){function n(e,t){var i=this;this.element=e.createElement("div"),this.element.classList.add(e_()),t.viewProps.bindClassModifiers(this.element),(0,h0e.bindValueMap)(t.props,"selected",function(s){s?i.element.classList.add(e_(void 0,"sel")):i.element.classList.remove(e_(void 0,"sel"))});var r=e.createElement("button");r.classList.add(e_("b")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;var o=e.createElement("div");o.classList.add(e_("t")),(0,p0e.bindValueToTextContent)(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o}return n}();c3.TabItemView=f0e;Object.defineProperty(u3,"__esModule",{value:!0});u3.TabItemController=void 0;var m0e=zi,v0e=c3,g0e=function(){function n(e,t){this.emitter=new m0e.Emitter,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new v0e.TabItemView(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return n.prototype.onClick_=function(){this.emitter.emit("click",{sender:this})},n}();u3.TabItemController=g0e;Object.defineProperty(Ng,"__esModule",{value:!0});Ng.TabPageController=void 0;var _0e=ur,SF=qh,y0e=Wh,x0e=Lx(),b0e=u3,w0e=function(){function n(e,t){var i=this;this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new b0e.TabItemController(e,{props:t.itemProps,viewProps:SF.ViewProps.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new x0e.RackController(e,{blade:(0,y0e.createBlade)(),viewProps:SF.ViewProps.create()}),this.props=t.props,(0,_0e.bindValueMap)(this.props,"selected",function(r){i.itemController.props.set("selected",r),i.contentController.viewProps.set("hidden",!r)})}return Object.defineProperty(n.prototype,"itemController",{get:function(){return this.ic_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"contentController",{get:function(){return this.cc_},enumerable:!1,configurable:!0}),n.prototype.onItemClick_=function(){this.props.set("selected",!0)},n}();Ng.TabPageController=w0e;var Vx={};Object.defineProperty(Vx,"__esModule",{value:!0});Vx.TabPageApi=void 0;var S0e=function(){function n(e,t){this.controller_=e,this.rackApi_=t}return Object.defineProperty(n.prototype,"title",{get:function(){var e;return(e=this.controller_.itemController.props.get("title"))!==null&&e!==void 0?e:""},set:function(e){this.controller_.itemController.props.set("title",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selected",{get:function(){return this.controller_.props.get("selected")},set:function(e){this.controller_.props.set("selected",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"children",{get:function(){return this.rackApi_.children},enumerable:!1,configurable:!0}),n.prototype.addButton=function(e){return this.rackApi_.addButton(e)},n.prototype.addFolder=function(e){return this.rackApi_.addFolder(e)},n.prototype.addSeparator=function(e){return this.rackApi_.addSeparator(e)},n.prototype.addTab=function(e){return this.rackApi_.addTab(e)},n.prototype.add=function(e,t){this.rackApi_.add(e,t)},n.prototype.remove=function(e){this.rackApi_.remove(e)},n.prototype.addInput=function(e,t,i){return this.rackApi_.addInput(e,t,i)},n.prototype.addMonitor=function(e,t,i){return this.rackApi_.addMonitor(e,t,i)},n.prototype.addBlade=function(e){return this.rackApi_.addBlade(e)},n}();Vx.TabPageApi=S0e;var M0e=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(zx,"__esModule",{value:!0});zx.TabApi=void 0;var C0e=zi,MF=mi,nS=es,E0e=Dg,T0e=wr,P0e=kh,A0e=Ng,L0e=Vx,D0e=function(n){M0e(e,n);function e(t,i){var r=n.call(this,t,new P0e.RackApi(t.rackController,i))||this;return r.onPageAdd_=r.onPageAdd_.bind(r),r.onPageRemove_=r.onPageRemove_.bind(r),r.onSelect_=r.onSelect_.bind(r),r.emitter_=new C0e.Emitter,r.pageApiMap_=new Map,r.rackApi_.on("change",function(o){r.emitter_.emit("change",{event:o})}),r.rackApi_.on("update",function(o){r.emitter_.emit("update",{event:o})}),r.controller_.tab.selectedIndex.emitter.on("change",r.onSelect_),r.controller_.pageSet.emitter.on("add",r.onPageAdd_),r.controller_.pageSet.emitter.on("remove",r.onPageRemove_),r.controller_.pageSet.items.forEach(function(o){r.setUpPageApi_(o)}),r}return Object.defineProperty(e.prototype,"pages",{get:function(){var t=this;return this.controller_.pageSet.items.map(function(i){var r=t.pageApiMap_.get(i);if(!r)throw nS.TpError.shouldNeverHappen();return r})},enumerable:!1,configurable:!0}),e.prototype.addPage=function(t){var i=this.controller_.view.element.ownerDocument,r=new A0e.TabPageController(i,{itemProps:MF.ValueMap.fromObject({selected:!1,title:t.title}),props:MF.ValueMap.fromObject({selected:!1})});this.controller_.add(r,t.index);var o=this.pageApiMap_.get(r);if(!o)throw nS.TpError.shouldNeverHappen();return o},e.prototype.removePage=function(t){this.controller_.remove(t)},e.prototype.on=function(t,i){var r=i.bind(this);return this.emitter_.on(t,function(o){r(o.event)}),this},e.prototype.setUpPageApi_=function(t){var i=this.rackApi_.apiSet_.find(function(o){return o.controller_===t.contentController});if(!i)throw nS.TpError.shouldNeverHappen();var r=new L0e.TabPageApi(t,i);this.pageApiMap_.set(t,r)},e.prototype.onPageAdd_=function(t){this.setUpPageApi_(t.item)},e.prototype.onPageRemove_=function(t){var i=this.pageApiMap_.get(t.item);if(!i)throw nS.TpError.shouldNeverHappen();this.pageApiMap_.delete(t.item)},e.prototype.onSelect_=function(t){this.emitter_.emit("select",{event:new T0e.TpTabSelectEvent(this,t.rawValue)})},e}(E0e.RackLikeApi);zx.TabApi=D0e;var Fx={},h3={};Object.defineProperty(h3,"__esModule",{value:!0});h3.Tab=void 0;var CF=Oo,EF=-1,R0e=function(){function n(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=(0,CF.createValue)(!0),this.selectedIndex=(0,CF.createValue)(EF),this.items_=[]}return n.prototype.add=function(e,t){var i=t!=null?t:this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()},n.prototype.remove=function(e){var t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())},n.prototype.keepSelection_=function(){if(this.items_.length===0){this.selectedIndex.rawValue=EF,this.empty.rawValue=!0;return}var e=this.items_.findIndex(function(t){return t.rawValue});e<0?(this.items_.forEach(function(t,i){t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach(function(t,i){t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1},n.prototype.onItemSelectedChange_=function(e){if(e.rawValue){var t=this.items_.findIndex(function(i){return i===e.sender});this.items_.forEach(function(i,r){i.rawValue=r===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()},n}();h3.Tab=R0e;var d3={};Object.defineProperty(d3,"__esModule",{value:!0});d3.TabView=void 0;var O0e=ur,k0e=pn,I0e=$o,N0e=Rx,iS=(0,k0e.ClassName)("tab"),z0e=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(iS(),(0,N0e.bladeContainerClassName)()),t.viewProps.bindClassModifiers(this.element),(0,O0e.bindValue)(t.empty,(0,I0e.valueToClassName)(this.element,iS(void 0,"nop")));var i=e.createElement("div");i.classList.add(iS("i")),this.element.appendChild(i),this.itemsElement=i;var r=t.contentsElement;r.classList.add(iS("c")),this.element.appendChild(r),this.contentsElement=r}return n}();d3.TabView=z0e;var V0e=it&&it.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Fx,"__esModule",{value:!0});Fx.TabController=void 0;var TF=Wr,F0e=Ig,B0e=Rg,U0e=Lx(),j0e=h3,H0e=d3,W0e=function(n){V0e(e,n);function e(t,i){var r=this,o=new U0e.RackController(t,{blade:i.blade,viewProps:i.viewProps}),s=new j0e.Tab;return r=n.call(this,{blade:i.blade,rackController:o,view:new H0e.TabView(t,{contentsElement:o.view.element,empty:s.empty,viewProps:i.viewProps})})||this,r.onPageAdd_=r.onPageAdd_.bind(r),r.onPageRemove_=r.onPageRemove_.bind(r),r.pageSet_=new B0e.NestedOrderedSet(function(){return null}),r.pageSet_.emitter.on("add",r.onPageAdd_),r.pageSet_.emitter.on("remove",r.onPageRemove_),r.tab=s,r}return Object.defineProperty(e.prototype,"pageSet",{get:function(){return this.pageSet_},enumerable:!1,configurable:!0}),e.prototype.add=function(t,i){this.pageSet_.add(t,i)},e.prototype.remove=function(t){this.pageSet_.remove(this.pageSet_.items[t])},e.prototype.onPageAdd_=function(t){var i=t.item;(0,TF.insertElementAt)(this.view.itemsElement,i.itemController.view.element,t.index),this.rackController.rack.add(i.contentController,t.index),this.tab.add(i.props.value("selected"))},e.prototype.onPageRemove_=function(t){var i=t.item;(0,TF.removeElement)(i.itemController.view.element),this.rackController.rack.remove(i.contentController),this.tab.remove(i.props.value("selected"))},e}(F0e.RackLikeController);Fx.TabController=W0e;var Bx={};Object.defineProperty(Bx,"__esModule",{value:!0});Bx.TabBladePlugin=void 0;var PF=mi,AF=Yi,G0e=zx,LF=Fx,X0e=Ng;Bx.TabBladePlugin={id:"tab",type:"blade",accept:function(n){var e=AF.ParamsParsers,t=(0,AF.parseParams)(n,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return!t||t.pages.length===0?null:{params:t}},controller:function(n){var e=new LF.TabController(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(function(t){var i=new X0e.TabPageController(n.document,{itemProps:PF.ValueMap.fromObject({selected:!1,title:t.title}),props:PF.ValueMap.fromObject({selected:!1})});e.add(i)}),e},api:function(n){return n.controller instanceof LF.TabController?new G0e.TabApi(n.controller,n.pool):null}};var Ux={},F2=it&&it.__assign||function(){return F2=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},F2.apply(this,arguments)};Object.defineProperty(Ux,"__esModule",{value:!0});Ux.createBladeController=void 0;var q0e=qh,DF=Yi,Y0e=Jt,K0e=Wh;function Z0e(n,e){var t=n.accept(e.params);if(!t)return null;var i=DF.ParamsParsers.optional.boolean(e.params.disabled).value,r=DF.ParamsParsers.optional.boolean(e.params.hidden).value;return n.controller({blade:(0,K0e.createBlade)(),document:e.document,params:(0,Y0e.forceCast)(F2(F2({},t.params),{disabled:i,hidden:r})),viewProps:q0e.ViewProps.create({disabled:i,hidden:r})})}Ux.createBladeController=Z0e;var jx={};Object.defineProperty(jx,"__esModule",{value:!0});jx.ManualTicker=void 0;var J0e=zi,Q0e=function(){function n(){this.disabled=!1,this.emitter=new J0e.Emitter}return n.prototype.dispose=function(){},n.prototype.tick=function(){this.disabled||this.emitter.emit("tick",{sender:this})},n}();jx.ManualTicker=Q0e;var Hx={};Object.defineProperty(Hx,"__esModule",{value:!0});Hx.IntervalTicker=void 0;var $0e=zi,e_e=function(){function n(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new $0e.Emitter,this.interval_=t,this.setTimer_()}return Object.defineProperty(n.prototype,"disabled",{get:function(){return this.disabled_},set:function(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this.clearTimer_()},n.prototype.clearTimer_=function(){if(this.timerId_!==null){var e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}},n.prototype.setTimer_=function(){if(this.clearTimer_(),!(this.interval_<=0)){var e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}},n.prototype.onTick_=function(){this.disabled_||this.emitter.emit("tick",{sender:this})},n}();Hx.IntervalTicker=e_e;var HG={};Object.defineProperty(HG,"__esModule",{value:!0});var Ga={};Object.defineProperty(Ga,"__esModule",{value:!0});Ga.findConstraint=Ga.CompositeConstraint=void 0;var WG=function(){function n(e){this.constraints=e}return n.prototype.constrain=function(e){return this.constraints.reduce(function(t,i){return i.constrain(t)},e)},n}();Ga.CompositeConstraint=WG;function t_e(n,e){if(n instanceof e)return n;if(n instanceof WG){var t=n.constraints.reduce(function(i,r){return i||(r instanceof e?r:null)},null);if(t)return t}return null}Ga.findConstraint=t_e;var GG={};Object.defineProperty(GG,"__esModule",{value:!0});var Yh={};Object.defineProperty(Yh,"__esModule",{value:!0});Yh.ListConstraint=void 0;var n_e=function(){function n(e){this.options=e}return n.prototype.constrain=function(e){var t=this.options;if(t.length===0)return e;var i=t.filter(function(r){return r.value===e}).length>0;return i?e:t[0].value},n}();Yh.ListConstraint=n_e;var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.RangeConstraint=void 0;var RF=Jt,i_e=function(){function n(e){this.maxValue=e.max,this.minValue=e.min}return n.prototype.constrain=function(e){var t=e;return(0,RF.isEmpty)(this.minValue)||(t=Math.max(t,this.minValue)),(0,RF.isEmpty)(this.maxValue)||(t=Math.min(t,this.maxValue)),t},n}();Kh.RangeConstraint=i_e;var zg={};Object.defineProperty(zg,"__esModule",{value:!0});zg.StepConstraint=void 0;var r_e=function(){function n(e,t){t===void 0&&(t=0),this.step=e,this.origin=t}return n.prototype.constrain=function(e){var t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step},n}();zg.StepConstraint=r_e;var XG={};Object.defineProperty(XG,"__esModule",{value:!0});var Jp={},Wx={};Object.defineProperty(Wx,"__esModule",{value:!0});Wx.ListView=void 0;var OF=Wr,o_e=ur,s_e=pn,DA=(0,s_e.ClassName)("lst"),a_e=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(DA()),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("select");i.classList.add(DA("s")),(0,o_e.bindValueMap)(this.props_,"options",function(o){(0,OF.removeChildElements)(i),o.forEach(function(s,a){var l=e.createElement("option");l.dataset.index=String(a),l.textContent=s.text,l.value=String(s.value),i.appendChild(l)})}),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;var r=e.createElement("div");r.classList.add(DA("m")),r.appendChild((0,OF.createSvgIconElement)(e,"dropdown")),this.element.appendChild(r),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,this.update_()}return n.prototype.update_=function(){this.selectElement.value=String(this.value_.rawValue)},n.prototype.onValueChange_=function(){this.update_()},n}();Wx.ListView=a_e;Object.defineProperty(Jp,"__esModule",{value:!0});Jp.ListController=void 0;var l_e=Jt,u_e=Wx,c_e=function(){function n(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new u_e.ListView(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}return n.prototype.onSelectChange_=function(e){var t=(0,l_e.forceCast)(e.currentTarget),i=t.selectedOptions.item(0);if(i){var r=Number(i.dataset.index);this.value.rawValue=this.props.get("options")[r].value}},n}();Jp.ListController=c_e;var Vg={},Gx={};Object.defineProperty(Gx,"__esModule",{value:!0});Gx.PopupView=void 0;var h_e=ur,d_e=pn,p_e=$o,kF=(0,d_e.ClassName)("pop"),f_e=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(kF()),t.viewProps.bindClassModifiers(this.element),(0,h_e.bindValue)(t.shows,(0,p_e.valueToClassName)(this.element,kF(void 0,"v")))}return n}();Gx.PopupView=f_e;Object.defineProperty(Vg,"__esModule",{value:!0});Vg.PopupController=void 0;var m_e=Oo,v_e=Gx,g_e=function(){function n(e,t){this.shows=(0,m_e.createValue)(!1),this.viewProps=t.viewProps,this.view=new v_e.PopupView(e,{shows:this.shows,viewProps:this.viewProps})}return n}();Vg.PopupController=g_e;var Fg={},Xx={};Object.defineProperty(Xx,"__esModule",{value:!0});Xx.TextView=void 0;var __e=pn,IF=(0,__e.ClassName)("txt"),y_e=function(){function n(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(IF()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);var i=e.createElement("input");i.classList.add(IF("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}return n.prototype.refresh=function(){var e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)},n.prototype.onChange_=function(){this.refresh()},n}();Xx.TextView=y_e;Object.defineProperty(Fg,"__esModule",{value:!0});Fg.TextController=void 0;var NF=Jt,x_e=Xx,b_e=function(){function n(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new x_e.TextView(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return n.prototype.onInputChange_=function(e){var t=(0,NF.forceCast)(e.currentTarget),i=t.value,r=this.parser_(i);(0,NF.isEmpty)(r)||(this.value.rawValue=r),this.view.refresh()},n}();Fg.TextController=b_e;var qG={};Object.defineProperty(qG,"__esModule",{value:!0});var Pl={};Object.defineProperty(Pl,"__esModule",{value:!0});Pl.BooleanFormatter=Pl.boolFromUnknown=Pl.boolToString=void 0;function YG(n){return String(n)}Pl.boolToString=YG;function w_e(n){return n==="false"?!1:!!n}Pl.boolFromUnknown=w_e;function S_e(n){return YG(n)}Pl.BooleanFormatter=S_e;var KG={};Object.defineProperty(KG,"__esModule",{value:!0});var ar={},p3={},Sh={};Object.defineProperty(Sh,"__esModule",{value:!0});Sh.UnaryOperationNode=Sh.BinaryOperationNode=Sh.NumberLiteralNode=void 0;var M_e=function(){function n(e){this.text=e}return n.prototype.evaluate=function(){return Number(this.text)},n.prototype.toString=function(){return this.text},n}();Sh.NumberLiteralNode=M_e;var C_e={"**":function(n,e){return Math.pow(n,e)},"*":function(n,e){return n*e},"/":function(n,e){return n/e},"%":function(n,e){return n%e},"+":function(n,e){return n+e},"-":function(n,e){return n-e},"<<":function(n,e){return n<<e},">>":function(n,e){return n>>e},">>>":function(n,e){return n>>>e},"&":function(n,e){return n&e},"^":function(n,e){return n^e},"|":function(n,e){return n|e}},E_e=function(){function n(e,t,i){this.left=t,this.operator=e,this.right=i}return n.prototype.evaluate=function(){var e=C_e[this.operator];if(!e)throw new Error("unexpected binary operator: '"+this.operator);return e(this.left.evaluate(),this.right.evaluate())},n.prototype.toString=function(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")},n}();Sh.BinaryOperationNode=E_e;var T_e={"+":function(n){return n},"-":function(n){return-n},"~":function(n){return~n}},P_e=function(){function n(e,t){this.operator=e,this.expression=t}return n.prototype.evaluate=function(){var e=T_e[this.operator];if(!e)throw new Error("unexpected unary operator: '"+this.operator);return e(this.expression.evaluate())},n.prototype.toString=function(){return["u(",this.operator,this.expression.toString(),")"].join(" ")},n}();Sh.UnaryOperationNode=P_e;var Jv={};Object.defineProperty(Jv,"__esModule",{value:!0});Jv.readNumericLiteral=Jv.readWhitespace=void 0;function pI(n){return function(e,t){for(var i=0;i<n.length;i++){var r=n[i](e,t);if(r!=="")return r}return""}}function A_e(n,e){var t,i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}Jv.readWhitespace=A_e;function L_e(n,e){var t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function Wy(n,e){var t,i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function D_e(n,e){var t=Wy(n,e);if(t!=="")return t;var i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";var r=Wy(n,e);return r===""?"":i+r}function fI(n,e){var t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";var i=D_e(n,e);return i===""?"":t+i}function ZG(n,e){var t=n.substr(e,1);if(t==="0")return t;var i=L_e(n,e);return e+=i.length,i===""?"":i+Wy(n,e)}function R_e(n,e){var t=ZG(n,e);if(e+=t.length,t==="")return"";var i=n.substr(e,1);if(e+=i.length,i!==".")return"";var r=Wy(n,e);return e+=r.length,t+i+r+fI(n,e)}function O_e(n,e){var t=n.substr(e,1);if(e+=t.length,t!==".")return"";var i=Wy(n,e);return e+=i.length,i===""?"":t+i+fI(n,e)}function k_e(n,e){var t=ZG(n,e);return e+=t.length,t===""?"":t+fI(n,e)}var I_e=pI([R_e,O_e,k_e]);function N_e(n,e){var t,i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function z_e(n,e){var t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";var i=N_e(n,e);return i===""?"":t+i}function V_e(n,e){var t,i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function F_e(n,e){var t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";var i=V_e(n,e);return i===""?"":t+i}function B_e(n,e){var t,i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function U_e(n,e){var t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";var i=B_e(n,e);return i===""?"":t+i}var j_e=pI([z_e,F_e,U_e]);Jv.readNumericLiteral=pI([j_e,I_e]);Object.defineProperty(p3,"__esModule",{value:!0});p3.parseEcmaNumberExpression=void 0;var mI=Sh,Qv=Jv;function H_e(n,e){var t=(0,Qv.readNumericLiteral)(n,e);return e+=t.length,t===""?null:{evaluable:new mI.NumberLiteralNode(t),cursor:e}}function W_e(n,e){var t=n.substr(e,1);if(e+=t.length,t!=="(")return null;var i=QG(n,e);if(!i)return null;e=i.cursor,e+=(0,Qv.readWhitespace)(n,e).length;var r=n.substr(e,1);return e+=r.length,r!==")"?null:{evaluable:i.evaluable,cursor:e}}function G_e(n,e){var t;return(t=H_e(n,e))!==null&&t!==void 0?t:W_e(n,e)}function JG(n,e){var t=G_e(n,e);if(t)return t;var i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;var r=JG(n,e);return r?(e=r.cursor,{cursor:e,evaluable:new mI.UnaryOperationNode(i,r.evaluable)}):null}function X_e(n,e,t){t+=(0,Qv.readWhitespace)(e,t).length;var i=n.filter(function(r){return e.startsWith(r,t)})[0];return i?(t+=i.length,t+=(0,Qv.readWhitespace)(e,t).length,{cursor:t,operator:i}):null}function q_e(n,e){return function(t,i){var r=n(t,i);if(!r)return null;i=r.cursor;for(var o=r.evaluable;;){var s=X_e(e,t,i);if(!s)break;i=s.cursor;var a=n(t,i);if(!a)return null;i=a.cursor,o=new mI.BinaryOperationNode(s.operator,o,a.evaluable)}return o?{cursor:i,evaluable:o}:null}}var Y_e=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(function(n,e){return q_e(n,e)},JG);function QG(n,e){return e+=(0,Qv.readWhitespace)(n,e).length,Y_e(n,e)}function K_e(n){var e=QG(n,0);if(!e)return null;var t=e.cursor+(0,Qv.readWhitespace)(n,e.cursor).length;return t!==n.length?null:e.evaluable}p3.parseEcmaNumberExpression=K_e;Object.defineProperty(ar,"__esModule",{value:!0});ar.createNumberFormatter=ar.numberToString=ar.numberFromUnknown=ar.parseNumber=void 0;var Z_e=Jt,J_e=p3;function $G(n){var e,t=(0,J_e.parseEcmaNumberExpression)(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}ar.parseNumber=$G;function Q_e(n){if(typeof n=="number")return n;if(typeof n=="string"){var e=$G(n);if(!(0,Z_e.isEmpty)(e))return e}return 0}ar.numberFromUnknown=Q_e;function $_e(n){return String(n)}ar.numberToString=$_e;function eye(n){return function(e){return e.toFixed(Math.max(Math.min(n,20),0))}}ar.createNumberFormatter=eye;var eX={};Object.defineProperty(eX,"__esModule",{value:!0});var qx={};Object.defineProperty(qx,"__esModule",{value:!0});qx.formatPercentage=void 0;var tye=ar,nye=(0,tye.createNumberFormatter)(0);function iye(n){return nye(n)+"%"}qx.formatPercentage=iye;var Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.formatString=Ih.stringFromUnknown=void 0;function rye(n){return String(n)}Ih.stringFromUnknown=rye;function oye(n){return n}Ih.formatString=oye;var Nh={},zF=it&&it.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,o;i<r;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(Nh,"__esModule",{value:!0});Nh.createPushedBuffer=Nh.initializeBuffer=void 0;var sye=Jt,aye=Oo;function tX(n,e){for(;n.length<e;)n.push(void 0)}function lye(n){var e=[];return tX(e,n),(0,aye.createValue)(e)}Nh.initializeBuffer=lye;function uye(n){var e=n.indexOf(void 0);return(0,sye.forceCast)(e<0?n:n.slice(0,e))}function cye(n,e){var t=zF(zF([],uye(n),!0),[e],!1);return t.length>n.length?t.splice(0,t.length-n.length):tX(t,n.length),t}Nh.createPushedBuffer=cye;var nX={};Object.defineProperty(nX,"__esModule",{value:!0});var ac={};Object.defineProperty(ac,"__esModule",{value:!0});ac.connectValues=void 0;function hye(n){var e=n.primary,t=n.secondary,i=n.forward,r=n.backward,o=!1;function s(a){o||(o=!0,a(),o=!1)}e.emitter.on("change",function(a){s(function(){t.setRawValue(i(e,t),a.options)})}),t.emitter.on("change",function(a){s(function(){e.setRawValue(r(e,t),a.options)}),s(function(){t.setRawValue(i(e,t),a.options)})}),s(function(){t.setRawValue(i(e,t),{forceEmit:!1,last:!0})})}ac.connectValues=hye;var lc={},Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});Sr.isArrowKey=Sr.isVerticalArrowKey=Sr.getHorizontalStepKeys=Sr.getVerticalStepKeys=Sr.getStepForKey=void 0;function dye(n,e){var t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}Sr.getStepForKey=dye;function pye(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}Sr.getVerticalStepKeys=pye;function fye(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}Sr.getHorizontalStepKeys=fye;function iX(n){return n==="ArrowUp"||n==="ArrowDown"}Sr.isVerticalArrowKey=iX;function mye(n){return iX(n)||n==="ArrowLeft"||n==="ArrowRight"}Sr.isArrowKey=mye;var Ya={};Object.defineProperty(Ya,"__esModule",{value:!0});Ya.PointerHandler=void 0;var vye=zi;function RA(n,e){var t,i,r=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:n.pageX-(((t=r&&r.scrollX)!==null&&t!==void 0?t:0)+o.left),y:n.pageY-(((i=r&&r.scrollY)!==null&&i!==void 0?i:0)+o.top)}}var gye=function(){function n(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new vye.Emitter,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}return n.prototype.computePosition_=function(e){var t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}},n.prototype.onMouseDown_=function(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();var i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(RA(e,this.elem_)),sender:this,shiftKey:e.shiftKey})},n.prototype.onDocumentMouseMove_=function(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(RA(e,this.elem_)),sender:this,shiftKey:e.shiftKey})},n.prototype.onDocumentMouseUp_=function(e){var t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(RA(e,this.elem_)),sender:this,shiftKey:e.shiftKey})},n.prototype.onTouchStart_=function(e){e.preventDefault();var t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t},n.prototype.onTouchMove_=function(e){var t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t},n.prototype.onTouchEnd_=function(e){var t,i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,r=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-r.left,y:i.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey})},n}();Ya.PointerHandler=gye;var Yx={},qn={};Object.defineProperty(qn,"__esModule",{value:!0});qn.loopRange=qn.constrainRange=qn.getDecimalDigits=qn.mapRange=void 0;function _ye(n,e,t,i,r){var o=(n-e)/(t-e);return i+o*(r-i)}qn.mapRange=_ye;function yye(n){var e=String(n.toFixed(10)),t=e.split(".")[1];return t.replace(/0+$/,"").length}qn.getDecimalDigits=yye;function xye(n,e,t){return Math.min(Math.max(n,e),t)}qn.constrainRange=xye;function bye(n,e){return(n%e+e)%e}qn.loopRange=bye;Object.defineProperty(Yx,"__esModule",{value:!0});Yx.NumberTextView=void 0;var OA=Wr,wye=qn,rX=pn,Bs=(0,rX.ClassName)("txt"),Sye=function(){function n(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Bs(),Bs(void 0,"num")),t.arrayPosition&&this.element.classList.add(Bs(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("input");i.classList.add(Bs("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Bs()),this.inputElement.classList.add(Bs("i"));var r=e.createElement("div");r.classList.add(Bs("k")),this.element.appendChild(r),this.knobElement=r;var o=e.createElementNS(OA.SVG_NS,"svg");o.classList.add(Bs("g")),this.knobElement.appendChild(o);var s=e.createElementNS(OA.SVG_NS,"path");s.classList.add(Bs("gb")),o.appendChild(s),this.guideBodyElem_=s;var a=e.createElementNS(OA.SVG_NS,"path");a.classList.add(Bs("gh")),o.appendChild(a),this.guideHeadElem_=a;var l=e.createElement("div");l.classList.add((0,rX.ClassName)("tt")()),this.knobElement.appendChild(l),this.tooltipElem_=l,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}return n.prototype.onDraggingChange_=function(e){if(e.rawValue===null){this.element.classList.remove(Bs(void 0,"drg"));return}this.element.classList.add(Bs(void 0,"drg"));var t=e.rawValue/this.props_.get("draggingScale"),i=t+(t>0?-1:t<0?1:0),r=(0,wye.constrainRange)(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M "+(i+r)+",0 L"+i+",4 L"+(i+r)+",8","M "+t+",-1 L"+t+",9"].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L"+t+",4");var o=this.props_.get("formatter");this.tooltipElem_.textContent=o(this.value.rawValue),this.tooltipElem_.style.left=t+"px"},n.prototype.refresh=function(){var e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)},n.prototype.onChange_=function(){this.refresh()},n}();Yx.NumberTextView=Sye;Object.defineProperty(lc,"__esModule",{value:!0});lc.NumberTextController=void 0;var VF=Jt,Mye=Oo,rS=Sr,Cye=Ya,Eye=Yx,Tye=function(){function n(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=(0,Mye.createValue)(null),this.view=new Eye.NumberTextView(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);var r=new Cye.PointerHandler(this.view.knobElement);r.emitter.on("down",this.onPointerDown_),r.emitter.on("move",this.onPointerMove_),r.emitter.on("up",this.onPointerUp_)}return n.prototype.constrainValue_=function(e){var t,i,r=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("minValue"),o=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("maxValue"),s=e;return r!==void 0&&(s=Math.max(s,r)),o!==void 0&&(s=Math.min(s,o)),s},n.prototype.onInputChange_=function(e){var t=(0,VF.forceCast)(e.currentTarget),i=t.value,r=this.parser_(i);(0,VF.isEmpty)(r)||(this.value.rawValue=this.constrainValue_(r)),this.view.refresh()},n.prototype.onInputKeyDown_=function(e){var t=(0,rS.getStepForKey)(this.baseStep_,(0,rS.getVerticalStepKeys)(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})},n.prototype.onInputKeyUp_=function(e){var t=(0,rS.getStepForKey)(this.baseStep_,(0,rS.getVerticalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n.prototype.onPointerDown_=function(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0},n.prototype.computeDraggingValue_=function(e){if(!e.point)return null;var t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("draggingScale"))},n.prototype.onPointerMove_=function(e){var t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)},n.prototype.onPointerUp_=function(e){var t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)},n}();lc.NumberTextController=Tye;var Kx={},Zx={};Object.defineProperty(Zx,"__esModule",{value:!0});Zx.SliderView=void 0;var FF=qn,Pye=pn,kA=(0,Pye.ClassName)("sld"),Aye=function(){function n(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(kA()),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(kA("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;var r=e.createElement("div");r.classList.add(kA("k")),this.trackElement.appendChild(r),this.knobElement=r,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}return n.prototype.update_=function(){var e=(0,FF.constrainRange)((0,FF.mapRange)(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=e+"%"},n.prototype.onChange_=function(){this.update_()},n}();Zx.SliderView=Aye;Object.defineProperty(Kx,"__esModule",{value:!0});Kx.SliderController=void 0;var BF=qn,oS=Sr,Lye=Ya,Dye=Zx,Rye=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new Dye.SliderView(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Lye.PointerHandler(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){!e.point||this.value.setRawValue((0,BF.mapRange)((0,BF.constrainRange)(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),t)},n.prototype.onPointerDownOrMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){var t=(0,oS.getStepForKey)(this.baseStep_,(0,oS.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})},n.prototype.onKeyUp_=function(e){var t=(0,oS.getStepForKey)(this.baseStep_,(0,oS.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();Kx.SliderController=Rye;var Jx={},Qx={};Object.defineProperty(Qx,"__esModule",{value:!0});Qx.SliderTextView=void 0;var Oye=pn,IA=(0,Oye.ClassName)("sldtxt"),kye=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(IA());var i=e.createElement("div");i.classList.add(IA("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(IA("t")),this.textView_=t.textView,r.appendChild(this.textView_.element),this.element.appendChild(r)}return n}();Qx.SliderTextView=kye;Object.defineProperty(Jx,"__esModule",{value:!0});Jx.SliderTextController=void 0;var Iye=Qx,Nye=lc,zye=Kx,Vye=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new zye.SliderController(e,{baseStep:t.baseStep,props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new Nye.NumberTextController(e,{baseStep:t.baseStep,parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new Iye.SliderTextView(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}return Object.defineProperty(n.prototype,"sliderController",{get:function(){return this.sliderC_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),n}();Jx.SliderTextController=Vye;var oX={};Object.defineProperty(oX,"__esModule",{value:!0});var f3={};Object.defineProperty(f3,"__esModule",{value:!0});f3.warnDeprecation=void 0;function Fye(n){var e;console.warn([n.name+" is deprecated.",n.alternative?"use "+n.alternative+" instead.":"",(e=n.postscript)!==null&&e!==void 0?e:""].join(" "))}f3.warnDeprecation=Fye;var sX={};Object.defineProperty(sX,"__esModule",{value:!0});var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});Zh.writePrimitive=void 0;function Bye(n,e){n.write(e)}Zh.writePrimitive=Bye;var Wn={};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.getSuitableDraggingScale=Wn.getBaseStep=Wn.getSuitableDecimalDigits=Wn.findListItems=Wn.createListConstraint=Wn.normalizeListOptions=Wn.parsePointDimensionParams=Wn.parsePickerLayout=Wn.parseListOptions=void 0;var UF=Jt,m3=Ga,aX=Yh,vI=zg,jF=qn,lX=Yi;function Uye(n){var e=lX.ParamsParsers;if(Array.isArray(n))return e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(n).value;if(typeof n=="object")return e.required.raw(n).value}Wn.parseListOptions=Uye;function jye(n){if(n==="inline"||n==="popup")return n}Wn.parsePickerLayout=jye;function Hye(n){var e=lX.ParamsParsers;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(n).value}Wn.parsePointDimensionParams=Hye;function uX(n){if(Array.isArray(n))return n;var e=[];return Object.keys(n).forEach(function(t){e.push({text:t,value:n[t]})}),e}Wn.normalizeListOptions=uX;function Wye(n){return(0,UF.isEmpty)(n)?null:new aX.ListConstraint(uX((0,UF.forceCast)(n)))}Wn.createListConstraint=Wye;function Gye(n){var e=n?(0,m3.findConstraint)(n,aX.ListConstraint):null;return e?e.options:null}Wn.findListItems=Gye;function Xye(n){var e=n?(0,m3.findConstraint)(n,vI.StepConstraint):null;return e?e.step:null}function qye(n,e){var t=n&&(0,m3.findConstraint)(n,vI.StepConstraint);return t?(0,jF.getDecimalDigits)(t.step):Math.max((0,jF.getDecimalDigits)(e),2)}Wn.getSuitableDecimalDigits=qye;function Yye(n){var e=Xye(n);return e!=null?e:1}Wn.getBaseStep=Yye;function Kye(n,e){var t,i=n&&(0,m3.findConstraint)(n,vI.StepConstraint),r=Math.abs((t=i==null?void 0:i.step)!==null&&t!==void 0?t:e);return r===0?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}Wn.getSuitableDraggingScale=Kye;var $x={},v3={};Object.defineProperty(v3,"__esModule",{value:!0});v3.CheckboxView=void 0;var Zye=Wr,Jye=pn,sS=(0,Jye.ClassName)("ckb"),Qye=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(sS()),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("label");i.classList.add(sS("l")),this.element.appendChild(i);var r=e.createElement("input");r.classList.add(sS("i")),r.type="checkbox",i.appendChild(r),this.inputElement=r,t.viewProps.bindDisabled(this.inputElement);var o=e.createElement("div");o.classList.add(sS("w")),i.appendChild(o);var s=(0,Zye.createSvgIconElement)(e,"check");o.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}return n.prototype.update_=function(){this.inputElement.checked=this.value.rawValue},n.prototype.onValueChange_=function(){this.update_()},n}();v3.CheckboxView=Qye;Object.defineProperty($x,"__esModule",{value:!0});$x.CheckboxController=void 0;var $ye=Jt,exe=v3,txe=function(){function n(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new exe.CheckboxView(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return n.prototype.onInputChange_=function(e){var t=(0,$ye.forceCast)(e.currentTarget);this.value.rawValue=t.checked},n}();$x.CheckboxController=txe;var e1={};Object.defineProperty(e1,"__esModule",{value:!0});e1.BooleanInputPlugin=void 0;var cX=Ga,nxe=Yh,ixe=Jp,rxe=Pl,oxe=mi,HF=Yi,sxe=Zh,QR=Wn,axe=$x;function lxe(n){var e=[],t=(0,QR.createListConstraint)(n.options);return t&&e.push(t),new cX.CompositeConstraint(e)}e1.BooleanInputPlugin={id:"input-bool",type:"input",accept:function(n,e){if(typeof n!="boolean")return null;var t=HF.ParamsParsers,i=(0,HF.parseParams)(e,{options:t.optional.custom(QR.parseListOptions)});return i?{initialValue:n,params:i}:null},binding:{reader:function(n){return rxe.boolFromUnknown},constraint:function(n){return lxe(n.params)},writer:function(n){return sxe.writePrimitive}},controller:function(n){var e,t=n.document,i=n.value,r=n.constraint;return r&&(0,cX.findConstraint)(r,nxe.ListConstraint)?new ixe.ListController(t,{props:oxe.ValueMap.fromObject({options:(e=(0,QR.findListItems)(r))!==null&&e!==void 0?e:[]}),value:i,viewProps:n.viewProps}):new axe.CheckboxController(t,{value:i,viewProps:n.viewProps})}};var Qp={},g3={};Object.defineProperty(g3,"__esModule",{value:!0});g3.ColorView=void 0;var uxe=ur,cxe=pn,hxe=$o,Bd=(0,cxe.ClassName)("col"),dxe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(Bd()),t.foldable.bindExpandedClass(this.element,Bd(void 0,"expanded")),(0,uxe.bindValueMap)(t.foldable,"completed",(0,hxe.valueToClassName)(this.element,Bd(void 0,"cpl")));var i=e.createElement("div");i.classList.add(Bd("h")),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(Bd("s")),i.appendChild(r),this.swatchElement=r;var o=e.createElement("div");if(o.classList.add(Bd("t")),i.appendChild(o),this.textElement=o,t.pickerLayout==="inline"){var s=e.createElement("div");s.classList.add(Bd("p")),this.element.appendChild(s),this.pickerElement=s}else this.pickerElement=null}return n}();g3.ColorView=dxe;var _3={},uo={},Si={};Object.defineProperty(Si,"__esModule",{value:!0});Si.convertColor=Si.constrainColorComponents=Si.getColorMaxComponents=Si.appendAlphaComponent=Si.removeAlphaComponent=Si.hsvToHslInt=Si.hslToHsvInt=Si.hsvToRgbInt=void 0;var io=qn;function pxe(n,e,t){var i=(0,io.constrainRange)(n/255,0,1),r=(0,io.constrainRange)(e/255,0,1),o=(0,io.constrainRange)(t/255,0,1),s=Math.max(i,r,o),a=Math.min(i,r,o),l=s-a,u=0,c=0,h=(a+s)/2;return l!==0&&(c=l/(1-Math.abs(s+a-1)),i===s?u=(r-o)/l:r===s?u=2+(o-i)/l:u=4+(i-r)/l,u=u/6+(u<0?1:0)),[u*360,c*100,h*100]}function fxe(n,e,t){var i,r,o,s,a,l,u=(n%360+360)%360,c=(0,io.constrainRange)(e/100,0,1),h=(0,io.constrainRange)(t/100,0,1),p=(1-Math.abs(2*h-1))*c,m=p*(1-Math.abs(u/60%2-1)),y=h-p/2,_,g,b;return u>=0&&u<60?(i=[p,m,0],_=i[0],g=i[1],b=i[2]):u>=60&&u<120?(r=[m,p,0],_=r[0],g=r[1],b=r[2]):u>=120&&u<180?(o=[0,p,m],_=o[0],g=o[1],b=o[2]):u>=180&&u<240?(s=[0,m,p],_=s[0],g=s[1],b=s[2]):u>=240&&u<300?(a=[m,0,p],_=a[0],g=a[1],b=a[2]):(l=[p,0,m],_=l[0],g=l[1],b=l[2]),[(_+y)*255,(g+y)*255,(b+y)*255]}function mxe(n,e,t){var i=(0,io.constrainRange)(n/255,0,1),r=(0,io.constrainRange)(e/255,0,1),o=(0,io.constrainRange)(t/255,0,1),s=Math.max(i,r,o),a=Math.min(i,r,o),l=s-a,u;l===0?u=0:s===i?u=60*(((r-o)/l%6+6)%6):s===r?u=60*((o-i)/l+2):u=60*((i-r)/l+4);var c=s===0?0:l/s,h=s;return[u,c*100,h*100]}function hX(n,e,t){var i,r,o,s,a,l,u=(0,io.loopRange)(n,360),c=(0,io.constrainRange)(e/100,0,1),h=(0,io.constrainRange)(t/100,0,1),p=h*c,m=p*(1-Math.abs(u/60%2-1)),y=h-p,_,g,b;return u>=0&&u<60?(i=[p,m,0],_=i[0],g=i[1],b=i[2]):u>=60&&u<120?(r=[m,p,0],_=r[0],g=r[1],b=r[2]):u>=120&&u<180?(o=[0,p,m],_=o[0],g=o[1],b=o[2]):u>=180&&u<240?(s=[0,m,p],_=s[0],g=s[1],b=s[2]):u>=240&&u<300?(a=[m,0,p],_=a[0],g=a[1],b=a[2]):(l=[p,0,m],_=l[0],g=l[1],b=l[2]),[(_+y)*255,(g+y)*255,(b+y)*255]}Si.hsvToRgbInt=hX;function dX(n,e,t){var i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}Si.hslToHsvInt=dX;function pX(n,e,t){var i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}Si.hsvToHslInt=pX;function vxe(n){return[n[0],n[1],n[2]]}Si.removeAlphaComponent=vxe;function gxe(n,e){return[n[0],n[1],n[2],e]}Si.appendAlphaComponent=gxe;var _xe={hsl:{hsl:function(n,e,t){return[n,e,t]},hsv:dX,rgb:fxe},hsv:{hsl:pX,hsv:function(n,e,t){return[n,e,t]},rgb:hX},rgb:{hsl:pxe,hsv:mxe,rgb:function(n,e,t){return[n,e,t]}}};function B2(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}Si.getColorMaxComponents=B2;function yxe(n,e,t){var i,r=B2(e,t);return[e==="rgb"?(0,io.constrainRange)(n[0],0,r[0]):(0,io.loopRange)(n[0],r[0]),(0,io.constrainRange)(n[1],0,r[1]),(0,io.constrainRange)(n[2],0,r[2]),(0,io.constrainRange)((i=n[3])!==null&&i!==void 0?i:1,0,1)]}Si.constrainColorComponents=yxe;function WF(n,e,t,i){var r=B2(e,t),o=B2(e,i);return n.map(function(s,a){return s/r[a]*o[a]})}function xxe(n,e,t){var i,r=WF(n,e.mode,e.type,"int"),o=(i=_xe[e.mode])[t.mode].apply(i,r);return WF(o,t.mode,"int",t.type)}Si.convertColor=xxe;Object.defineProperty(uo,"__esModule",{value:!0});uo.Color=void 0;var bxe=Jt,aS=Si;function lS(n,e){return typeof n!="object"||(0,bxe.isEmpty)(n)?!1:e in n&&typeof n[e]=="number"}var wxe=function(){function n(e,t,i){i===void 0&&(i="int"),this.mode=t,this.type=i,this.comps_=(0,aS.constrainColorComponents)(e,t,i)}return n.black=function(e){return e===void 0&&(e="int"),new n([0,0,0],"rgb",e)},n.fromObject=function(e,t){t===void 0&&(t="int");var i="a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b];return new n(i,"rgb",t)},n.toRgbaObject=function(e,t){return t===void 0&&(t="int"),e.toRgbaObject(t)},n.isRgbColorObject=function(e){return lS(e,"r")&&lS(e,"g")&&lS(e,"b")},n.isRgbaColorObject=function(e){return this.isRgbColorObject(e)&&lS(e,"a")},n.isColorObject=function(e){return this.isRgbColorObject(e)},n.equals=function(e,t){if(e.mode!==t.mode)return!1;for(var i=e.comps_,r=t.comps_,o=0;o<i.length;o++)if(i[o]!==r[o])return!1;return!0},n.prototype.getComponents=function(e,t){return t===void 0&&(t="int"),(0,aS.appendAlphaComponent)((0,aS.convertColor)((0,aS.removeAlphaComponent)(this.comps_),{mode:this.mode,type:this.type},{mode:e!=null?e:this.mode,type:t}),this.comps_[3])},n.prototype.toRgbaObject=function(e){e===void 0&&(e="int");var t=this.getComponents("rgb",e);return{r:t[0],g:t[1],b:t[2],a:t[3]}},n}();uo.Color=wxe;var y3={},Sxe=it&&it.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,o;i<r;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(y3,"__esModule",{value:!0});y3.ColorPickerView=void 0;var Mxe=pn,Vc=(0,Mxe.ClassName)("colp"),Cxe=function(){function n(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Vc());var i=e.createElement("div");i.classList.add(Vc("hsv"));var r=e.createElement("div");r.classList.add(Vc("sv")),this.svPaletteView_=t.svPaletteView,r.appendChild(this.svPaletteView_.element),i.appendChild(r);var o=e.createElement("div");o.classList.add(Vc("h")),this.hPaletteView_=t.hPaletteView,o.appendChild(this.hPaletteView_.element),i.appendChild(o),this.element.appendChild(i);var s=e.createElement("div");if(s.classList.add(Vc("rgb")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};var a=e.createElement("div");a.classList.add(Vc("a"));var l=e.createElement("div");l.classList.add(Vc("ap")),l.appendChild(this.alphaViews_.palette.element),a.appendChild(l);var u=e.createElement("div");u.classList.add(Vc("at")),u.appendChild(this.alphaViews_.text.element),a.appendChild(u),this.element.appendChild(a)}}return Object.defineProperty(n.prototype,"allFocusableElements",{get:function(){var e=Sxe([this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement],this.textView_.textViews.map(function(t){return t.inputElement}),!0);return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e},enumerable:!1,configurable:!0}),n}();y3.ColorPickerView=Cxe;var x3={},Jo={};Object.defineProperty(Jo,"__esModule",{value:!0});Jo.extractColorType=Jo.getBaseStepForColor=Jo.parseColorInputParams=void 0;var GF=Yi,Exe=Wn;function Txe(n){return n==="int"?"int":n==="float"?"float":void 0}function Pxe(n){var e=GF.ParamsParsers;return(0,GF.parseParams)(n,{alpha:e.optional.boolean,color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Txe)}),expanded:e.optional.boolean,picker:e.optional.custom(Exe.parsePickerLayout)})}Jo.parseColorInputParams=Pxe;function Axe(n){return n?.1:1}Jo.getBaseStepForColor=Axe;function Lxe(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}Jo.extractColorType=Lxe;var b3={},uc={};(function(n){var e=it&&it.__assign||function(){return e=Object.assign||function(Ce){for(var ve,k=1,O=arguments.length;k<O;k++){ve=arguments[k];for(var ie in ve)Object.prototype.hasOwnProperty.call(ve,ie)&&(Ce[ie]=ve[ie])}return Ce},e.apply(this,arguments)},t=it&&it.__spreadArray||function(Ce,ve,k){if(k||arguments.length===2)for(var O=0,ie=ve.length,ge;O<ie;O++)(ge||!(O in ve))&&(ge||(ge=Array.prototype.slice.call(ve,0,O)),ge[O]=ve[O]);return Ce.concat(ge||Array.prototype.slice.call(ve))};Object.defineProperty(n,"__esModule",{value:!0}),n.findColorStringifier=n.getColorStringifier=n.colorToObjectRgbaString=n.colorToObjectRgbString=n.colorToFunctionalHslaString=n.colorToFunctionalHslString=n.colorToFunctionalRgbaString=n.colorToFunctionalRgbString=n.colorToHexRgbaString=n.colorToHexRgbString=n.colorFromString=n.hasAlphaComponent=n.createColorStringParser=n.createColorStringBindingReader=n.CompositeColorParser=n.detectStringColorFormat=n.getColorNotation=void 0;var i=ar,r=qx,o=qn,s=uo,a=Si;function l(Ce,ve){return Ce.alpha===ve.alpha&&Ce.mode===ve.mode&&Ce.notation===ve.notation&&Ce.type===ve.type}function u(Ce,ve){var k=Ce.match(/^(.+)%$/);return Math.min(k?parseFloat(k[1])*.01*ve:parseFloat(Ce),ve)}var c={deg:function(Ce){return Ce},grad:function(Ce){return Ce*360/400},rad:function(Ce){return Ce*360/(2*Math.PI)},turn:function(Ce){return Ce*360}};function h(Ce){var ve=Ce.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!ve)return parseFloat(Ce);var k=parseFloat(ve[1]),O=ve[2];return c[O](k)}function p(Ce){var ve=Ce.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!ve)return null;var k=[u(ve[1],255),u(ve[2],255),u(ve[3],255)];return isNaN(k[0])||isNaN(k[1])||isNaN(k[2])?null:k}function m(Ce){return function(ve){var k=p(ve);return k?new s.Color(k,"rgb",Ce):null}}function y(Ce){var ve=Ce.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!ve)return null;var k=[u(ve[1],255),u(ve[2],255),u(ve[3],255),u(ve[4],1)];return isNaN(k[0])||isNaN(k[1])||isNaN(k[2])||isNaN(k[3])?null:k}function _(Ce){return function(ve){var k=y(ve);return k?new s.Color(k,"rgb",Ce):null}}function g(Ce){var ve=Ce.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!ve)return null;var k=[h(ve[1]),u(ve[2],100),u(ve[3],100)];return isNaN(k[0])||isNaN(k[1])||isNaN(k[2])?null:k}function b(Ce){return function(ve){var k=g(ve);return k?new s.Color(k,"hsl",Ce):null}}function w(Ce){var ve=Ce.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!ve)return null;var k=[h(ve[1]),u(ve[2],100),u(ve[3],100),u(ve[4],1)];return isNaN(k[0])||isNaN(k[1])||isNaN(k[2])||isNaN(k[3])?null:k}function M(Ce){return function(ve){var k=w(ve);return k?new s.Color(k,"hsl",Ce):null}}function C(Ce){var ve=Ce.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(ve)return[parseInt(ve[1]+ve[1],16),parseInt(ve[2]+ve[2],16),parseInt(ve[3]+ve[3],16)];var k=Ce.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return k?[parseInt(k[1],16),parseInt(k[2],16),parseInt(k[3],16)]:null}function P(Ce){var ve=C(Ce);return ve?new s.Color(ve,"rgb","int"):null}function L(Ce){var ve=Ce.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(ve)return[parseInt(ve[1]+ve[1],16),parseInt(ve[2]+ve[2],16),parseInt(ve[3]+ve[3],16),(0,o.mapRange)(parseInt(ve[4]+ve[4],16),0,255,0,1)];var k=Ce.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return k?[parseInt(k[1],16),parseInt(k[2],16),parseInt(k[3],16),(0,o.mapRange)(parseInt(k[4],16),0,255,0,1)]:null}function R(Ce){var ve=L(Ce);return ve?new s.Color(ve,"rgb","int"):null}function E(Ce){var ve=Ce.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!ve)return null;var k=[parseFloat(ve[1]),parseFloat(ve[2]),parseFloat(ve[3])];return isNaN(k[0])||isNaN(k[1])||isNaN(k[2])?null:k}function D(Ce){return function(ve){var k=E(ve);return k?new s.Color(k,"rgb",Ce):null}}function N(Ce){var ve=Ce.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!ve)return null;var k=[parseFloat(ve[1]),parseFloat(ve[2]),parseFloat(ve[3]),parseFloat(ve[4])];return isNaN(k[0])||isNaN(k[1])||isNaN(k[2])||isNaN(k[3])?null:k}function j(Ce){return function(ve){var k=N(ve);return k?new s.Color(k,"rgb",Ce):null}}var te={"func.rgb":m("int"),"func.rgba":_("int"),"func.hsl":b("int"),"func.hsla":M("int"),"hex.rgb":P,"hex.rgba":R};function ee(Ce){var ve=Object.keys(te);return ve.reduce(function(k,O){if(k)return k;var ie=te[O];return ie(Ce)?O:null},null)}n.getColorNotation=ee;var H=[{parser:C,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:L,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:p,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:y,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:g,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:w,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:E,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:N,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Q(Ce){return H.reduce(function(ve,k){var O=k.parser,ie=k.result;return ve||(O(Ce)?ie:null)},null)}function Z(Ce,ve){ve===void 0&&(ve="int");var k=Q(Ce);return k?k.notation==="hex"&&ve!=="float"?e(e({},k),{type:"int"}):k.notation==="func"?e(e({},k),{type:ve}):null:null}n.detectStringColorFormat=Z;var de=function(Ce){var ve=ee(Ce);return ve?te[ve](Ce):null};n.CompositeColorParser=de;var X={int:[P,R,m("int"),_("int"),b("int"),M("int"),D("int"),j("int")],float:[m("float"),_("float"),b("float"),M("float"),D("float"),j("float")]};function B(Ce){var ve=X[Ce];return function(k){if(typeof k!="string")return s.Color.black(Ce);var O=ve.reduce(function(ie,ge){return ie||ge(k)},null);return O!=null?O:s.Color.black(Ce)}}n.createColorStringBindingReader=B;function U(Ce){var ve=X[Ce];return function(k){return ve.reduce(function(O,ie){return O||ie(k)},null)}}n.createColorStringParser=U;function le(Ce){return Ce==="func.hsla"||Ce==="func.rgba"||Ce==="hex.rgba"}n.hasAlphaComponent=le;function ne(Ce){if(typeof Ce=="string"){var ve=(0,n.CompositeColorParser)(Ce);if(ve)return ve}return s.Color.black()}n.colorFromString=ne;function fe(Ce){var ve=(0,o.constrainRange)(Math.floor(Ce),0,255).toString(16);return ve.length===1?"0"+ve:ve}function we(Ce,ve){ve===void 0&&(ve="#");var k=(0,a.removeAlphaComponent)(Ce.getComponents("rgb")).map(fe).join("");return""+ve+k}n.colorToHexRgbString=we;function Be(Ce,ve){ve===void 0&&(ve="#");var k=Ce.getComponents("rgb"),O=[k[0],k[1],k[2],k[3]*255].map(fe).join("");return""+ve+O}n.colorToHexRgbaString=Be;function oe(Ce,ve){var k=(0,i.createNumberFormatter)(ve==="float"?2:0),O=(0,a.removeAlphaComponent)(Ce.getComponents("rgb",ve)).map(function(ie){return k(ie)});return"rgb("+O.join(", ")+")"}n.colorToFunctionalRgbString=oe;function tt(Ce){return function(ve){return oe(ve,Ce)}}function Ue(Ce,ve){var k=(0,i.createNumberFormatter)(2),O=(0,i.createNumberFormatter)(ve==="float"?2:0),ie=Ce.getComponents("rgb",ve).map(function(ge,ye){var Pe=ye===3?k:O;return Pe(ge)});return"rgba("+ie.join(", ")+")"}n.colorToFunctionalRgbaString=Ue;function Ve(Ce){return function(ve){return Ue(ve,Ce)}}function Ae(Ce){var ve=[(0,i.createNumberFormatter)(0),r.formatPercentage,r.formatPercentage],k=(0,a.removeAlphaComponent)(Ce.getComponents("hsl")).map(function(O,ie){return ve[ie](O)});return"hsl("+k.join(", ")+")"}n.colorToFunctionalHslString=Ae;function Oe(Ce){var ve=[(0,i.createNumberFormatter)(0),r.formatPercentage,r.formatPercentage,(0,i.createNumberFormatter)(2)],k=Ce.getComponents("hsl").map(function(O,ie){return ve[ie](O)});return"hsla("+k.join(", ")+")"}n.colorToFunctionalHslaString=Oe;function Te(Ce,ve){var k=(0,i.createNumberFormatter)(ve==="float"?2:0),O=["r","g","b"],ie=(0,a.removeAlphaComponent)(Ce.getComponents("rgb",ve)).map(function(ge,ye){return O[ye]+": "+k(ge)});return"{"+ie.join(", ")+"}"}n.colorToObjectRgbString=Te;function be(Ce){return function(ve){return Te(ve,Ce)}}function Ye(Ce,ve){var k=(0,i.createNumberFormatter)(2),O=(0,i.createNumberFormatter)(ve==="float"?2:0),ie=["r","g","b","a"],ge=Ce.getComponents("rgb",ve).map(function(ye,Pe){var Xe=Pe===3?k:O;return ie[Pe]+": "+Xe(ye)});return"{"+ge.join(", ")+"}"}n.colorToObjectRgbaString=Ye;function Ke(Ce){return function(ve){return Ye(ve,Ce)}}var ft={"func.hsl":Ae,"func.hsla":Oe,"func.rgb":oe,"func.rgba":Ue,"hex.rgb":we,"hex.rgba":Be};function mt(Ce){return ft[Ce]}n.getColorStringifier=mt;var yt=t([{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:we},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Be},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Ae},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:Oe}],["int","float"].reduce(function(Ce,ve){return t(t([],Ce,!0),[{format:{alpha:!1,mode:"rgb",notation:"func",type:ve},stringifier:tt(ve)},{format:{alpha:!0,mode:"rgb",notation:"func",type:ve},stringifier:Ve(ve)},{format:{alpha:!1,mode:"rgb",notation:"object",type:ve},stringifier:be(ve)},{format:{alpha:!0,mode:"rgb",notation:"object",type:ve},stringifier:Ke(ve)}],!1)},[]),!0);function st(Ce){return yt.reduce(function(ve,k){return ve||(l(k.format,Ce)?k.stringifier:null)},null)}n.findColorStringifier=st})(uc);Object.defineProperty(b3,"__esModule",{value:!0});b3.APaletteView=void 0;var Dxe=qn,Rxe=pn,NA=uc,XF=uo,t_=(0,Rxe.ClassName)("apl"),Oxe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(t_()),t.viewProps.bindTabIndex(this.element);var i=e.createElement("div");i.classList.add(t_("b")),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(t_("c")),i.appendChild(r),this.colorElem_=r;var o=e.createElement("div");o.classList.add(t_("m")),this.element.appendChild(o),this.markerElem_=o;var s=e.createElement("div");s.classList.add(t_("p")),this.markerElem_.appendChild(s),this.previewElem_=s,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue,t=e.getComponents("rgb"),i=new XF.Color([t[0],t[1],t[2],0],"rgb"),r=new XF.Color([t[0],t[1],t[2],255],"rgb"),o=["to right",(0,NA.colorToFunctionalRgbaString)(i),(0,NA.colorToFunctionalRgbaString)(r)];this.colorElem_.style.background="linear-gradient("+o.join(",")+")",this.previewElem_.style.backgroundColor=(0,NA.colorToFunctionalRgbaString)(e);var s=(0,Dxe.mapRange)(t[3],0,1,0,100);this.markerElem_.style.left=s+"%"},n.prototype.onValueChange_=function(){this.update_()},n}();b3.APaletteView=Oxe;Object.defineProperty(x3,"__esModule",{value:!0});x3.APaletteController=void 0;var uS=Sr,kxe=Ya,qF=uo,YF=Jo,Ixe=b3,Nxe=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Ixe.APaletteView(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new kxe.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(e.point){var i=e.point.x/e.bounds.width,r=this.value.rawValue,o=r.getComponents("hsv"),s=o[0],a=o[1],l=o[2];this.value.setRawValue(new qF.Color([s,a,l,i],"hsv"),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){var t=(0,uS.getStepForKey)((0,YF.getBaseStepForColor)(!0),(0,uS.getHorizontalStepKeys)(e));if(t!==0){var i=this.value.rawValue,r=i.getComponents("hsv"),o=r[0],s=r[1],a=r[2],l=r[3];this.value.setRawValue(new qF.Color([o,s,a,l+t],"hsv"),{forceEmit:!1,last:!1})}},n.prototype.onKeyUp_=function(e){var t=(0,uS.getStepForKey)((0,YF.getBaseStepForColor)(!0),(0,uS.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();x3.APaletteController=Nxe;var w3={},S3={};Object.defineProperty(S3,"__esModule",{value:!0});S3.ColorTextView=void 0;var KF=Wr,zxe=ur,Vxe=pn,lm=(0,Vxe.ClassName)("coltxt");function Fxe(n){var e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(t.reduce(function(i,r){var o=n.createElement("option");return o.textContent=r.text,o.value=r.value,i.appendChild(o),i},n.createDocumentFragment())),e}var Bxe=function(){function n(e,t){var i=this;this.element=e.createElement("div"),this.element.classList.add(lm());var r=e.createElement("div");r.classList.add(lm("m")),this.modeElem_=Fxe(e),this.modeElem_.classList.add(lm("ms")),r.appendChild(this.modeSelectElement);var o=e.createElement("div");o.classList.add(lm("mm")),o.appendChild((0,KF.createSvgIconElement)(e,"dropdown")),r.appendChild(o),this.element.appendChild(r);var s=e.createElement("div");s.classList.add(lm("w")),this.element.appendChild(s),this.textsElem_=s,this.textViews_=t.textViews,this.applyTextViews_(),(0,zxe.bindValue)(t.colorMode,function(a){i.modeElem_.value=a})}return Object.defineProperty(n.prototype,"modeSelectElement",{get:function(){return this.modeElem_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textViews",{get:function(){return this.textViews_},set:function(e){this.textViews_=e,this.applyTextViews_()},enumerable:!1,configurable:!0}),n.prototype.applyTextViews_=function(){var e=this;(0,KF.removeChildElements)(this.textsElem_);var t=this.element.ownerDocument;this.textViews_.forEach(function(i){var r=t.createElement("div");r.classList.add(lm("c")),r.appendChild(i.element),e.textsElem_.appendChild(r)})},n}();S3.ColorTextView=Bxe;Object.defineProperty(w3,"__esModule",{value:!0});w3.ColorTextController=void 0;var Uxe=Kh,jxe=ar,Hxe=mi,Wxe=ac,fX=Oo,Gxe=lc,Xxe=uo,$R=Si,qxe=Jo,Yxe=S3;function Kxe(n){return(0,jxe.createNumberFormatter)(n==="float"?2:0)}function Zxe(n,e,t){var i=(0,$R.getColorMaxComponents)(n,e)[t];return new Uxe.RangeConstraint({min:0,max:i})}function zA(n,e,t){return new Gxe.NumberTextController(n,{arrayPosition:t===0?"fst":t===3-1?"lst":"mid",baseStep:(0,qxe.getBaseStepForColor)(!1),parser:e.parser,props:Hxe.ValueMap.fromObject({draggingScale:e.colorType==="float"?.01:1,formatter:Kxe(e.colorType)}),value:(0,fX.createValue)(0,{constraint:Zxe(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}var Jxe=function(){function n(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.parser_=t.parser,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=(0,fX.createValue)(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Yxe.ColorTextView(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}return n.prototype.createComponentControllers_=function(e){var t=this,i={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},r=[zA(e,i,0),zA(e,i,1),zA(e,i,2)];return r.forEach(function(o,s){(0,Wxe.connectValues)({primary:t.value,secondary:o.value,forward:function(a){return a.rawValue.getComponents(t.colorMode.rawValue,t.colorType_)[s]},backward:function(a,l){var u=t.colorMode.rawValue,c=a.rawValue.getComponents(u,t.colorType_);return c[s]=l.rawValue,new Xxe.Color((0,$R.appendAlphaComponent)((0,$R.removeAlphaComponent)(c),c[3]),u,t.colorType_)}})}),r},n.prototype.onModeSelectChange_=function(e){var t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]},n}();w3.ColorTextController=Jxe;var M3={},C3={};Object.defineProperty(C3,"__esModule",{value:!0});C3.HPaletteView=void 0;var Qxe=qn,$xe=pn,e1e=uc,t1e=uo,VA=(0,$xe.ClassName)("hpl"),n1e=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(VA()),t.viewProps.bindTabIndex(this.element);var i=e.createElement("div");i.classList.add(VA("c")),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(VA("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue,t=e.getComponents("hsv")[0];this.markerElem_.style.backgroundColor=(0,e1e.colorToFunctionalRgbString)(new t1e.Color([t,100,100],"hsv"));var i=(0,Qxe.mapRange)(t,0,360,0,100);this.markerElem_.style.left=i+"%"},n.prototype.onValueChange_=function(){this.update_()},n}();C3.HPaletteView=n1e;Object.defineProperty(M3,"__esModule",{value:!0});M3.HPaletteController=void 0;var ZF=qn,cS=Sr,i1e=Ya,JF=uo,QF=Jo,r1e=C3,o1e=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new r1e.HPaletteView(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new i1e.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(e.point){var i=(0,ZF.mapRange)((0,ZF.constrainRange)(e.point.x,0,e.bounds.width),0,e.bounds.width,0,359),r=this.value.rawValue,o=r.getComponents("hsv"),s=o[1],a=o[2],l=o[3];this.value.setRawValue(new JF.Color([i,s,a,l],"hsv"),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){var t=(0,cS.getStepForKey)((0,QF.getBaseStepForColor)(!1),(0,cS.getHorizontalStepKeys)(e));if(t!==0){var i=this.value.rawValue,r=i.getComponents("hsv"),o=r[0],s=r[1],a=r[2],l=r[3];this.value.setRawValue(new JF.Color([o+t,s,a,l],"hsv"),{forceEmit:!1,last:!1})}},n.prototype.onKeyUp_=function(e){var t=(0,cS.getStepForKey)((0,QF.getBaseStepForColor)(!1),(0,cS.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();M3.HPaletteController=o1e;var E3={},T3={};Object.defineProperty(T3,"__esModule",{value:!0});T3.SvPaletteView=void 0;var s1e=Wr,hS=qn,a1e=pn,l1e=Si,FA=(0,a1e.ClassName)("svp"),$F=64,u1e=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(FA()),t.viewProps.bindTabIndex(this.element);var i=e.createElement("canvas");i.height=$F,i.width=$F,i.classList.add(FA("c")),this.element.appendChild(i),this.canvasElement=i;var r=e.createElement("div");r.classList.add(FA("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}return n.prototype.update_=function(){var e=(0,s1e.getCanvasContext)(this.canvasElement);if(e){for(var t=this.value.rawValue,i=t.getComponents("hsv"),r=this.canvasElement.width,o=this.canvasElement.height,s=e.getImageData(0,0,r,o),a=s.data,l=0;l<o;l++)for(var u=0;u<r;u++){var c=(0,hS.mapRange)(u,0,r,0,100),h=(0,hS.mapRange)(l,0,o,100,0),p=(0,l1e.hsvToRgbInt)(i[0],c,h),m=(l*r+u)*4;a[m]=p[0],a[m+1]=p[1],a[m+2]=p[2],a[m+3]=255}e.putImageData(s,0,0);var y=(0,hS.mapRange)(i[1],0,100,0,100);this.markerElem_.style.left=y+"%";var _=(0,hS.mapRange)(i[2],0,100,100,0);this.markerElem_.style.top=_+"%"}},n.prototype.onValueChange_=function(){this.update_()},n}();T3.SvPaletteView=u1e;Object.defineProperty(E3,"__esModule",{value:!0});E3.SvPaletteController=void 0;var eB=qn,wu=Sr,c1e=Ya,tB=uo,nB=Jo,h1e=T3,d1e=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new h1e.SvPaletteView(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new c1e.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(e.point){var i=(0,eB.mapRange)(e.point.x,0,e.bounds.width,0,100),r=(0,eB.mapRange)(e.point.y,0,e.bounds.height,100,0),o=this.value.rawValue.getComponents("hsv"),s=o[0],a=o[3];this.value.setRawValue(new tB.Color([s,i,r,a],"hsv"),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){(0,wu.isArrowKey)(e.key)&&e.preventDefault();var t=this.value.rawValue.getComponents("hsv"),i=t[0],r=t[1],o=t[2],s=t[3],a=(0,nB.getBaseStepForColor)(!1),l=(0,wu.getStepForKey)(a,(0,wu.getHorizontalStepKeys)(e)),u=(0,wu.getStepForKey)(a,(0,wu.getVerticalStepKeys)(e));l===0&&u===0||this.value.setRawValue(new tB.Color([i,r+l,o+u,s],"hsv"),{forceEmit:!1,last:!1})},n.prototype.onKeyUp_=function(e){var t=(0,nB.getBaseStepForColor)(!1),i=(0,wu.getStepForKey)(t,(0,wu.getHorizontalStepKeys)(e)),r=(0,wu.getStepForKey)(t,(0,wu.getVerticalStepKeys)(e));i===0&&r===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();E3.SvPaletteController=d1e;Object.defineProperty(_3,"__esModule",{value:!0});_3.ColorPickerController=void 0;var p1e=Kh,BA=ar,f1e=mi,m1e=ac,v1e=Oo,g1e=lc,_1e=uo,y1e=y3,x1e=x3,b1e=w3,w1e=M3,S1e=E3,M1e=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new w1e.HPaletteController(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new S1e.SvPaletteController(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new x1e.APaletteController(e,{value:this.value,viewProps:this.viewProps}),text:new g1e.NumberTextController(e,{parser:BA.parseNumber,baseStep:.1,props:f1e.ValueMap.fromObject({draggingScale:.01,formatter:(0,BA.createNumberFormatter)(2)}),value:(0,v1e.createValue)(0,{constraint:new p1e.RangeConstraint({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&(0,m1e.connectValues)({primary:this.value,secondary:this.alphaIcs_.text.value,forward:function(i){return i.rawValue.getComponents()[3]},backward:function(i,r){var o=i.rawValue.getComponents();return o[3]=r.rawValue,new _1e.Color(o,i.rawValue.mode)}}),this.textC_=new b1e.ColorTextController(e,{colorType:t.colorType,parser:BA.parseNumber,value:this.value,viewProps:this.viewProps}),this.view=new y1e.ColorPickerView(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}return Object.defineProperty(n.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),n}();_3.ColorPickerController=M1e;var P3={},A3={};Object.defineProperty(A3,"__esModule",{value:!0});A3.ColorSwatchView=void 0;var C1e=pn,E1e=uc,UA=(0,C1e.ClassName)("colsw"),T1e=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(UA()),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(UA("sw")),this.element.appendChild(i),this.swatchElem_=i;var r=e.createElement("button");r.classList.add(UA("b")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue;this.swatchElem_.style.backgroundColor=(0,E1e.colorToHexRgbaString)(e)},n.prototype.onValueChange_=function(){this.update_()},n}();A3.ColorSwatchView=T1e;Object.defineProperty(P3,"__esModule",{value:!0});P3.ColorSwatchController=void 0;var P1e=A3,A1e=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new P1e.ColorSwatchView(e,{value:this.value,viewProps:this.viewProps})}return n}();P3.ColorSwatchController=A1e;Object.defineProperty(Qp,"__esModule",{value:!0});Qp.ColorController=void 0;var iB=wo,L1e=Vg,D1e=Fg,rB=Wr,R1e=mi,O1e=ac,k1e=Jt,I1e=g3,N1e=_3,z1e=P3,V1e=function(){function n(e,t){var i=this;this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=iB.Foldable.create(t.expanded),this.swatchC_=new z1e.ColorSwatchController(e,{value:this.value,viewProps:this.viewProps});var r=this.swatchC_.view.buttonElement;r.addEventListener("blur",this.onButtonBlur_),r.addEventListener("click",this.onButtonClick_),this.textC_=new D1e.TextController(e,{parser:t.parser,props:R1e.ValueMap.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new I1e.ColorView(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new L1e.PopupController(e,{viewProps:this.viewProps}):null;var o=new N1e.ColorPickerController(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach(function(s){s.addEventListener("blur",i.onPopupChildBlur_),s.addEventListener("keydown",i.onPopupChildKeydown_)}),this.pickerC_=o,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(o.view.element),(0,O1e.connectValues)({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(s){return s.rawValue},backward:function(s,a){return a.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),(0,iB.bindFoldable)(this.foldable_,this.view.pickerElement))}return Object.defineProperty(n.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),n.prototype.onButtonBlur_=function(e){if(this.popC_){var t=this.view.element,i=(0,k1e.forceCast)(e.relatedTarget);(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}},n.prototype.onButtonClick_=function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()},n.prototype.onPopupChildBlur_=function(e){if(this.popC_){var t=this.popC_.view.element,i=(0,rB.findNextTarget)(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!(0,rB.supportsTouch)(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}},n.prototype.onPopupChildKeydown_=function(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()},n}();Qp.ColorController=V1e;var ir={};Object.defineProperty(ir,"__esModule",{value:!0});ir.colorFromRgbaNumber=ir.colorFromRgbNumber=ir.numberToRgbaColor=ir.numberToRgbColor=ir.colorToRgbaNumber=ir.colorToRgbNumber=ir.colorFromObject=void 0;var F1e=qn,_p=uo,B1e=Si;function U1e(n,e){return _p.Color.isColorObject(n)?_p.Color.fromObject(n,e):_p.Color.black(e)}ir.colorFromObject=U1e;function j1e(n){return(0,B1e.removeAlphaComponent)(n.getComponents("rgb")).reduce(function(e,t){return e<<8|Math.floor(t)&255},0)}ir.colorToRgbNumber=j1e;function H1e(n){return n.getComponents("rgb").reduce(function(e,t,i){var r=Math.floor(i===3?t*255:t)&255;return e<<8|r},0)>>>0}ir.colorToRgbaNumber=H1e;function mX(n){return new _p.Color([n>>16&255,n>>8&255,n&255],"rgb")}ir.numberToRgbColor=mX;function vX(n){return new _p.Color([n>>24&255,n>>16&255,n>>8&255,(0,F1e.mapRange)(n&255,0,255,0,1)],"rgb")}ir.numberToRgbaColor=vX;function W1e(n){return typeof n!="number"?_p.Color.black():mX(n)}ir.colorFromRgbNumber=W1e;function G1e(n){return typeof n!="number"?_p.Color.black():vX(n)}ir.colorFromRgbaNumber=G1e;var t1={},Wo={};Object.defineProperty(Wo,"__esModule",{value:!0});Wo.createColorObjectWriter=Wo.writeRgbColorObject=Wo.writeRgbaColorObject=Wo.createColorNumberWriter=Wo.createColorStringWriter=void 0;var gX=Zh,oB=ir,X1e=uc;function q1e(n){var e=(0,X1e.findColorStringifier)(n);return e?function(t,i){(0,gX.writePrimitive)(t,e(i))}:null}Wo.createColorStringWriter=q1e;function Y1e(n){var e=n?oB.colorToRgbaNumber:oB.colorToRgbNumber;return function(t,i){(0,gX.writePrimitive)(t,e(i))}}Wo.createColorNumberWriter=Y1e;function _X(n,e,t){var i=e.toRgbaObject(t);n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b),n.writeProperty("a",i.a)}Wo.writeRgbaColorObject=_X;function yX(n,e,t){var i=e.toRgbaObject(t);n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b)}Wo.writeRgbColorObject=yX;function K1e(n,e){return function(t,i){n?_X(t,i,e):yX(t,i,e)}}Wo.createColorObjectWriter=K1e;Object.defineProperty(t1,"__esModule",{value:!0});t1.NumberColorInputPlugin=void 0;var Z1e=Qp,sB=ir,e4=uc,J1e=Wo,Q1e=uo,$1e=Jo;function jA(n){var e;return!!((n==null?void 0:n.alpha)||((e=n==null?void 0:n.color)===null||e===void 0?void 0:e.alpha))}function ebe(n){return n?function(e){return(0,e4.colorToHexRgbaString)(e,"0x")}:function(e){return(0,e4.colorToHexRgbString)(e,"0x")}}function tbe(n){return"color"in n||"view"in n&&n.view==="color"}t1.NumberColorInputPlugin={id:"input-color-number",type:"input",accept:function(n,e){if(typeof n!="number"||!tbe(e))return null;var t=(0,$1e.parseColorInputParams)(e);return t?{initialValue:n,params:t}:null},binding:{reader:function(n){return jA(n.params)?sB.colorFromRgbaNumber:sB.colorFromRgbNumber},equals:Q1e.Color.equals,writer:function(n){return(0,J1e.createColorNumberWriter)(jA(n.params))}},controller:function(n){var e=jA(n.params),t="expanded"in n.params?n.params.expanded:void 0,i="picker"in n.params?n.params.picker:void 0;return new Z1e.ColorController(n.document,{colorType:"int",expanded:t!=null?t:!1,formatter:ebe(e),parser:(0,e4.createColorStringParser)("int"),pickerLayout:i!=null?i:"popup",supportsAlpha:e,value:n.value,viewProps:n.viewProps})}};var n1={};Object.defineProperty(n1,"__esModule",{value:!0});n1.ObjectColorInputPlugin=void 0;var nbe=Qp,ibe=ir,t4=uc,rbe=Wo,TM=uo,dS=Jo;function obe(n){return TM.Color.isRgbaColorObject(n)}function sbe(n){return function(e){return(0,ibe.colorFromObject)(e,n)}}function abe(n,e){return function(t){return n?(0,t4.colorToObjectRgbaString)(t,e):(0,t4.colorToObjectRgbString)(t,e)}}n1.ObjectColorInputPlugin={id:"input-color-object",type:"input",accept:function(n,e){if(!TM.Color.isColorObject(n))return null;var t=(0,dS.parseColorInputParams)(e);return t?{initialValue:n,params:t}:null},binding:{reader:function(n){return sbe((0,dS.extractColorType)(n.params))},equals:TM.Color.equals,writer:function(n){return(0,rbe.createColorObjectWriter)(obe(n.initialValue),(0,dS.extractColorType)(n.params))}},controller:function(n){var e,t=TM.Color.isRgbaColorObject(n.initialValue),i="expanded"in n.params?n.params.expanded:void 0,r="picker"in n.params?n.params.picker:void 0,o=(e=(0,dS.extractColorType)(n.params))!==null&&e!==void 0?e:"int";return new nbe.ColorController(n.document,{colorType:o,expanded:i!=null?i:!1,formatter:abe(t,o),parser:(0,t4.createColorStringParser)(o),pickerLayout:r!=null?r:"popup",supportsAlpha:t,value:n.value,viewProps:n.viewProps})}};var i1={};Object.defineProperty(i1,"__esModule",{value:!0});i1.StringColorInputPlugin=void 0;var pS=es,lbe=Qp,Ud=uc,ube=Wo,cbe=uo,n_=Jo;i1.StringColorInputPlugin={id:"input-color-string",type:"input",accept:function(n,e){if(typeof n!="string"||"view"in e&&e.view==="text")return null;var t=(0,Ud.detectStringColorFormat)(n,(0,n_.extractColorType)(e));if(!t)return null;var i=(0,Ud.findColorStringifier)(t);if(!i)return null;var r=(0,n_.parseColorInputParams)(e);return r?{initialValue:n,params:r}:null},binding:{reader:function(n){var e;return(0,Ud.createColorStringBindingReader)((e=(0,n_.extractColorType)(n.params))!==null&&e!==void 0?e:"int")},equals:cbe.Color.equals,writer:function(n){var e=(0,Ud.detectStringColorFormat)(n.initialValue,(0,n_.extractColorType)(n.params));if(!e)throw pS.TpError.shouldNeverHappen();var t=(0,ube.createColorStringWriter)(e);if(!t)throw pS.TpError.notBindable();return t}},controller:function(n){var e=(0,Ud.detectStringColorFormat)(n.initialValue,(0,n_.extractColorType)(n.params));if(!e)throw pS.TpError.shouldNeverHappen();var t=(0,Ud.findColorStringifier)(e);if(!t)throw pS.TpError.shouldNeverHappen();var i="expanded"in n.params?n.params.expanded:void 0,r="picker"in n.params?n.params.picker:void 0;return new lbe.ColorController(n.document,{colorType:e.type,expanded:i!=null?i:!1,formatter:t,parser:(0,Ud.createColorStringParser)(e.type),pickerLayout:r!=null?r:"popup",supportsAlpha:e.alpha,value:n.value,viewProps:n.viewProps})}};var $p={};Object.defineProperty($p,"__esModule",{value:!0});$p.PointNdConstraint=void 0;var hbe=function(){function n(e){this.components=e.components,this.asm_=e.assembly}return n.prototype.constrain=function(e){var t=this,i=this.asm_.toComponents(e).map(function(r,o){var s,a;return(a=(s=t.components[o])===null||s===void 0?void 0:s.constrain(r))!==null&&a!==void 0?a:r});return this.asm_.fromComponents(i)},n}();$p.PointNdConstraint=hbe;var ef={},L3={};Object.defineProperty(L3,"__esModule",{value:!0});L3.PointNdTextView=void 0;var dbe=pn,aB=(0,dbe.ClassName)("pndtxt"),pbe=function(){function n(e,t){var i=this;this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(aB()),this.textViews.forEach(function(r){var o=e.createElement("div");o.classList.add(aB("a")),o.appendChild(r.element),i.element.appendChild(o)})}return n}();L3.PointNdTextView=pbe;Object.defineProperty(ef,"__esModule",{value:!0});ef.PointNdTextController=void 0;var fbe=ac,mbe=Oo,vbe=lc,gbe=L3;function _be(n,e,t){return new vbe.NumberTextController(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",baseStep:e.axes[t].baseStep,parser:e.parser,props:e.axes[t].textProps,value:(0,mbe.createValue)(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}var ybe=function(){function n(e,t){var i=this;this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map(function(r,o){return _be(e,t,o)}),this.acs_.forEach(function(r,o){(0,fbe.connectValues)({primary:i.value,secondary:r.value,forward:function(s){return t.assembly.toComponents(s.rawValue)[o]},backward:function(s,a){var l=t.assembly.toComponents(s.rawValue);return l[o]=a.rawValue,t.assembly.fromComponents(l)}})}),this.view=new gbe.PointNdTextView(e,{textViews:this.acs_.map(function(r){return r.view})})}return n}();ef.PointNdTextController=ybe;var Al={};Object.defineProperty(Al,"__esModule",{value:!0});Al.NumberInputPlugin=Al.createRangeConstraint=Al.createStepConstraint=void 0;var U2=Ga,xbe=Yh,gI=Kh,bbe=zg,wbe=Jp,fS=ar,mS=mi,Sbe=lc,Mbe=Jx,lB=Yi,Cbe=Zh,Zc=Wn,n4=Jt;function xX(n,e){return"step"in n&&!(0,n4.isEmpty)(n.step)?new bbe.StepConstraint(n.step,e):null}Al.createStepConstraint=xX;function bX(n){return"max"in n&&!(0,n4.isEmpty)(n.max)||"min"in n&&!(0,n4.isEmpty)(n.min)?new gI.RangeConstraint({max:n.max,min:n.min}):null}Al.createRangeConstraint=bX;function Ebe(n,e){var t=[],i=xX(n,e);i&&t.push(i);var r=bX(n);r&&t.push(r);var o=(0,Zc.createListConstraint)(n.options);return o&&t.push(o),new U2.CompositeConstraint(t)}function Tbe(n){var e=n?(0,U2.findConstraint)(n,gI.RangeConstraint):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}function Pbe(n){var e=Tbe(n),t=e[0],i=e[1];return[t!=null?t:0,i!=null?i:100]}Al.NumberInputPlugin={id:"input-number",type:"input",accept:function(n,e){if(typeof n!="number")return null;var t=lB.ParamsParsers,i=(0,lB.parseParams)(e,{format:t.optional.function,max:t.optional.number,min:t.optional.number,options:t.optional.custom(Zc.parseListOptions),step:t.optional.number});return i?{initialValue:n,params:i}:null},binding:{reader:function(n){return fS.numberFromUnknown},constraint:function(n){return Ebe(n.params,n.initialValue)},writer:function(n){return Cbe.writePrimitive}},controller:function(n){var e,t,i=n.value,r=n.constraint;if(r&&(0,U2.findConstraint)(r,xbe.ListConstraint))return new wbe.ListController(n.document,{props:mS.ValueMap.fromObject({options:(e=(0,Zc.findListItems)(r))!==null&&e!==void 0?e:[]}),value:i,viewProps:n.viewProps});var o=(t="format"in n.params?n.params.format:void 0)!==null&&t!==void 0?t:(0,fS.createNumberFormatter)((0,Zc.getSuitableDecimalDigits)(r,i.rawValue));if(r&&(0,U2.findConstraint)(r,gI.RangeConstraint)){var s=Pbe(r),a=s[0],l=s[1];return new Mbe.SliderTextController(n.document,{baseStep:(0,Zc.getBaseStep)(r),parser:fS.parseNumber,sliderProps:mS.ValueMap.fromObject({maxValue:l,minValue:a}),textProps:mS.ValueMap.fromObject({draggingScale:(0,Zc.getSuitableDraggingScale)(r,i.rawValue),formatter:o}),value:i,viewProps:n.viewProps})}return new Sbe.NumberTextController(n.document,{baseStep:(0,Zc.getBaseStep)(r),parser:fS.parseNumber,props:mS.ValueMap.fromObject({draggingScale:(0,Zc.getSuitableDraggingScale)(r,i.rawValue),formatter:o}),value:i,viewProps:n.viewProps})}};var r1={},$u={},Abe=it&&it.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,o;i<r;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))};Object.defineProperty($u,"__esModule",{value:!0});$u.Point2dAssembly=$u.Point2d=void 0;var Lbe=Jt,i4=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=e,this.y=t}return n.prototype.getComponents=function(){return[this.x,this.y]},n.isObject=function(e){if((0,Lbe.isEmpty)(e))return!1;var t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")},n.equals=function(e,t){return e.x===t.x&&e.y===t.y},n.prototype.toObject=function(){return{x:this.x,y:this.y}},n}();$u.Point2d=i4;$u.Point2dAssembly={toComponents:function(n){return n.getComponents()},fromComponents:function(n){return new(i4.bind.apply(i4,Abe([void 0],n,!1)))}};var D3={};Object.defineProperty(D3,"__esModule",{value:!0});D3.Point2dView=void 0;var Dbe=Wr,Rbe=ur,Obe=pn,kbe=$o,um=(0,Obe.ClassName)("p2d"),Ibe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(um()),t.viewProps.bindClassModifiers(this.element),(0,Rbe.bindValue)(t.expanded,(0,kbe.valueToClassName)(this.element,um(void 0,"expanded")));var i=e.createElement("div");i.classList.add(um("h")),this.element.appendChild(i);var r=e.createElement("button");r.classList.add(um("b")),r.appendChild((0,Dbe.createSvgIconElement)(e,"p2dpad")),t.viewProps.bindDisabled(r),i.appendChild(r),this.buttonElement=r;var o=e.createElement("div");if(o.classList.add(um("t")),i.appendChild(o),this.textElement=o,t.pickerLayout==="inline"){var s=e.createElement("div");s.classList.add(um("p")),this.element.appendChild(s),this.pickerElement=s}else this.pickerElement=null}return n}();D3.Point2dView=Ibe;var R3={},O3={};Object.defineProperty(O3,"__esModule",{value:!0});O3.Point2dPickerView=void 0;var vS=Wr,uB=qn,Nbe=pn,Fc=(0,Nbe.ClassName)("p2dp"),zbe=function(){function n(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=t.invertsY,this.maxValue_=t.maxValue,this.element=e.createElement("div"),this.element.classList.add(Fc()),t.layout==="popup"&&this.element.classList.add(Fc(void 0,"p"));var i=e.createElement("div");i.classList.add(Fc("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;var r=e.createElementNS(vS.SVG_NS,"svg");r.classList.add(Fc("g")),this.padElement.appendChild(r),this.svgElem_=r;var o=e.createElementNS(vS.SVG_NS,"line");o.classList.add(Fc("ax")),o.setAttributeNS(null,"x1","0"),o.setAttributeNS(null,"y1","50%"),o.setAttributeNS(null,"x2","100%"),o.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(o);var s=e.createElementNS(vS.SVG_NS,"line");s.classList.add(Fc("ax")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","0"),s.setAttributeNS(null,"x2","50%"),s.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(s);var a=e.createElementNS(vS.SVG_NS,"line");a.classList.add(Fc("l")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(a),this.lineElem_=a;var l=e.createElement("div");l.classList.add(Fc("m")),this.padElement.appendChild(l),this.markerElem_=l,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}return Object.defineProperty(n.prototype,"allFocusableElements",{get:function(){return[this.padElement]},enumerable:!1,configurable:!0}),n.prototype.update_=function(){var e=this.value.rawValue.getComponents(),t=e[0],i=e[1],r=this.maxValue_,o=(0,uB.mapRange)(t,-r,+r,0,100),s=(0,uB.mapRange)(i,-r,+r,0,100),a=this.invertsY_?100-s:s;this.lineElem_.setAttributeNS(null,"x2",o+"%"),this.lineElem_.setAttributeNS(null,"y2",a+"%"),this.markerElem_.style.left=o+"%",this.markerElem_.style.top=a+"%"},n.prototype.onValueChange_=function(){this.update_()},n.prototype.onFoldableChange_=function(){this.update_()},n}();O3.Point2dPickerView=zbe;Object.defineProperty(R3,"__esModule",{value:!0});R3.Point2dPickerController=void 0;var cB=qn,E_=Sr,Vbe=Ya,hB=$u,Fbe=O3;function dB(n,e,t){return[(0,E_.getStepForKey)(e[0],(0,E_.getHorizontalStepKeys)(n)),(0,E_.getStepForKey)(e[1],(0,E_.getVerticalStepKeys)(n))*(t?1:-1)]}var Bbe=function(){function n(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.baseSteps_=t.baseSteps,this.maxValue_=t.maxValue,this.invertsY_=t.invertsY,this.view=new Fbe.Point2dPickerView(e,{invertsY:this.invertsY_,layout:t.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Vbe.PointerHandler(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(e.point){var i=this.maxValue_,r=(0,cB.mapRange)(e.point.x,0,e.bounds.width,-i,+i),o=(0,cB.mapRange)(this.invertsY_?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new hB.Point2d(r,o),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onPadKeyDown_=function(e){(0,E_.isArrowKey)(e.key)&&e.preventDefault();var t=dB(e,this.baseSteps_,this.invertsY_),i=t[0],r=t[1];i===0&&r===0||this.value.setRawValue(new hB.Point2d(this.value.rawValue.x+i,this.value.rawValue.y+r),{forceEmit:!1,last:!1})},n.prototype.onPadKeyUp_=function(e){var t=dB(e,this.baseSteps_,this.invertsY_),i=t[0],r=t[1];i===0&&r===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();R3.Point2dPickerController=Bbe;Object.defineProperty(r1,"__esModule",{value:!0});r1.Point2dController=void 0;var pB=wo,Ube=Vg,fB=Wr,jbe=ac,Hbe=Jt,Wbe=ef,Gbe=$u,Xbe=D3,qbe=R3,Ybe=function(){function n(e,t){var i=this,r,o;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=pB.Foldable.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new Ube.PopupController(e,{viewProps:this.viewProps}):null;var s=new qbe.Point2dPickerController(e,{baseSteps:[t.axes[0].baseStep,t.axes[1].baseStep],invertsY:t.invertsY,layout:t.pickerLayout,maxValue:t.maxValue,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(function(a){a.addEventListener("blur",i.onPopupChildBlur_),a.addEventListener("keydown",i.onPopupChildKeydown_)}),this.pickerC_=s,this.textC_=new Wbe.PointNdTextController(e,{assembly:Gbe.Point2dAssembly,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new Xbe.Point2dView(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(r=this.view.buttonElement)===null||r===void 0||r.addEventListener("blur",this.onPadButtonBlur_),(o=this.view.buttonElement)===null||o===void 0||o.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),(0,jbe.connectValues)({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(a){return a.rawValue},backward:function(a,l){return l.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),(0,pB.bindFoldable)(this.foldable_,this.view.pickerElement))}return n.prototype.onPadButtonBlur_=function(e){if(this.popC_){var t=this.view.element,i=(0,Hbe.forceCast)(e.relatedTarget);(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}},n.prototype.onPadButtonClick_=function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()},n.prototype.onPopupChildBlur_=function(e){if(this.popC_){var t=this.popC_.view.element,i=(0,fB.findNextTarget)(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!(0,fB.supportsTouch)(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}},n.prototype.onPopupChildKeydown_=function(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()},n}();r1.Point2dController=Ybe;var Ua={},$v={};Object.defineProperty($v,"__esModule",{value:!0});$v.writePoint2d=$v.point2dFromUnknown=void 0;var HA=$u;function Kbe(n){return HA.Point2d.isObject(n)?new HA.Point2d(n.x,n.y):new HA.Point2d}$v.point2dFromUnknown=Kbe;function Zbe(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}$v.writePoint2d=Zbe;Object.defineProperty(Ua,"__esModule",{value:!0});Ua.Point2dInputPlugin=Ua.getSuitableMaxValue=Ua.createDimensionConstraint=void 0;var wX=Ga,Jbe=Kh,SX=ar,Qbe=mi,mB=Yi,$be=es,mv=Wn,j2=$p,vB=Al,ewe=r1,gB=$v,r4=$u;function o4(n,e){if(n){var t=[],i=(0,vB.createStepConstraint)(n,e);i&&t.push(i);var r=(0,vB.createRangeConstraint)(n);return r&&t.push(r),new wX.CompositeConstraint(t)}}Ua.createDimensionConstraint=o4;function twe(n,e){return new j2.PointNdConstraint({assembly:r4.Point2dAssembly,components:[o4("x"in n?n.x:void 0,e.x),o4("y"in n?n.y:void 0,e.y)]})}function _B(n,e){var t,i,r=n&&(0,wX.findConstraint)(n,Jbe.RangeConstraint);if(r)return Math.max(Math.abs((t=r.minValue)!==null&&t!==void 0?t:0),Math.abs((i=r.maxValue)!==null&&i!==void 0?i:0));var o=(0,mv.getBaseStep)(n);return Math.max(Math.abs(o)*10,Math.abs(e)*10)}function MX(n,e){var t=e instanceof j2.PointNdConstraint?e.components[0]:void 0,i=e instanceof j2.PointNdConstraint?e.components[1]:void 0,r=_B(t,n.x),o=_B(i,n.y);return Math.max(r,o)}Ua.getSuitableMaxValue=MX;function yB(n,e){return{baseStep:(0,mv.getBaseStep)(e),constraint:e,textProps:Qbe.ValueMap.fromObject({draggingScale:(0,mv.getSuitableDraggingScale)(e,n),formatter:(0,SX.createNumberFormatter)((0,mv.getSuitableDecimalDigits)(e,n))})}}function nwe(n){if(!("y"in n))return!1;var e=n.y;return e&&"inverted"in e?!!e.inverted:!1}Ua.Point2dInputPlugin={id:"input-point2d",type:"input",accept:function(n,e){if(!r4.Point2d.isObject(n))return null;var t=mB.ParamsParsers,i=(0,mB.parseParams)(e,{expanded:t.optional.boolean,picker:t.optional.custom(mv.parsePickerLayout),x:t.optional.custom(mv.parsePointDimensionParams),y:t.optional.object({inverted:t.optional.boolean,max:t.optional.number,min:t.optional.number,step:t.optional.number})});return i?{initialValue:n,params:i}:null},binding:{reader:function(n){return gB.point2dFromUnknown},constraint:function(n){return twe(n.params,n.initialValue)},equals:r4.Point2d.equals,writer:function(n){return gB.writePoint2d}},controller:function(n){var e=n.document,t=n.value,i=n.constraint;if(!(i instanceof j2.PointNdConstraint))throw $be.TpError.shouldNeverHappen();var r="expanded"in n.params?n.params.expanded:void 0,o="picker"in n.params?n.params.picker:void 0;return new ewe.Point2dController(e,{axes:[yB(t.rawValue.x,i.components[0]),yB(t.rawValue.y,i.components[1])],expanded:r!=null?r:!1,invertsY:nwe(n.params),maxValue:MX(t.rawValue,i),parser:SX.parseNumber,pickerLayout:o!=null?o:"popup",value:t,viewProps:n.viewProps})}};var o1={},eg={},Op={},iwe=it&&it.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,o;i<r;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(Op,"__esModule",{value:!0});Op.Point3dAssembly=Op.Point3d=void 0;var rwe=Jt,s4=function(){function n(e,t,i){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),this.x=e,this.y=t,this.z=i}return n.prototype.getComponents=function(){return[this.x,this.y,this.z]},n.isObject=function(e){if((0,rwe.isEmpty)(e))return!1;var t=e.x,i=e.y,r=e.z;return!(typeof t!="number"||typeof i!="number"||typeof r!="number")},n.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z},n.prototype.toObject=function(){return{x:this.x,y:this.y,z:this.z}},n}();Op.Point3d=s4;Op.Point3dAssembly={toComponents:function(n){return n.getComponents()},fromComponents:function(n){return new(s4.bind.apply(s4,iwe([void 0],n,!1)))}};Object.defineProperty(eg,"__esModule",{value:!0});eg.writePoint3d=eg.point3dFromUnknown=void 0;var WA=Op;function owe(n){return WA.Point3d.isObject(n)?new WA.Point3d(n.x,n.y,n.z):new WA.Point3d}eg.point3dFromUnknown=owe;function swe(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}eg.writePoint3d=swe;Object.defineProperty(o1,"__esModule",{value:!0});o1.Point3dInputPlugin=void 0;var CX=ar,awe=mi,xB=Yi,lwe=es,vv=Wn,EX=$p,uwe=ef,GA=Ua,bB=eg,PM=Op;function cwe(n,e){return new EX.PointNdConstraint({assembly:PM.Point3dAssembly,components:[(0,GA.createDimensionConstraint)("x"in n?n.x:void 0,e.x),(0,GA.createDimensionConstraint)("y"in n?n.y:void 0,e.y),(0,GA.createDimensionConstraint)("z"in n?n.z:void 0,e.z)]})}function XA(n,e){return{baseStep:(0,vv.getBaseStep)(e),constraint:e,textProps:awe.ValueMap.fromObject({draggingScale:(0,vv.getSuitableDraggingScale)(e,n),formatter:(0,CX.createNumberFormatter)((0,vv.getSuitableDecimalDigits)(e,n))})}}o1.Point3dInputPlugin={id:"input-point3d",type:"input",accept:function(n,e){if(!PM.Point3d.isObject(n))return null;var t=xB.ParamsParsers,i=(0,xB.parseParams)(e,{x:t.optional.custom(vv.parsePointDimensionParams),y:t.optional.custom(vv.parsePointDimensionParams),z:t.optional.custom(vv.parsePointDimensionParams)});return i?{initialValue:n,params:i}:null},binding:{reader:function(n){return bB.point3dFromUnknown},constraint:function(n){return cwe(n.params,n.initialValue)},equals:PM.Point3d.equals,writer:function(n){return bB.writePoint3d}},controller:function(n){var e=n.value,t=n.constraint;if(!(t instanceof EX.PointNdConstraint))throw lwe.TpError.shouldNeverHappen();return new uwe.PointNdTextController(n.document,{assembly:PM.Point3dAssembly,axes:[XA(e.rawValue.x,t.components[0]),XA(e.rawValue.y,t.components[1]),XA(e.rawValue.z,t.components[2])],parser:CX.parseNumber,value:e,viewProps:n.viewProps})}};var s1={},tg={},kp={},hwe=it&&it.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,o;i<r;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(kp,"__esModule",{value:!0});kp.Point4dAssembly=kp.Point4d=void 0;var dwe=Jt,a4=function(){function n(e,t,i,r){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=0),this.x=e,this.y=t,this.z=i,this.w=r}return n.prototype.getComponents=function(){return[this.x,this.y,this.z,this.w]},n.isObject=function(e){if((0,dwe.isEmpty)(e))return!1;var t=e.x,i=e.y,r=e.z,o=e.w;return!(typeof t!="number"||typeof i!="number"||typeof r!="number"||typeof o!="number")},n.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},n.prototype.toObject=function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},n}();kp.Point4d=a4;kp.Point4dAssembly={toComponents:function(n){return n.getComponents()},fromComponents:function(n){return new(a4.bind.apply(a4,hwe([void 0],n,!1)))}};Object.defineProperty(tg,"__esModule",{value:!0});tg.writePoint4d=tg.point4dFromUnknown=void 0;var qA=kp;function pwe(n){return qA.Point4d.isObject(n)?new qA.Point4d(n.x,n.y,n.z,n.w):new qA.Point4d}tg.point4dFromUnknown=pwe;function fwe(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}tg.writePoint4d=fwe;Object.defineProperty(s1,"__esModule",{value:!0});s1.Point4dInputPlugin=void 0;var TX=ar,mwe=mi,wB=Yi,vwe=es,lp=Wn,PX=$p,gwe=ef,gS=Ua,SB=tg,AM=kp;function _we(n,e){return new PX.PointNdConstraint({assembly:AM.Point4dAssembly,components:[(0,gS.createDimensionConstraint)("x"in n?n.x:void 0,e.x),(0,gS.createDimensionConstraint)("y"in n?n.y:void 0,e.y),(0,gS.createDimensionConstraint)("z"in n?n.z:void 0,e.z),(0,gS.createDimensionConstraint)("w"in n?n.w:void 0,e.w)]})}function ywe(n,e){return{baseStep:(0,lp.getBaseStep)(e),constraint:e,textProps:mwe.ValueMap.fromObject({draggingScale:(0,lp.getSuitableDraggingScale)(e,n),formatter:(0,TX.createNumberFormatter)((0,lp.getSuitableDecimalDigits)(e,n))})}}s1.Point4dInputPlugin={id:"input-point4d",type:"input",accept:function(n,e){if(!AM.Point4d.isObject(n))return null;var t=wB.ParamsParsers,i=(0,wB.parseParams)(e,{x:t.optional.custom(lp.parsePointDimensionParams),y:t.optional.custom(lp.parsePointDimensionParams),z:t.optional.custom(lp.parsePointDimensionParams),w:t.optional.custom(lp.parsePointDimensionParams)});return i?{initialValue:n,params:i}:null},binding:{reader:function(n){return SB.point4dFromUnknown},constraint:function(n){return _we(n.params,n.initialValue)},equals:AM.Point4d.equals,writer:function(n){return SB.writePoint4d}},controller:function(n){var e=n.value,t=n.constraint;if(!(t instanceof PX.PointNdConstraint))throw vwe.TpError.shouldNeverHappen();return new gwe.PointNdTextController(n.document,{assembly:AM.Point4dAssembly,axes:e.rawValue.getComponents().map(function(i,r){return ywe(i,t.components[r])}),parser:TX.parseNumber,value:e,viewProps:n.viewProps})}};var a1={};Object.defineProperty(a1,"__esModule",{value:!0});a1.StringInputPlugin=void 0;var AX=Ga,xwe=Yh,bwe=Jp,wwe=Fg,MB=Ih,CB=mi,EB=Yi,Swe=Zh,l4=Wn;function Mwe(n){var e=[],t=(0,l4.createListConstraint)(n.options);return t&&e.push(t),new AX.CompositeConstraint(e)}a1.StringInputPlugin={id:"input-string",type:"input",accept:function(n,e){if(typeof n!="string")return null;var t=EB.ParamsParsers,i=(0,EB.parseParams)(e,{options:t.optional.custom(l4.parseListOptions)});return i?{initialValue:n,params:i}:null},binding:{reader:function(n){return MB.stringFromUnknown},constraint:function(n){return Mwe(n.params)},writer:function(n){return Swe.writePrimitive}},controller:function(n){var e,t=n.document,i=n.value,r=n.constraint;return r&&(0,AX.findConstraint)(r,xwe.ListConstraint)?new bwe.ListController(t,{props:CB.ValueMap.fromObject({options:(e=(0,l4.findListItems)(r))!==null&&e!==void 0?e:[]}),value:i,viewProps:n.viewProps}):new wwe.TextController(t,{parser:function(o){return o},props:CB.ValueMap.fromObject({formatter:MB.formatString}),value:i,viewProps:n.viewProps})}};var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});Jh.Constants=void 0;Jh.Constants={monitor:{defaultInterval:200,defaultLineCount:3}};var l1={},tf={},k3={};Object.defineProperty(k3,"__esModule",{value:!0});k3.MultiLogView=void 0;var Cwe=pn,TB=(0,Cwe.ClassName)("mll"),Ewe=function(){function n(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(TB()),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("textarea");i.classList.add(TB("i")),i.style.height="calc(var(--bld-us) * "+t.lineCount+")",i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}return n.prototype.update_=function(){var e=this,t=this.textareaElem_,i=t.scrollTop===t.scrollHeight-t.clientHeight,r=[];this.value.rawValue.forEach(function(o){o!==void 0&&r.push(e.formatter_(o))}),t.textContent=r.join(`
`),i&&(t.scrollTop=t.scrollHeight)},n.prototype.onValueUpdate_=function(){this.update_()},n}();k3.MultiLogView=Ewe;Object.defineProperty(tf,"__esModule",{value:!0});tf.MultiLogController=void 0;var Twe=k3,Pwe=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Twe.MultiLogView(e,{formatter:t.formatter,lineCount:t.lineCount,value:this.value,viewProps:this.viewProps})}return n}();tf.MultiLogController=Pwe;var nf={},I3={};Object.defineProperty(I3,"__esModule",{value:!0});I3.SingleLogView=void 0;var Awe=pn,PB=(0,Awe.ClassName)("sgl"),Lwe=function(){function n(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(PB()),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("input");i.classList.add(PB("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""},n.prototype.onValueUpdate_=function(){this.update_()},n}();I3.SingleLogView=Lwe;Object.defineProperty(nf,"__esModule",{value:!0});nf.SingleLogController=void 0;var Dwe=I3,Rwe=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Dwe.SingleLogView(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}return n}();nf.SingleLogController=Rwe;Object.defineProperty(l1,"__esModule",{value:!0});l1.BooleanMonitorPlugin=void 0;var YA=Pl,AB=Yi,Owe=Jh,kwe=tf,Iwe=nf;l1.BooleanMonitorPlugin={id:"monitor-bool",type:"monitor",accept:function(n,e){if(typeof n!="boolean")return null;var t=AB.ParamsParsers,i=(0,AB.parseParams)(e,{lineCount:t.optional.number});return i?{initialValue:n,params:i}:null},binding:{reader:function(n){return YA.boolFromUnknown}},controller:function(n){var e;return n.value.rawValue.length===1?new Iwe.SingleLogController(n.document,{formatter:YA.BooleanFormatter,value:n.value,viewProps:n.viewProps}):new kwe.MultiLogController(n.document,{formatter:YA.BooleanFormatter,lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:Owe.Constants.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}};var u1={},N3={};Object.defineProperty(N3,"__esModule",{value:!0});N3.GraphLogView=void 0;var KA=Wr,_S=qn,LX=pn,Bc=(0,LX.ClassName)("grl"),Nwe=function(){function n(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Bc()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var i=e.createElementNS(KA.SVG_NS,"svg");i.classList.add(Bc("g")),i.style.height="calc(var(--bld-us) * "+t.lineCount+")",this.element.appendChild(i),this.svgElem_=i;var r=e.createElementNS(KA.SVG_NS,"polyline");this.svgElem_.appendChild(r),this.lineElem_=r;var o=e.createElement("div");o.classList.add(Bc("t"),(0,LX.ClassName)("tt")()),this.element.appendChild(o),this.tooltipElem_=o,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}return Object.defineProperty(n.prototype,"graphElement",{get:function(){return this.svgElem_},enumerable:!1,configurable:!0}),n.prototype.update_=function(){var e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,i=this.props_.get("minValue"),r=this.props_.get("maxValue"),o=[];this.value.rawValue.forEach(function(c,h){if(c!==void 0){var p=(0,_S.mapRange)(h,0,t,0,e.width),m=(0,_S.mapRange)(c,i,r,e.height,0);o.push([p,m].join(","))}}),this.lineElem_.setAttributeNS(null,"points",o.join(" "));var s=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){s.classList.remove(Bc("t","a"));return}var l=(0,_S.mapRange)(this.cursor_.rawValue,0,t,0,e.width),u=(0,_S.mapRange)(a,i,r,e.height,0);s.style.left=l+"px",s.style.top=u+"px",s.textContent=""+this.formatter_(a),s.classList.contains(Bc("t","a"))||(s.classList.add(Bc("t","a"),Bc("t","in")),(0,KA.forceReflow)(s),s.classList.remove(Bc("t","in")))},n.prototype.onValueUpdate_=function(){this.update_()},n.prototype.onCursorChange_=function(){this.update_()},n}();N3.GraphLogView=Nwe;Object.defineProperty(u1,"__esModule",{value:!0});u1.GraphLogController=void 0;var zwe=Wr,Vwe=Oo,LB=qn,Fwe=Ya,Bwe=N3,Uwe=function(){function n(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=(0,Vwe.createValue)(-1),this.view=new Bwe.GraphLogView(e,{cursor:this.cursor_,formatter:t.formatter,lineCount:t.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!(0,zwe.supportsTouch)(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{var i=new Fwe.PointerHandler(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}return n.prototype.onGraphMouseLeave_=function(){this.cursor_.rawValue=-1},n.prototype.onGraphMouseMove_=function(e){var t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor((0,LB.mapRange)(e.offsetX,0,t.width,0,this.value.rawValue.length))},n.prototype.onGraphPointerDown_=function(e){this.onGraphPointerMove_(e)},n.prototype.onGraphPointerMove_=function(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor((0,LB.mapRange)(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))},n.prototype.onGraphPointerUp_=function(){this.cursor_.rawValue=-1},n}();u1.GraphLogController=Uwe;var c1={};Object.defineProperty(c1,"__esModule",{value:!0});c1.NumberMonitorPlugin=void 0;var DX=ar,jwe=mi,DB=Yi,RX=Jh,Hwe=Jt,Wwe=tf,Gwe=nf,Xwe=u1;function u4(n){return"format"in n&&!(0,Hwe.isEmpty)(n.format)?n.format:(0,DX.createNumberFormatter)(2)}function qwe(n){var e;return n.value.rawValue.length===1?new Gwe.SingleLogController(n.document,{formatter:u4(n.params),value:n.value,viewProps:n.viewProps}):new Wwe.MultiLogController(n.document,{formatter:u4(n.params),lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:RX.Constants.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}function Ywe(n){var e,t,i;return new Xwe.GraphLogController(n.document,{formatter:u4(n.params),lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:RX.Constants.monitor.defaultLineCount,props:jwe.ValueMap.fromObject({maxValue:(t="max"in n.params?n.params.max:null)!==null&&t!==void 0?t:100,minValue:(i="min"in n.params?n.params.min:null)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function RB(n){return"view"in n&&n.view==="graph"}c1.NumberMonitorPlugin={id:"monitor-number",type:"monitor",accept:function(n,e){if(typeof n!="number")return null;var t=DB.ParamsParsers,i=(0,DB.parseParams)(e,{format:t.optional.function,lineCount:t.optional.number,max:t.optional.number,min:t.optional.number,view:t.optional.string});return i?{initialValue:n,params:i}:null},binding:{defaultBufferSize:function(n){return RB(n)?64:1},reader:function(n){return DX.numberFromUnknown}},controller:function(n){return RB(n.params)?Ywe(n):qwe(n)}};var h1={};Object.defineProperty(h1,"__esModule",{value:!0});h1.StringMonitorPlugin=void 0;var ZA=Ih,OB=Yi,Kwe=Jh,Zwe=tf,Jwe=nf;h1.StringMonitorPlugin={id:"monitor-string",type:"monitor",accept:function(n,e){if(typeof n!="string")return null;var t=OB.ParamsParsers,i=(0,OB.parseParams)(e,{lineCount:t.optional.number,multiline:t.optional.boolean});return i?{initialValue:n,params:i}:null},binding:{reader:function(n){return ZA.stringFromUnknown}},controller:function(n){var e,t=n.value,i=t.rawValue.length>1||"multiline"in n.params&&n.params.multiline;return i?new Zwe.MultiLogController(n.document,{formatter:ZA.formatString,lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:Kwe.Constants.monitor.defaultLineCount,value:t,viewProps:n.viewProps}):new Jwe.SingleLogController(n.document,{formatter:ZA.formatString,value:t,viewProps:n.viewProps})}};var OX={};Object.defineProperty(OX,"__esModule",{value:!0});var z3={},d1={},V3={},F3={};Object.defineProperty(F3,"__esModule",{value:!0});F3.InputBinding=void 0;var Qwe=zi,$we=function(){function n(e){this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new Qwe.Emitter,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}return n.prototype.read=function(){var e=this.target.read();e!==void 0&&(this.value.rawValue=this.reader(e))},n.prototype.write_=function(e){this.writer(this.target,e)},n.prototype.onValueChange_=function(e){this.write_(e.rawValue),this.emitter.emit("change",{options:e.options,rawValue:e.rawValue,sender:this})},n}();F3.InputBinding=$we;Object.defineProperty(V3,"__esModule",{value:!0});V3.createInputBindingController=void 0;var eSe=Wh,tSe=Gh,nSe=F3,iSe=mi,rSe=Oo,oSe=qh,sSe=Yi,aSe=Jt;function lSe(n,e){var t=n.accept(e.target.read(),e.params);if((0,aSe.isEmpty)(t))return null;var i=sSe.ParamsParsers,r={target:e.target,initialValue:t.initialValue,params:t.params},o=n.binding.reader(r),s=n.binding.constraint?n.binding.constraint(r):void 0,a=(0,rSe.createValue)(o(t.initialValue),{constraint:s,equals:n.binding.equals}),l=new nSe.InputBinding({reader:o,target:e.target,value:a,writer:n.binding.writer(r)}),u=i.optional.boolean(e.params.disabled).value,c=i.optional.boolean(e.params.hidden).value,h=n.controller({constraint:s,document:e.document,initialValue:t.initialValue,params:t.params,value:l.value,viewProps:oSe.ViewProps.create({disabled:u,hidden:c})}),p=i.optional.string(e.params.label).value;return new tSe.InputBindingController(e.document,{binding:l,blade:(0,eSe.createBlade)(),props:iSe.ValueMap.fromObject({label:p!=null?p:e.target.key}),valueController:h})}V3.createInputBindingController=lSe;var B3={},U3={};Object.defineProperty(U3,"__esModule",{value:!0});U3.MonitorBinding=void 0;var uSe=Nh,cSe=zi,hSe=function(){function n(e){this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new cSe.Emitter,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}return n.prototype.dispose=function(){this.ticker.dispose()},n.prototype.read=function(){var e=this.target.read();if(e!==void 0){var t=this.value.rawValue,i=this.reader_(e);this.value.rawValue=(0,uSe.createPushedBuffer)(t,i),this.emitter.emit("update",{rawValue:i,sender:this})}},n.prototype.onTick_=function(e){this.read()},n}();U3.MonitorBinding=hSe;Object.defineProperty(B3,"__esModule",{value:!0});B3.createMonitorBindingController=void 0;var dSe=Wh,pSe=Xh,fSe=U3,mSe=Hx,vSe=jx,gSe=Nh,_Se=mi,ySe=qh,xSe=Yi,bSe=Jh,wSe=Jt;function SSe(n,e){return e===0?new vSe.ManualTicker:new mSe.IntervalTicker(n,e!=null?e:bSe.Constants.monitor.defaultInterval)}function MSe(n,e){var t,i,r,o=xSe.ParamsParsers,s=n.accept(e.target.read(),e.params);if((0,wSe.isEmpty)(s))return null;var a={target:e.target,initialValue:s.initialValue,params:s.params},l=n.binding.reader(a),u=(i=(t=o.optional.number(e.params.bufferSize).value)!==null&&t!==void 0?t:n.binding.defaultBufferSize&&n.binding.defaultBufferSize(s.params))!==null&&i!==void 0?i:1,c=o.optional.number(e.params.interval).value,h=new fSe.MonitorBinding({reader:l,target:e.target,ticker:SSe(e.document,c),value:(0,gSe.initializeBuffer)(u)}),p=o.optional.boolean(e.params.disabled).value,m=o.optional.boolean(e.params.hidden).value,y=n.controller({document:e.document,params:s.params,value:h.value,viewProps:ySe.ViewProps.create({disabled:p,hidden:m})}),_=(r=o.optional.string(e.params.label).value)!==null&&r!==void 0?r:e.target.key;return new pSe.MonitorBindingController(e.document,{binding:h,blade:(0,dSe.createBlade)(),props:_Se.ValueMap.fromObject({label:_}),valueController:y})}B3.createMonitorBindingController=MSe;var JA=it&&it.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,o;i<r;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(d1,"__esModule",{value:!0});d1.PluginPool=void 0;var CSe=Og,ESe=Gh,TSe=kg,PSe=Xh,ASe=Ux,LSe=kh,DSe=Lx(),i_=es,RSe=V3,OSe=Jt,kSe=B3,ISe=function(){function n(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}return n.prototype.getAll=function(){return JA(JA(JA([],this.pluginsMap_.blades,!0),this.pluginsMap_.inputs,!0),this.pluginsMap_.monitors,!0)},n.prototype.register=function(e){e.type==="blade"?this.pluginsMap_.blades.unshift(e):e.type==="input"?this.pluginsMap_.inputs.unshift(e):e.type==="monitor"&&this.pluginsMap_.monitors.unshift(e)},n.prototype.createInput=function(e,t,i){var r=t.read();if((0,OSe.isEmpty)(r))throw new i_.TpError({context:{key:t.key},type:"nomatchingcontroller"});var o=this.pluginsMap_.inputs.reduce(function(s,a){return s!=null?s:(0,RSe.createInputBindingController)(a,{document:e,target:t,params:i})},null);if(o)return o;throw new i_.TpError({context:{key:t.key},type:"nomatchingcontroller"})},n.prototype.createMonitor=function(e,t,i){var r=this.pluginsMap_.monitors.reduce(function(o,s){return o!=null?o:(0,kSe.createMonitorBindingController)(s,{document:e,params:i,target:t})},null);if(r)return r;throw new i_.TpError({context:{key:t.key},type:"nomatchingcontroller"})},n.prototype.createBlade=function(e,t){var i=this.pluginsMap_.blades.reduce(function(r,o){return r!=null?r:(0,ASe.createBladeController)(o,{document:e,params:t})},null);if(!i)throw new i_.TpError({type:"nomatchingview",context:{params:t}});return i},n.prototype.createBladeApi=function(e){var t=this;if(e instanceof ESe.InputBindingController)return new CSe.InputBindingApi(e);if(e instanceof PSe.MonitorBindingController)return new TSe.MonitorBindingApi(e);if(e instanceof DSe.RackController)return new LSe.RackApi(e,this);var i=this.pluginsMap_.blades.reduce(function(r,o){return r!=null?r:o.api({controller:e,pool:t})},null);if(!i)throw i_.TpError.shouldNeverHappen();return i},n}();d1.PluginPool=ISe;Object.defineProperty(z3,"__esModule",{value:!0});z3.createDefaultPluginPool=void 0;var NSe=Cx,zSe=Ox,VSe=Nx,FSe=Bx,BSe=e1,USe=t1,jSe=n1,HSe=i1,WSe=Al,GSe=Ua,XSe=o1,qSe=s1,YSe=a1,KSe=l1,ZSe=c1,JSe=h1,QSe=d1;function $Se(){var n=new QSe.PluginPool;return[GSe.Point2dInputPlugin,XSe.Point3dInputPlugin,qSe.Point4dInputPlugin,YSe.StringInputPlugin,WSe.NumberInputPlugin,HSe.StringColorInputPlugin,jSe.ObjectColorInputPlugin,USe.NumberColorInputPlugin,BSe.BooleanInputPlugin,KSe.BooleanMonitorPlugin,JSe.StringMonitorPlugin,ZSe.NumberMonitorPlugin,NSe.ButtonBladePlugin,zSe.FolderBladePlugin,VSe.SeparatorBladePlugin,FSe.TabBladePlugin].forEach(function(e){n.register(e)}),n}z3.createDefaultPluginPool=$Se;(function(n){var e=it&&it.__createBinding||(Object.create?function(r,o,s,a){a===void 0&&(a=s),Object.defineProperty(r,a,{enumerable:!0,get:function(){return o[s]}})}:function(r,o,s,a){a===void 0&&(a=s),r[a]=o[s]}),t=it&&it.__exportStar||function(r,o){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,r,s)};Object.defineProperty(n,"__esModule",{value:!0}),n.createBladeController=void 0,t(jl,n),t(NG,n),t(zG,n),t(wr,n),t(bx,n),t(wx,n),t(Sx,n),t(Mx,n),t(Cx,n),t(sc,n),t(Zp,n),t(Ex,n),t(Wh,n),t(wo,n),t(Tx,n),t(Px,n),t(Dx,n),t(Ox,n),t(Og,n),t(Gh,n),t(Kp,n),t(a3,n),t(Lg,n),t(kg,n),t(Xh,n),t(kx,n),t(Ix,n),t(Nx,n),t(zx,n),t(Vx,n),t(Fx,n),t(Ng,n),t(Bx,n);var i=Ux;Object.defineProperty(n,"createBladeController",{enumerable:!0,get:function(){return i.createBladeController}}),t(jx,n),t(Hx,n),t(HG,n),t(Ga,n),t(GG,n),t(Yh,n),t(Kh,n),t(zg,n),t(XG,n),t(Jp,n),t(Vg,n),t(Fg,n),t(qG,n),t(Pl,n),t(KG,n),t(ar,n),t(eX,n),t(qx,n),t(Ih,n),t(Nh,n),t(zi,n),t(ur,n),t(nX,n),t(mi,n),t(ac,n),t(Oo,n),t(qh,n),t(lc,n),t(Kx,n),t(Jx,n),t(Yx,n),t(Zx,n),t(Qx,n),t(pn,n),t(Wx,n),t(Ax,n),t(Ya,n),t(Gx,n),t($o,n),t(Xx,n),t(oX,n),t(f3,n),t(Wr,n),t(qn,n),t(Yi,n),t(sX,n),t(Zh,n),t(es,n),t(Sr,n),t(Wn,n),t($x,n),t(e1,n),t(Qp,n),t(ir,n),t(uc,n),t(uo,n),t(t1,n),t(n1,n),t(i1,n),t($p,n),t(ef,n),t(Al,n),t(r1,n),t(Ua,n),t(o1,n),t(s1,n),t(a1,n),t(Jh,n),t(Jt,n),t(l1,n),t(tf,n),t(nf,n),t(u1,n),t(c1,n),t(h1,n),t(OX,n),t(z3,n),t(d1,n)})(IG);const eMe={...OG,shadowDistance:Number},tMe={...kG,shadowDistance:new ci(2e3),shadowResolution:new ci(1024)};class gv extends gx{constructor(){super(Yue),q(this,"defaultShadowResolution",1024),q(this,"shadowDistanceState",new Pt(void 0)),this.createEffect(()=>{const e=this.lightState.get();if(e)return St.add(e.target),St.attach(e),()=>{St.remove(e.target),St.remove(e)}},[this.lightState.get]),this.createEffect(()=>{var e,t;const i=this.lightState.get();if(!i)return;const r=dt().userData.manager,o=r?Math.max(IG.mapRange(r.innerZ*(r.fov/75)*(1/r.zoom),500,1e3,1,1.5),1):1,s=(t=(e=this.shadowDistanceState.get())!=null?e:jR())!=null?t:2e3,a=i.shadow.camera;a.zoom=500/o/s,a.updateProjectionMatrix();const l=this.shadowBiasComputedState.get(),u=this.shadowResolutionComputedState.get();if(!l||!u)return;const c=l;return i.shadow.bias=c*o*(this.defaultShadowResolution/u)*(s/2e3),()=>{i.shadow.bias=c}},[this.lightState.get,this.shadowDistanceState.get,jR,dt,this.shadowBiasComputedState.get,this.shadowResolutionComputedState.get]),this.createEffect(()=>{const e=this.lightState.get();if(!e)return;const t=dt(),i=Yn(()=>{const r=Dn(t),o=Dn(this.outerObject3d);e.position.copy(r).add(o),e.target.position.copy(r).sub(o)});return()=>{i.cancel()}},[dt,this.lightState.get])}getWorldPosition(){return Ba(Dn(this.outerObject3d))}get shadowDistance(){return this.shadowDistanceState.get()}set shadowDistance(e){this.shadowDistanceState.set(e)}}q(gv,"componentName","directionalLight"),q(gv,"defaults",tMe),q(gv,"schema",eMe);const nMe=Object.freeze(Object.defineProperty({__proto__:null,default:gv},Symbol.toStringTag,{value:"Module"})),iMe={..._x,groundColor:String},rMe={...yx,groundColor:"#ffffff",castShadow:!1};class _v extends gx{constructor(){super(jue),this.innerY=0}get groundColor(){const e=this.lightState.get();return e?"#"+e.groundColor.getHexString():"#ffffff"}set groundColor(e){this.cancelHandle("groundColor",()=>this.lightState.get(t=>t&&(t.groundColor=new vt(e))))}get castShadow(){return!1}set castShadow(e){}}q(_v,"componentName","skyLight"),q(_v,"defaults",rMe),q(_v,"schema",iMe);const oMe=Object.freeze(Object.defineProperty({__proto__:null,default:_v},Symbol.toStringTag,{value:"Module"})),sMe={..._x,decay:Number,distance:Number},aMe={...yx,decay:1,distance:0};class ry extends gx{constructor(){super(Xue)}get decay(){const e=this.lightState.get();return e?e.decay:1}set decay(e){this.cancelHandle("decay",()=>this.lightState.get(t=>t&&(t.decay=e)))}get distance(){const e=this.lightState.get();return e?e.distance:0}set distance(e){this.cancelHandle("distance",()=>this.lightState.get(t=>t&&(t.distance=e)))}}q(ry,"componentName","pointLight"),q(ry,"defaults",aMe),q(ry,"schema",sMe);const lMe={..._x,angle:Number,penumbra:Number,decay:Number,distance:Number},uMe={...yx,angle:1,penumbra:0,decay:1,distance:0};class oy extends gx{constructor(){super(Wue,gce),this.innerY=0}get angle(){const e=this.lightState.get();return e?e.angle:1}set angle(e){this.cancelHandle("angle",()=>this.lightState.get(t=>t&&(t.angle=e)))}get penumbra(){const e=this.lightState.get();return e?e.penumbra:0}set penumbra(e){this.cancelHandle("penumbra",()=>this.lightState.get(t=>t&&(t.penumbra=e)))}get decay(){const e=this.lightState.get();return e?e.decay:1}set decay(e){this.cancelHandle("decay",()=>this.lightState.get(t=>t&&(t.decay=e)))}get distance(){const e=this.lightState.get();return e?e.distance:0}set distance(e){this.cancelHandle("distance",()=>this.lightState.get(t=>t&&(t.distance=e)))}}q(oy,"componentName","spotLight"),q(oy,"defaults",uMe),q(oy,"schema",lMe);const cMe={...Uh,onKeyPress:Function,onKeyUp:Function,onKeyDown:Function},hMe={...jh,onKeyPress:void 0,onKeyUp:void 0,onKeyDown:void 0},[dMe,pMe]=lo(),[kB,fMe]=lo(),[IB,mMe]=lo(),bo=new Set,NB=n=>(n=n.length===1?n.toLowerCase():n,n===" "&&(n="Space"),n);Vt(()=>{if(ao()||ta()&&dt()===di)return;const n=Yn(()=>bo.size>0&&IB()),e=i=>{const r=NB(i.key);bo.add(r),dMe(r)},t=i=>{const r=NB(i.key);bo.delete(r),kB(r),!bo.size&&IB()};return n.watch($C(()=>{if(!bo.size)return;const i=[...bo];bo.clear();for(const r of i)kB(r)})),document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{n.cancel(),document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[ao,ta,dt]);class yv extends nc{constructor(){super(),q(this,"onKeyPress"),q(this,"onKeyUp"),q(this,"onKeyDown"),this.watch(mMe(()=>{if(this.onKeyPress){if(!bo.size){this.onKeyPress("",bo);return}for(const e of bo)this.onKeyPress(e,bo)}})),this.watch(fMe(e=>{var t;return(t=this.onKeyUp)==null?void 0:t.call(this,e,bo)})),this.watch(pMe(e=>{var t;return(t=this.onKeyDown)==null?void 0:t.call(this,e,bo)}))}}q(yv,"componentName","keyboard"),q(yv,"defaults",hMe),q(yv,"schema",cMe);const vMe=new yv;Ii.delete(vMe);"getGamepads"in navigator&&Yn(()=>{for(const n of navigator.getGamepads())if(n){for(let e=0;e<n.buttons.length;e++){const t=n.buttons[e],i=Math.round(t.value*100)+"%";t.pressed&&console.log(e,t.value,t.pressed,i)}for(let e=0;e<n.axes.length;e++){const t=Number(n.axes[e].toFixed(2));t!==0&&console.log(e,t)}}});const gMe=new Map,p1=(n,e)=>{for(const t of e)gMe.set(t,n);return e};p1("image",["jpg","jpeg","gif","png","svg","tiff","webp","hdr"]);p1("audio",["m4a","mp3","wav","wma","ogg","flax","flac","aac"]);p1("plainText",["ls","js","ts","jsx","tsx","py","txt","md","json","yaml","c","cpp","h","hpp","css","scss","sass","html"]);p1("model",["gltf","glb","fbx"]);p1("scene",["l3d"]);const hRe=new WeakSet,_Me={...Uh,variant:Number},yMe={...jh,variant:1},j3=n=>{const e=document.createElement("div");return e.innerHTML=n,e.children[0]};class LM extends nc{constructor(){super(),q(this,"variantState",new Pt(1)),this.createEffect(()=>{const e=this.variantState.get(),t=j3(`
                <img
                  src="${iW}reticle${e}.png"
                  style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); pointer-events: none; user-select: none; width: 20px;"
                ></img>
            `);return Vn.appendChild(t),()=>{Vn.removeChild(t)}},[this.variantState.get])}get variant(){return this.variantState.get()}set variant(e){this.variantState.set(e)}}q(LM,"componentName","reticle"),q(LM,"defaults",yMe),q(LM,"schema",_Me);const DM=(n,e)=>{const t=e.x-n.x,i=e.y-n.y;return Math.sqrt(t*t+i*i)},xMe=(n,e)=>{const t=e.x-n.x,i=e.y-n.y;return wMe(Math.atan2(i,t))},bMe=(n,e,t)=>{const i={x:0,y:0};return t=c4(t),i.x=n.x-e*Math.cos(t),i.y=n.y-e*Math.sin(t),i},c4=n=>n*(Math.PI/180),wMe=n=>n*(180/Math.PI),SMe=n=>isNaN(n.buttons)?n.pressure!==0:n.buttons!==0,QA=new Map,zB=n=>{QA.has(n)&&clearTimeout(QA.get(n)),QA.set(n,setTimeout(n,100))},H2=(n,e,t)=>{const i=e.split(/[ ,]+/g);let r;for(let o=0;o<i.length;o+=1)r=i[o],n.addEventListener?n.addEventListener(r,t,!1):n.attachEvent&&n.attachEvent(r,t)},VB=(n,e,t)=>{const i=e.split(/[ ,]+/g);let r;for(let o=0;o<i.length;o+=1)r=i[o],n.removeEventListener?n.removeEventListener(r,t):n.detachEvent&&n.detachEvent(r,t)},kX=n=>(n.preventDefault(),n.type.match(/^touch/)?n.changedTouches:n),FB=()=>{const n=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:n,y:e}},h4=(n,e)=>{e.top||e.right||e.bottom||e.left?(n.style.top=e.top,n.style.right=e.right,n.style.bottom=e.bottom,n.style.left=e.left):(n.style.left=e.x+"px",n.style.top=e.y+"px")},_I=(n,e,t)=>{const i=IX(n);for(let r in i)if(i.hasOwnProperty(r))if(typeof e=="string")i[r]=e+" "+t;else{let o="";for(let s=0,a=e.length;s<a;s+=1)o+=e[s]+" "+t+", ";i[r]=o.slice(0,-2)}return i},MMe=(n,e)=>{const t=IX(n);for(let i in t)t.hasOwnProperty(i)&&(t[i]=e);return t},IX=n=>{const e={};return e[n]="",["webkit","Moz","o"].forEach(function(t){e[t+n.charAt(0).toUpperCase()+n.slice(1)]=""}),e},$A=(n,e)=>{for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n},CMe=(n,e)=>{const t={};for(let i in n)n.hasOwnProperty(i)&&e.hasOwnProperty(i)?t[i]=e[i]:n.hasOwnProperty(i)&&(t[i]=n[i]);return t},d4=(n,e)=>{if(n.length)for(let t=0,i=n.length;t<i;t+=1)e(n[t]);else e(n)},EMe=(n,e,t)=>({x:Math.min(Math.max(n.x,e.x-t),e.x+t),y:Math.min(Math.max(n.y,e.y-t),e.y+t)});var TMe="ontouchstart"in window,PMe=!!window.PointerEvent,AMe=!!window.MSPointerEvent,r_={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Xm,Gy={};PMe?Xm=r_.pointer:AMe?Xm=r_.MSPointer:TMe?(Xm=r_.touch,Gy=r_.mouse):Xm=r_.mouse;function cc(){}cc.prototype.on=function(n,e){var t=this,i=n.split(/[ ,]+/g),r;t._handlers_=t._handlers_||{};for(var o=0;o<i.length;o+=1)r=i[o],t._handlers_[r]=t._handlers_[r]||[],t._handlers_[r].push(e);return t};cc.prototype.off=function(n,e){var t=this;return t._handlers_=t._handlers_||{},n===void 0?t._handlers_={}:e===void 0?t._handlers_[n]=null:t._handlers_[n]&&t._handlers_[n].indexOf(e)>=0&&t._handlers_[n].splice(t._handlers_[n].indexOf(e),1),t};cc.prototype.trigger=function(n,e){var t=this,i=n.split(/[ ,]+/g),r;t._handlers_=t._handlers_||{};for(var o=0;o<i.length;o+=1)r=i[o],t._handlers_[r]&&t._handlers_[r].length&&t._handlers_[r].forEach(function(s){s.call(t,{type:r,target:t},e)})};cc.prototype.config=function(n){var e=this;e.options=e.defaults||{},n&&(e.options=CMe(e.options,n))};cc.prototype.bindEvt=function(n,e){var t=this;return t._domHandlers_=t._domHandlers_||{},t._domHandlers_[e]=function(){typeof t["on"+e]=="function"?t["on"+e].apply(t,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},H2(n,Xm[e],t._domHandlers_[e]),Gy[e]&&H2(n,Gy[e],t._domHandlers_[e]),t};cc.prototype.unbindEvt=function(n,e){var t=this;return t._domHandlers_=t._domHandlers_||{},VB(n,Xm[e],t._domHandlers_[e]),Gy[e]&&VB(n,Gy[e],t._domHandlers_[e]),delete t._domHandlers_[e],this};function cr(n,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=n,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=cr.id,cr.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}cr.prototype=new cc;cr.constructor=cr;cr.id=0;cr.prototype.buildEl=function(n){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};cr.prototype.stylize=function(){if(this.options.dataOnly)return this;var n=this.options.fadeTime+"ms",e=MMe("borderRadius","50%"),t=_I("transition","opacity",n),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},$A(i.el,t),this.options.shape==="circle"&&$A(i.back,e),$A(i.front,e),this.applyStyles(i),this};cr.prototype.applyStyles=function(n){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var t in n[e])this.ui[e].style[t]=n[e][t];return this};cr.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};cr.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};cr.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};cr.prototype.show=function(n){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof n=="function"&&n.call(this)},e.options.fadeTime)),e};cr.prototype.hide=function(n){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var t=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=t,typeof n=="function"&&n.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const t=e.options.restJoystick,i={};i.x=t===!0||t.x!==!1?0:e.instance.frontPosition.x,i.y=t===!0||t.y!==!1?0:e.instance.frontPosition.y,e.setPosition(n,i)}return e};cr.prototype.setPosition=function(n,e){var t=this;t.frontPosition={x:e.x,y:e.y};var i=t.options.fadeTime+"ms",r={};r.front=_I("transition",["top","left"],i);var o={front:{}};o.front={left:t.frontPosition.x+"px",top:t.frontPosition.y+"px"},t.applyStyles(r),t.applyStyles(o),t.restTimeout=setTimeout(function(){typeof n=="function"&&n.call(t),t.restCallback()},t.options.fadeTime)};cr.prototype.restCallback=function(){var n=this,e={};e.front=_I("transition","none",""),n.applyStyles(e),n.trigger("rested",n.instance)};cr.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};cr.prototype.computeDirection=function(n){var e=n.angle.radian,t=Math.PI/4,i=Math.PI/2,r,o,s;if(e>t&&e<t*3&&!n.lockX?r="up":e>-t&&e<=t&&!n.lockY?r="left":e>-t*3&&e<=-t&&!n.lockX?r="down":n.lockY||(r="right"),n.lockY||(e>-i&&e<i?o="left":o="right"),n.lockX||(e>0?s="up":s="down"),n.force>this.options.threshold){var a={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(a[l]=this.direction[l]);var u={};this.direction={x:o,y:s,angle:r},n.direction=this.direction;for(l in a)a[l]===this.direction[l]&&(u[l]=!0);if(u.x&&u.y&&u.angle)return n;(!u.x||!u.y)&&this.trigger("plain",n),u.x||this.trigger("plain:"+o,n),u.y||this.trigger("plain:"+s,n),u.angle||this.trigger("dir dir:"+r,n)}else this.resetDirection();return n};function Ni(n,e){var t=this;t.nipples=[],t.idles=[],t.actives=[],t.ids=[],t.pressureIntervals={},t.manager=n,t.id=Ni.id,Ni.id+=1,t.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},t.config(e),(t.options.mode==="static"||t.options.mode==="semi")&&(t.options.multitouch=!1),t.options.multitouch||(t.options.maxNumberOfNipples=1);const i=getComputedStyle(t.options.zone.parentElement);return i&&i.display==="flex"&&(t.parentIsFlex=!0),t.updateBox(),t.prepareNipples(),t.bindings(),t.begin(),t.nipples}Ni.prototype=new cc;Ni.constructor=Ni;Ni.id=0;Ni.prototype.prepareNipples=function(){var n=this,e=n.nipples;e.on=n.on.bind(n),e.off=n.off.bind(n),e.options=n.options,e.destroy=n.destroy.bind(n),e.ids=n.ids,e.id=n.id,e.processOnMove=n.processOnMove.bind(n),e.processOnEnd=n.processOnEnd.bind(n),e.get=function(t){if(t===void 0)return e[0];for(var i=0,r=e.length;i<r;i+=1)if(e[i].identifier===t)return e[i];return!1}};Ni.prototype.bindings=function(){var n=this;n.bindEvt(n.options.zone,"start"),n.options.zone.style.touchAction="none",n.options.zone.style.msTouchAction="none"};Ni.prototype.begin=function(){var n=this,e=n.options;if(e.mode==="static"){var t=n.createNipple(e.position,n.manager.getIdentifier());t.add(),n.idles.push(t)}};Ni.prototype.createNipple=function(n,e){var t=this,i=t.manager.scroll,r={},o=t.options,s={x:t.parentIsFlex?i.x:i.x+t.box.left,y:t.parentIsFlex?i.y:i.y+t.box.top};if(n.x&&n.y)r={x:n.x-s.x,y:n.y-s.y};else if(n.top||n.right||n.bottom||n.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=n.top,a.style.right=n.right,a.style.bottom=n.bottom,a.style.left=n.left,a.style.position="absolute",o.zone.appendChild(a);var l=a.getBoundingClientRect();o.zone.removeChild(a),r=n,n={x:l.left+i.x,y:l.top+i.y}}var u=new cr(t,{color:o.color,size:o.size,threshold:o.threshold,fadeTime:o.fadeTime,dataOnly:o.dataOnly,restJoystick:o.restJoystick,restOpacity:o.restOpacity,mode:o.mode,identifier:e,position:n,zone:o.zone,frontPosition:{x:0,y:0},shape:o.shape});return o.dataOnly||(h4(u.ui.el,r),h4(u.ui.front,u.frontPosition)),t.nipples.push(u),t.trigger("added "+u.identifier+":added",u),t.manager.trigger("added "+u.identifier+":added",u),t.bindNipple(u),u};Ni.prototype.updateBox=function(){var n=this;n.box=n.options.zone.getBoundingClientRect()};Ni.prototype.bindNipple=function(n){var e=this,t,i=function(r,o){t=r.type+" "+o.id+":"+r.type,e.trigger(t,o)};n.on("destroyed",e.onDestroyed.bind(e)),n.on("shown hidden rested dir plain",i),n.on("dir:up dir:right dir:down dir:left",i),n.on("plain:up plain:right plain:down plain:left",i)};Ni.prototype.pressureFn=function(n,e,t){var i=this,r=0;clearInterval(i.pressureIntervals[t]),i.pressureIntervals[t]=setInterval(function(){var o=n.force||n.pressure||n.webkitForce||0;o!==r&&(e.trigger("pressure",o),i.trigger("pressure "+e.identifier+":pressure",o),r=o)}.bind(i),100)};Ni.prototype.onstart=function(n){var e=this,t=e.options,i=n;n=kX(n),e.updateBox();var r=function(o){e.actives.length<t.maxNumberOfNipples?e.processOnStart(o):i.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(s){if(Object.values(i.touches).findIndex(function(l){return l.identifier===s})<0){var a=[n[0]];a.identifier=s,e.processOnEnd(a)}}),e.actives.length<t.maxNumberOfNipples&&e.processOnStart(o))};return d4(n,r),e.manager.bindDocument(),!1};Ni.prototype.processOnStart=function(n){var e=this,t=e.options,i,r=e.manager.getIdentifier(n),o=n.force||n.pressure||n.webkitForce||0,s={x:n.pageX,y:n.pageY},a=e.getOrCreate(r,s);a.identifier!==r&&e.manager.removeIdentifier(a.identifier),a.identifier=r;var l=function(c){c.trigger("start",c),e.trigger("start "+c.id+":start",c),c.show(),o>0&&e.pressureFn(n,c,c.identifier),e.processOnMove(n)};if((i=e.idles.indexOf(a))>=0&&e.idles.splice(i,1),e.actives.push(a),e.ids.push(a.identifier),t.mode!=="semi")l(a);else{var u=DM(s,a.position);if(u<=t.catchDistance)l(a);else{a.destroy(),e.processOnStart(n);return}}return a};Ni.prototype.getOrCreate=function(n,e){var t=this,i=t.options,r;return/(semi|static)/.test(i.mode)?(r=t.idles[0],r?(t.idles.splice(0,1),r):i.mode==="semi"?t.createNipple(e,n):(console.warn("Coudln't find the needed nipple."),!1)):(r=t.createNipple(e,n),r)};Ni.prototype.processOnMove=function(n){var e=this,t=e.options,i=e.manager.getIdentifier(n),r=e.nipples.get(i),o=e.manager.scroll;if(!SMe(n)){this.processOnEnd(n);return}if(!r){console.error("Found zombie joystick with ID "+i),e.manager.removeIdentifier(i);return}if(t.dynamicPage){var s=r.el.getBoundingClientRect();r.position={x:o.x+s.left,y:o.y+s.top}}r.identifier=i;var a=r.options.size/2,l={x:n.pageX,y:n.pageY};t.lockX&&(l.y=r.position.y),t.lockY&&(l.x=r.position.x);var u=DM(l,r.position),c=xMe(l,r.position),h=c4(c),p=u/a,m={distance:u,position:l},y,_;if(r.options.shape==="circle"?(y=Math.min(u,a),_=bMe(r.position,y,c)):(_=EMe(l,r.position,a),y=DM(_,r.position)),t.follow){if(u>a){let M=l.x-_.x,C=l.y-_.y;r.position.x+=M,r.position.y+=C,r.el.style.top=r.position.y-(e.box.top+o.y)+"px",r.el.style.left=r.position.x-(e.box.left+o.x)+"px",u=DM(l,r.position)}}else l=_,u=y;var g=l.x-r.position.x,b=l.y-r.position.y;r.frontPosition={x:g,y:b},t.dataOnly||h4(r.ui.front,r.frontPosition);var w={identifier:r.identifier,position:l,force:p,pressure:n.force||n.pressure||n.webkitForce||0,distance:u,angle:{radian:h,degree:c},vector:{x:g/a,y:-b/a},raw:m,instance:r,lockX:t.lockX,lockY:t.lockY};w=r.computeDirection(w),w.angle={radian:c4(180-c),degree:180-c},r.trigger("move",w),e.trigger("move "+r.id+":move",w)};Ni.prototype.processOnEnd=function(n){var e=this,t=e.options,i=e.manager.getIdentifier(n),r=e.nipples.get(i),o=e.manager.removeIdentifier(r.identifier);!r||(t.dataOnly||r.hide(function(){t.mode==="dynamic"&&(r.trigger("removed",r),e.trigger("removed "+r.id+":removed",r),e.manager.trigger("removed "+r.id+":removed",r),r.destroy())}),clearInterval(e.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),e.trigger("end "+r.id+":end",r),e.ids.indexOf(r.identifier)>=0&&e.ids.splice(e.ids.indexOf(r.identifier),1),e.actives.indexOf(r)>=0&&e.actives.splice(e.actives.indexOf(r),1),/(semi|static)/.test(t.mode)?e.idles.push(r):e.nipples.indexOf(r)>=0&&e.nipples.splice(e.nipples.indexOf(r),1),e.manager.unbindDocument(),/(semi|static)/.test(t.mode)&&(e.manager.ids[o.id]=o.identifier))};Ni.prototype.onDestroyed=function(n,e){var t=this;t.nipples.indexOf(e)>=0&&t.nipples.splice(t.nipples.indexOf(e),1),t.actives.indexOf(e)>=0&&t.actives.splice(t.actives.indexOf(e),1),t.idles.indexOf(e)>=0&&t.idles.splice(t.idles.indexOf(e),1),t.ids.indexOf(e.identifier)>=0&&t.ids.splice(t.ids.indexOf(e.identifier),1),t.manager.removeIdentifier(e.identifier),t.manager.unbindDocument()};Ni.prototype.destroy=function(){var n=this;n.unbindEvt(n.options.zone,"start"),n.nipples.forEach(function(t){t.destroy()});for(var e in n.pressureIntervals)n.pressureIntervals.hasOwnProperty(e)&&clearInterval(n.pressureIntervals[e]);n.trigger("destroyed",n.nipples),n.manager.unbindDocument(),n.off()};function Tr(n){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=FB(),e.config(n),e.prepareCollections();var t=function(){var r;e.collections.forEach(function(o){o.forEach(function(s){r=s.el.getBoundingClientRect(),s.position={x:e.scroll.x+r.left,y:e.scroll.y+r.top}})})};H2(window,"resize",function(){zB(t)});var i=function(){e.scroll=FB()};return H2(window,"scroll",function(){zB(i)}),e.collections}Tr.prototype=new cc;Tr.constructor=Tr;Tr.prototype.prepareCollections=function(){var n=this;n.collections.create=n.create.bind(n),n.collections.on=n.on.bind(n),n.collections.off=n.off.bind(n),n.collections.destroy=n.destroy.bind(n),n.collections.get=function(e){var t;return n.collections.every(function(i){return t=i.get(e),!t}),t}};Tr.prototype.create=function(n){return this.createCollection(n)};Tr.prototype.createCollection=function(n){var e=this,t=new Ni(e,n);return e.bindCollection(t),e.collections.push(t),t};Tr.prototype.bindCollection=function(n){var e=this,t,i=function(r,o){t=r.type+" "+o.id+":"+r.type,e.trigger(t,o)};n.on("destroyed",e.onDestroyed.bind(e)),n.on("shown hidden rested dir plain",i),n.on("dir:up dir:right dir:down dir:left",i),n.on("plain:up plain:right plain:down plain:left",i)};Tr.prototype.bindDocument=function(){var n=this;n.binded||(n.bindEvt(document,"move").bindEvt(document,"end"),n.binded=!0)};Tr.prototype.unbindDocument=function(n){var e=this;(!Object.keys(e.ids).length||n===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};Tr.prototype.getIdentifier=function(n){var e;return n?(e=n.identifier===void 0?n.pointerId:n.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};Tr.prototype.removeIdentifier=function(n){var e={};for(var t in this.ids)if(this.ids[t]===n){e.id=t,e.identifier=this.ids[t],delete this.ids[t];break}return e};Tr.prototype.onmove=function(n){var e=this;return e.onAny("move",n),!1};Tr.prototype.onend=function(n){var e=this;return e.onAny("end",n),!1};Tr.prototype.oncancel=function(n){var e=this;return e.onAny("end",n),!1};Tr.prototype.onAny=function(n,e){var t=this,i,r="processOn"+n.charAt(0).toUpperCase()+n.slice(1);e=kX(e);var o=function(a,l,u){u.ids.indexOf(l)>=0&&(u[r](a),a._found_=!0)},s=function(a){i=t.getIdentifier(a),d4(t.collections,o.bind(null,a,i)),a._found_||t.removeIdentifier(i)};return d4(e,s),!1};Tr.prototype.destroy=function(){var n=this;n.unbindDocument(!0),n.ids={},n.index=0,n.collections.forEach(function(e){e.destroy()}),n.off()};Tr.prototype.onDestroyed=function(n,e){var t=this;if(t.collections.indexOf(e)<0)return!1;t.collections.splice(t.collections.indexOf(e),1)};const BB=new Tr,LMe={create:function(n){return BB.create(n)},factory:BB},DMe={...Uh,onMove:Function,onMoveStart:Function,onMoveEnd:Function,onPress:Function},RMe={...jh,onMove:void 0,onMoveStart:void 0,onMoveEnd:void 0,onPress:void 0};class RM extends nc{constructor(){super(),q(this,"onMove"),q(this,"onMoveStart"),q(this,"onMoveEnd"),q(this,"onPressState",new Pt(void 0));let e=new __(0,0);const[t,i]=Qe(!1);this.createEffect(()=>{const r=this.onPressState.get();if(!r||!i())return;const o=Yn(()=>{r(e)});return()=>o.cancel()},[this.onPressState.get,i]),this.createEffect(()=>{const r=j3(`
                <div style="width: 150px; height: 150px; position: absolute; bottom: 25px; left: 25px;"></div>
            `);Vn.appendChild(r);const o=a=>{a.preventDefault(),a.stopPropagation()};r.onmousedown=o,r.ontouchstart=o,r.onpointerdown=o;const s=new Cn;return setTimeout(()=>{const a=LMe.create({zone:r,mode:"static",position:{left:"75px",bottom:"75px"},color:"white"});s.then(()=>a.destroy()),a.on("start",()=>{var l;(l=this.onMoveStart)==null||l.call(this,new __(0,0)),t(!0)}),a.on("move",(l,u)=>{var c;(c=this.onMove)==null||c.call(this,u.vector),e=u.vector}),a.on("end",()=>{var l;(l=this.onMoveEnd)==null||l.call(this,new __(0,0)),e=new __(0,0),t(!1)})}),()=>{s.cancel()}},[])}get onPress(){return this.onPressState.get()}set onPress(e){this.onPressState.set(e)}}q(RM,"componentName","joystick"),q(RM,"defaults",RMe),q(RM,"schema",DMe);const H3=(n,e,t)=>{const i=n[e];return i instanceof ci?t?i.value:void 0:t?i!=null?i:"":i},Tm=(n,e)=>Number(e.toFixed(2)),NX=["type","children","scale","rotation","velocity","target","proxy","gridHelper","gridHelperSize"],OMe=["autoMount"],p4=n=>{const e=[];for(const t of n){if(jC.has(t))continue;const{componentName:i,schema:r,defaults:o}=t.constructor,s={type:i};for(const a of Object.keys(r)){if(NX.includes(a))continue;let l;if(a==="animations"){if(l=t.serializeAnimations,!l)continue}else if(a==="animation"){if(l=t.serializeAnimation,l===void 0)continue}else l=t[a];l===H3(o,a)||typeof l=="function"||(s[a]=typeof l=="number"?Tm(a,l):l)}t.children&&(s.children=p4(t.children)),e.push(s)}return e},W3=(n=Ii)=>{if(n instanceof mk)return p4([n]);const e=[];for(const r of n)!(r instanceof wh)&&e.push(r);const t=new wh(!0);Object.assign(t,fs),e.push(t);const i=p4(e);return t.dispose(),i},kMe=Bne({group:()=>new fv,model:()=>new Tl,svgMesh:()=>new pv,dummy:()=>new dv,building:()=>new MM,tree:()=>new CM,reflector:()=>new K_,water:()=>new Z_,sprite:()=>new Wu,trigger:()=>new J_,spawnPoint:()=>new Q_,audio:()=>new $_,camera:()=>new ey,thirdPersonCamera:()=>new ty,firstPersonCamera:()=>new hI,orbitCamera:()=>new sv,ambientLight:()=>new ny,areaLight:()=>new iy,directionalLight:()=>new gv,skyLight:()=>new _v,pointLight:()=>new ry,spotLight:()=>new oy,circle:()=>new q_,cone:()=>new Jk,cube:()=>new qC,cylinder:()=>new fx,octahedron:()=>new Qk,plane:()=>new cv,sphere:()=>new px,tetrahedron:()=>new $k,torus:()=>new eI,skybox:()=>new uv,environment:()=>new lv,setup:()=>new wh}),zX=n=>kMe[n](),VX=(n,e)=>{var t;if(n.type==="animation")return;const i=zX(n.type);return e&&i instanceof dx&&e.push(i.loaded),Object.assign(i,ro.exports.omit(n,NX)),(t=n.children)==null||t.map(r=>VX(r,e)).forEach(r=>r&&i.append(r)),i},FX=(n,e)=>n.map(t=>VX(t,e)),BX=(n,e)=>{const t=document.createElement("a"),i=t.href=URL.createObjectURL(e);t.download=n,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(i)},yI=(n,e)=>{const t=new Blob([e],{type:"text/plain"});BX(n,t)},IMe=async()=>{const{default:n}=await ki(()=>import("./standalone.0df1515c.34a5625e.js"),[]).then(i=>i.s),{default:e}=await ki(()=>import("./parser-babel.786750b5.b45dbdaf.js"),[]).then(i=>i.p),t=n.format(JSON.stringify(W3()),{parser:"json",plugins:[e]});yI("scene.json",t)},UX=n=>{let e="";for(const t of n){const i=ro.exports.upperFirst(t.type);let r="";for(const[o,s]of Object.entries(t))o==="children"||o==="type"||!s||(typeof s=="string"?r+=` ${o}="${s}"`:s===!0?r+=` ${o}`:typeof s=="object"?r+=` ${o}={${JSON.stringify(s)}}`:r+=` ${o}={${s}}`);e+="children"in t&&t.children?`<${i}${r}>${UX(t.children)}</${i}>`:`<${i}${r} />`}return e},NMe=async()=>{const n=(await ki(()=>import("./standalone.0df1515c.34a5625e.js"),[]).then(i=>i.s)).default,e=(await ki(()=>import("./parser-babel.786750b5.b45dbdaf.js"),[]).then(i=>i.p)).default,t=n.format(`
        const App = () => {
            return (
                <World>
                    ${UX(W3())}
                </World>
            )
        }
    `,{parser:"babel",plugins:[e]});yI("App.jsx",t)},jX=n=>{let e="";for(const t of n){const i=ro.exports.upperFirst(t.type);let r="";for(let[o,s]of Object.entries(t))o==="children"||o==="type"||!s||(o=ro.exports.kebabCase(o),typeof s=="string"?r+=` ${o}='${s}'`:s===!0?r+=` ${o}`:typeof s=="object"?r+=` :${o}='${JSON.stringify(s)}'`:r+=` :${o}='${s}'`);e+="children"in t&&t.children?`<${i}${r}>
${jX(t.children)}</${i}>
`:`<${i}${r} />
`}return e},zMe=async()=>{const n=(await ki(()=>import("./standalone.0df1515c.34a5625e.js"),[]).then(i=>i.s)).default,e=(await ki(()=>import("./parser-html.2a5170e2.eaca68ab.js"),[]).then(i=>i.p)).default,t=n.format(`
        <template>
            <World>
                ${jX(W3())}
            </World>
        </template>
    `,{parser:"vue",plugins:[e]});yI("App.vue",t)},VMe=async()=>{const{fileOpen:n}=await Promise.resolve().then(()=>UCe),e=await(await n({extensions:[".json"]})).text();for(const t of Ii)t.dispose();try{FX(JSON.parse(e))}catch{}},FMe=(n,e,t=500)=>{const i=Ck[0];n-=i.x,e-=i.y;const r=n/i.width*2-1,o=-(e/i.height)*2+1,s=dt();Ci.set(r,o,.5),Ci.unproject(s);const a=Dn(s);Ci.sub(a).normalize();const l=a.add(Ci.multiplyScalar(t*rn));return Ba(l)},[dRe,pRe]=Qe("https://unpkg.com/lingo3d-wasm@1.0.1/assets/"),HX=0,BMe=1,UMe=2,UB=2,eL=1.25,jB=1,OM=6*4+4+4,f4=65535,jMe=Math.pow(2,-24);class yS{constructor(){}}function _l(n,e,t){return t.min.x=e[n],t.min.y=e[n+1],t.min.z=e[n+2],t.max.x=e[n+3],t.max.y=e[n+4],t.max.z=e[n+5],t}function HB(n){let e=-1,t=-1/0;for(let i=0;i<3;i++){const r=n[i+3]-n[i];r>t&&(t=r,e=i)}return e}function WB(n,e){e.set(n)}function GB(n,e,t){let i,r;for(let o=0;o<3;o++){const s=o+3;i=n[o],r=e[o],t[o]=i<r?i:r,i=n[s],r=e[s],t[s]=i>r?i:r}}function xS(n,e,t){for(let i=0;i<3;i++){const r=e[n+2*i],o=e[n+2*i+1],s=r-o,a=r+o;s<t[i]&&(t[i]=s),a>t[i+3]&&(t[i+3]=a)}}function o_(n){const e=n[3]-n[0],t=n[4]-n[1],i=n[5]-n[2];return 2*(e*t+t*i+i*e)}function HMe(n,e){if(!n.index){const t=n.attributes.position.count,i=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;let r;t>65535?r=new Uint32Array(new i(4*t)):r=new Uint16Array(new i(2*t)),n.setIndex(new Co(r,1));for(let o=0;o<t;o++)r[o]=o}}function WMe(n){if(!n.groups||!n.groups.length)return[{offset:0,count:n.index.count/3}];const e=[],t=new Set;for(const r of n.groups)t.add(r.start),t.add(r.start+r.count);const i=Array.from(t.values()).sort((r,o)=>r-o);for(let r=0;r<i.length-1;r++){const o=i[r],s=i[r+1];e.push({offset:o/3,count:(s-o)/3})}return e}function tL(n,e,t,i,r=null){let o=1/0,s=1/0,a=1/0,l=-1/0,u=-1/0,c=-1/0,h=1/0,p=1/0,m=1/0,y=-1/0,_=-1/0,g=-1/0;const b=r!==null;for(let w=e*6,M=(e+t)*6;w<M;w+=6){const C=n[w+0],P=n[w+1],L=C-P,R=C+P;L<o&&(o=L),R>l&&(l=R),b&&C<h&&(h=C),b&&C>y&&(y=C);const E=n[w+2],D=n[w+3],N=E-D,j=E+D;N<s&&(s=N),j>u&&(u=j),b&&E<p&&(p=E),b&&E>_&&(_=E);const te=n[w+4],ee=n[w+5],H=te-ee,Q=te+ee;H<a&&(a=H),Q>c&&(c=Q),b&&te<m&&(m=te),b&&te>g&&(g=te)}i[0]=o,i[1]=s,i[2]=a,i[3]=l,i[4]=u,i[5]=c,b&&(r[0]=h,r[1]=p,r[2]=m,r[3]=y,r[4]=_,r[5]=g)}function GMe(n,e,t,i){let r=1/0,o=1/0,s=1/0,a=-1/0,l=-1/0,u=-1/0;for(let c=e*6,h=(e+t)*6;c<h;c+=6){const p=n[c+0];p<r&&(r=p),p>a&&(a=p);const m=n[c+2];m<o&&(o=m),m>l&&(l=m);const y=n[c+4];y<s&&(s=y),y>u&&(u=y)}i[0]=r,i[1]=o,i[2]=s,i[3]=a,i[4]=l,i[5]=u}function XMe(n,e,t,i,r){let o=t,s=t+i-1;const a=r.pos,l=r.axis*2;for(;;){for(;o<=s&&e[o*6+l]<a;)o++;for(;o<=s&&e[s*6+l]>=a;)s--;if(o<s){for(let u=0;u<3;u++){let c=n[o*3+u];n[o*3+u]=n[s*3+u],n[s*3+u]=c;let h=e[o*6+u*2+0];e[o*6+u*2+0]=e[s*6+u*2+0],e[s*6+u*2+0]=h;let p=e[o*6+u*2+1];e[o*6+u*2+1]=e[s*6+u*2+1],e[s*6+u*2+1]=p}o++,s--}else return o}}const Pu=32,qMe=(n,e)=>n.candidate-e.candidate,Uc=new Array(Pu).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),bS=new Float32Array(6);function YMe(n,e,t,i,r,o){let s=-1,a=0;if(o===HX)s=HB(e),s!==-1&&(a=(e[s]+e[s+3])/2);else if(o===BMe)s=HB(n),s!==-1&&(a=KMe(t,i,r,s));else if(o===UMe){const l=o_(n);let u=eL*r;const c=i*6,h=(i+r)*6;for(let p=0;p<3;p++){const m=e[p],y=(e[p+3]-m)/Pu;if(r<Pu/4){const _=[...Uc];_.length=r;let g=0;for(let w=c;w<h;w+=6,g++){const M=_[g];M.candidate=t[w+2*p],M.count=0;const{bounds:C,leftCacheBounds:P,rightCacheBounds:L}=M;for(let R=0;R<3;R++)L[R]=1/0,L[R+3]=-1/0,P[R]=1/0,P[R+3]=-1/0,C[R]=1/0,C[R+3]=-1/0;xS(w,t,C)}_.sort(qMe);let b=r;for(let w=0;w<b;w++){const M=_[w];for(;w+1<b&&_[w+1].candidate===M.candidate;)_.splice(w+1,1),b--}for(let w=c;w<h;w+=6){const M=t[w+2*p];for(let C=0;C<b;C++){const P=_[C];M>=P.candidate?xS(w,t,P.rightCacheBounds):(xS(w,t,P.leftCacheBounds),P.count++)}}for(let w=0;w<b;w++){const M=_[w],C=M.count,P=r-M.count,L=M.leftCacheBounds,R=M.rightCacheBounds;let E=0;C!==0&&(E=o_(L)/l);let D=0;P!==0&&(D=o_(R)/l);const N=jB+eL*(E*C+D*P);N<u&&(s=p,u=N,a=M.candidate)}}else{for(let b=0;b<Pu;b++){const w=Uc[b];w.count=0,w.candidate=m+y+b*y;const M=w.bounds;for(let C=0;C<3;C++)M[C]=1/0,M[C+3]=-1/0}for(let b=c;b<h;b+=6){let w=~~((t[b+2*p]-m)/y);w>=Pu&&(w=Pu-1);const M=Uc[w];M.count++,xS(b,t,M.bounds)}const _=Uc[Pu-1];WB(_.bounds,_.rightCacheBounds);for(let b=Pu-2;b>=0;b--){const w=Uc[b],M=Uc[b+1];GB(w.bounds,M.rightCacheBounds,w.rightCacheBounds)}let g=0;for(let b=0;b<Pu-1;b++){const w=Uc[b],M=w.count,C=w.bounds,P=Uc[b+1].rightCacheBounds;M!==0&&(g===0?WB(C,bS):GB(C,bS,bS)),g+=M;let L=0,R=0;g!==0&&(L=o_(bS)/l);const E=r-g;E!==0&&(R=o_(P)/l);const D=jB+eL*(L*g+R*E);D<u&&(s=p,u=D,a=w.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${o} used.`);return{axis:s,pos:a}}function KMe(n,e,t,i){let r=0;for(let o=e,s=e+t;o<s;o++)r+=n[o*6+i*2];return r/t}function ZMe(n,e){const t=n.attributes.position,i=t.array,r=n.index.array,o=r.length/3,s=new Float32Array(o*6),a=t.offset||0;let l=3;t.isInterleavedBufferAttribute&&(l=t.data.stride);for(let u=0;u<o;u++){const c=u*3,h=u*6,p=r[c+0]*l+a,m=r[c+1]*l+a,y=r[c+2]*l+a;for(let _=0;_<3;_++){const g=i[p+_],b=i[m+_],w=i[y+_];let M=g;b<M&&(M=b),w<M&&(M=w);let C=g;b>C&&(C=b),w>C&&(C=w);const P=(C-M)/2,L=_*2;s[h+L+0]=M+P,s[h+L+1]=P+(Math.abs(M)+P)*jMe,M<e[_]&&(e[_]=M),C>e[_+3]&&(e[_+3]=C)}}return s}function JMe(n,e){function t(b){p&&p(b/m)}function i(b,w,M,C=null,P=0){if(!y&&P>=l&&(y=!0,u&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(n))),M<=c||P>=l)return t(w+M),b.offset=w,b.count=M,b;const L=YMe(b.boundingData,C,s,w,M,h);if(L.axis===-1)return t(w+M),b.offset=w,b.count=M,b;const R=XMe(a,s,w,M,L);if(R===w||R===w+M)t(w+M),b.offset=w,b.count=M;else{b.splitAxis=L.axis;const E=new yS,D=w,N=R-w;b.left=E,E.boundingData=new Float32Array(6),tL(s,D,N,E.boundingData,o),i(E,D,N,o,P+1);const j=new yS,te=R,ee=M-N;b.right=j,j.boundingData=new Float32Array(6),tL(s,te,ee,j.boundingData,o),i(j,te,ee,o,P+1)}return b}HMe(n,e);const r=new Float32Array(6),o=new Float32Array(6),s=ZMe(n,r),a=n.index.array,l=e.maxDepth,u=e.verbose,c=e.maxLeafTris,h=e.strategy,p=e.onProgress,m=n.index.count/3;let y=!1;const _=[],g=WMe(n);if(g.length===1){const b=g[0],w=new yS;w.boundingData=r,GMe(s,b.offset,b.count,o),i(w,b.offset,b.count,o),_.push(w)}else for(let b of g){const w=new yS;w.boundingData=new Float32Array(6),tL(s,b.offset,b.count,w.boundingData,o),i(w,b.offset,b.count,o),_.push(w)}return _}function QMe(n,e){const t=JMe(n,e);let i,r,o;const s=[],a=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let c=0;c<t.length;c++){const h=t[c];let p=l(h);const m=new a(OM*p);i=new Float32Array(m),r=new Uint32Array(m),o=new Uint16Array(m),u(0,h),s.push(m)}return s;function l(c){return c.count?1:1+l(c.left)+l(c.right)}function u(c,h){const p=c/4,m=c/2,y=!!h.count,_=h.boundingData;for(let g=0;g<6;g++)i[p+g]=_[g];if(y){const g=h.offset,b=h.count;return r[p+6]=g,o[m+14]=b,o[m+15]=f4,c+OM}else{const g=h.left,b=h.right,w=h.splitAxis;let M;if(M=u(c+OM,g),M/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[p+6]=M/4,M=u(M,b),r[p+7]=w,M}}}class kl{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let i=1/0,r=-1/0;for(let o=0,s=e.length;o<s;o++){const a=e[o][t];i=a<i?a:i,r=a>r?a:r}this.min=i,this.max=r}setFromPoints(e,t){let i=1/0,r=-1/0;for(let o=0,s=t.length;o<s;o++){const a=t[o],l=e.dot(a);i=l<i?l:i,r=l>r?l:r}this.min=i,this.max=r}isSeparated(e){return this.min>e.max||e.min>this.max}}kl.prototype.setFromBox=function(){const n=new K;return function(e,t){const i=t.min,r=t.max;let o=1/0,s=-1/0;for(let a=0;a<=1;a++)for(let l=0;l<=1;l++)for(let u=0;u<=1;u++){n.x=i.x*a+r.x*(1-a),n.y=i.y*l+r.y*(1-l),n.z=i.z*u+r.z*(1-u);const c=e.dot(n);o=Math.min(c,o),s=Math.max(c,s)}this.min=o,this.max=s}}();(function(){const n=new kl;return function(e,t){const i=e.points,r=e.satAxes,o=e.satBounds,s=t.points,a=t.satAxes,l=t.satBounds;for(let u=0;u<3;u++){const c=o[u],h=r[u];if(n.setFromPoints(h,s),c.isSeparated(n))return!1}for(let u=0;u<3;u++){const c=l[u],h=a[u];if(n.setFromPoints(h,i),c.isSeparated(n))return!1}}})();const $Me=function(){const n=new K,e=new K,t=new K;return function(i,r,o){const s=i.start,a=n,l=r.start,u=e;t.subVectors(s,l),n.subVectors(i.end,i.start),e.subVectors(r.end,r.start);const c=t.dot(u),h=u.dot(a),p=u.dot(u),m=t.dot(a),y=a.dot(a)*p-h*h;let _,g;y!==0?_=(c*h-m*p)/y:_=0,g=(c+_*h)/p,o.x=_,o.y=g}}(),xI=function(){const n=new ze,e=new K,t=new K;return function(i,r,o,s){$Me(i,r,n);let a=n.x,l=n.y;if(a>=0&&a<=1&&l>=0&&l<=1){i.at(a,o),r.at(l,s);return}else if(a>=0&&a<=1){l<0?r.at(0,s):r.at(1,s),i.closestPointToPoint(s,!0,o);return}else if(l>=0&&l<=1){a<0?i.at(0,o):i.at(1,o),r.closestPointToPoint(o,!0,s);return}else{let u;a<0?u=i.start:u=i.end;let c;l<0?c=r.start:c=r.end;const h=e,p=t;if(i.closestPointToPoint(c,!0,e),r.closestPointToPoint(u,!0,t),h.distanceToSquared(c)<=p.distanceToSquared(u)){o.copy(h),s.copy(c);return}else{o.copy(u),s.copy(p);return}}}}(),e2e=function(){const n=new K,e=new K,t=new Ou,i=new Fa;return function(r,o){const{radius:s,center:a}=r,{a:l,b:u,c}=o;if(i.start=l,i.end=u,i.closestPointToPoint(a,!0,n).distanceTo(a)<=s||(i.start=l,i.end=c,i.closestPointToPoint(a,!0,n).distanceTo(a)<=s)||(i.start=u,i.end=c,i.closestPointToPoint(a,!0,n).distanceTo(a)<=s))return!0;const h=o.getPlane(t);if(Math.abs(h.distanceToPoint(a))<=s){const p=h.projectPoint(a,e);if(o.containsPoint(p))return!0}return!1}}(),t2e=1e-15;function cm(n){return Math.abs(n)<t2e}class ec extends gs{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new K),this.satBounds=new Array(4).fill().map(()=>new kl),this.points=[this.a,this.b,this.c],this.sphere=new Hp,this.plane=new Ou,this.needsUpdate=!0}intersectsSphere(e){return e2e(e,this)}update(){const e=this.a,t=this.b,i=this.c,r=this.points,o=this.satAxes,s=this.satBounds,a=o[0],l=s[0];this.getNormal(a),l.setFromPoints(a,r);const u=o[1],c=s[1];u.subVectors(e,t),c.setFromPoints(u,r);const h=o[2],p=s[2];h.subVectors(t,i),p.setFromPoints(h,r);const m=o[3],y=s[3];m.subVectors(i,e),y.setFromPoints(m,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}}ec.prototype.closestPointToSegment=function(){const n=new K,e=new K,t=new Fa;return function(i,r=null,o=null){const{start:s,end:a}=i,l=this.points;let u,c=1/0;for(let h=0;h<3;h++){const p=(h+1)%3;t.start.copy(l[h]),t.end.copy(l[p]),xI(t,i,n,e),u=n.distanceToSquared(e),u<c&&(c=u,r&&r.copy(n),o&&o.copy(e))}return this.closestPointToPoint(s,n),u=s.distanceToSquared(n),u<c&&(c=u,r&&r.copy(n),o&&o.copy(s)),this.closestPointToPoint(a,n),u=a.distanceToSquared(n),u<c&&(c=u,r&&r.copy(n),o&&o.copy(a)),Math.sqrt(c)}}();ec.prototype.intersectsTriangle=function(){const n=new ec,e=new Array(3),t=new Array(3),i=new kl,r=new kl,o=new K,s=new K,a=new K,l=new K,u=new Fa,c=new Fa,h=new Fa;return function(p,m=null){this.needsUpdate&&this.update(),p.isExtendedTriangle?p.needsUpdate&&p.update():(n.copy(p),n.update(),p=n);const y=this.plane,_=p.plane;if(Math.abs(y.normal.dot(_.normal))>1-1e-10){const g=this.satBounds,b=this.satAxes;t[0]=p.a,t[1]=p.b,t[2]=p.c;for(let C=0;C<4;C++){const P=g[C],L=b[C];if(i.setFromPoints(L,t),P.isSeparated(i))return!1}const w=p.satBounds,M=p.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let C=0;C<4;C++){const P=w[C],L=M[C];if(i.setFromPoints(L,e),P.isSeparated(i))return!1}for(let C=0;C<4;C++){const P=b[C];for(let L=0;L<4;L++){const R=M[L];if(o.crossVectors(P,R),i.setFromPoints(o,e),r.setFromPoints(o,t),i.isSeparated(r))return!1}}return m&&(console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),m.start.set(0,0,0),m.end.set(0,0,0)),!0}else{const g=this.points;let b=!1,w=0;for(let te=0;te<3;te++){const ee=g[te],H=g[(te+1)%3];u.start.copy(ee),u.end.copy(H),u.delta(s);const Q=b?c.start:c.end,Z=cm(_.distanceToPoint(ee));if(cm(_.normal.dot(s))&&Z){c.copy(u),w=2;break}if((_.intersectLine(u,Q)||Z)&&!cm(Q.distanceTo(H))){if(w++,b)break;b=!0}}if(w===1&&this.containsPoint(c.end))return m&&(m.start.copy(c.end),m.end.copy(c.end)),!0;if(w!==2)return!1;const M=p.points;let C=!1,P=0;for(let te=0;te<3;te++){const ee=M[te],H=M[(te+1)%3];u.start.copy(ee),u.end.copy(H),u.delta(a);const Q=C?h.start:h.end,Z=cm(y.distanceToPoint(ee));if(cm(y.normal.dot(a))&&Z){h.copy(u),P=2;break}if((y.intersectLine(u,Q)||Z)&&!cm(Q.distanceTo(H))){if(P++,C)break;C=!0}}if(P===1&&this.containsPoint(h.end))return m&&(m.start.copy(h.end),m.end.copy(h.end)),!0;if(P!==2)return!1;if(c.delta(s),h.delta(a),s.dot(a)<0){let te=h.start;h.start=h.end,h.end=te}const L=c.start.dot(s),R=c.end.dot(s),E=h.start.dot(s),D=h.end.dot(s),N=R<E,j=L<D;return L!==D&&E!==R&&N===j?!1:(m&&(l.subVectors(c.start,h.start),l.dot(s)>0?m.start.copy(c.start):m.start.copy(h.start),l.subVectors(c.end,h.end),l.dot(s)<0?m.end.copy(c.end):m.end.copy(h.end)),!0)}}}();ec.prototype.distanceToPoint=function(){const n=new K;return function(e){return this.closestPointToPoint(e,n),e.distanceTo(n)}}();ec.prototype.distanceToTriangle=function(){const n=new K,e=new K,t=["a","b","c"],i=new Fa,r=new Fa;return function(o,s=null,a=null){const l=s||a?i:null;if(this.intersectsTriangle(o,l))return(s||a)&&(s&&l.getCenter(s),a&&l.getCenter(a)),0;let u=1/0;for(let c=0;c<3;c++){let h;const p=t[c],m=o[p];this.closestPointToPoint(m,n),h=m.distanceToSquared(n),h<u&&(u=h,s&&s.copy(n),a&&a.copy(m));const y=this[p];o.closestPointToPoint(y,n),h=y.distanceToSquared(n),h<u&&(u=h,s&&s.copy(y),a&&a.copy(n))}for(let c=0;c<3;c++){const h=t[c],p=t[(c+1)%3];i.set(this[h],this[p]);for(let m=0;m<3;m++){const y=t[m],_=t[(m+1)%3];r.set(o[y],o[_]),xI(i,r,n,e);const g=n.distanceToSquared(e);g<u&&(u=g,s&&s.copy(n),a&&a.copy(e))}}return Math.sqrt(u)}}();class Il extends Hr{constructor(...e){super(...e),this.isOrientedBox=!0,this.matrix=new Bt,this.invMatrix=new Bt,this.points=new Array(8).fill().map(()=>new K),this.satAxes=new Array(3).fill().map(()=>new K),this.satBounds=new Array(3).fill().map(()=>new kl),this.alignedSatBounds=new Array(3).fill().map(()=>new kl),this.needsUpdate=!1}set(e,t,i){super.set(e,t),this.matrix.copy(i),this.needsUpdate=!0}copy(e){super.copy(e),this.matrix.copy(e.matrix),this.needsUpdate=!0}}Il.prototype.update=function(){return function(){const n=this.matrix,e=this.min,t=this.max,i=this.points;for(let l=0;l<=1;l++)for(let u=0;u<=1;u++)for(let c=0;c<=1;c++){const h=1*l|2*u|4*c,p=i[h];p.x=l?t.x:e.x,p.y=u?t.y:e.y,p.z=c?t.z:e.z,p.applyMatrix4(n)}const r=this.satBounds,o=this.satAxes,s=i[0];for(let l=0;l<3;l++){const u=o[l],c=r[l],h=1<<l,p=i[h];u.subVectors(s,p),c.setFromPoints(u,i)}const a=this.alignedSatBounds;a[0].setFromPointsField(i,"x"),a[1].setFromPointsField(i,"y"),a[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Il.prototype.intersectsBox=function(){const n=new kl;return function(e){this.needsUpdate&&this.update();const t=e.min,i=e.max,r=this.satBounds,o=this.satAxes,s=this.alignedSatBounds;if(n.min=t.x,n.max=i.x,s[0].isSeparated(n)||(n.min=t.y,n.max=i.y,s[1].isSeparated(n))||(n.min=t.z,n.max=i.z,s[2].isSeparated(n)))return!1;for(let a=0;a<3;a++){const l=o[a],u=r[a];if(n.setFromBox(l,e),u.isSeparated(n))return!1}return!0}}();Il.prototype.intersectsTriangle=function(){const n=new ec,e=new Array(3),t=new kl,i=new kl,r=new K;return function(o){this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(n.copy(o),n.update(),o=n);const s=this.satBounds,a=this.satAxes;e[0]=o.a,e[1]=o.b,e[2]=o.c;for(let h=0;h<3;h++){const p=s[h],m=a[h];if(t.setFromPoints(m,e),p.isSeparated(t))return!1}const l=o.satBounds,u=o.satAxes,c=this.points;for(let h=0;h<3;h++){const p=l[h],m=u[h];if(t.setFromPoints(m,c),p.isSeparated(t))return!1}for(let h=0;h<3;h++){const p=a[h];for(let m=0;m<4;m++){const y=u[m];if(r.crossVectors(p,y),t.setFromPoints(r,e),i.setFromPoints(r,c),t.isSeparated(i))return!1}}return!0}}();Il.prototype.closestPointToPoint=function(){return function(n,e){return this.needsUpdate&&this.update(),e.copy(n).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();Il.prototype.distanceToPoint=function(){const n=new K;return function(e){return this.closestPointToPoint(e,n),e.distanceTo(n)}}();Il.prototype.distanceToBox=function(){const n=["x","y","z"],e=new Array(12).fill().map(()=>new Fa),t=new Array(12).fill().map(()=>new Fa),i=new K,r=new K;return function(o,s=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(o))return(a||l)&&(o.getCenter(r),this.closestPointToPoint(r,i),o.closestPointToPoint(i,r),a&&a.copy(i),l&&l.copy(r)),0;const u=s*s,c=o.min,h=o.max,p=this.points;let m=1/0;for(let _=0;_<8;_++){const g=p[_];r.copy(g).clamp(c,h);const b=g.distanceToSquared(r);if(b<m&&(m=b,a&&a.copy(g),l&&l.copy(r),b<u))return Math.sqrt(b)}let y=0;for(let _=0;_<3;_++)for(let g=0;g<=1;g++)for(let b=0;b<=1;b++){const w=(_+1)%3,M=(_+2)%3,C=g<<w|b<<M,P=1<<_|g<<w|b<<M,L=p[C],R=p[P];e[y].set(L,R);const E=n[_],D=n[w],N=n[M],j=t[y],te=j.start,ee=j.end;te[E]=c[E],te[D]=g?c[D]:h[D],te[N]=b?c[N]:h[D],ee[E]=h[E],ee[D]=g?c[D]:h[D],ee[N]=b?c[N]:h[D],y++}for(let _=0;_<=1;_++)for(let g=0;g<=1;g++)for(let b=0;b<=1;b++){r.x=_?h.x:c.x,r.y=g?h.y:c.y,r.z=b?h.z:c.z,this.closestPointToPoint(r,i);const w=r.distanceToSquared(i);if(w<m&&(m=w,a&&a.copy(i),l&&l.copy(r),w<u))return Math.sqrt(w)}for(let _=0;_<12;_++){const g=e[_];for(let b=0;b<12;b++){const w=t[b];xI(g,w,i,r);const M=i.distanceToSquared(r);if(M<m&&(m=M,a&&a.copy(i),l&&l.copy(r),M<u))return Math.sqrt(M)}}return Math.sqrt(m)}}();const wS=new K,SS=new K,MS=new K,XB=new ze,qB=new ze,YB=new ze,KB=new K;function n2e(n,e,t,i,r,o){let s;return o===Zo?s=n.intersectTriangle(i,t,e,!0,r):s=n.intersectTriangle(e,t,i,o!==Qu,r),s===null?null:{distance:n.origin.distanceTo(r),point:r.clone()}}function i2e(n,e,t,i,r,o,s){wS.fromBufferAttribute(e,i),SS.fromBufferAttribute(e,r),MS.fromBufferAttribute(e,o);const a=n2e(n,wS,SS,MS,KB,s);if(a){t&&(XB.fromBufferAttribute(t,i),qB.fromBufferAttribute(t,r),YB.fromBufferAttribute(t,o),a.uv=gs.getUV(KB,wS,SS,MS,XB,qB,YB,new ze));const l={a:i,b:r,c:o,normal:new K,materialIndex:0};gs.getNormal(wS,SS,MS,l.normal),a.face=l,a.faceIndex=i}return a}function WX(n,e,t,i,r){const o=i*3,s=n.index.getX(o),a=n.index.getX(o+1),l=n.index.getX(o+2),u=i2e(t,n.attributes.position,n.attributes.uv,s,a,l,e);return u?(u.faceIndex=i,r&&r.push(u),u):null}function r2e(n,e,t,i,r,o){for(let s=i,a=i+r;s<a;s++)WX(n,e,t,s,o)}function o2e(n,e,t,i,r){let o=1/0,s=null;for(let a=i,l=i+r;a<l;a++){const u=WX(n,e,t,a);u&&u.distance<o&&(s=u,o=u.distance)}return s}function GX(n,e,t){return n===null||(n.point.applyMatrix4(e.matrixWorld),n.distance=n.point.distanceTo(t.ray.origin),n.object=e,n.distance<t.near||n.distance>t.far)?null:n}function ml(n,e,t,i){const r=n.a,o=n.b,s=n.c;let a=e,l=e+1,u=e+2;t&&(a=t.getX(e),l=t.getX(e+1),u=t.getX(e+2)),r.x=i.getX(a),r.y=i.getY(a),r.z=i.getZ(a),o.x=i.getX(l),o.y=i.getY(l),o.z=i.getZ(l),s.x=i.getX(u),s.y=i.getY(u),s.z=i.getZ(u)}function ZB(n,e,t,i,r,o,s){const a=t.index,l=t.attributes.position;for(let u=n,c=e+n;u<c;u++)if(ml(s,u*3,a,l),s.needsUpdate=!0,i(s,u,r,o))return!0;return!1}class XX{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){const e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}function ah(n,e){return e[n+15]===65535}function xv(n,e){return e[n+6]}function Xy(n,e){return e[n+14]}function qy(n){return n+8}function Yy(n,e){return e[n+6]}function s2e(n,e){return e[n+7]}const qm=new Hr,W2=new K,a2e=["x","y","z"];function m4(n,e,t,i,r){let o=n*2,s=Bg,a=Mh,l=Ch;if(ah(o,a)){const u=xv(n,l),c=Xy(o,a);r2e(e,t,i,u,c,r)}else{const u=qy(n);G2(u,s,i,W2)&&m4(u,e,t,i,r);const c=Yy(n,l);G2(c,s,i,W2)&&m4(c,e,t,i,r)}}function v4(n,e,t,i){let r=n*2,o=Bg,s=Mh,a=Ch;if(ah(r,s)){const l=xv(n,a),u=Xy(r,s);return o2e(e,t,i,l,u)}else{const l=s2e(n,a),u=a2e[l],c=i.direction[u]>=0;let h,p;c?(h=qy(n),p=Yy(n,a)):(h=Yy(n,a),p=qy(n));const m=G2(h,o,i,W2)?v4(h,e,t,i):null;if(m){const _=m.point[u];if(c?_<=o[p+l]:_>=o[p+l+3])return m}const y=G2(p,o,i,W2)?v4(p,e,t,i):null;return m&&y?m.distance<=y.distance?m:y:m||y||null}}const l2e=function(){let n,e;const t=[],i=new XX(()=>new Hr);return function(...o){n=i.getPrimitive(),e=i.getPrimitive(),t.push(n,e);const s=r(...o);i.releasePrimitive(n),i.releasePrimitive(e),t.pop(),t.pop();const a=t.length;return a>0&&(e=t[a-1],n=t[a-2]),s};function r(o,s,a,l,u=null,c=0,h=0){function p(w){let M=w*2,C=Mh,P=Ch;for(;!ah(M,C);)w=qy(w),M=w*2;return xv(w,P)}function m(w){let M=w*2,C=Mh,P=Ch;for(;!ah(M,C);)w=Yy(w,P),M=w*2;return xv(w,P)+Xy(M,C)}let y=o*2,_=Bg,g=Mh,b=Ch;if(ah(y,g)){const w=xv(o,b),M=Xy(y,g);return _l(o,_,n),l(w,M,!1,h,c+o,n)}else{const w=qy(o),M=Yy(o,b);let C=w,P=M,L,R,E,D;if(u&&(E=n,D=e,_l(C,_,E),_l(P,_,D),L=u(E),R=u(D),R<L)){C=M,P=w;const Z=L;L=R,R=Z,E=D}E||(E=n,_l(C,_,E));const N=ah(C*2,g),j=a(E,N,L,h+1,c+C);let te;if(j===UB){const Z=p(C),de=m(C)-Z;te=l(Z,de,!0,h+1,c+C,E)}else te=j&&r(C,s,a,l,u,c,h+1);if(te)return!0;D=e,_l(P,_,D);const ee=ah(P*2,g),H=a(D,ee,R,h+1,c+P);let Q;if(H===UB){const Z=p(P),de=m(P)-Z;Q=l(Z,de,!0,h+1,c+P,D)}else Q=H&&r(P,s,a,l,u,c,h+1);return!!Q}}}(),u2e=function(){const n=new ec,e=new ec,t=new Bt,i=new Il,r=new Il;return function o(s,a,l,u,c=null){let h=s*2,p=Bg,m=Mh,y=Ch;if(c===null&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,u),c=i),ah(h,m)){const _=a,g=_.index,b=_.attributes.position,w=l.index,M=l.attributes.position,C=xv(s,y),P=Xy(h,m);if(t.copy(u).invert(),l.boundsTree)return _l(s,p,r),r.matrix.copy(t),r.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:L=>r.intersectsBox(L),intersectsTriangle:L=>{L.a.applyMatrix4(u),L.b.applyMatrix4(u),L.c.applyMatrix4(u),L.needsUpdate=!0;for(let R=C*3,E=(P+C)*3;R<E;R+=3)if(ml(e,R,g,b),e.needsUpdate=!0,L.intersectsTriangle(e))return!0;return!1}});for(let L=C*3,R=P+C*3;L<R;L+=3){ml(n,L,g,b),n.a.applyMatrix4(t),n.b.applyMatrix4(t),n.c.applyMatrix4(t),n.needsUpdate=!0;for(let E=0,D=w.count;E<D;E+=3)if(ml(e,E,w,M),e.needsUpdate=!0,n.intersectsTriangle(e))return!0}}else{const _=s+8,g=y[s+6];return _l(_,p,qm),!!(c.intersectsBox(qm)&&o(_,a,l,u,c)||(_l(g,p,qm),c.intersectsBox(qm)&&o(g,a,l,u,c)))}}}();function G2(n,e,t,i){return _l(n,e,qm),t.intersectBox(qm,i)}const g4=[];let kM,Bg,Mh,Ch;function T_(n){kM&&g4.push(kM),kM=n,Bg=new Float32Array(n),Mh=new Uint16Array(n),Ch=new Uint32Array(n)}function CS(){kM=null,Bg=null,Mh=null,Ch=null,g4.length&&T_(g4.pop())}const nL=Symbol("skip tree generation"),iL=new Hr,rL=new Hr,hm=new Bt,jd=new Il,s_=new Il,a_=new K,ES=new K,c2e=new K,h2e=new K,d2e=new K,JB=new Hr,ll=new XX(()=>new ec);class Ur{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),Ur.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};const i=e.geometry,r=e._roots,o=i.getIndex();let s;return t.cloneBuffers?s={roots:r.map(a=>a.slice()),index:o.array.slice()}:s={roots:r,index:o.array},s}static deserialize(e,t,i={}){if(typeof i=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),Ur.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});i={setIndex:!0,...i};const{index:r,roots:o}=e,s=new Ur(t,{...i,[nL]:!0});if(s._roots=o,i.setIndex){const a=t.getIndex();if(a===null){const l=new Co(e.index,1,!1);t.setIndex(l)}else a.array!==r&&(a.array.set(r),a.needsUpdate=!0)}return s}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:HX,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[nL]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[nL]||(this._roots=QMe(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Hr))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));const t=this.geometry,i=t.index.array,r=t.attributes.position,o=r.array,s=r.offset||0;let a=3;r.isInterleavedBufferAttribute&&(a=r.data.stride);let l,u,c,h,p=0;const m=this._roots;for(let _=0,g=m.length;_<g;_++)l=m[_],u=new Uint32Array(l),c=new Uint16Array(l),h=new Float32Array(l),y(0,p),p+=l.byteLength;function y(_,g,b=!1){const w=_*2;if(c[w+15]===f4){const M=u[_+6],C=c[w+14];let P=1/0,L=1/0,R=1/0,E=-1/0,D=-1/0,N=-1/0;for(let j=3*M,te=3*(M+C);j<te;j++){const ee=i[j]*a+s,H=o[ee+0],Q=o[ee+1],Z=o[ee+2];H<P&&(P=H),H>E&&(E=H),Q<L&&(L=Q),Q>D&&(D=Q),Z<R&&(R=Z),Z>N&&(N=Z)}return h[_+0]!==P||h[_+1]!==L||h[_+2]!==R||h[_+3]!==E||h[_+4]!==D||h[_+5]!==N?(h[_+0]=P,h[_+1]=L,h[_+2]=R,h[_+3]=E,h[_+4]=D,h[_+5]=N,!0):!1}else{const M=_+8,C=u[_+6],P=M+g,L=C+g;let R=b,E=!1,D=!1;e?R||(E=e.has(P),D=e.has(L),R=!E&&!D):(E=!0,D=!0);const N=R||E,j=R||D;let te=!1;N&&(te=y(M,g,R));let ee=!1;j&&(ee=y(C,g,R));const H=te||ee;if(H)for(let Q=0;Q<3;Q++){const Z=M+Q,de=C+Q,X=h[Z],B=h[Z+3],U=h[de],le=h[de+3];h[_+Q]=X<U?X:U,h[_+Q+3]=B>le?B:le}return H}}}traverse(e,t=0){const i=this._roots[t],r=new Uint32Array(i),o=new Uint16Array(i);s(0);function s(a,l=0){const u=a*2,c=o[u+15]===f4;if(c){const h=r[a+6],p=o[u+14];e(l,c,new Float32Array(i,a*4,6),h,p)}else{const h=a+OM/4,p=r[a+6],m=r[a+7];e(l,c,new Float32Array(i,a*4,6),m)||(s(h,l+1),s(p,l+1))}}}raycast(e,t=Ep){const i=this._roots,r=this.geometry,o=[],s=t.isMaterial,a=Array.isArray(t),l=r.groups,u=s?t.side:t;for(let c=0,h=i.length;c<h;c++){const p=a?t[l[c].materialIndex].side:u,m=o.length;if(T_(i[c]),m4(0,r,p,e,o),CS(),a){const y=l[c].materialIndex;for(let _=m,g=o.length;_<g;_++)o[_].face.materialIndex=y}}return o}raycastFirst(e,t=Ep){const i=this._roots,r=this.geometry,o=t.isMaterial,s=Array.isArray(t);let a=null;const l=r.groups,u=o?t.side:t;for(let c=0,h=i.length;c<h;c++){const p=s?t[l[c].materialIndex].side:u;T_(i[c]);const m=v4(0,r,p,e);CS(),m!=null&&(a==null||m.distance<a.distance)&&(a=m,s&&(m.face.materialIndex=l[c].materialIndex))}return a}intersectsGeometry(e,t){const i=this.geometry;let r=!1;for(const o of this._roots)if(T_(o),r=u2e(0,i,e,t),CS(),r)break;return r}shapecast(e,t,i){const r=this.geometry;if(e instanceof Function){if(t){const p=t;t=(m,y,_,g)=>{const b=y*3;return p(m,b,b+1,b+2,_,g)}}e={boundsTraverseOrder:i,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}const o=ll.getPrimitive();let{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:l,intersectsTriangle:u}=e;if(l&&u){const p=l;l=(m,y,_,g,b)=>p(m,y,_,g,b)?!0:ZB(m,y,r,u,_,g,o)}else l||(u?l=(p,m,y,_)=>ZB(p,m,r,u,y,_,o):l=(p,m,y)=>y);let c=!1,h=0;for(const p of this._roots){if(T_(p),c=l2e(0,r,a,l,s,h),CS(),c)break;h+=p.byteLength}return ll.releasePrimitive(o),c}bvhcast(e,t,i){let{intersectsRanges:r,intersectsTriangles:o}=i;const s=this.geometry.index,a=this.geometry.attributes.position,l=e.geometry.index,u=e.geometry.attributes.position;hm.copy(t).invert();const c=ll.getPrimitive(),h=ll.getPrimitive();if(o){let m=function(y,_,g,b,w,M,C,P){for(let L=g,R=g+b;L<R;L++){ml(h,L*3,l,u),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let E=y,D=y+_;E<D;E++)if(ml(c,E*3,s,a),c.needsUpdate=!0,o(c,h,E,L,w,M,C,P))return!0}return!1};if(r){const y=r;r=function(_,g,b,w,M,C,P,L){return y(_,g,b,w,M,C,P,L)?!0:m(_,g,b,w,M,C,P,L)}}else r=m}e.getBoundingBox(rL),rL.applyMatrix4(t);const p=this.shapecast({intersectsBounds:m=>rL.intersectsBox(m),intersectsRange:(m,y,_,g,b,w)=>(iL.copy(w),iL.applyMatrix4(hm),e.shapecast({intersectsBounds:M=>iL.intersectsBox(M),intersectsRange:(M,C,P,L,R)=>r(m,y,M,C,g,b,L,R)}))});return ll.releasePrimitive(c),ll.releasePrimitive(h),p}intersectsBox(e,t){return jd.set(e.min,e.max,t),jd.needsUpdate=!0,this.shapecast({intersectsBounds:i=>jd.intersectsBox(i),intersectsTriangle:i=>jd.intersectsTriangle(i)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,i={},r={},o=0,s=1/0){e.boundingBox||e.computeBoundingBox(),jd.set(e.boundingBox.min,e.boundingBox.max,t),jd.needsUpdate=!0;const a=this.geometry,l=a.attributes.position,u=a.index,c=e.attributes.position,h=e.index,p=ll.getPrimitive(),m=ll.getPrimitive();let y=ES,_=c2e,g=null,b=null;r&&(g=h2e,b=d2e);let w=1/0,M=null,C=null;return hm.copy(t).invert(),s_.matrix.copy(hm),this.shapecast({boundsTraverseOrder:P=>jd.distanceToBox(P),intersectsBounds:(P,L,R)=>R<w&&R<s?(L&&(s_.min.copy(P.min),s_.max.copy(P.max),s_.needsUpdate=!0),!0):!1,intersectsRange:(P,L)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:R=>s_.distanceToBox(R),intersectsBounds:(R,E,D)=>D<w&&D<s,intersectsRange:(R,E)=>{for(let D=R*3,N=(R+E)*3;D<N;D+=3){ml(m,D,h,c),m.a.applyMatrix4(t),m.b.applyMatrix4(t),m.c.applyMatrix4(t),m.needsUpdate=!0;for(let j=P*3,te=(P+L)*3;j<te;j+=3){ml(p,j,u,l),p.needsUpdate=!0;const ee=p.distanceToTriangle(m,y,g);if(ee<w&&(_.copy(y),b&&b.copy(g),w=ee,M=j/3,C=D/3),ee<o)return!0}}}});{const R=h?h.count:c.count;for(let E=0,D=R;E<D;E+=3){ml(m,E,h,c),m.a.applyMatrix4(t),m.b.applyMatrix4(t),m.c.applyMatrix4(t),m.needsUpdate=!0;for(let N=P*3,j=(P+L)*3;N<j;N+=3){ml(p,N,u,l),p.needsUpdate=!0;const te=p.distanceToTriangle(m,y,g);if(te<w&&(_.copy(y),b&&b.copy(g),w=te,M=N/3,C=E/3),te<o)return!0}}}}}),ll.releasePrimitive(p),ll.releasePrimitive(m),w===1/0?null:(i.point?i.point.copy(_):i.point=_.clone(),i.distance=w,i.faceIndex=M,r&&(r.point?r.point.copy(b):r.point=b.clone(),r.point.applyMatrix4(hm),_.applyMatrix4(hm),r.distance=_.sub(r.point).length(),r.faceIndex=C),i)}closestPointToPoint(e,t={},i=0,r=1/0){const o=i*i,s=r*r;let a=1/0,l=null;if(this.shapecast({boundsTraverseOrder:c=>(a_.copy(e).clamp(c.min,c.max),a_.distanceToSquared(e)),intersectsBounds:(c,h,p)=>p<a&&p<s,intersectsTriangle:(c,h)=>{c.closestPointToPoint(e,a_);const p=e.distanceToSquared(a_);return p<a&&(ES.copy(a_),a=p,l=h),p<o}}),a===1/0)return null;const u=Math.sqrt(a);return t.point?t.point.copy(ES):t.point=ES.clone(),t.distance=u,t.faceIndex=l,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{_l(0,new Float32Array(t),JB),e.union(JB)}),e}}const QB=Ur.prototype.raycast;Ur.prototype.raycast=function(...n){if(n[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycast" has changed. See docs for new signature.');const[e,t,i,r]=n;return QB.call(this,i,e.material).forEach(o=>{o=GX(o,e,t),o&&r.push(o)}),r}else return QB.apply(this,n)};const $B=Ur.prototype.raycastFirst;Ur.prototype.raycastFirst=function(...n){if(n[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycastFirst" has changed. See docs for new signature.');const[e,t,i]=n;return GX($B.call(this,i,e.material),e,t)}else return $B.apply(this,n)};const eU=Ur.prototype.closestPointToPoint;Ur.prototype.closestPointToPoint=function(...n){if(n[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "closestPointToPoint" has changed. See docs for new signature.'),n.unshift();const e=n[1],t={};return n[1]=t,eU.apply(this,n),e&&e.copy(t.point),t.distance}else return eU.apply(this,n)};const tU=Ur.prototype.closestPointToGeometry;Ur.prototype.closestPointToGeometry=function(...n){const e=n[2],t=n[3];if(e&&e.isVector3||t&&t.isVector3){console.warn('MeshBVH: The function signature and results frame for "closestPointToGeometry" has changed. See docs for new signature.');const i={},r={},o=n[1];return n[2]=i,n[3]=r,tU.apply(this,n),e&&e.copy(i.point),t&&t.copy(r.point).applyMatrix4(o),i.distance}else return tU.apply(this,n)};const nU=Ur.prototype.refit;Ur.prototype.refit=function(...n){const e=n[0],t=n[1];if(t&&(t instanceof Set||Array.isArray(t))){console.warn('MeshBVH: The function signature for "refit" has changed. See docs for new signature.');const i=new Set;t.forEach(r=>i.add(r)),e&&e.forEach(r=>i.add(r)),nU.call(this,i)}else nU.apply(this,n)};["intersectsGeometry","shapecast","intersectsBox","intersectsSphere"].forEach(n=>{const e=Ur.prototype[n];Ur.prototype[n]=function(...t){return(t[0]===null||t[0].isMesh)&&(t.shift(),console.warn(`MeshBVH: The function signature for "${n}" has changed and no longer takes Mesh. See docs for new signature.`)),e.apply(this,t)}});const p2e=new WeakMap;let f2e={generate:async n=>new Ur(n)};const m2e=async n=>{const e=[];for(const t of n)e.push(await f2e.generate(t));return e},fRe=async n=>{n.outerObject3d.updateMatrixWorld(!0);const e=[];n.outerObject3d.traverse(i=>{if(!i.geometry||i===n.nativeObject3d&&!(n instanceof Cs))return;const r=i.geometry.clone();r.applyMatrix4(i.matrixWorld),e.push(r),r.dispose()});const t=await m2e(e);for(const i of t)p2e.set(i,n);return[t,e]},qX=document.createElement("div");Object.assign(qX.style,{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",pointerEvents:"none",userSelect:"none"});const bI=(n,e)=>{const t=hn.exports.useRef({}),i=[],r=[];if(e)return[i,r];const o=t.current;for(const[s,a]of Object.entries(n)){if(s==="children")continue;const l=o[s];l!==a&&(a&&typeof a=="object"?JSON.stringify(a)!==JSON.stringify(l)&&i.push([s,a]):i.push([s,a]))}for(const s of Object.keys(o))!(s in n)&&r.push(s);return t.current=n,[i,r]},YX=n=>{const e=hn.exports.useRef(n);return e.current=n,e},v2e=console.log;let _4=[];const g2e=()=>_4=[],_2e=parseFloat(_t.version)>17,oL=new WeakSet;let iU=!1;const y2e=(n,e,t)=>{if(_2e){const r=hn.exports.useMemo(n,[]),[o]=hn.exports.useState(()=>{const s={};return queueMicrotask(()=>{oL.has(s)||(iU=!0,e==null||e(r))}),s});return hn.exports.useLayoutEffect(()=>oL.has(o)?()=>{e==null||e(r),t==null||t(r)}:(oL.add(o),()=>{queueMicrotask(()=>{iU||(e==null||e(r),t==null||t(r))})}),[]),r}const[i]=hn.exports.useState(()=>{if(v2e===console.log){queueMicrotask(g2e);const r=n();return _4.push(r),r}return _4.shift()});return hn.exports.useLayoutEffect(()=>()=>{e==null||e(i),t==null||t(i)},[]),i};var KX=function(){if(typeof Map<"u")return Map;function n(e,t){var i=-1;return e.some(function(r,o){return r[0]===t?(i=o,!0):!1}),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var i=n(this.__entries__,t),r=this.__entries__[i];return r&&r[1]},e.prototype.set=function(t,i){var r=n(this.__entries__,t);~r?this.__entries__[r][1]=i:this.__entries__.push([t,i])},e.prototype.delete=function(t){var i=this.__entries__,r=n(i,t);~r&&i.splice(r,1)},e.prototype.has=function(t){return!!~n(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,i){i===void 0&&(i=null);for(var r=0,o=this.__entries__;r<o.length;r++){var s=o[r];t.call(i,s[1],s[0])}},e}()}(),y4=typeof window<"u"&&typeof document<"u"&&window.document===document,X2=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),x2e=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(X2):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)}}(),b2e=2;function w2e(n,e){var t=!1,i=!1,r=0;function o(){t&&(t=!1,n()),i&&a()}function s(){x2e(o)}function a(){var l=Date.now();if(t){if(l-r<b2e)return;i=!0}else t=!0,i=!1,setTimeout(s,e);r=l}return a}var S2e=20,M2e=["top","right","bottom","left","width","height","size","weight"],C2e=typeof MutationObserver<"u",E2e=function(){function n(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=w2e(this.refresh.bind(this),S2e)}return n.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},n.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},n.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},n.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},n.prototype.connect_=function(){!y4||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),C2e?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},n.prototype.disconnect_=function(){!y4||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},n.prototype.onTransitionEnd_=function(e){var t=e.propertyName,i=t===void 0?"":t,r=M2e.some(function(o){return!!~i.indexOf(o)});r&&this.refresh()},n.getInstance=function(){return this.instance_||(this.instance_=new n),this.instance_},n.instance_=null,n}(),ZX=function(n,e){for(var t=0,i=Object.keys(e);t<i.length;t++){var r=i[t];Object.defineProperty(n,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return n},ng=function(n){var e=n&&n.ownerDocument&&n.ownerDocument.defaultView;return e||X2},JX=G3(0,0,0,0);function q2(n){return parseFloat(n)||0}function rU(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(i,r){var o=n["border-"+r+"-width"];return i+q2(o)},0)}function T2e(n){for(var e=["top","right","bottom","left"],t={},i=0,r=e;i<r.length;i++){var o=r[i],s=n["padding-"+o];t[o]=q2(s)}return t}function P2e(n){var e=n.getBBox();return G3(0,0,e.width,e.height)}function A2e(n){var e=n.clientWidth,t=n.clientHeight;if(!e&&!t)return JX;var i=ng(n).getComputedStyle(n),r=T2e(i),o=r.left+r.right,s=r.top+r.bottom,a=q2(i.width),l=q2(i.height);if(i.boxSizing==="border-box"&&(Math.round(a+o)!==e&&(a-=rU(i,"left","right")+o),Math.round(l+s)!==t&&(l-=rU(i,"top","bottom")+s)),!D2e(n)){var u=Math.round(a+o)-e,c=Math.round(l+s)-t;Math.abs(u)!==1&&(a-=u),Math.abs(c)!==1&&(l-=c)}return G3(r.left,r.top,a,l)}var L2e=function(){return typeof SVGGraphicsElement<"u"?function(n){return n instanceof ng(n).SVGGraphicsElement}:function(n){return n instanceof ng(n).SVGElement&&typeof n.getBBox=="function"}}();function D2e(n){return n===ng(n).document.documentElement}function R2e(n){return y4?L2e(n)?P2e(n):A2e(n):JX}function O2e(n){var e=n.x,t=n.y,i=n.width,r=n.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,s=Object.create(o.prototype);return ZX(s,{x:e,y:t,width:i,height:r,top:t,right:e+i,bottom:r+t,left:e}),s}function G3(n,e,t,i){return{x:n,y:e,width:t,height:i}}var k2e=function(){function n(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=G3(0,0,0,0),this.target=e}return n.prototype.isActive=function(){var e=R2e(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},n.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},n}(),I2e=function(){function n(e,t){var i=O2e(t);ZX(this,{target:e,contentRect:i})}return n}(),N2e=function(){function n(e,t,i){if(this.activeObservations_=[],this.observations_=new KX,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return n.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof ng(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new k2e(e)),this.controller_.addObserver(this),this.controller_.refresh())}},n.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof ng(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;!t.has(e)||(t.delete(e),t.size||this.controller_.removeObserver(this))}},n.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},n.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},n.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(i){return new I2e(i.target,i.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},n.prototype.clearActive=function(){this.activeObservations_.splice(0)},n.prototype.hasActive=function(){return this.activeObservations_.length>0},n}(),QX=typeof WeakMap<"u"?new WeakMap:new KX,$X=function(){function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=E2e.getInstance(),i=new N2e(e,t,this);QX.set(this,i)}return n}();["observe","unobserve","disconnect"].forEach(function(n){$X.prototype[n]=function(){var e;return(e=QX.get(this))[n].apply(e,arguments)}});(function(){return typeof X2.ResizeObserver<"u"?X2.ResizeObserver:$X})();(function(){if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function n(M){try{return M.defaultView&&M.defaultView.frameElement||null}catch{return null}}var e=function(M){for(var C=M,P=n(C);P;)C=P.ownerDocument,P=n(C);return C}(window.document),t=[],i=null,r=null;function o(M){this.time=M.time,this.target=M.target,this.rootBounds=y(M.rootBounds),this.boundingClientRect=y(M.boundingClientRect),this.intersectionRect=y(M.intersectionRect||m()),this.isIntersecting=!!M.intersectionRect;var C=this.boundingClientRect,P=C.width*C.height,L=this.intersectionRect,R=L.width*L.height;P?this.intersectionRatio=Number((R/P).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function s(M,C){var P=C||{};if(typeof M!="function")throw new Error("callback must be a function");if(P.root&&P.root.nodeType!=1&&P.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=l(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=M,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(P.rootMargin),this.thresholds=this._initThresholds(P.threshold),this.root=P.root||null,this.rootMargin=this._rootMarginValues.map(function(L){return L.value+L.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}s.prototype.THROTTLE_TIMEOUT=100,s.prototype.POLL_INTERVAL=null,s.prototype.USE_MUTATION_OBSERVER=!0,s._setupCrossOriginUpdater=function(){return i||(i=function(M,C){!M||!C?r=m():r=_(M,C),t.forEach(function(P){P._checkForIntersections()})}),i},s._resetCrossOriginUpdater=function(){i=null,r=null},s.prototype.observe=function(M){var C=this._observationTargets.some(function(P){return P.element==M});if(!C){if(!(M&&M.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:M,entry:null}),this._monitorIntersections(M.ownerDocument),this._checkForIntersections()}},s.prototype.unobserve=function(M){this._observationTargets=this._observationTargets.filter(function(C){return C.element!=M}),this._unmonitorIntersections(M.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},s.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},s.prototype.takeRecords=function(){var M=this._queuedEntries.slice();return this._queuedEntries=[],M},s.prototype._initThresholds=function(M){var C=M||[0];return Array.isArray(C)||(C=[C]),C.sort().filter(function(P,L,R){if(typeof P!="number"||isNaN(P)||P<0||P>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return P!==R[L-1]})},s.prototype._parseRootMargin=function(M){var C=M||"0px",P=C.split(/\s+/).map(function(L){var R=/^(-?\d*\.?\d+)(px|%)$/.exec(L);if(!R)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(R[1]),unit:R[2]}});return P[1]=P[1]||P[0],P[2]=P[2]||P[0],P[3]=P[3]||P[1],P},s.prototype._monitorIntersections=function(M){var C=M.defaultView;if(!!C&&this._monitoringDocuments.indexOf(M)==-1){var P=this._checkForIntersections,L=null,R=null;this.POLL_INTERVAL?L=C.setInterval(P,this.POLL_INTERVAL):(u(C,"resize",P,!0),u(M,"scroll",P,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in C&&(R=new C.MutationObserver(P),R.observe(M,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(M),this._monitoringUnsubscribes.push(function(){var N=M.defaultView;N&&(L&&N.clearInterval(L),c(N,"resize",P,!0)),c(M,"scroll",P,!0),R&&R.disconnect()});var E=this.root&&(this.root.ownerDocument||this.root)||e;if(M!=E){var D=n(M);D&&this._monitorIntersections(D.ownerDocument)}}},s.prototype._unmonitorIntersections=function(M){var C=this._monitoringDocuments.indexOf(M);if(C!=-1){var P=this.root&&(this.root.ownerDocument||this.root)||e,L=this._observationTargets.some(function(D){var N=D.element.ownerDocument;if(N==M)return!0;for(;N&&N!=P;){var j=n(N);if(N=j&&j.ownerDocument,N==M)return!0}return!1});if(!L){var R=this._monitoringUnsubscribes[C];if(this._monitoringDocuments.splice(C,1),this._monitoringUnsubscribes.splice(C,1),R(),M!=P){var E=n(M);E&&this._unmonitorIntersections(E.ownerDocument)}}}},s.prototype._unmonitorAllIntersections=function(){var M=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var C=0;C<M.length;C++)M[C]()},s.prototype._checkForIntersections=function(){if(!(!this.root&&i&&!r)){var M=this._rootIsInDom(),C=M?this._getRootRect():m();this._observationTargets.forEach(function(P){var L=P.element,R=p(L),E=this._rootContainsTarget(L),D=P.entry,N=M&&E&&this._computeTargetAndRootIntersection(L,R,C),j=null;this._rootContainsTarget(L)?(!i||this.root)&&(j=C):j=m();var te=P.entry=new o({time:a(),target:L,boundingClientRect:R,rootBounds:j,intersectionRect:N});D?M&&E?this._hasCrossedThreshold(D,te)&&this._queuedEntries.push(te):D&&D.isIntersecting&&this._queuedEntries.push(te):this._queuedEntries.push(te)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},s.prototype._computeTargetAndRootIntersection=function(M,C,P){if(window.getComputedStyle(M).display!="none"){for(var L=C,R=b(M),E=!1;!E&&R;){var D=null,N=R.nodeType==1?window.getComputedStyle(R):{};if(N.display=="none")return null;if(R==this.root||R.nodeType==9)if(E=!0,R==this.root||R==e)i&&!this.root?!r||r.width==0&&r.height==0?(R=null,D=null,L=null):D=r:D=P;else{var j=b(R),te=j&&p(j),ee=j&&this._computeTargetAndRootIntersection(j,te,P);te&&ee?(R=j,D=_(te,ee)):(R=null,L=null)}else{var H=R.ownerDocument;R!=H.body&&R!=H.documentElement&&N.overflow!="visible"&&(D=p(R))}if(D&&(L=h(D,L)),!L)break;R=R&&b(R)}return L}},s.prototype._getRootRect=function(){var M;if(this.root&&!w(this.root))M=p(this.root);else{var C=w(this.root)?this.root:e,P=C.documentElement,L=C.body;M={top:0,left:0,right:P.clientWidth||L.clientWidth,width:P.clientWidth||L.clientWidth,bottom:P.clientHeight||L.clientHeight,height:P.clientHeight||L.clientHeight}}return this._expandRectByRootMargin(M)},s.prototype._expandRectByRootMargin=function(M){var C=this._rootMarginValues.map(function(L,R){return L.unit=="px"?L.value:L.value*(R%2?M.width:M.height)/100}),P={top:M.top-C[0],right:M.right+C[1],bottom:M.bottom+C[2],left:M.left-C[3]};return P.width=P.right-P.left,P.height=P.bottom-P.top,P},s.prototype._hasCrossedThreshold=function(M,C){var P=M&&M.isIntersecting?M.intersectionRatio||0:-1,L=C.isIntersecting?C.intersectionRatio||0:-1;if(P!==L)for(var R=0;R<this.thresholds.length;R++){var E=this.thresholds[R];if(E==P||E==L||E<P!=E<L)return!0}},s.prototype._rootIsInDom=function(){return!this.root||g(e,this.root)},s.prototype._rootContainsTarget=function(M){var C=this.root&&(this.root.ownerDocument||this.root)||e;return g(C,M)&&(!this.root||C==M.ownerDocument)},s.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},s.prototype._unregisterInstance=function(){var M=t.indexOf(this);M!=-1&&t.splice(M,1)};function a(){return window.performance&&performance.now&&performance.now()}function l(M,C){var P=null;return function(){P||(P=setTimeout(function(){M(),P=null},C))}}function u(M,C,P,L){typeof M.addEventListener=="function"?M.addEventListener(C,P,L||!1):typeof M.attachEvent=="function"&&M.attachEvent("on"+C,P)}function c(M,C,P,L){typeof M.removeEventListener=="function"?M.removeEventListener(C,P,L||!1):typeof M.detachEvent=="function"&&M.detachEvent("on"+C,P)}function h(M,C){var P=Math.max(M.top,C.top),L=Math.min(M.bottom,C.bottom),R=Math.max(M.left,C.left),E=Math.min(M.right,C.right),D=E-R,N=L-P;return D>=0&&N>=0&&{top:P,bottom:L,left:R,right:E,width:D,height:N}||null}function p(M){var C;try{C=M.getBoundingClientRect()}catch{}return C?(C.width&&C.height||(C={top:C.top,right:C.right,bottom:C.bottom,left:C.left,width:C.right-C.left,height:C.bottom-C.top}),C):m()}function m(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function y(M){return!M||"x"in M?M:{top:M.top,y:M.top,bottom:M.bottom,left:M.left,x:M.left,right:M.right,width:M.width,height:M.height}}function _(M,C){var P=C.top-M.top,L=C.left-M.left;return{top:P,left:L,height:C.height,width:C.width,bottom:P+C.height,right:L+C.width}}function g(M,C){for(var P=C;P;){if(P==M)return!0;P=b(P)}return!1}function b(M){var C=M.parentNode;return M.nodeType==9&&M!=e?n(M):(C&&C.assignedSlot&&(C=C.assignedSlot.parentNode),C&&C.nodeType==11&&C.host?C.host:C)}function w(M){return M&&M.nodeType===9}window.IntersectionObserver=s,window.IntersectionObserverEntry=o})();const z2e=new WeakMap,oU=new WeakSet,V2e=n=>oU.has(n)?n:zl(z2e,n,()=>{const e=Object.fromEntries(Object.keys(n).map(t=>[t,H3(n,t)]));return oU.add(e),e}),Yt=_t.createContext(void 0),eq=new WeakMap,F2e=()=>new Map,wI=(n,e,t)=>{var i,r;const o=zl(eq,n,F2e),s=V2e(n.constructor.defaults);for(const[a,l]of e){if((i=o.get(a))==null||i.cancel(),l instanceof Pt){o.set(a,l.get(u=>n[a]=u));continue}if(s[a]===ku){if(!l)continue;Array.isArray(l)?n[a](...l):n[a]();continue}n[a]=l}for(const a of t)(r=o.get(a))==null||r.cancel(),n[a]=s[a]},sL=new WeakSet,sn=(n,e,t)=>{const{children:i,...r}=n,o=hn.exports.useContext(Yt),s=y2e(()=>{const u=new t;return o&&(o.append(u),sL.add(u)),u},u=>{const c=eq.get(u);if(c)for(const h of c.values())h.cancel();u.dispose()});hn.exports.useLayoutEffect(()=>{!o||sL.has(s)||(o.append(s),sL.add(s))},[o]);const[a,l]=bI(r);return wI(s,a,l),hn.exports.useLayoutEffect(()=>{!e||(typeof e=="function"?e(s):e.current=s)},[e]),s};var X3={exports:{}},l_={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sU;function B2e(){if(sU)return l_;sU=1;var n=_t,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function s(a,l,u){var c,h={},p=null,m=null;u!==void 0&&(p=""+u),l.key!==void 0&&(p=""+l.key),l.ref!==void 0&&(m=l.ref);for(c in l)i.call(l,c)&&!o.hasOwnProperty(c)&&(h[c]=l[c]);if(a&&a.defaultProps)for(c in l=a.defaultProps,l)h[c]===void 0&&(h[c]=l[c]);return{$$typeof:e,type:a,key:p,ref:m,props:h,_owner:r.current}}return l_.Fragment=t,l_.jsx=s,l_.jsxs=s,l_}(function(n){n.exports=B2e()})(X3);const U2e=X3.exports.Fragment,qt=X3.exports.jsx,aU=X3.exports.jsxs,j2e=_t.forwardRef((n,e)=>{const t=sn(n,e,wh);return qt(Yt.Provider,{value:t})}),H2e=({style:n,className:e,position:t,children:i,...r})=>{const o=hn.exports.useRef(null);return hn.exports.useLayoutEffect(()=>{const s=o.current;if(s)return s.appendChild(qX),fs.autoMount=s,()=>{fs.autoMount=!1}},[]),aU(U2e,{children:[aU("div",{style:{width:"100%",height:"100%",position:t!=null?t:"absolute",top:0,left:0,display:"flex",...n},children:[qt("div",{style:{height:"100%"},children:i}),qt("div",{ref:o,style:{height:"100%",flexGrow:1,position:"relative",overflow:"hidden"}})]}),qt(j2e,{...r})]})};var f1,Tt,tq,sy,lU,Y2={},nq=[],W2e=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Uu(n,e){for(var t in e)n[t]=e[t];return n}function iq(n){var e=n.parentNode;e&&e.removeChild(n)}function bl(n,e,t){var i,r,o,s={};for(o in e)o=="key"?i=e[o]:o=="ref"?r=e[o]:s[o]=e[o];if(arguments.length>2&&(s.children=arguments.length>3?f1.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(o in n.defaultProps)s[o]===void 0&&(s[o]=n.defaultProps[o]);return ay(n,s,i,r,null)}function ay(n,e,t,i,r){var o={type:n,props:e,key:t,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:r==null?++tq:r};return r==null&&Tt.vnode!=null&&Tt.vnode(o),o}function Nl(n){return n.children}function Xu(n,e){this.props=n,this.context=e}function ig(n,e){if(e==null)return n.__?ig(n.__,n.__.__k.indexOf(n)+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?ig(n):null}function rq(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return rq(n)}}function uU(n){(!n.__d&&(n.__d=!0)&&sy.push(n)&&!K2.__r++||lU!==Tt.debounceRendering)&&((lU=Tt.debounceRendering)||setTimeout)(K2)}function K2(){for(var n;K2.__r=sy.length;)n=sy.sort(function(e,t){return e.__v.__b-t.__v.__b}),sy=[],n.some(function(e){var t,i,r,o,s,a;e.__d&&(s=(o=(t=e).__v).__e,(a=t.__P)&&(i=[],(r=Uu({},o)).__v=o.__v+1,SI(a,o,r,t.__n,a.ownerSVGElement!==void 0,o.__h!=null?[s]:null,i,s==null?ig(o):s,o.__h),lq(i,o),o.__e!=s&&rq(o)))})}function oq(n,e,t,i,r,o,s,a,l,u){var c,h,p,m,y,_,g,b=i&&i.__k||nq,w=b.length;for(t.__k=[],c=0;c<e.length;c++)if((m=t.__k[c]=(m=e[c])==null||typeof m=="boolean"?null:typeof m=="string"||typeof m=="number"||typeof m=="bigint"?ay(null,m,null,null,m):Array.isArray(m)?ay(Nl,{children:m},null,null,null):m.__b>0?ay(m.type,m.props,m.key,null,m.__v):m)!=null){if(m.__=t,m.__b=t.__b+1,(p=b[c])===null||p&&m.key==p.key&&m.type===p.type)b[c]=void 0;else for(h=0;h<w;h++){if((p=b[h])&&m.key==p.key&&m.type===p.type){b[h]=void 0;break}p=null}SI(n,m,p=p||Y2,r,o,s,a,l,u),y=m.__e,(h=m.ref)&&p.ref!=h&&(g||(g=[]),p.ref&&g.push(p.ref,null,m),g.push(h,m.__c||y,m)),y!=null?(_==null&&(_=y),typeof m.type=="function"&&m.__k===p.__k?m.__d=l=sq(m,l,n):l=aq(n,m,p,b,y,l),typeof t.type=="function"&&(t.__d=l)):l&&p.__e==l&&l.parentNode!=n&&(l=ig(p))}for(t.__e=_,c=w;c--;)b[c]!=null&&(typeof t.type=="function"&&b[c].__e!=null&&b[c].__e==t.__d&&(t.__d=ig(i,c+1)),cq(b[c],b[c]));if(g)for(c=0;c<g.length;c++)uq(g[c],g[++c],g[++c])}function sq(n,e,t){for(var i,r=n.__k,o=0;r&&o<r.length;o++)(i=r[o])&&(i.__=n,e=typeof i.type=="function"?sq(i,e,t):aq(t,i,i,r,i.__e,e));return e}function Z2(n,e){return e=e||[],n==null||typeof n=="boolean"||(Array.isArray(n)?n.some(function(t){Z2(t,e)}):e.push(n)),e}function aq(n,e,t,i,r,o){var s,a,l;if(e.__d!==void 0)s=e.__d,e.__d=void 0;else if(t==null||r!=o||r.parentNode==null)e:if(o==null||o.parentNode!==n)n.appendChild(r),s=null;else{for(a=o,l=0;(a=a.nextSibling)&&l<i.length;l+=2)if(a==r)break e;n.insertBefore(r,o),s=o}return s!==void 0?s:r.nextSibling}function G2e(n,e,t,i,r){var o;for(o in t)o==="children"||o==="key"||o in e||J2(n,o,null,t[o],i);for(o in e)r&&typeof e[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||t[o]===e[o]||J2(n,o,e[o],t[o],i)}function cU(n,e,t){e[0]==="-"?n.setProperty(e,t):n[e]=t==null?"":typeof t!="number"||W2e.test(e)?t:t+"px"}function J2(n,e,t,i,r){var o;e:if(e==="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof i=="string"&&(n.style.cssText=i=""),i)for(e in i)t&&e in t||cU(n.style,e,"");if(t)for(e in t)i&&t[e]===i[e]||cU(n.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in n?e.toLowerCase().slice(2):e.slice(2),n.l||(n.l={}),n.l[e+o]=t,t?i||n.addEventListener(e,o?dU:hU,o):n.removeEventListener(e,o?dU:hU,o);else if(e!=="dangerouslySetInnerHTML"){if(r)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in n)try{n[e]=t==null?"":t;break e}catch{}typeof t=="function"||(t!=null&&(t!==!1||e[0]==="a"&&e[1]==="r")?n.setAttribute(e,t):n.removeAttribute(e))}}function hU(n){this.l[n.type+!1](Tt.event?Tt.event(n):n)}function dU(n){this.l[n.type+!0](Tt.event?Tt.event(n):n)}function SI(n,e,t,i,r,o,s,a,l){var u,c,h,p,m,y,_,g,b,w,M,C,P,L=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(l=t.__h,a=e.__e=t.__e,e.__h=null,o=[a]),(u=Tt.__b)&&u(e);try{e:if(typeof L=="function"){if(g=e.props,b=(u=L.contextType)&&i[u.__c],w=u?b?b.props.value:u.__:i,t.__c?_=(c=e.__c=t.__c).__=c.__E:("prototype"in L&&L.prototype.render?e.__c=c=new L(g,w):(e.__c=c=new Xu(g,w),c.constructor=L,c.render=q2e),b&&b.sub(c),c.props=g,c.state||(c.state={}),c.context=w,c.__n=i,h=c.__d=!0,c.__h=[]),c.__s==null&&(c.__s=c.state),L.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=Uu({},c.__s)),Uu(c.__s,L.getDerivedStateFromProps(g,c.__s))),p=c.props,m=c.state,h)L.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(L.getDerivedStateFromProps==null&&g!==p&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(g,w),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(g,c.__s,w)===!1||e.__v===t.__v){c.props=g,c.state=c.__s,e.__v!==t.__v&&(c.__d=!1),c.__v=e,e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(R){R&&(R.__=e)}),c.__h.length&&s.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(g,c.__s,w),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(p,m,y)})}if(c.context=w,c.props=g,c.__v=e,c.__P=n,M=Tt.__r,C=0,"prototype"in L&&L.prototype.render)c.state=c.__s,c.__d=!1,M&&M(e),u=c.render(c.props,c.state,c.context);else do c.__d=!1,M&&M(e),u=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++C<25);c.state=c.__s,c.getChildContext!=null&&(i=Uu(Uu({},i),c.getChildContext())),h||c.getSnapshotBeforeUpdate==null||(y=c.getSnapshotBeforeUpdate(p,m)),P=u!=null&&u.type===Nl&&u.key==null?u.props.children:u,oq(n,Array.isArray(P)?P:[P],e,t,i,r,o,s,a,l),c.base=e.__e,e.__h=null,c.__h.length&&s.push(c),_&&(c.__E=c.__=null),c.__e=!1}else o==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=X2e(t.__e,e,t,i,r,o,s,l);(u=Tt.diffed)&&u(e)}catch(R){e.__v=null,(l||o!=null)&&(e.__e=a,e.__h=!!l,o[o.indexOf(a)]=null),Tt.__e(R,e,t)}}function lq(n,e){Tt.__c&&Tt.__c(e,n),n.some(function(t){try{n=t.__h,t.__h=[],n.some(function(i){i.call(t)})}catch(i){Tt.__e(i,t.__v)}})}function X2e(n,e,t,i,r,o,s,a){var l,u,c,h=t.props,p=e.props,m=e.type,y=0;if(m==="svg"&&(r=!0),o!=null){for(;y<o.length;y++)if((l=o[y])&&"setAttribute"in l==!!m&&(m?l.localName===m:l.nodeType===3)){n=l,o[y]=null;break}}if(n==null){if(m===null)return document.createTextNode(p);n=r?document.createElementNS("http://www.w3.org/2000/svg",m):document.createElement(m,p.is&&p),o=null,a=!1}if(m===null)h===p||a&&n.data===p||(n.data=p);else{if(o=o&&f1.call(n.childNodes),u=(h=t.props||Y2).dangerouslySetInnerHTML,c=p.dangerouslySetInnerHTML,!a){if(o!=null)for(h={},y=0;y<n.attributes.length;y++)h[n.attributes[y].name]=n.attributes[y].value;(c||u)&&(c&&(u&&c.__html==u.__html||c.__html===n.innerHTML)||(n.innerHTML=c&&c.__html||""))}if(G2e(n,p,h,r,a),c)e.__k=[];else if(y=e.props.children,oq(n,Array.isArray(y)?y:[y],e,t,i,r&&m!=="foreignObject",o,s,o?o[0]:t.__k&&ig(t,0),a),o!=null)for(y=o.length;y--;)o[y]!=null&&iq(o[y]);a||("value"in p&&(y=p.value)!==void 0&&(y!==n.value||m==="progress"&&!y||m==="option"&&y!==h.value)&&J2(n,"value",y,h.value,!1),"checked"in p&&(y=p.checked)!==void 0&&y!==n.checked&&J2(n,"checked",y,h.checked,!1))}return n}function uq(n,e,t){try{typeof n=="function"?n(e):n.current=e}catch(i){Tt.__e(i,t)}}function cq(n,e,t){var i,r;if(Tt.unmount&&Tt.unmount(n),(i=n.ref)&&(i.current&&i.current!==n.__e||uq(i,null,e)),(i=n.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){Tt.__e(o,e)}i.base=i.__P=null}if(i=n.__k)for(r=0;r<i.length;r++)i[r]&&cq(i[r],e,typeof n.type!="function");t||n.__e==null||iq(n.__e),n.__e=n.__d=void 0}function q2e(n,e,t){return this.constructor(n,t)}function rg(n,e,t){var i,r,o;Tt.__&&Tt.__(n,e),r=(i=typeof t=="function")?null:t&&t.__k||e.__k,o=[],SI(e,n=(!i&&t||e).__k=bl(Nl,null,[n]),r||Y2,Y2,e.ownerSVGElement!==void 0,!i&&t?[t]:r?null:e.firstChild?f1.call(e.childNodes):null,o,!i&&t?t:r?r.__e:e.firstChild,i),lq(o,n)}function hq(n,e){rg(n,e,hq)}function dq(n,e,t){var i,r,o,s=Uu({},n.props);for(o in e)o=="key"?i=e[o]:o=="ref"?r=e[o]:s[o]=e[o];return arguments.length>2&&(s.children=arguments.length>3?f1.call(arguments,2):t),ay(n.type,s,i||n.key,r||n.ref,null)}f1=nq.slice,Tt={__e:function(n,e,t,i){for(var r,o,s;e=e.__;)if((r=e.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(n)),s=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(n,i||{}),s=r.__d),s)return r.__E=r}catch(a){n=a}throw n}},tq=0,Xu.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Uu({},this.state),typeof n=="function"&&(n=n(Uu({},t),this.props)),n&&Uu(t,n),n!=null&&this.__v&&(e&&this.__h.push(e),uU(this))},Xu.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),uU(this))},Xu.prototype.render=Nl,sy=[],K2.__r=0;var Y2e=0;function Se(n,e,t,i,r){var o,s,a={};for(s in e)s=="ref"?o=e[s]:a[s]=e[s];var l={type:n,props:a,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--Y2e,__source:r,__self:i};if(typeof n=="function"&&(o=n.defaultProps))for(s in o)a[s]===void 0&&(a[s]=o[s]);return Tt.vnode&&Tt.vnode(l),l}function MI(){return(MI=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n}).apply(this,arguments)}function K2e(n){this.getChildContext=function(){return n.context};var e=n.children,t=function(i,r){if(i==null)return{};var o,s,a={},l=Object.keys(i);for(s=0;s<l.length;s++)r.indexOf(o=l[s])>=0||(a[o]=i[o]);return a}(n,["context","children"]);return dq(e,t)}function Z2e(){var n=new CustomEvent("_preact",{detail:{},bubbles:!0,cancelable:!0});this.dispatchEvent(n),this._vdom=bl(K2e,MI({},this._props,{context:n.detail.context}),function e(t,i){if(t.nodeType===3)return t.data;if(t.nodeType!==1)return null;var r=[],o={},s=0,a=t.attributes,l=t.childNodes;for(s=a.length;s--;)a[s].name!=="slot"&&(o[a[s].name]=a[s].value,o[pq(a[s].name)]=a[s].value);for(s=l.length;s--;){var u=e(l[s],null),c=l[s].slot;c?o[c]=bl(pU,{name:c},u):r[s]=u}var h=i?bl(pU,null,r):r;return bl(i||t.nodeName.toLowerCase(),o,h)}(this,this._vdomComponent)),(this.hasAttribute("hydrate")?hq:rg)(this._vdom,this._root)}function pq(n){return n.replace(/-(\w)/g,function(e,t){return t?t.toUpperCase():""})}function J2e(n,e,t){if(this._vdom){var i={};i[n]=t=t==null?void 0:t,i[pq(n)]=t,this._vdom=dq(this._vdom,i),rg(this._vdom,this._root)}}function Q2e(){rg(this._vdom=null,this._root)}function pU(n,e){var t=this;return bl("slot",MI({},n,{ref:function(i){i?(t.ref=i,t._listener||(t._listener=function(r){r.stopPropagation(),r.detail.context=e},i.addEventListener("_preact",t._listener))):t.ref.removeEventListener("_preact",t._listener)}}))}function rf(n,e,t,i){function r(){var o=Reflect.construct(HTMLElement,[],r);return o._vdomComponent=n,o._root=i&&i.shadow?o.attachShadow({mode:"open"}):o,o}return(r.prototype=Object.create(HTMLElement.prototype)).constructor=r,r.prototype.connectedCallback=Z2e,r.prototype.attributeChangedCallback=J2e,r.prototype.disconnectedCallback=Q2e,t=t||n.observedAttributes||Object.keys(n.propTypes||{}),r.observedAttributes=t,t.forEach(function(o){Object.defineProperty(r.prototype,o,{get:function(){return this._vdom.props[o]},set:function(s){this._vdom?this.attributeChangedCallback(o,null,s):(this._props||(this._props={}),this._props[o]=s,this.connectedCallback());var a=typeof s;s!=null&&a!=="string"&&a!=="boolean"&&a!=="number"||this.setAttribute(o,s)}})}),customElements.define(e||n.tagName||n.displayName||n.name,r)}const $2e=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Se("path",{fill:"#fff",d:"M960 480L768 320v128H512V192h128L480 0 320 192h128v256H192V320L0 480l192 160V512h256v256H320l160 192 160-192H512V512h256v128l192-160z"})}),eCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Se("path",{fill:"#fff",d:"M929 849a30 30 0 01-30-30v-83.137a447.514 447.514 0 01-70.921 92.209C722.935 933.225 578.442 975.008 442 953.482a444.917 444.917 0 01-241.139-120.591 30 30 0 1137.258-47.01l.231-.231A385.175 385.175 0 00442 892.625v-.006c120.855 22.123 250.206-13.519 343.656-106.975a386.646 386.646 0 0070.6-96.653h-87.247a30 30 0 010-60H929a30 30 0 0130 30V819a30 30 0 01-30 30zM512 392a120 120 0 11-120 120 120 120 0 01120-120zm293.005-147.025a29.87 29.87 0 01-19.117-6.882l-.232.231A386.5 386.5 0 00689.478 168h-.011c-145.646-75.182-329.021-51.747-451.117 70.35a386.615 386.615 0 00-70.6 96.65H255a30 30 0 010 60H95a30 30 0 01-30-30V205a30 30 0 0160 0v83.129a447.534 447.534 0 0170.923-92.206C317.981 73.866 493.048 37.2 647 85.836v-.045a444.883 444.883 0 01176.143 105.291 30 30 0 01-18.138 53.893z"})}),tCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Se("path",{fill:"#fff",d:"M609.52 584.92a35.309 35.309 0 0124.98-10.36c9.37 0 18.36 3.73 24.98 10.36l189.29 189.22-.07-114.3.57-6.35c3.25-17.98 19.7-30.5 37.9-28.85 18.2 1.65 32.12 16.92 32.09 35.2v200.23c-.05 1.49-.19 2.97-.42 4.45l-.21 1.13c-.22 1.44-.55 2.85-.99 4.24l-.57 1.62-.56 1.41a34.163 34.163 0 01-7.62 11.36l2.12-2.4-.14.14-.92 1.06-1.06 1.2-.57.57-.56.57a36.378 36.378 0 01-16.23 8.39l-3.53.5-4.02.35h-199.6l-6.35-.63c-16.73-3.06-28.9-17.63-28.93-34.64l.56-6.35c3.07-16.76 17.67-28.93 34.71-28.92l114.29-.14-189.07-189.1-4.09-4.94c-9.71-14.01-8.01-32.95 4.02-45.02zm-162.06 0c12.06 12.05 13.78 30.99 4.09 45.01l-4.09 4.94-189.15 189.08 114.3.14c17.04-.01 31.65 12.17 34.71 28.92l.57 6.35c-.03 17.01-12.19 31.58-28.92 34.64l-6.35.63H173.09l-4.23-.42-3.39-.49a36.38 36.38 0 01-17.36-9.52l-1.06-1.13-.98-1.13.98 1.06-1.97-2.26.85 1.06-.42-.56a35.137 35.137 0 01-3.74-5.64l-1.13-2.68a34.71 34.71 0 01-2.11-7.33l-.28-1.13c-.21-1.47-.33-2.96-.36-4.45V659.78c-.03-18.28 13.89-33.55 32.09-35.2 18.2-1.65 34.65 10.87 37.9 28.85l.57 6.35-.07 114.36 189.29-189.22c13.77-13.77 36.11-13.77 49.88 0h-.09zm-74.71-471.71l6.35.57c16.76 3.06 28.93 17.67 28.92 34.71l-.63 6.35c-3.07 16.76-17.67 28.93-34.71 28.92l-114.3.14 189.15 189.08 4.09 4.94c10.26 15.02 7.42 35.37-6.55 47.01-13.98 11.63-34.51 10.74-47.42-2.07L208.29 233.71l.07 114.3-.57 6.35c-3.25 17.98-19.7 30.5-37.9 28.85-18.2-1.65-32.12-16.92-32.09-35.2V147.78c0-1.55.14-3.03.35-4.51l.21-1.13c.24-1.44.59-2.85 1.06-4.23a34.97 34.97 0 018.68-14.39l-2.12 2.4-.42.57 1.55-1.84-.99 1.06.92-.98 2.26-2.33c3.04-2.73 6.52-4.92 10.3-6.49l2.82-1.06c3.45-1.07 7.04-1.62 10.65-1.62l-3.6.14h.49l1.48-.14h201.31zm512.91 0l1.41.14h.42c2.43.29 4.84.79 7.19 1.48l2.82 1.06 2.61 1.2 3.04 1.76c2.09 1.33 4.03 2.89 5.78 4.66l1.13 1.2.78.98.21.14.49.64 2.33 3.17c2.35 3.83 3.98 8.07 4.8 12.49l.21 1.13c.21 1.48.35 2.96.35 4.44v200.37c-.16 18.13-14.03 33.19-32.08 34.83-18.06 1.64-34.42-10.67-37.83-28.48l-.57-6.35V233.65L659.54 422.87c-12.9 12.95-33.56 13.91-47.59 2.2-14.04-11.71-16.81-32.2-6.38-47.22l4.02-4.86 189.22-189.08-114.29-.14c-17.06.04-31.71-12.14-34.78-28.92l-.63-6.35c-.01-17.04 12.16-31.65 28.93-34.71l6.35-.57h201.27zm0 0"})}),nCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:[Se("path",{fill:"#fff",d:"M96 892.8V121.6c0-16 12.8-28.8 28.8-28.8h774.4c16 0 28.8 12.8 28.8 28.8v771.2c0 16-12.8 28.8-28.8 28.8H124.8c-16 3.2-28.8-9.6-28.8-28.8zm64-736v704h704v-704H160z"}),Se("path",{fill:"#fff",d:"M352 656V358.4c0-6.4 6.4-12.8 9.6-12.8h297.6c6.4 0 9.6 6.4 9.6 12.8V656c0 6.4-6.4 12.8-9.6 12.8H361.6c-3.2 0-9.6-6.4-9.6-12.8zm80-227.2v160h160v-160H432zm240 108.8v-48h192v48H672zm121.6-48H736v48h57.6v-48zm-633.6 48v-48h192v48H160zm124.8-48H224v48h57.6v-48z"}),Se("path",{fill:"#fff",d:"M489.6 156.8h48v192h-48v-192zm48 121.6v-57.6h-48v57.6h48zm-48 387.2h48v195.2h-48V665.6zm48 124.8v-57.6h-48v57.6h48z"})]}),iCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Se("path",{fill:"#fff",d:"M185.6 489.6h-48c-3.2 0-9.6 3.2-9.6 9.6v384c0 3.2 3.2 9.6 9.6 9.6h48c3.2 0 9.6-3.2 9.6-9.6v-384c-3.2-6.4-6.4-9.6-9.6-9.6zm217.6 236.8c6.4 0 12.8-3.2 12.8-9.6v-48c0-3.2-6.4-9.6-12.8-9.6H140.8c-6.4 0-12.8 3.2-12.8 9.6v48c0 3.2 6.4 9.6 12.8 9.6h262.4zm512-547.2v-48c0-3.2-3.2-9.6-9.6-9.6h-384c-3.2 0-9.6 3.2-9.6 9.6v48c0 3.2 3.2 9.6 9.6 9.6h384c6.4 0 9.6-6.4 9.6-9.6zM678.4 377.6c0 6.4 3.2 9.6 9.6 9.6h48c3.2 0 9.6-3.2 9.6-9.6V134.4c0-6.4-3.2-9.6-9.6-9.6h-48c-3.2 0-9.6 3.2-9.6 9.6v243.2zm-195.2 89.6v416c0 9.6 6.4 16 16 16h400c9.6 0 16-6.4 16-16v-416c0-9.6-6.4-16-16-16h-400c-9.6 0-16 9.6-16 16zm361.6 57.6v304h-288v-304h288z"})}),Us=({children:n,onClick:e,active:t,disabled:i})=>Se("div",{style:{width:30,height:30,display:"flex",alignItems:"center",justifyContent:"center",margin:6,borderRadius:4,background:t?"rgba(255, 255, 255, 0.1)":void 0,opacity:i?.25:t?1:.75,cursor:"pointer"},onClick:i||t?void 0:e,children:n});var m1,Gi,aL,fU,Q2=0,fq=[],IM=[],mU=Tt.__b,vU=Tt.__r,gU=Tt.diffed,_U=Tt.__c,yU=Tt.unmount;function q3(n,e){Tt.__h&&Tt.__h(Gi,n,Q2||e),Q2=0;var t=Gi.__H||(Gi.__H={__:[],__h:[]});return n>=t.__.length&&t.__.push({__V:IM}),t.__[n]}function Es(n){return Q2=1,rCe(vq,n)}function rCe(n,e,t){var i=q3(m1++,2);if(i.t=n,!i.__c&&(i.__=[t?t(e):vq(void 0,e),function(o){var s=i.__N?i.__N[0]:i.__[0],a=i.t(s,o);s!==a&&(i.__N=[a,i.__[1]],i.__c.setState({}))}],i.__c=Gi,!Gi.u)){Gi.u=!0;var r=Gi.shouldComponentUpdate;Gi.shouldComponentUpdate=function(o,s,a){if(!i.__c.__H)return!0;var l=i.__c.__H.__.filter(function(c){return c.__c});if(l.every(function(c){return!c.__N}))return!r||r.call(this,o,s,a);var u=!1;return l.forEach(function(c){if(c.__N){var h=c.__[0];c.__=c.__N,c.__N=void 0,h!==c.__[0]&&(u=!0)}}),!!u&&(!r||r.call(this,o,s,a))}}return i.__N||i.__}function Ts(n,e){var t=q3(m1++,3);!Tt.__s&&CI(t.__H,e)&&(t.__=n,t.i=e,Gi.__H.__h.push(t))}function mq(n,e){var t=q3(m1++,4);!Tt.__s&&CI(t.__H,e)&&(t.__=n,t.i=e,Gi.__h.push(t))}function og(n){return Q2=5,Ky(function(){return{current:n}},[])}function Ky(n,e){var t=q3(m1++,7);return CI(t.__H,e)?(t.__V=n(),t.i=e,t.__h=n,t.__V):t.__}function oCe(){for(var n;n=fq.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(NM),n.__H.__h.forEach(x4),n.__H.__h=[]}catch(e){n.__H.__h=[],Tt.__e(e,n.__v)}}Tt.__b=function(n){Gi=null,mU&&mU(n)},Tt.__r=function(n){vU&&vU(n),m1=0;var e=(Gi=n.__c).__H;e&&(aL===Gi?(e.__h=[],Gi.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=IM,t.__N=t.i=void 0})):(e.__h.forEach(NM),e.__h.forEach(x4),e.__h=[])),aL=Gi},Tt.diffed=function(n){gU&&gU(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(fq.push(e)!==1&&fU===Tt.requestAnimationFrame||((fU=Tt.requestAnimationFrame)||function(t){var i,r=function(){clearTimeout(o),xU&&cancelAnimationFrame(i),setTimeout(t)},o=setTimeout(r,100);xU&&(i=requestAnimationFrame(r))})(oCe)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==IM&&(t.__=t.__V),t.i=void 0,t.__V=IM})),aL=Gi=null},Tt.__c=function(n,e){e.some(function(t){try{t.__h.forEach(NM),t.__h=t.__h.filter(function(i){return!i.__||x4(i)})}catch(i){e.some(function(r){r.__h&&(r.__h=[])}),e=[],Tt.__e(i,t.__v)}}),_U&&_U(n,e)},Tt.unmount=function(n){yU&&yU(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(i){try{NM(i)}catch(r){e=r}}),e&&Tt.__e(e,t.__v))};var xU=typeof requestAnimationFrame=="function";function NM(n){var e=Gi,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),Gi=e}function x4(n){var e=Gi;n.__c=n.__(),Gi=e}function CI(n,e){return!n||n.length!==e.length||e.some(function(t,i){return t!==n[i]})}function vq(n,e){return typeof e=="function"?e(n):e}const ts=(n,e)=>()=>{const[t,i]=Es(()=>e());return Ts(()=>{const r=e(i);return()=>{r.cancel()}},[]),[t,n]},[Y3,sCe]=Qe(void 0);Ti(()=>Y3(void 0));const[gq,aCe]=Qe(void 0),[EI,lCe]=Qe(!1),[uCe,cCe]=Qe(!1);Qe(void 0);const v1=ts(Fv,Ti),TI=ts(VC,Wa),hCe=ts(Lk,XC),dCe=ts(zk,Vk),pCe=ts(Ek,Lp),fCe=ts(gM,dt),mCe=ts(b_,Rp),vCe=ts(DR,RR),_q=ts(Y3,sCe),yq=ts(gq,aCe),gCe=ts(EI,lCe),PI=ts(uCe,cCe),_Ce=ts(eG,$de),yCe=ts(Mk,ta),xCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",style:{left:-2},children:Se("path",{fill:"#fff",d:"M279.552 198.879a22.26 22.26 0 0135.217-20.347L933.265 628.47a22.26 22.26 0 01-11.799 40.248l-324.43 19.456a22.26 22.26 0 00-17.23 9.972l-179.11 271.227a22.26 22.26 0 01-40.738-9.929L279.597 198.88z"})}),bCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:[Se("path",{fill:"#fff",d:"M808.192 246.528a320.16 320.16 0 00-592.352 0A238.592 238.592 0 0032 479.936c0 132.352 107.648 240 240 240h91.488a32 32 0 100-64H272a176.192 176.192 0 01-176-176 175.04 175.04 0 01148.48-173.888l19.04-2.976 6.24-18.24C305.248 181.408 402.592 111.936 512 111.936a256 256 0 01242.208 172.896l6.272 18.24 19.04 2.976A175.04 175.04 0 01928 479.936c0 97.024-78.976 176-176 176h-97.28a32 32 0 100 64H752c132.352 0 240-107.648 240-240a238.592 238.592 0 00-183.808-233.408z"}),Se("path",{fill:"#fff",d:"M649.792 789.888L544 876.48V447.936a32 32 0 00-64 0V876.48l-106.752-87.424a31.968 31.968 0 10-40.544 49.504l159.04 130.24a32 32 0 0040.576 0l158.048-129.44a32 32 0 10-40.576-49.472z"})]}),wCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:[Se("path",{fill:"#fff",d:"M870.4 342.4c-12.8 0-24-11.2-24-24V153.6c0-12.8 11.2-24 24-24s24 11.2 24 24v164.8c0 12.8-11.2 24-24 24z"}),Se("path",{fill:"#fff",d:"M870.4 177.6H705.6c-12.8 0-24-11.2-24-24s11.2-24 24-24h164.8c12.8 0 24 11.2 24 24s-11.2 24-24 24zm-96 716.8H249.6c-65.6 0-120-54.4-120-120V249.6c0-65.6 54.4-120 120-120H512c12.8 0 24 11.2 24 24s-11.2 24-24 24H249.6c-40 0-72 32-72 72v524.8c0 40 32 72 72 72h524.8c40 0 72-32 72-72V512c0-12.8 11.2-24 24-24s24 11.2 24 24v262.4c0 65.6-54.4 120-120 120z"}),Se("path",{fill:"#fff",d:"M526.4 521.6c-6.4 0-12.8-1.6-17.6-6.4-9.6-9.6-9.6-24 0-33.6l344-344c9.6-9.6 24-9.6 33.6 0 9.6 9.6 9.6 24 0 33.6l-344 344c-4.8 4.8-11.2 6.4-16 6.4z"})]}),SCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Se("path",{fill:"#fff",d:"M836.8 353.6c-11.2-3.2-20.8-6.4-32-9.6 1.6-8 3.2-14.4 4.8-22.4 24-118.4 8-214.4-46.4-246.4C710.4 44.8 624 76.8 537.6 152c-8 8-17.6 14.4-25.6 22.4-4.8-4.8-11.2-9.6-16-16-91.2-81.6-182.4-115.2-236.8-83.2-52.8 30.4-68.8 120-46.4 233.6 1.6 11.2 4.8 22.4 8 33.6-12.8 3.2-25.6 8-36.8 11.2C76.8 392 0 451.2 0 510.4c0 62.4 81.6 124.8 192 163.2 9.6 3.2 17.6 6.4 27.2 8-3.2 12.8-6.4 24-8 36.8-20.8 110.4-4.8 198.4 48 228.8 54.4 32 145.6 0 233.6-78.4 6.4-6.4 14.4-12.8 20.8-19.2 8 8 17.6 16 27.2 24 84.8 73.6 169.6 104 222.4 73.6 54.4-32 72-126.4 48-241.6-1.6-8-3.2-17.6-6.4-27.2 6.4-1.6 12.8-3.2 19.2-6.4 116.8-35.2 200-97.6 200-161.6 0-59.2-78.4-118.4-187.2-156.8zM566.4 184c75.2-65.6 144-89.6 176-72 33.6 19.2 46.4 97.6 25.6 201.6-1.6 6.4-3.2 12.8-4.8 20.8-44.8-9.6-89.6-17.6-134.4-20.8C603.2 276.8 574.4 240 544 208c6.4-9.6 14.4-16 22.4-24zm-232 430.4c9.6 17.6 20.8 35.2 32 51.2-32-3.2-62.4-8-92.8-14.4 8-28.8 19.2-59.2 32-89.6 9.6 19.2 19.2 36.8 28.8 52.8zm-60.8-240c28.8-6.4 59.2-11.2 91.2-16-11.2 16-20.8 33.6-30.4 51.2-9.6 17.6-19.2 33.6-28.8 52.8-12.8-30.4-22.4-59.2-32-88zM328 512c12.8-27.2 27.2-54.4 43.2-81.6s32-52.8 48-78.4c30.4-1.6 60.8-3.2 91.2-3.2s62.4 1.6 91.2 3.2c17.6 25.6 33.6 51.2 48 76.8s30.4 52.8 43.2 81.6c-12.8 27.2-27.2 54.4-43.2 81.6-16 27.2-32 52.8-48 78.4-30.4 1.6-60.8 3.2-92.8 3.2s-62.4-1.6-91.2-3.2C400 644.8 384 619.2 368 592s-25.6-52.8-40-80zm361.6 102.4l28.8-52.8c12.8 28.8 24 59.2 33.6 88-30.4 6.4-62.4 12.8-94.4 16 11.2-16 22.4-33.6 32-51.2zm28.8-153.6L689.6 408c-9.6-17.6-20.8-33.6-30.4-49.6 32 4.8 62.4 9.6 91.2 16-8 30.4-19.2 59.2-32 86.4zM512 236.8c20.8 22.4 40 46.4 59.2 72-40-1.6-80-1.6-118.4 0 19.2-27.2 40-51.2 59.2-72zM280 113.6c33.6-19.2 108.8 8 187.2 78.4 4.8 4.8 9.6 9.6 16 14.4C452.8 240 424 275.2 396.8 312c-44.8 4.8-89.6 11.2-134.4 20.8-3.2-9.6-4.8-20.8-6.4-30.4-19.2-97.6-6.4-169.6 24-188.8zm-48 528c-8-3.2-16-4.8-25.6-8-43.2-12.8-91.2-35.2-126.4-62.4C59.2 556.8 46.4 536 41.6 512c0-36.8 64-83.2 155.2-115.2 11.2-4.8 22.4-8 35.2-11.2 14.4 43.2 30.4 86.4 49.6 128-19.2 40-36.8 83.2-49.6 128zm232 195.2c-33.6 30.4-72 54.4-113.6 70.4-22.4 11.2-48 11.2-70.4 3.2-32-19.2-44.8-89.6-27.2-184 1.6-11.2 4.8-22.4 8-33.6 44.8 9.6 89.6 16 136 19.2 25.6 36.8 56 73.6 86.4 107.2-6.4 6.4-12.8 12.8-19.2 17.6zm49.6-48c-20.8-22.4-40-46.4-60.8-72 19.2 0 38.4 1.6 59.2 1.6 20.8 0 41.6 0 60.8-1.6-19.2 24-38.4 48-59.2 72zM774.4 848c-1.6 24-14.4 48-33.6 62.4-32 19.2-99.2-4.8-172.8-68.8-8-8-16-14.4-25.6-22.4 30.4-33.6 59.2-68.8 84.8-107.2 46.4-3.2 91.2-11.2 136-20.8l4.8 24c11.2 43.2 12.8 89.6 6.4 132.8zm36.8-214.4c-4.8 1.6-11.2 3.2-17.6 4.8-14.4-43.2-32-86.4-51.2-128 19.2-40 35.2-83.2 49.6-126.4 11.2 3.2 20.8 6.4 30.4 9.6 92.8 32 158.4 80 158.4 116.8 0 40-68.8 89.6-169.6 123.2zM512 603.2c51.2 0 91.2-41.6 91.2-91.2s-41.6-91.2-91.2-91.2-91.2 41.6-91.2 91.2 40 91.2 91.2 91.2z"})}),MCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Se("path",{fill:"#fff",d:"M777.8 128.6H624L512 305.8l-96-177.2H64L512 896l448-767.4H777.8zm-602.4 64H283L512 589l228.8-396.4h107.6L512 769 175.4 192.6z"})}),CCe=()=>Se("div",{style:{width:"60%",height:2,background:"rgba(255, 255, 255, 0.1)",margin:12}}),TS=({children:n})=>!Array.isArray(n)||!n.length?null:Se(Nl,{children:[n,Se(CCe,{})]}),g1=()=>{const n=og(null);return Ts(()=>{const e=n.current;if(!e)return;const t=i=>i.stopPropagation();return e.addEventListener("mousedown",t),e.addEventListener("pointerdown",t),e.addEventListener("touchstart",t),e.addEventListener("keydown",t),()=>{e.removeEventListener("mousedown",t),e.removeEventListener("pointerdown",t),e.removeEventListener("touchstart",t),e.removeEventListener("keydown",t)}},[]),n},ECe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:[Se("path",{fill:"#fff",d:"M856.2 47.8H167.8c-66.2 0-120 53.8-120 120v688.6c0 66.2 53.8 120 120 120h688.6c66.2 0 120-53.8 120-120V167.8c-.2-66.2-54-120-120.2-120zm60 808.4c0 33-27 60-60 60H167.8c-33 0-60-27-60-60V167.8c0-33 27-60 60-60h688.6c33 0 60 27 60 60v688.4z"}),Se("path",{fill:"#fff",d:"M646.6 466.2l-163.4-94.4c-16.8-9.8-37-9.8-54 0-16.8 9.8-27 27.2-27 46.8v188.8c0 19.6 10 37 27 46.8 8.4 4.8 17.8 7.4 27 7.4s18.6-2.4 27-7.4l163.4-94.4c16.8-9.8 27-27.2 27-46.8-.2-19.6-10.2-37-27-46.8z"})]}),TCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:[Se("path",{fill:"#fff",d:"M195.1 334.6c-72.2 0-131-58.7-131-131s58.7-131.1 131-131.1c35 0 67.9 13.6 92.6 38.3 24.8 24.7 38.4 57.6 38.4 92.7 0 35-13.6 67.9-38.3 92.7-24.7 24.8-57.6 38.4-92.7 38.4.1 0 .1 0 0 0zm0-215.8c-46.8 0-84.8 38.1-84.8 84.8 0 46.7 38.1 84.8 84.8 84.8 22.7 0 43.9-8.8 60-24.9 16-16 24.8-37.3 24.8-60 0-22.6-8.8-43.9-24.9-59.9-15.9-16-37.2-24.8-59.9-24.8zm632.4 832.3c-35 0-67.9-13.6-92.6-38.3-24.8-24.7-38.4-57.7-38.4-92.7s13.6-67.9 38.3-92.7c24.7-24.8 57.7-38.4 92.7-38.4h.1c72.2 0 131 58.7 131.1 131-.1 72.2-58.9 131-131.2 131.1.1 0 0 0 0 0zm0-215.9c-22.7 0-44 8.8-60 24.9-16 16-24.8 37.3-24.8 60 0 22.7 8.8 43.9 24.9 60 16 16 37.3 24.8 59.9 24.8 46.7 0 84.8-38.1 84.8-84.8 0-46.9-38-84.9-84.8-84.9z"}),Se("path",{fill:"#fff",d:"M241.6 843.4c-47.2 0-91.6-18.5-125.2-52-33.6-33.6-52.1-78-52.1-125.2s18.5-91.7 52-125.3c33.6-33.6 78-52.1 125.2-52.1l539.6-.2c34.8 0 67.7-13.7 92.5-38.6 24.8-24.9 38.5-57.7 38.5-92.6 0-72.2-58.8-131-131.1-131h-.1l-474.1.2v-46.3l474.1-.2h.1c47.2 0 91.6 18.5 125.2 52 33.6 33.6 52.1 78 52.1 125.2s-18.5 91.7-52 125.3c-33.6 33.6-78 52.1-125.2 52.1l-539.6.3c-72.3 0-131 58.8-131 131.1 0 72.2 58.8 131 131.1 131h.1l481.8-.2v46.3l-481.9.2z"})]}),K3=(()=>{if(typeof self>"u")return!1;if(!("top"in self&&self!==top)){if("showOpenFilePicker"in self)return"showOpenFilePicker"}return!1})(),PCe=K3?Promise.resolve().then(function(){return ICe}):Promise.resolve().then(function(){return VCe});async function ACe(...n){return(await PCe).default(...n)}const LCe=K3?Promise.resolve().then(function(){return NCe}):Promise.resolve().then(function(){return FCe});async function DCe(...n){return(await LCe).default(...n)}const RCe=K3?Promise.resolve().then(function(){return zCe}):Promise.resolve().then(function(){return BCe});async function OCe(...n){return(await RCe).default(...n)}const kCe=async n=>{const e=await n.getFile();return e.handle=n,e};var xq=async(n=[{}])=>{Array.isArray(n)||(n=[n]);const e=[];n.forEach((r,o)=>{e[o]={description:r.description||"Files",accept:{}},r.mimeTypes?r.mimeTypes.map(s=>{e[o].accept[s]=r.extensions||[]}):e[o].accept["*/*"]=r.extensions||[]});const t=await window.showOpenFilePicker({id:n[0].id,startIn:n[0].startIn,types:e,multiple:n[0].multiple||!1,excludeAcceptAllOption:n[0].excludeAcceptAllOption||!1}),i=await Promise.all(t.map(kCe));return n[0].multiple?i:i[0]},ICe={__proto__:null,default:xq};function zM(n){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var i=t.done;return Promise.resolve(t.value).then(function(r){return{value:r,done:i}})}return zM=function(t){this.s=t,this.n=t.next},zM.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var i=this.s.return;return i===void 0?Promise.resolve({value:t,done:!0}):e(i.apply(this.s,arguments))},throw:function(t){var i=this.s.return;return i===void 0?Promise.reject(t):e(i.apply(this.s,arguments))}},new zM(n)}const bq=async(n,e,t=n.name,i)=>{const r=[],o=[];var s,a=!1,l=!1;try{for(var u,c=function(h){var p,m,y,_=2;for(typeof Symbol<"u"&&(m=Symbol.asyncIterator,y=Symbol.iterator);_--;){if(m&&(p=h[m])!=null)return p.call(h);if(y&&(p=h[y])!=null)return new zM(p.call(h));m="@@asyncIterator",y="@@iterator"}throw new TypeError("Object is not async iterable")}(n.values());a=!(u=await c.next()).done;a=!1){const h=u.value,p=`${t}/${h.name}`;h.kind==="file"?o.push(h.getFile().then(m=>(m.directoryHandle=n,m.handle=h,Object.defineProperty(m,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>p})))):h.kind!=="directory"||!e||i&&i(h)||r.push(bq(h,e,p,i))}}catch(h){l=!0,s=h}finally{try{a&&c.return!=null&&await c.return()}finally{if(l)throw s}}return[...(await Promise.all(r)).flat(),...await Promise.all(o)]};var wq=async(n={})=>{n.recursive=n.recursive||!1,n.mode=n.mode||"read";const e=await window.showDirectoryPicker({id:n.id,startIn:n.startIn,mode:n.mode});return bq(e,n.recursive,void 0,n.skipDirectory)},NCe={__proto__:null,default:wq},Sq=async(n,e=[{}],t=null,i=!1,r=null)=>{Array.isArray(e)||(e=[e]),e[0].fileName=e[0].fileName||"Untitled";const o=[];let s=null;if(n instanceof Blob&&n.type?s=n.type:n.headers&&n.headers.get("content-type")&&(s=n.headers.get("content-type")),e.forEach((u,c)=>{o[c]={description:u.description||"Files",accept:{}},u.mimeTypes?(c===0&&s&&u.mimeTypes.push(s),u.mimeTypes.map(h=>{o[c].accept[h]=u.extensions||[]})):s?o[c].accept[s]=u.extensions||[]:o[c].accept["*/*"]=u.extensions||[]}),t)try{await t.getFile()}catch(u){if(t=null,i)throw u}const a=t||await window.showSaveFilePicker({suggestedName:e[0].fileName,id:e[0].id,startIn:e[0].startIn,types:o,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1});!t&&r&&r(a);const l=await a.createWritable();return"stream"in n?(await n.stream().pipeTo(l),a):"body"in n?(await n.body.pipeTo(l),a):(await l.write(await n),await l.close(),a)},zCe={__proto__:null,default:Sq},Mq=async(n=[{}])=>(Array.isArray(n)||(n=[n]),new Promise((e,t)=>{const i=document.createElement("input");i.type="file";const r=[...n.map(l=>l.mimeTypes||[]),...n.map(l=>l.extensions||[])].join();i.multiple=n[0].multiple||!1,i.accept=r||"",i.style.display="none",document.body.append(i);const o=l=>{typeof s=="function"&&s(),e(l)},s=n[0].legacySetup&&n[0].legacySetup(o,()=>s(t),i),a=()=>{window.removeEventListener("focus",a),i.remove()};i.addEventListener("click",()=>{window.addEventListener("focus",a)}),i.addEventListener("change",()=>{window.removeEventListener("focus",a),i.remove(),o(i.multiple?Array.from(i.files):i.files[0])}),i.click()})),VCe={__proto__:null,default:Mq},Cq=async(n=[{}])=>(Array.isArray(n)||(n=[n]),n[0].recursive=n[0].recursive||!1,new Promise((e,t)=>{const i=document.createElement("input");i.type="file",i.webkitdirectory=!0;const r=s=>{typeof o=="function"&&o(),e(s)},o=n[0].legacySetup&&n[0].legacySetup(r,()=>o(t),i);i.addEventListener("change",()=>{let s=Array.from(i.files);n[0].recursive?n[0].recursive&&n[0].skipDirectory&&(s=s.filter(a=>a.webkitRelativePath.split("/").every(l=>!n[0].skipDirectory({name:l,kind:"directory"})))):s=s.filter(a=>a.webkitRelativePath.split("/").length===2),r(s)}),i.click()})),FCe={__proto__:null,default:Cq},Eq=async(n,e={})=>{Array.isArray(e)&&(e=e[0]);const t=document.createElement("a");let i=n;"body"in n&&(i=await async function(s,a){const l=s.getReader(),u=new ReadableStream({start:p=>async function m(){return l.read().then(({done:y,value:_})=>{if(!y)return p.enqueue(_),m();p.close()})}()}),c=new Response(u),h=await c.blob();return l.releaseLock(),new Blob([h],{type:a})}(n.body,n.headers.get("content-type"))),t.download=e.fileName||"Untitled",t.href=URL.createObjectURL(await i);const r=()=>{typeof o=="function"&&o()},o=e.legacySetup&&e.legacySetup(r,()=>o(),t);return t.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(t.href),3e4),r()}),t.click(),null},BCe={__proto__:null,default:Eq};const UCe=Object.freeze(Object.defineProperty({__proto__:null,directoryOpen:DCe,directoryOpenLegacy:Cq,directoryOpenModern:wq,fileOpen:ACe,fileOpenLegacy:Mq,fileOpenModern:xq,fileSave:OCe,fileSaveLegacy:Eq,fileSaveModern:Sq,supported:K3},Symbol.toStringTag,{value:"Module"})),Tq=({buttons:n})=>{var e,t,i,r,o,s,a,l,u,c,h,p;const m=g1(),[y]=mCe(),[_]=vCe(),[g]=v1(),b=g&&Pp(g)&&!(g instanceof Yp);return Ts(()=>(WC(),()=>{GC()}),[]),Se("div",{ref:m,className:"lingo3d-ui lingo3d-bg",style:{width:50,height:"100%",borderRight:"1px solid rgba(255, 255, 255, 0.05)",overflow:"hidden"},children:Se("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",opacity:.75,paddingTop:12},children:[Se(TS,{children:[Se(Us,{active:y==="select",onClick:()=>$c("select"),children:Se(xCe,{})}),Se(Us,{active:y==="translate",onClick:()=>$c("translate"),children:Se($2e,{})}),Se(Us,{active:y==="rotate",disabled:b,onClick:()=>$c("rotate"),children:Se(eCe,{})}),Se(Us,{active:y==="scale",disabled:b,onClick:()=>$c("scale"),children:Se(tCe,{})}),Se(Us,{active:y==="path",onClick:()=>$c("path"),children:Se(TCe,{})}),Se(Us,{active:y==="play",onClick:()=>$c("play"),children:Se(ECe,{})})]}),Se(TS,{children:[Se(Us,{active:_==="world",onClick:()=>AR("world"),disabled:y!=="translate"&&y!=="rotate",children:Se(nCe,{})}),Se(Us,{active:_==="local",onClick:()=>AR("local"),disabled:y!=="translate"&&y!=="rotate"&&y!=="scale",children:Se(iCe,{})})]}),Se(TS,{children:[!((e=n==null?void 0:n.openJSON)!=null&&e.hidden)&&Se(Us,{onClick:(i=(t=n==null?void 0:n.openJSON)==null?void 0:t.onClick)!=null?i:VMe,children:Se(wCe,{})}),!((r=n==null?void 0:n.exportJSON)!=null&&r.hidden)&&Se(Us,{onClick:(s=(o=n==null?void 0:n.exportJSON)==null?void 0:o.onClick)!=null?s:IMe,children:Se(bCe,{})})]}),Se(TS,{children:[!((a=n==null?void 0:n.exportReact)!=null&&a.hidden)&&Se(Us,{onClick:(u=(l=n==null?void 0:n.exportReact)==null?void 0:l.onClick)!=null?u:NMe,children:Se(SCe,{})}),!((c=n==null?void 0:n.exportVue)!=null&&c.hidden)&&Se(Us,{onClick:(p=(h=n==null?void 0:n.exportVue)==null?void 0:h.onClick)!=null?p:zMe,children:Se(MCe,{})})]})]})})};rf(Tq,"lingo3d-toolbar",["buttons"]);var b4={exports:{}};/*! Tweakpane 3.1.0 (c) 2016 cocopon, licensed under the MIT license. */(function(n,e){(function(t,i){i(e)})(it,function(t){class i{constructor(f){const[x,A]=f.split("-"),F=x.split(".");this.major=parseInt(F[0],10),this.minor=parseInt(F[1],10),this.patch=parseInt(F[2],10),this.prerelease=A!=null?A:null}toString(){const f=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[f,this.prerelease].join("-"):f}}class r{constructor(f){this.controller_=f}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(f){this.controller_.viewProps.set("disabled",f)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(f){this.controller_.viewProps.set("hidden",f)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class o{constructor(f){this.target=f}}class s extends o{constructor(f,x,A,F){super(f),this.value=x,this.presetKey=A,this.last=F!=null?F:!0}}class a extends o{constructor(f,x,A){super(f),this.value=x,this.presetKey=A}}class l extends o{constructor(f,x){super(f),this.expanded=x}}class u extends o{constructor(f,x){super(f),this.index=x}}function c(S){return S==null}function h(S,f){if(S.length!==f.length)return!1;for(let x=0;x<S.length;x++)if(S[x]!==f[x])return!1;return!0}const p={alreadydisposed:()=>"View has been already disposed",invalidparams:S=>`Invalid parameters for '${S.name}'`,nomatchingcontroller:S=>`No matching controller for '${S.key}'`,nomatchingview:S=>`No matching view for '${JSON.stringify(S.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:S=>`Property '${S.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class m{constructor(f){var x;this.message=(x=p[f.type](f.context))!==null&&x!==void 0?x:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=f.type}static alreadyDisposed(){return new m({type:"alreadydisposed"})}static notBindable(){return new m({type:"notbindable"})}static propertyNotFound(f){return new m({type:"propertynotfound",context:{name:f}})}static shouldNeverHappen(){return new m({type:"shouldneverhappen"})}}class y{constructor(f,x,A){this.obj_=f,this.key_=x,this.presetKey_=A!=null?A:x}static isBindable(f){return!(f===null||typeof f!="object")}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(f){this.obj_[this.key_]=f}writeProperty(f,x){const A=this.read();if(!y.isBindable(A))throw m.notBindable();if(!(f in A))throw m.propertyNotFound(f);A[f]=x}}class _ extends r{get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}get title(){var f;return(f=this.controller_.valueController.props.get("title"))!==null&&f!==void 0?f:""}set title(f){this.controller_.valueController.props.set("title",f)}on(f,x){const A=x.bind(this);return this.controller_.valueController.emitter.on(f,()=>{A(new o(this))}),this}}class g{constructor(){this.observers_={}}on(f,x){let A=this.observers_[f];return A||(A=this.observers_[f]=[]),A.push({handler:x}),this}off(f,x){const A=this.observers_[f];return A&&(this.observers_[f]=A.filter(F=>F.handler!==x)),this}emit(f,x){const A=this.observers_[f];!A||A.forEach(F=>{F.handler(x)})}}const b="tp";function w(S){return(f,x)=>[b,"-",S,"v",f?`_${f}`:"",x?`-${x}`:""].join("")}function M(S,f){return x=>f(S(x))}function C(S){return S.rawValue}function P(S,f){S.emitter.on("change",M(C,f)),f(S.rawValue)}function L(S,f,x){P(S.value(f),x)}function R(S,f,x){x?S.classList.add(f):S.classList.remove(f)}function E(S,f){return x=>{R(S,f,x)}}function D(S,f){P(S,x=>{f.textContent=x!=null?x:""})}const N=w("btn");class j{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(N()),x.viewProps.bindClassModifiers(this.element);const A=f.createElement("button");A.classList.add(N("b")),x.viewProps.bindDisabled(A),this.element.appendChild(A),this.buttonElement=A;const F=f.createElement("div");F.classList.add(N("t")),D(x.props.value("title"),F),this.buttonElement.appendChild(F)}}class te{constructor(f,x){this.emitter=new g,this.onClick_=this.onClick_.bind(this),this.props=x.props,this.viewProps=x.viewProps,this.view=new j(f,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ee{constructor(f,x){var A;this.constraint_=x==null?void 0:x.constraint,this.equals_=(A=x==null?void 0:x.equals)!==null&&A!==void 0?A:(F,ce)=>F===ce,this.emitter=new g,this.rawValue_=f}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(f){this.setRawValue(f,{forceEmit:!1,last:!0})}setRawValue(f,x){const A=x!=null?x:{forceEmit:!1,last:!0},F=this.constraint_?this.constraint_.constrain(f):f;!!this.equals_(this.rawValue_,F)&&!A.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=F,this.emitter.emit("change",{options:A,rawValue:F,sender:this}))}}class H{constructor(f){this.emitter=new g,this.value_=f}get rawValue(){return this.value_}set rawValue(f){this.setRawValue(f,{forceEmit:!1,last:!0})}setRawValue(f,x){const A=x!=null?x:{forceEmit:!1,last:!0};this.value_===f&&!A.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=f,this.emitter.emit("change",{options:A,rawValue:this.value_,sender:this}))}}function Q(S,f){const x=f==null?void 0:f.constraint,A=f==null?void 0:f.equals;return!x&&!A?new H(S):new ee(S,f)}class Z{constructor(f){this.emitter=new g,this.valMap_=f;for(const x in this.valMap_)this.valMap_[x].emitter.on("change",()=>{this.emitter.emit("change",{key:x,sender:this})})}static createCore(f){return Object.keys(f).reduce((x,A)=>Object.assign(x,{[A]:Q(f[A])}),{})}static fromObject(f){const x=this.createCore(f);return new Z(x)}get(f){return this.valMap_[f].rawValue}set(f,x){this.valMap_[f].rawValue=x}value(f){return this.valMap_[f]}}function de(S,f){return Object.keys(f).reduce((A,F)=>{if(A===void 0)return;const ce=f[F],xe=ce(S[F]);return xe.succeeded?Object.assign(Object.assign({},A),{[F]:xe.value}):void 0},{})}function X(S,f){return S.reduce((x,A)=>{if(x===void 0)return;const F=f(A);if(!(!F.succeeded||F.value===void 0))return[...x,F.value]},[])}function B(S){return S===null?!1:typeof S=="object"}function U(S){return f=>x=>{if(!f&&x===void 0)return{succeeded:!1,value:void 0};if(f&&x===void 0)return{succeeded:!0,value:void 0};const A=S(x);return A!==void 0?{succeeded:!0,value:A}:{succeeded:!1,value:void 0}}}function le(S){return{custom:f=>U(f)(S),boolean:U(f=>typeof f=="boolean"?f:void 0)(S),number:U(f=>typeof f=="number"?f:void 0)(S),string:U(f=>typeof f=="string"?f:void 0)(S),function:U(f=>typeof f=="function"?f:void 0)(S),constant:f=>U(x=>x===f?f:void 0)(S),raw:U(f=>f)(S),object:f=>U(x=>{if(B(x))return de(x,f)})(S),array:f=>U(x=>{if(Array.isArray(x))return X(x,f)})(S)}}const ne={optional:le(!0),required:le(!1)};function fe(S,f){const x=ne.required.object(f)(S);return x.succeeded?x.value:void 0}function we(S){return S&&S.parentElement&&S.parentElement.removeChild(S),null}function Be(){return["veryfirst","first","last","verylast"]}const oe=w(""),tt={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class Ue{constructor(f){this.parent_=null,this.blade=f.blade,this.view=f.view,this.viewProps=f.viewProps;const x=this.view.element;this.blade.value("positions").emitter.on("change",()=>{Be().forEach(A=>{x.classList.remove(oe(void 0,tt[A]))}),this.blade.get("positions").forEach(A=>{x.classList.add(oe(void 0,tt[A]))})}),this.viewProps.handleDispose(()=>{we(x)})}get parent(){return this.parent_}}const Ve="http://www.w3.org/2000/svg";function Ae(S){S.offsetHeight}function Oe(S,f){const x=S.style.transition;S.style.transition="none",f(),S.style.transition=x}function Te(S){return S.ontouchstart!==void 0}function be(){return new Function("return this")()}function Ye(){return be().document}function Ke(S){const f=S.ownerDocument.defaultView;return f&&"document"in f?S.getContext("2d"):null}const ft={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function mt(S,f){const x=S.createElementNS(Ve,"svg");return x.innerHTML=ft[f],x}function yt(S,f,x){S.insertBefore(f,S.children[x])}function st(S){S.parentElement&&S.parentElement.removeChild(S)}function Ce(S){for(;S.children.length>0;)S.removeChild(S.children[0])}function ve(S){for(;S.childNodes.length>0;)S.removeChild(S.childNodes[0])}function k(S){return S.relatedTarget?S.relatedTarget:"explicitOriginalTarget"in S?S.explicitOriginalTarget:null}const O=w("lbl");function ie(S,f){const x=S.createDocumentFragment();return f.split(`
`).map(A=>S.createTextNode(A)).forEach((A,F)=>{F>0&&x.appendChild(S.createElement("br")),x.appendChild(A)}),x}class ge{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(O()),x.viewProps.bindClassModifiers(this.element);const A=f.createElement("div");A.classList.add(O("l")),L(x.props,"label",ce=>{c(ce)?this.element.classList.add(O(void 0,"nol")):(this.element.classList.remove(O(void 0,"nol")),ve(A),A.appendChild(ie(f,ce)))}),this.element.appendChild(A),this.labelElement=A;const F=f.createElement("div");F.classList.add(O("v")),this.element.appendChild(F),this.valueElement=F}}class ye extends Ue{constructor(f,x){const A=x.valueController.viewProps;super(Object.assign(Object.assign({},x),{view:new ge(f,{props:x.props,viewProps:A}),viewProps:A})),this.props=x.props,this.valueController=x.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const Pe={id:"button",type:"blade",accept(S){const f=ne,x=fe(S,{title:f.required.string,view:f.required.constant("button"),label:f.optional.string});return x?{params:x}:null},controller(S){return new ye(S.document,{blade:S.blade,props:Z.fromObject({label:S.params.label}),valueController:new te(S.document,{props:Z.fromObject({title:S.params.title}),viewProps:S.viewProps})})},api(S){return!(S.controller instanceof ye)||!(S.controller.valueController instanceof te)?null:new _(S.controller)}};class Xe extends Ue{constructor(f){super(f),this.value=f.value}}function re(){return new Z({positions:Q([],{equals:h})})}class Fe extends Z{constructor(f){super(f)}static create(f){const x={completed:!0,expanded:f,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},A=Z.createCore(x);return new Fe(A)}get styleExpanded(){var f;return(f=this.get("temporaryExpanded"))!==null&&f!==void 0?f:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const f=this.get("expandedHeight");return this.get("shouldFixHeight")&&!c(f)?`${f}px`:"auto"}bindExpandedClass(f,x){const A=()=>{this.styleExpanded?f.classList.add(x):f.classList.remove(x)};L(this,"expanded",A),L(this,"temporaryExpanded",A)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Ne(S,f){let x=0;return Oe(f,()=>{S.set("expandedHeight",null),S.set("temporaryExpanded",!0),Ae(f),x=f.clientHeight,S.set("temporaryExpanded",null),Ae(f)}),x}function He(S,f){f.style.height=S.styleHeight}function Ie(S,f){S.value("expanded").emitter.on("beforechange",()=>{S.set("completed",!1),c(S.get("expandedHeight"))&&S.set("expandedHeight",Ne(S,f)),S.set("shouldFixHeight",!0),Ae(f)}),S.emitter.on("change",()=>{He(S,f)}),He(S,f),f.addEventListener("transitionend",x=>{x.propertyName==="height"&&S.cleanUpTransition()})}class nt extends r{constructor(f,x){super(f),this.rackApi_=x}}function gt(S,f){return S.addBlade(Object.assign(Object.assign({},f),{view:"button"}))}function kt(S,f){return S.addBlade(Object.assign(Object.assign({},f),{view:"folder"}))}function W(S,f){const x=f!=null?f:{};return S.addBlade(Object.assign(Object.assign({},x),{view:"separator"}))}function De(S,f){return S.addBlade(Object.assign(Object.assign({},f),{view:"tab"}))}class ae{constructor(f){this.emitter=new g,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=f}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(f){for(const x of this.allItems())if(f(x))return x;return null}includes(f){return this.cache_.has(f)}add(f,x){if(this.includes(f))throw m.shouldNeverHappen();const A=x!==void 0?x:this.items_.length;this.items_.splice(A,0,f),this.cache_.add(f);const F=this.extract_(f);F&&(F.emitter.on("add",this.onSubListAdd_),F.emitter.on("remove",this.onSubListRemove_),F.allItems().forEach(ce=>{this.cache_.add(ce)})),this.emitter.emit("add",{index:A,item:f,root:this,target:this})}remove(f){const x=this.items_.indexOf(f);if(x<0)return;this.items_.splice(x,1),this.cache_.delete(f);const A=this.extract_(f);A&&(A.emitter.off("add",this.onSubListAdd_),A.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:x,item:f,root:this,target:this})}onSubListAdd_(f){this.cache_.add(f.item),this.emitter.emit("add",{index:f.index,item:f.item,root:this,target:f.target})}onSubListRemove_(f){this.cache_.delete(f.item),this.emitter.emit("remove",{index:f.index,item:f.item,root:this,target:f.target})}}class Re extends r{constructor(f){super(f),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new g,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}on(f,x){const A=x.bind(this);return this.emitter_.on(f,F=>{A(F.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(f){const x=f.sender.target.read();this.emitter_.emit("change",{event:new s(this,x,this.controller_.binding.target.presetKey,f.options.last)})}}class Me extends ye{constructor(f,x){super(f,x),this.binding=x.binding}}class bt extends r{constructor(f){super(f),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new g,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}on(f,x){const A=x.bind(this);return this.emitter_.on(f,F=>{A(F.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(f){const x=f.sender.target.read();this.emitter_.emit("update",{event:new a(this,x,this.controller_.binding.target.presetKey)})}}class It extends ye{constructor(f,x){super(f,x),this.binding=x.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function zt(S){return S instanceof Bn?S.apiSet_:S instanceof nt?S.rackApi_.apiSet_:null}function Kn(S,f){const x=S.find(A=>A.controller_===f);if(!x)throw m.shouldNeverHappen();return x}function Dt(S,f,x){if(!y.isBindable(S))throw m.notBindable();return new y(S,f,x)}class Bn extends r{constructor(f,x){super(f),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new g,this.apiSet_=new ae(zt),this.pool_=x;const A=this.controller_.rack;A.emitter.on("add",this.onRackAdd_),A.emitter.on("remove",this.onRackRemove_),A.emitter.on("inputchange",this.onRackInputChange_),A.emitter.on("monitorupdate",this.onRackMonitorUpdate_),A.children.forEach(F=>{this.setUpApi_(F)})}get children(){return this.controller_.rack.children.map(f=>Kn(this.apiSet_,f))}addInput(f,x,A){const F=A!=null?A:{},ce=this.controller_.view.element.ownerDocument,xe=this.pool_.createInput(ce,Dt(f,x,F.presetKey),F),Je=new Re(xe);return this.add(Je,F.index)}addMonitor(f,x,A){const F=A!=null?A:{},ce=this.controller_.view.element.ownerDocument,xe=this.pool_.createMonitor(ce,Dt(f,x),F),Je=new bt(xe);return this.add(Je,F.index)}addFolder(f){return kt(this,f)}addButton(f){return gt(this,f)}addSeparator(f){return W(this,f)}addTab(f){return De(this,f)}add(f,x){this.controller_.rack.add(f.controller_,x);const A=this.apiSet_.find(F=>F.controller_===f.controller_);return A&&this.apiSet_.remove(A),this.apiSet_.add(f),f}remove(f){this.controller_.rack.remove(f.controller_)}addBlade(f){const x=this.controller_.view.element.ownerDocument,A=this.pool_.createBlade(x,f),F=this.pool_.createBladeApi(A);return this.add(F,f.index)}on(f,x){const A=x.bind(this);return this.emitter_.on(f,F=>{A(F.event)}),this}setUpApi_(f){this.apiSet_.find(x=>x.controller_===f)||this.apiSet_.add(this.pool_.createBladeApi(f))}onRackAdd_(f){this.setUpApi_(f.bladeController)}onRackRemove_(f){if(f.isRoot){const x=Kn(this.apiSet_,f.bladeController);this.apiSet_.remove(x)}}onRackInputChange_(f){const x=f.bladeController;if(x instanceof Me){const A=Kn(this.apiSet_,x),F=x.binding;this.emitter_.emit("change",{event:new s(A,F.target.read(),F.target.presetKey,f.options.last)})}else if(x instanceof Xe){const A=Kn(this.apiSet_,x);this.emitter_.emit("change",{event:new s(A,x.value.rawValue,void 0,f.options.last)})}}onRackMonitorUpdate_(f){if(!(f.bladeController instanceof It))throw m.shouldNeverHappen();const x=Kn(this.apiSet_,f.bladeController),A=f.bladeController.binding;this.emitter_.emit("update",{event:new a(x,A.target.read(),A.target.presetKey)})}}class yn extends nt{constructor(f,x){super(f,new Bn(f.rackController,x)),this.emitter_=new g,this.controller_.foldable.value("expanded").emitter.on("change",A=>{this.emitter_.emit("fold",{event:new l(this,A.sender.rawValue)})}),this.rackApi_.on("change",A=>{this.emitter_.emit("change",{event:A})}),this.rackApi_.on("update",A=>{this.emitter_.emit("update",{event:A})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(f){this.controller_.foldable.set("expanded",f)}get title(){return this.controller_.props.get("title")}set title(f){this.controller_.props.set("title",f)}get children(){return this.rackApi_.children}addInput(f,x,A){return this.rackApi_.addInput(f,x,A)}addMonitor(f,x,A){return this.rackApi_.addMonitor(f,x,A)}addFolder(f){return this.rackApi_.addFolder(f)}addButton(f){return this.rackApi_.addButton(f)}addSeparator(f){return this.rackApi_.addSeparator(f)}addTab(f){return this.rackApi_.addTab(f)}add(f,x){return this.rackApi_.add(f,x)}remove(f){this.rackApi_.remove(f)}addBlade(f){return this.rackApi_.addBlade(f)}on(f,x){const A=x.bind(this);return this.emitter_.on(f,F=>{A(F.event)}),this}}class Hl extends Ue{constructor(f){super({blade:f.blade,view:f.view,viewProps:f.rackController.viewProps}),this.rackController=f.rackController}}class Ds{constructor(f,x){const A=w(x.viewName);this.element=f.createElement("div"),this.element.classList.add(A()),x.viewProps.bindClassModifiers(this.element)}}function ra(S,f){for(let x=0;x<S.length;x++){const A=S[x];if(A instanceof Me&&A.binding===f)return A}return null}function Qh(S,f){for(let x=0;x<S.length;x++){const A=S[x];if(A instanceof It&&A.binding===f)return A}return null}function Wl(S,f){for(let x=0;x<S.length;x++){const A=S[x];if(A instanceof Xe&&A.value===f)return A}return null}function Gl(S){return S instanceof se?S.rack:S instanceof Hl?S.rackController.rack:null}function z(S){const f=Gl(S);return f?f.bcSet_:null}class ${constructor(f){var x;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new g,this.blade_=f!=null?f:null,(x=this.blade_)===null||x===void 0||x.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new ae(z),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(f,x){f.parent&&f.parent.remove(f),f.parent_=this,this.bcSet_.add(f,x)}remove(f){f.parent_=null,this.bcSet_.remove(f)}find(f){return this.bcSet_.allItems().filter(x=>x instanceof f)}onSetAdd_(f){this.updatePositions_();const x=f.target===f.root;if(this.emitter.emit("add",{bladeController:f.item,index:f.index,isRoot:x,sender:this}),!x)return;const A=f.item;if(A.viewProps.emitter.on("change",this.onChildViewPropsChange_),A.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),A.viewProps.handleDispose(this.onChildDispose_),A instanceof Me)A.binding.emitter.on("change",this.onChildInputChange_);else if(A instanceof It)A.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(A instanceof Xe)A.value.emitter.on("change",this.onChildValueChange_);else{const F=Gl(A);if(F){const ce=F.emitter;ce.on("layout",this.onDescendantLayout_),ce.on("inputchange",this.onDescendantInputChange_),ce.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(f){this.updatePositions_();const x=f.target===f.root;if(this.emitter.emit("remove",{bladeController:f.item,isRoot:x,sender:this}),!x)return;const A=f.item;if(A instanceof Me)A.binding.emitter.off("change",this.onChildInputChange_);else if(A instanceof It)A.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(A instanceof Xe)A.value.emitter.off("change",this.onChildValueChange_);else{const F=Gl(A);if(F){const ce=F.emitter;ce.off("layout",this.onDescendantLayout_),ce.off("inputchange",this.onDescendantInputChange_),ce.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const f=this.bcSet_.items.filter(F=>!F.viewProps.get("hidden")),x=f[0],A=f[f.length-1];this.bcSet_.items.forEach(F=>{const ce=[];F===x&&(ce.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&ce.push("veryfirst")),F===A&&(ce.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&ce.push("verylast")),F.blade.set("positions",ce)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(f){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(f=>f.viewProps.get("disposed")).forEach(f=>{this.bcSet_.remove(f)})}onChildInputChange_(f){const x=ra(this.find(Me),f.sender);if(!x)throw m.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:x,options:f.options,sender:this})}onChildMonitorUpdate_(f){const x=Qh(this.find(It),f.sender);if(!x)throw m.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:x,sender:this})}onChildValueChange_(f){const x=Wl(this.find(Xe),f.sender);if(!x)throw m.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:x,options:f.options,sender:this})}onDescendantLayout_(f){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(f){this.emitter.emit("inputchange",{bladeController:f.bladeController,options:f.options,sender:this})}onDescendantMonitorUpdate_(f){this.emitter.emit("monitorupdate",{bladeController:f.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class se extends Ue{constructor(f,x){super(Object.assign(Object.assign({},x),{view:new Ds(f,{viewName:"brk",viewProps:x.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const A=new $(x.root?void 0:x.blade);A.emitter.on("add",this.onRackAdd_),A.emitter.on("remove",this.onRackRemove_),this.rack=A,this.viewProps.handleDispose(()=>{for(let F=this.rack.children.length-1;F>=0;F--)this.rack.children[F].viewProps.set("disposed",!0)})}onRackAdd_(f){!f.isRoot||yt(this.view.element,f.bladeController.view.element,f.index)}onRackRemove_(f){!f.isRoot||st(f.bladeController.view.element)}}const J=w("cnt");class he{constructor(f,x){var A;this.className_=w((A=x.viewName)!==null&&A!==void 0?A:"fld"),this.element=f.createElement("div"),this.element.classList.add(this.className_(),J()),x.viewProps.bindClassModifiers(this.element),this.foldable_=x.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),L(this.foldable_,"completed",E(this.element,this.className_(void 0,"cpl")));const F=f.createElement("button");F.classList.add(this.className_("b")),L(x.props,"title",Et=>{c(Et)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),x.viewProps.bindDisabled(F),this.element.appendChild(F),this.buttonElement=F;const ce=f.createElement("div");ce.classList.add(this.className_("t")),D(x.props.value("title"),ce),this.buttonElement.appendChild(ce),this.titleElement=ce;const xe=f.createElement("div");xe.classList.add(this.className_("m")),this.buttonElement.appendChild(xe);const Je=x.containerElement;Je.classList.add(this.className_("c")),this.element.appendChild(Je),this.containerElement=Je}}class Ge extends Hl{constructor(f,x){var A;const F=Fe.create((A=x.expanded)!==null&&A!==void 0?A:!0),ce=new se(f,{blade:x.blade,root:x.root,viewProps:x.viewProps});super(Object.assign(Object.assign({},x),{rackController:ce,view:new he(f,{containerElement:ce.view.element,foldable:F,props:x.props,viewName:x.root?"rot":void 0,viewProps:x.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=x.props,this.foldable=F,Ie(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const et={id:"folder",type:"blade",accept(S){const f=ne,x=fe(S,{title:f.required.string,view:f.required.constant("folder"),expanded:f.optional.boolean});return x?{params:x}:null},controller(S){return new Ge(S.document,{blade:S.blade,expanded:S.params.expanded,props:Z.fromObject({title:S.params.title}),viewProps:S.viewProps})},api(S){return S.controller instanceof Ge?new yn(S.controller,S.pool):null}};class $e extends Xe{constructor(f,x){const A=x.valueController.viewProps;super(Object.assign(Object.assign({},x),{value:x.valueController.value,view:new ge(f,{props:x.props,viewProps:A}),viewProps:A})),this.props=x.props,this.valueController=x.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class rt extends r{}const Ct=w("spr");class ct{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(Ct()),x.viewProps.bindClassModifiers(this.element);const A=f.createElement("hr");A.classList.add(Ct("r")),this.element.appendChild(A)}}class ht extends Ue{constructor(f,x){super(Object.assign(Object.assign({},x),{view:new ct(f,{viewProps:x.viewProps})}))}}const Ft={id:"separator",type:"blade",accept(S){const f=fe(S,{view:ne.required.constant("separator")});return f?{params:f}:null},controller(S){return new ht(S.document,{blade:S.blade,viewProps:S.viewProps})},api(S){return S.controller instanceof ht?new rt(S.controller):null}},Ki=w("");function Pi(S,f){return E(S,Ki(void 0,f))}class ti extends Z{constructor(f){super(f)}static create(f){var x,A;const F=f!=null?f:{},ce={disabled:(x=F.disabled)!==null&&x!==void 0?x:!1,disposed:!1,hidden:(A=F.hidden)!==null&&A!==void 0?A:!1},xe=Z.createCore(ce);return new ti(xe)}bindClassModifiers(f){L(this,"disabled",Pi(f,"disabled")),L(this,"hidden",Pi(f,"hidden"))}bindDisabled(f){L(this,"disabled",x=>{f.disabled=x})}bindTabIndex(f){L(this,"disabled",x=>{f.tabIndex=x?-1:0})}handleDispose(f){this.value("disposed").emitter.on("change",x=>{x&&f()})}}const vn=w("tbi");class wt{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(vn()),x.viewProps.bindClassModifiers(this.element),L(x.props,"selected",ce=>{ce?this.element.classList.add(vn(void 0,"sel")):this.element.classList.remove(vn(void 0,"sel"))});const A=f.createElement("button");A.classList.add(vn("b")),x.viewProps.bindDisabled(A),this.element.appendChild(A),this.buttonElement=A;const F=f.createElement("div");F.classList.add(vn("t")),D(x.props.value("title"),F),this.buttonElement.appendChild(F),this.titleElement=F}}class Ar{constructor(f,x){this.emitter=new g,this.onClick_=this.onClick_.bind(this),this.props=x.props,this.viewProps=x.viewProps,this.view=new wt(f,{props:x.props,viewProps:x.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class xn{constructor(f,x){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Ar(f,{props:x.itemProps,viewProps:ti.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new se(f,{blade:re(),viewProps:ti.create()}),this.props=x.props,L(this.props,"selected",A=>{this.itemController.props.set("selected",A),this.contentController.viewProps.set("hidden",!A)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class bn{constructor(f,x){this.controller_=f,this.rackApi_=x}get title(){var f;return(f=this.controller_.itemController.props.get("title"))!==null&&f!==void 0?f:""}set title(f){this.controller_.itemController.props.set("title",f)}get selected(){return this.controller_.props.get("selected")}set selected(f){this.controller_.props.set("selected",f)}get children(){return this.rackApi_.children}addButton(f){return this.rackApi_.addButton(f)}addFolder(f){return this.rackApi_.addFolder(f)}addSeparator(f){return this.rackApi_.addSeparator(f)}addTab(f){return this.rackApi_.addTab(f)}add(f,x){this.rackApi_.add(f,x)}remove(f){this.rackApi_.remove(f)}addInput(f,x,A){return this.rackApi_.addInput(f,x,A)}addMonitor(f,x,A){return this.rackApi_.addMonitor(f,x,A)}addBlade(f){return this.rackApi_.addBlade(f)}}class ii extends nt{constructor(f,x){super(f,new Bn(f.rackController,x)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new g,this.pageApiMap_=new Map,this.rackApi_.on("change",A=>{this.emitter_.emit("change",{event:A})}),this.rackApi_.on("update",A=>{this.emitter_.emit("update",{event:A})}),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(A=>{this.setUpPageApi_(A)})}get pages(){return this.controller_.pageSet.items.map(f=>{const x=this.pageApiMap_.get(f);if(!x)throw m.shouldNeverHappen();return x})}addPage(f){const x=this.controller_.view.element.ownerDocument,A=new xn(x,{itemProps:Z.fromObject({selected:!1,title:f.title}),props:Z.fromObject({selected:!1})});this.controller_.add(A,f.index);const F=this.pageApiMap_.get(A);if(!F)throw m.shouldNeverHappen();return F}removePage(f){this.controller_.remove(f)}on(f,x){const A=x.bind(this);return this.emitter_.on(f,F=>{A(F.event)}),this}setUpPageApi_(f){const x=this.rackApi_.apiSet_.find(F=>F.controller_===f.contentController);if(!x)throw m.shouldNeverHappen();const A=new bn(f,x);this.pageApiMap_.set(f,A)}onPageAdd_(f){this.setUpPageApi_(f.item)}onPageRemove_(f){if(!this.pageApiMap_.get(f.item))throw m.shouldNeverHappen();this.pageApiMap_.delete(f.item)}onSelect_(f){this.emitter_.emit("select",{event:new u(this,f.rawValue)})}}const Lr=-1;class oa{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=Q(!0),this.selectedIndex=Q(Lr),this.items_=[]}add(f,x){const A=x!=null?x:this.items_.length;this.items_.splice(A,0,f),f.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(f){const x=this.items_.indexOf(f);x<0||(this.items_.splice(x,1),f.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=Lr,this.empty.rawValue=!0;return}const f=this.items_.findIndex(x=>x.rawValue);f<0?(this.items_.forEach((x,A)=>{x.rawValue=A===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((x,A)=>{x.rawValue=A===f}),this.selectedIndex.rawValue=f),this.empty.rawValue=!1}onItemSelectedChange_(f){if(f.rawValue){const x=this.items_.findIndex(A=>A===f.sender);this.items_.forEach((A,F)=>{A.rawValue=F===x}),this.selectedIndex.rawValue=x}else this.keepSelection_()}}const Qt=w("tab");class Dr{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(Qt(),J()),x.viewProps.bindClassModifiers(this.element),P(x.empty,E(this.element,Qt(void 0,"nop")));const A=f.createElement("div");A.classList.add(Qt("i")),this.element.appendChild(A),this.itemsElement=A;const F=x.contentsElement;F.classList.add(Qt("c")),this.element.appendChild(F),this.contentsElement=F}}class Rs extends Hl{constructor(f,x){const A=new se(f,{blade:x.blade,viewProps:x.viewProps}),F=new oa;super({blade:x.blade,rackController:A,view:new Dr(f,{contentsElement:A.view.element,empty:F.empty,viewProps:x.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new ae(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=F}get pageSet(){return this.pageSet_}add(f,x){this.pageSet_.add(f,x)}remove(f){this.pageSet_.remove(this.pageSet_.items[f])}onPageAdd_(f){const x=f.item;yt(this.view.itemsElement,x.itemController.view.element,f.index),this.rackController.rack.add(x.contentController,f.index),this.tab.add(x.props.value("selected"))}onPageRemove_(f){const x=f.item;st(x.itemController.view.element),this.rackController.rack.remove(x.contentController),this.tab.remove(x.props.value("selected"))}}const fn={id:"tab",type:"blade",accept(S){const f=ne,x=fe(S,{pages:f.required.array(f.required.object({title:f.required.string})),view:f.required.constant("tab")});return!x||x.pages.length===0?null:{params:x}},controller(S){const f=new Rs(S.document,{blade:S.blade,viewProps:S.viewProps});return S.params.pages.forEach(x=>{const A=new xn(S.document,{itemProps:Z.fromObject({selected:!1,title:x.title}),props:Z.fromObject({selected:!1})});f.add(A)}),f},api(S){return S.controller instanceof Rs?new ii(S.controller,S.pool):null}};function Os(S,f){const x=S.accept(f.params);if(!x)return null;const A=ne.optional.boolean(f.params.disabled).value,F=ne.optional.boolean(f.params.hidden).value;return S.controller({blade:re(),document:f.document,params:Object.assign(Object.assign({},x.params),{disabled:A,hidden:F}),viewProps:ti.create({disabled:A,hidden:F})})}class dc{constructor(){this.disabled=!1,this.emitter=new g}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class sa{constructor(f,x){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=f,this.emitter=new g,this.interval_=x,this.setTimer_()}get disabled(){return this.disabled_}set disabled(f){this.disabled_=f,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const f=this.doc_.defaultView;f&&f.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const f=this.doc_.defaultView;f&&(this.timerId_=f.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class $h{constructor(f){this.constraints=f}constrain(f){return this.constraints.reduce((x,A)=>A.constrain(x),f)}}function ns(S,f){if(S instanceof f)return S;if(S instanceof $h){const x=S.constraints.reduce((A,F)=>A||(F instanceof f?F:null),null);if(x)return x}return null}class Ka{constructor(f){this.options=f}constrain(f){const x=this.options;return x.length===0||x.filter(A=>A.value===f).length>0?f:x[0].value}}class Xl{constructor(f){this.maxValue=f.max,this.minValue=f.min}constrain(f){let x=f;return c(this.minValue)||(x=Math.max(x,this.minValue)),c(this.maxValue)||(x=Math.min(x,this.maxValue)),x}}class of{constructor(f,x=0){this.step=f,this.origin=x}constrain(f){const x=this.origin%this.step,A=Math.round((f-x)/this.step);return x+A*this.step}}const sf=w("lst");class M1{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),this.props_=x.props,this.element=f.createElement("div"),this.element.classList.add(sf()),x.viewProps.bindClassModifiers(this.element);const A=f.createElement("select");A.classList.add(sf("s")),L(this.props_,"options",ce=>{Ce(A),ce.forEach((xe,Je)=>{const Et=f.createElement("option");Et.dataset.index=String(Je),Et.textContent=xe.text,Et.value=String(xe.value),A.appendChild(Et)})}),x.viewProps.bindDisabled(A),this.element.appendChild(A),this.selectElement=A;const F=f.createElement("div");F.classList.add(sf("m")),F.appendChild(mt(f,"dropdown")),this.element.appendChild(F),x.value.emitter.on("change",this.onValueChange_),this.value_=x.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class ql{constructor(f,x){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=x.props,this.value=x.value,this.viewProps=x.viewProps,this.view=new M1(f,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(f){const x=f.currentTarget.selectedOptions.item(0);if(!x)return;const A=Number(x.dataset.index);this.value.rawValue=this.props.get("options")[A].value}}const C1=w("pop");class E1{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(C1()),x.viewProps.bindClassModifiers(this.element),P(x.shows,E(this.element,C1(void 0,"v")))}}class af{constructor(f,x){this.shows=Q(!1),this.viewProps=x.viewProps,this.view=new E1(f,{shows:this.shows,viewProps:this.viewProps})}}const lf=w("txt");class pc{constructor(f,x){this.onChange_=this.onChange_.bind(this),this.element=f.createElement("div"),this.element.classList.add(lf()),x.viewProps.bindClassModifiers(this.element),this.props_=x.props,this.props_.emitter.on("change",this.onChange_);const A=f.createElement("input");A.classList.add(lf("i")),A.type="text",x.viewProps.bindDisabled(A),this.element.appendChild(A),this.inputElement=A,x.value.emitter.on("change",this.onChange_),this.value_=x.value,this.refresh()}refresh(){const f=this.props_.get("formatter");this.inputElement.value=f(this.value_.rawValue)}onChange_(){this.refresh()}}class ed{constructor(f,x){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=x.parser,this.props=x.props,this.value=x.value,this.viewProps=x.viewProps,this.view=new pc(f,{props:x.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(f){const x=f.currentTarget.value,A=this.parser_(x);c(A)||(this.value.rawValue=A),this.view.refresh()}}function T1(S){return String(S)}function P1(S){return S==="false"?!1:!!S}function Wg(S){return T1(S)}class A1{constructor(f){this.text=f}evaluate(){return Number(this.text)}toString(){return this.text}}const L1={"**":(S,f)=>Math.pow(S,f),"*":(S,f)=>S*f,"/":(S,f)=>S/f,"%":(S,f)=>S%f,"+":(S,f)=>S+f,"-":(S,f)=>S-f,"<<":(S,f)=>S<<f,">>":(S,f)=>S>>f,">>>":(S,f)=>S>>>f,"&":(S,f)=>S&f,"^":(S,f)=>S^f,"|":(S,f)=>S|f};class D1{constructor(f,x,A){this.left=x,this.operator=f,this.right=A}evaluate(){const f=L1[this.operator];if(!f)throw new Error(`unexpected binary operator: '${this.operator}`);return f(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const tE={"+":S=>S,"-":S=>-S,"~":S=>~S};class nE{constructor(f,x){this.operator=f,this.expression=x}evaluate(){const f=tE[this.operator];if(!f)throw new Error(`unexpected unary operator: '${this.operator}`);return f(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Gg(S){return(f,x)=>{for(let A=0;A<S.length;A++){const F=S[A](f,x);if(F!=="")return F}return""}}function fc(S,f){var x;const A=S.substr(f).match(/^\s+/);return(x=A&&A[0])!==null&&x!==void 0?x:""}function iE(S,f){const x=S.substr(f,1);return x.match(/^[1-9]$/)?x:""}function td(S,f){var x;const A=S.substr(f).match(/^[0-9]+/);return(x=A&&A[0])!==null&&x!==void 0?x:""}function rE(S,f){const x=td(S,f);if(x!=="")return x;const A=S.substr(f,1);if(f+=1,A!=="-"&&A!=="+")return"";const F=td(S,f);return F===""?"":A+F}function Xg(S,f){const x=S.substr(f,1);if(f+=1,x.toLowerCase()!=="e")return"";const A=rE(S,f);return A===""?"":x+A}function uf(S,f){const x=S.substr(f,1);if(x==="0")return x;const A=iE(S,f);return f+=A.length,A===""?"":A+td(S,f)}function oE(S,f){const x=uf(S,f);if(f+=x.length,x==="")return"";const A=S.substr(f,1);if(f+=A.length,A!==".")return"";const F=td(S,f);return f+=F.length,x+A+F+Xg(S,f)}function sE(S,f){const x=S.substr(f,1);if(f+=x.length,x!==".")return"";const A=td(S,f);return f+=A.length,A===""?"":x+A+Xg(S,f)}function aE(S,f){const x=uf(S,f);return f+=x.length,x===""?"":x+Xg(S,f)}const lE=Gg([oE,sE,aE]);function uE(S,f){var x;const A=S.substr(f).match(/^[01]+/);return(x=A&&A[0])!==null&&x!==void 0?x:""}function Un(S,f){const x=S.substr(f,2);if(f+=x.length,x.toLowerCase()!=="0b")return"";const A=uE(S,f);return A===""?"":x+A}function In(S,f){var x;const A=S.substr(f).match(/^[0-7]+/);return(x=A&&A[0])!==null&&x!==void 0?x:""}function cE(S,f){const x=S.substr(f,2);if(f+=x.length,x.toLowerCase()!=="0o")return"";const A=In(S,f);return A===""?"":x+A}function hE(S,f){var x;const A=S.substr(f).match(/^[0-9a-f]+/i);return(x=A&&A[0])!==null&&x!==void 0?x:""}function dE(S,f){const x=S.substr(f,2);if(f+=x.length,x.toLowerCase()!=="0x")return"";const A=hE(S,f);return A===""?"":x+A}const pE=Gg([Un,cE,dE]),fE=Gg([pE,lE]);function mE(S,f){const x=fE(S,f);return f+=x.length,x===""?null:{evaluable:new A1(x),cursor:f}}function R1(S,f){const x=S.substr(f,1);if(f+=x.length,x!=="(")return null;const A=cf(S,f);if(!A)return null;f=A.cursor,f+=fc(S,f).length;const F=S.substr(f,1);return f+=F.length,F!==")"?null:{evaluable:A.evaluable,cursor:f}}function vE(S,f){var x;return(x=mE(S,f))!==null&&x!==void 0?x:R1(S,f)}function Vi(S,f){const x=vE(S,f);if(x)return x;const A=S.substr(f,1);if(f+=A.length,A!=="+"&&A!=="-"&&A!=="~")return null;const F=Vi(S,f);return F?(f=F.cursor,{cursor:f,evaluable:new nE(A,F.evaluable)}):null}function qg(S,f,x){x+=fc(f,x).length;const A=S.filter(F=>f.startsWith(F,x))[0];return A?(x+=A.length,x+=fc(f,x).length,{cursor:x,operator:A}):null}function Yl(S,f){return(x,A)=>{const F=S(x,A);if(!F)return null;A=F.cursor;let ce=F.evaluable;for(;;){const xe=qg(f,x,A);if(!xe)break;A=xe.cursor;const Je=S(x,A);if(!Je)return null;A=Je.cursor,ce=new D1(xe.operator,ce,Je.evaluable)}return ce?{cursor:A,evaluable:ce}:null}}const O1=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((S,f)=>Yl(S,f),Vi);function cf(S,f){return f+=fc(S,f).length,O1(S,f)}function ko(S){const f=cf(S,0);return!f||f.cursor+fc(S,f.cursor).length!==S.length?null:f.evaluable}function ks(S){var f;const x=ko(S);return(f=x==null?void 0:x.evaluate())!==null&&f!==void 0?f:null}function Yg(S){if(typeof S=="number")return S;if(typeof S=="string"){const f=ks(S);if(!c(f))return f}return 0}function k1(S){return String(S)}function Fi(S){return f=>f.toFixed(Math.max(Math.min(S,20),0))}const I1=Fi(0);function nd(S){return I1(S)+"%"}function Gr(S){return String(S)}function Kg(S){return S}function co(S,f){for(;S.length<f;)S.push(void 0)}function gE(S){const f=[];return co(f,S),Q(f)}function N1(S){const f=S.indexOf(void 0);return f<0?S:S.slice(0,f)}function Za(S,f){const x=[...N1(S),f];return x.length>S.length?x.splice(0,x.length-S.length):co(x,S.length),x}function Ja({primary:S,secondary:f,forward:x,backward:A}){let F=!1;function ce(xe){F||(F=!0,xe(),F=!1)}S.emitter.on("change",xe=>{ce(()=>{f.setRawValue(x(S,f),xe.options)})}),f.emitter.on("change",xe=>{ce(()=>{S.setRawValue(A(S,f),xe.options)}),ce(()=>{f.setRawValue(x(S,f),xe.options)})}),ce(()=>{f.setRawValue(x(S,f),{forceEmit:!1,last:!0})})}function hr(S,f){const x=S*(f.altKey?.1:1)*(f.shiftKey?10:1);return f.upKey?+x:f.downKey?-x:0}function En(S){return{altKey:S.altKey,downKey:S.key==="ArrowDown",shiftKey:S.shiftKey,upKey:S.key==="ArrowUp"}}function dr(S){return{altKey:S.altKey,downKey:S.key==="ArrowLeft",shiftKey:S.shiftKey,upKey:S.key==="ArrowRight"}}function Zg(S){return S==="ArrowUp"||S==="ArrowDown"}function z1(S){return Zg(S)||S==="ArrowLeft"||S==="ArrowRight"}function id(S,f){var x,A;const F=f.ownerDocument.defaultView,ce=f.getBoundingClientRect();return{x:S.pageX-(((x=F&&F.scrollX)!==null&&x!==void 0?x:0)+ce.left),y:S.pageY-(((A=F&&F.scrollY)!==null&&A!==void 0?A:0)+ce.top)}}class Kl{constructor(f){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=f,this.emitter=new g,f.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),f.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),f.addEventListener("touchend",this.onTouchEnd_),f.addEventListener("mousedown",this.onMouseDown_)}computePosition_(f){const x=this.elem_.getBoundingClientRect();return{bounds:{width:x.width,height:x.height},point:f?{x:f.x,y:f.y}:null}}onMouseDown_(f){var x;f.preventDefault(),(x=f.currentTarget)===null||x===void 0||x.focus();const A=this.elem_.ownerDocument;A.addEventListener("mousemove",this.onDocumentMouseMove_),A.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:f.altKey,data:this.computePosition_(id(f,this.elem_)),sender:this,shiftKey:f.shiftKey})}onDocumentMouseMove_(f){this.emitter.emit("move",{altKey:f.altKey,data:this.computePosition_(id(f,this.elem_)),sender:this,shiftKey:f.shiftKey})}onDocumentMouseUp_(f){const x=this.elem_.ownerDocument;x.removeEventListener("mousemove",this.onDocumentMouseMove_),x.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:f.altKey,data:this.computePosition_(id(f,this.elem_)),sender:this,shiftKey:f.shiftKey})}onTouchStart_(f){f.preventDefault();const x=f.targetTouches.item(0),A=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:f.altKey,data:this.computePosition_(x?{x:x.clientX-A.left,y:x.clientY-A.top}:void 0),sender:this,shiftKey:f.shiftKey}),this.lastTouch_=x}onTouchMove_(f){const x=f.targetTouches.item(0),A=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:f.altKey,data:this.computePosition_(x?{x:x.clientX-A.left,y:x.clientY-A.top}:void 0),sender:this,shiftKey:f.shiftKey}),this.lastTouch_=x}onTouchEnd_(f){var x;const A=(x=f.targetTouches.item(0))!==null&&x!==void 0?x:this.lastTouch_,F=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:f.altKey,data:this.computePosition_(A?{x:A.clientX-F.left,y:A.clientY-F.top}:void 0),sender:this,shiftKey:f.shiftKey})}}function Gn(S,f,x,A,F){const ce=(S-f)/(x-f);return A+ce*(F-A)}function V1(S){return String(S.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function vi(S,f,x){return Math.min(Math.max(S,f),x)}function rd(S,f){return(S%f+f)%f}const Zi=w("txt");class _E{constructor(f,x){this.onChange_=this.onChange_.bind(this),this.props_=x.props,this.props_.emitter.on("change",this.onChange_),this.element=f.createElement("div"),this.element.classList.add(Zi(),Zi(void 0,"num")),x.arrayPosition&&this.element.classList.add(Zi(void 0,x.arrayPosition)),x.viewProps.bindClassModifiers(this.element);const A=f.createElement("input");A.classList.add(Zi("i")),A.type="text",x.viewProps.bindDisabled(A),this.element.appendChild(A),this.inputElement=A,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=x.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Zi()),this.inputElement.classList.add(Zi("i"));const F=f.createElement("div");F.classList.add(Zi("k")),this.element.appendChild(F),this.knobElement=F;const ce=f.createElementNS(Ve,"svg");ce.classList.add(Zi("g")),this.knobElement.appendChild(ce);const xe=f.createElementNS(Ve,"path");xe.classList.add(Zi("gb")),ce.appendChild(xe),this.guideBodyElem_=xe;const Je=f.createElementNS(Ve,"path");Je.classList.add(Zi("gh")),ce.appendChild(Je),this.guideHeadElem_=Je;const Et=f.createElement("div");Et.classList.add(w("tt")()),this.knobElement.appendChild(Et),this.tooltipElem_=Et,x.value.emitter.on("change",this.onChange_),this.value=x.value,this.refresh()}onDraggingChange_(f){if(f.rawValue===null){this.element.classList.remove(Zi(void 0,"drg"));return}this.element.classList.add(Zi(void 0,"drg"));const x=f.rawValue/this.props_.get("draggingScale"),A=x+(x>0?-1:x<0?1:0),F=vi(-A,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${A+F},0 L${A},4 L${A+F},8`,`M ${x},-1 L${x},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${x},4`);const ce=this.props_.get("formatter");this.tooltipElem_.textContent=ce(this.value.rawValue),this.tooltipElem_.style.left=`${x}px`}refresh(){const f=this.props_.get("formatter");this.inputElement.value=f(this.value.rawValue)}onChange_(){this.refresh()}}class mc{constructor(f,x){var A;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=x.baseStep,this.parser_=x.parser,this.props=x.props,this.sliderProps_=(A=x.sliderProps)!==null&&A!==void 0?A:null,this.value=x.value,this.viewProps=x.viewProps,this.dragging_=Q(null),this.view=new _E(f,{arrayPosition:x.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const F=new Kl(this.view.knobElement);F.emitter.on("down",this.onPointerDown_),F.emitter.on("move",this.onPointerMove_),F.emitter.on("up",this.onPointerUp_)}constrainValue_(f){var x,A;const F=(x=this.sliderProps_)===null||x===void 0?void 0:x.get("minValue"),ce=(A=this.sliderProps_)===null||A===void 0?void 0:A.get("maxValue");let xe=f;return F!==void 0&&(xe=Math.max(xe,F)),ce!==void 0&&(xe=Math.min(xe,ce)),xe}onInputChange_(f){const x=f.currentTarget.value,A=this.parser_(x);c(A)||(this.value.rawValue=this.constrainValue_(A)),this.view.refresh()}onInputKeyDown_(f){const x=hr(this.baseStep_,En(f));x!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+x),{forceEmit:!1,last:!1})}onInputKeyUp_(f){hr(this.baseStep_,En(f))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(f){if(!f.point)return null;const x=f.point.x-f.bounds.width/2;return this.constrainValue_(this.originRawValue_+x*this.props.get("draggingScale"))}onPointerMove_(f){const x=this.computeDraggingValue_(f.data);x!==null&&(this.value.setRawValue(x,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(f){const x=this.computeDraggingValue_(f.data);x!==null&&(this.value.setRawValue(x,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const hf=w("sld");class Jg{constructor(f,x){this.onChange_=this.onChange_.bind(this),this.props_=x.props,this.props_.emitter.on("change",this.onChange_),this.element=f.createElement("div"),this.element.classList.add(hf()),x.viewProps.bindClassModifiers(this.element);const A=f.createElement("div");A.classList.add(hf("t")),x.viewProps.bindTabIndex(A),this.element.appendChild(A),this.trackElement=A;const F=f.createElement("div");F.classList.add(hf("k")),this.trackElement.appendChild(F),this.knobElement=F,x.value.emitter.on("change",this.onChange_),this.value=x.value,this.update_()}update_(){const f=vi(Gn(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${f}%`}onChange_(){this.update_()}}class Qg{constructor(f,x){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=x.baseStep,this.value=x.value,this.viewProps=x.viewProps,this.props=x.props,this.view=new Jg(f,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kl(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(f,x){!f.point||this.value.setRawValue(Gn(vi(f.point.x,0,f.bounds.width),0,f.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),x)}onPointerDownOrMove_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerUp_(f){this.handlePointerEvent_(f.data,{forceEmit:!0,last:!0})}onKeyDown_(f){const x=hr(this.baseStep_,dr(f));x!==0&&this.value.setRawValue(this.value.rawValue+x,{forceEmit:!1,last:!1})}onKeyUp_(f){hr(this.baseStep_,dr(f))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const df=w("sldtxt");class yE{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(df());const A=f.createElement("div");A.classList.add(df("s")),this.sliderView_=x.sliderView,A.appendChild(this.sliderView_.element),this.element.appendChild(A);const F=f.createElement("div");F.classList.add(df("t")),this.textView_=x.textView,F.appendChild(this.textView_.element),this.element.appendChild(F)}}class od{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.sliderC_=new Qg(f,{baseStep:x.baseStep,props:x.sliderProps,value:x.value,viewProps:this.viewProps}),this.textC_=new mc(f,{baseStep:x.baseStep,parser:x.parser,props:x.textProps,sliderProps:x.sliderProps,value:x.value,viewProps:x.viewProps}),this.view=new yE(f,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Zl(S,f){S.write(f)}function pf(S){const f=ne;if(Array.isArray(S))return f.required.array(f.required.object({text:f.required.string,value:f.required.raw}))(S).value;if(typeof S=="object")return f.required.raw(S).value}function $g(S){if(S==="inline"||S==="popup")return S}function gi(S){const f=ne;return f.required.object({max:f.optional.number,min:f.optional.number,step:f.optional.number})(S).value}function ff(S){if(Array.isArray(S))return S;const f=[];return Object.keys(S).forEach(x=>{f.push({text:x,value:S[x]})}),f}function Jl(S){return c(S)?null:new Ka(ff(S))}function mf(S){const f=S?ns(S,Ka):null;return f?f.options:null}function F1(S){const f=S?ns(S,of):null;return f?f.step:null}function vf(S,f){const x=S&&ns(S,of);return x?V1(x.step):Math.max(V1(f),2)}function vc(S){const f=F1(S);return f!=null?f:1}function gc(S,f){var x;const A=S&&ns(S,of),F=Math.abs((x=A==null?void 0:A.step)!==null&&x!==void 0?x:f);return F===0?.1:Math.pow(10,Math.floor(Math.log10(F))-1)}const gf=w("ckb");class xE{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),this.element=f.createElement("div"),this.element.classList.add(gf()),x.viewProps.bindClassModifiers(this.element);const A=f.createElement("label");A.classList.add(gf("l")),this.element.appendChild(A);const F=f.createElement("input");F.classList.add(gf("i")),F.type="checkbox",A.appendChild(F),this.inputElement=F,x.viewProps.bindDisabled(this.inputElement);const ce=f.createElement("div");ce.classList.add(gf("w")),A.appendChild(ce);const xe=mt(f,"check");ce.appendChild(xe),x.value.emitter.on("change",this.onValueChange_),this.value=x.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class _c{constructor(f,x){this.onInputChange_=this.onInputChange_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.view=new xE(f,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(f){const x=f.currentTarget;this.value.rawValue=x.checked}}function bE(S){const f=[],x=Jl(S.options);return x&&f.push(x),new $h(f)}const wE={id:"input-bool",type:"input",accept:(S,f)=>{if(typeof S!="boolean")return null;const x=fe(f,{options:ne.optional.custom(pf)});return x?{initialValue:S,params:x}:null},binding:{reader:S=>P1,constraint:S=>bE(S.params),writer:S=>Zl},controller:S=>{var f;const x=S.document,A=S.value,F=S.constraint;return F&&ns(F,Ka)?new ql(x,{props:Z.fromObject({options:(f=mf(F))!==null&&f!==void 0?f:[]}),value:A,viewProps:S.viewProps}):new _c(x,{value:A,viewProps:S.viewProps})}},aa=w("col");class B1{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(aa()),x.foldable.bindExpandedClass(this.element,aa(void 0,"expanded")),L(x.foldable,"completed",E(this.element,aa(void 0,"cpl")));const A=f.createElement("div");A.classList.add(aa("h")),this.element.appendChild(A);const F=f.createElement("div");F.classList.add(aa("s")),A.appendChild(F),this.swatchElement=F;const ce=f.createElement("div");if(ce.classList.add(aa("t")),A.appendChild(ce),this.textElement=ce,x.pickerLayout==="inline"){const xe=f.createElement("div");xe.classList.add(aa("p")),this.element.appendChild(xe),this.pickerElement=xe}else this.pickerElement=null}}function Qa(S,f,x){const A=vi(S/255,0,1),F=vi(f/255,0,1),ce=vi(x/255,0,1),xe=Math.max(A,F,ce),Je=Math.min(A,F,ce),Et=xe-Je;let At=0,an=0;const Ht=(Je+xe)/2;return Et!==0&&(an=Et/(1-Math.abs(xe+Je-1)),A===xe?At=(F-ce)/Et:F===xe?At=2+(ce-A)/Et:At=4+(A-F)/Et,At=At/6+(At<0?1:0)),[At*360,an*100,Ht*100]}function _f(S,f,x){const A=(S%360+360)%360,F=vi(f/100,0,1),ce=vi(x/100,0,1),xe=(1-Math.abs(2*ce-1))*F,Je=xe*(1-Math.abs(A/60%2-1)),Et=ce-xe/2;let At,an,Ht;return A>=0&&A<60?[At,an,Ht]=[xe,Je,0]:A>=60&&A<120?[At,an,Ht]=[Je,xe,0]:A>=120&&A<180?[At,an,Ht]=[0,xe,Je]:A>=180&&A<240?[At,an,Ht]=[0,Je,xe]:A>=240&&A<300?[At,an,Ht]=[Je,0,xe]:[At,an,Ht]=[xe,0,Je],[(At+Et)*255,(an+Et)*255,(Ht+Et)*255]}function SE(S,f,x){const A=vi(S/255,0,1),F=vi(f/255,0,1),ce=vi(x/255,0,1),xe=Math.max(A,F,ce),Je=Math.min(A,F,ce),Et=xe-Je;let At;Et===0?At=0:xe===A?At=60*(((F-ce)/Et%6+6)%6):xe===F?At=60*((ce-A)/Et+2):At=60*((A-F)/Et+4);const an=xe===0?0:Et/xe,Ht=xe;return[At,an*100,Ht*100]}function U1(S,f,x){const A=rd(S,360),F=vi(f/100,0,1),ce=vi(x/100,0,1),xe=ce*F,Je=xe*(1-Math.abs(A/60%2-1)),Et=ce-xe;let At,an,Ht;return A>=0&&A<60?[At,an,Ht]=[xe,Je,0]:A>=60&&A<120?[At,an,Ht]=[Je,xe,0]:A>=120&&A<180?[At,an,Ht]=[0,xe,Je]:A>=180&&A<240?[At,an,Ht]=[0,Je,xe]:A>=240&&A<300?[At,an,Ht]=[Je,0,xe]:[At,an,Ht]=[xe,0,Je],[(At+Et)*255,(an+Et)*255,(Ht+Et)*255]}function ME(S,f,x){const A=x+f*(100-Math.abs(2*x-100))/200;return[S,A!==0?f*(100-Math.abs(2*x-100))/A:0,x+f*(100-Math.abs(2*x-100))/(2*100)]}function yc(S,f,x){const A=100-Math.abs(x*(200-f)/100-100);return[S,A!==0?f*x/A:0,x*(200-f)/(2*100)]}function Ji(S){return[S[0],S[1],S[2]]}function e0(S,f){return[S[0],S[1],S[2],f]}const CE={hsl:{hsl:(S,f,x)=>[S,f,x],hsv:ME,rgb:_f},hsv:{hsl:yc,hsv:(S,f,x)=>[S,f,x],rgb:U1},rgb:{hsl:Qa,hsv:SE,rgb:(S,f,x)=>[S,f,x]}};function yf(S,f){return[f==="float"?1:S==="rgb"?255:360,f==="float"?1:S==="rgb"?255:100,f==="float"?1:S==="rgb"?255:100]}function EE(S,f,x){var A;const F=yf(f,x);return[f==="rgb"?vi(S[0],0,F[0]):rd(S[0],F[0]),vi(S[1],0,F[1]),vi(S[2],0,F[2]),vi((A=S[3])!==null&&A!==void 0?A:1,0,1)]}function j1(S,f,x,A){const F=yf(f,x),ce=yf(f,A);return S.map((xe,Je)=>xe/F[Je]*ce[Je])}function TE(S,f,x){const A=j1(S,f.mode,f.type,"int"),F=CE[f.mode][x.mode](...A);return j1(F,x.mode,"int",x.type)}function la(S,f){return typeof S!="object"||c(S)?!1:f in S&&typeof S[f]=="number"}class pe{constructor(f,x,A="int"){this.mode=x,this.type=A,this.comps_=EE(f,x,A)}static black(f="int"){return new pe([0,0,0],"rgb",f)}static fromObject(f,x="int"){const A="a"in f?[f.r,f.g,f.b,f.a]:[f.r,f.g,f.b];return new pe(A,"rgb",x)}static toRgbaObject(f,x="int"){return f.toRgbaObject(x)}static isRgbColorObject(f){return la(f,"r")&&la(f,"g")&&la(f,"b")}static isRgbaColorObject(f){return this.isRgbColorObject(f)&&la(f,"a")}static isColorObject(f){return this.isRgbColorObject(f)}static equals(f,x){if(f.mode!==x.mode)return!1;const A=f.comps_,F=x.comps_;for(let ce=0;ce<A.length;ce++)if(A[ce]!==F[ce])return!1;return!0}getComponents(f,x="int"){return e0(TE(Ji(this.comps_),{mode:this.mode,type:this.type},{mode:f!=null?f:this.mode,type:x}),this.comps_[3])}toRgbaObject(f="int"){const x=this.getComponents("rgb",f);return{r:x[0],g:x[1],b:x[2],a:x[3]}}}const ke=w("colp");class Le{constructor(f,x){this.alphaViews_=null,this.element=f.createElement("div"),this.element.classList.add(ke());const A=f.createElement("div");A.classList.add(ke("hsv"));const F=f.createElement("div");F.classList.add(ke("sv")),this.svPaletteView_=x.svPaletteView,F.appendChild(this.svPaletteView_.element),A.appendChild(F);const ce=f.createElement("div");ce.classList.add(ke("h")),this.hPaletteView_=x.hPaletteView,ce.appendChild(this.hPaletteView_.element),A.appendChild(ce),this.element.appendChild(A);const xe=f.createElement("div");if(xe.classList.add(ke("rgb")),this.textView_=x.textView,xe.appendChild(this.textView_.element),this.element.appendChild(xe),x.alphaViews){this.alphaViews_={palette:x.alphaViews.palette,text:x.alphaViews.text};const Je=f.createElement("div");Je.classList.add(ke("a"));const Et=f.createElement("div");Et.classList.add(ke("ap")),Et.appendChild(this.alphaViews_.palette.element),Je.appendChild(Et);const At=f.createElement("div");At.classList.add(ke("at")),At.appendChild(this.alphaViews_.text.element),Je.appendChild(At),this.element.appendChild(Je)}}get allFocusableElements(){const f=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(x=>x.inputElement)];return this.alphaViews_&&f.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),f}}function pt(S){return S==="int"?"int":S==="float"?"float":void 0}function Nt(S){const f=ne;return fe(S,{alpha:f.optional.boolean,color:f.optional.object({alpha:f.optional.boolean,type:f.optional.custom(pt)}),expanded:f.optional.boolean,picker:f.optional.custom($g)})}function Kt(S){return S?.1:1}function jn(S){var f;return(f=S.color)===null||f===void 0?void 0:f.type}function Ln(S,f){return S.alpha===f.alpha&&S.mode===f.mode&&S.notation===f.notation&&S.type===f.type}function Xr(S,f){const x=S.match(/^(.+)%$/);return Math.min(x?parseFloat(x[1])*.01*f:parseFloat(S),f)}const PE={deg:S=>S,grad:S=>S*360/400,rad:S=>S*360/(2*Math.PI),turn:S=>S*360};function ho(S){const f=S.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!f)return parseFloat(S);const x=parseFloat(f[1]),A=f[2];return PE[A](x)}function sd(S){const f=S.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!f)return null;const x=[Xr(f[1],255),Xr(f[2],255),Xr(f[3],255)];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])?null:x}function H1(S){return f=>{const x=sd(f);return x?new pe(x,"rgb",S):null}}function Ql(S){const f=S.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!f)return null;const x=[Xr(f[1],255),Xr(f[2],255),Xr(f[3],255),Xr(f[4],1)];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])||isNaN(x[3])?null:x}function ad(S){return f=>{const x=Ql(f);return x?new pe(x,"rgb",S):null}}function ld(S){const f=S.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!f)return null;const x=[ho(f[1]),Xr(f[2],100),Xr(f[3],100)];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])?null:x}function gn(S){return f=>{const x=ld(f);return x?new pe(x,"hsl",S):null}}function W1(S){const f=S.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!f)return null;const x=[ho(f[1]),Xr(f[2],100),Xr(f[3],100),Xr(f[4],1)];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])||isNaN(x[3])?null:x}function t0(S){return f=>{const x=W1(f);return x?new pe(x,"hsl",S):null}}function ud(S){const f=S.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(f)return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16)];const x=S.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return x?[parseInt(x[1],16),parseInt(x[2],16),parseInt(x[3],16)]:null}function AE(S){const f=ud(S);return f?new pe(f,"rgb","int"):null}function G1(S){const f=S.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(f)return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16),Gn(parseInt(f[4]+f[4],16),0,255,0,1)];const x=S.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return x?[parseInt(x[1],16),parseInt(x[2],16),parseInt(x[3],16),Gn(parseInt(x[4],16),0,255,0,1)]:null}function LE(S){const f=G1(S);return f?new pe(f,"rgb","int"):null}function cd(S){const f=S.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!f)return null;const x=[parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])?null:x}function ua(S){return f=>{const x=cd(f);return x?new pe(x,"rgb",S):null}}function hd(S){const f=S.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!f)return null;const x=[parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]),parseFloat(f[4])];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])||isNaN(x[3])?null:x}function n0(S){return f=>{const x=hd(f);return x?new pe(x,"rgb",S):null}}const xf=[{parser:ud,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:G1,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:sd,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Ql,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:ld,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:W1,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:cd,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:hd,result:{alpha:!0,mode:"rgb",notation:"object"}}];function X1(S){return xf.reduce((f,{parser:x,result:A})=>f||(x(S)?A:null),null)}function bf(S,f="int"){const x=X1(S);return x?x.notation==="hex"&&f!=="float"?Object.assign(Object.assign({},x),{type:"int"}):x.notation==="func"?Object.assign(Object.assign({},x),{type:f}):null:null}const dd={int:[AE,LE,H1("int"),ad("int"),gn("int"),t0("int"),ua("int"),n0("int")],float:[H1("float"),ad("float"),gn("float"),t0("float"),ua("float"),n0("float")]};function q1(S){const f=dd[S];return x=>{if(typeof x!="string")return pe.black(S);const A=f.reduce((F,ce)=>F||ce(x),null);return A!=null?A:pe.black(S)}}function $l(S){const f=dd[S];return x=>f.reduce((A,F)=>A||F(x),null)}function $a(S){const f=vi(Math.floor(S),0,255).toString(16);return f.length===1?`0${f}`:f}function pd(S,f="#"){const x=Ji(S.getComponents("rgb")).map($a).join("");return`${f}${x}`}function i0(S,f="#"){const x=S.getComponents("rgb"),A=[x[0],x[1],x[2],x[3]*255].map($a).join("");return`${f}${A}`}function Y1(S,f){const x=Fi(f==="float"?2:0);return`rgb(${Ji(S.getComponents("rgb",f)).map(A=>x(A)).join(", ")})`}function DE(S){return f=>Y1(f,S)}function eu(S,f){const x=Fi(2),A=Fi(f==="float"?2:0);return`rgba(${S.getComponents("rgb",f).map((F,ce)=>(ce===3?x:A)(F)).join(", ")})`}function wf(S){return f=>eu(f,S)}function r0(S){const f=[Fi(0),nd,nd];return`hsl(${Ji(S.getComponents("hsl")).map((x,A)=>f[A](x)).join(", ")})`}function RE(S){const f=[Fi(0),nd,nd,Fi(2)];return`hsla(${S.getComponents("hsl").map((x,A)=>f[A](x)).join(", ")})`}function o0(S,f){const x=Fi(f==="float"?2:0),A=["r","g","b"];return`{${Ji(S.getComponents("rgb",f)).map((F,ce)=>`${A[ce]}: ${x(F)}`).join(", ")}}`}function OE(S){return f=>o0(f,S)}function K1(S,f){const x=Fi(2),A=Fi(f==="float"?2:0),F=["r","g","b","a"];return`{${S.getComponents("rgb",f).map((ce,xe)=>{const Je=xe===3?x:A;return`${F[xe]}: ${Je(ce)}`}).join(", ")}}`}function Ai(S){return f=>K1(f,S)}const pr=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:pd},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:i0},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:r0},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:RE},...["int","float"].reduce((S,f)=>[...S,{format:{alpha:!1,mode:"rgb",notation:"func",type:f},stringifier:DE(f)},{format:{alpha:!0,mode:"rgb",notation:"func",type:f},stringifier:wf(f)},{format:{alpha:!1,mode:"rgb",notation:"object",type:f},stringifier:OE(f)},{format:{alpha:!0,mode:"rgb",notation:"object",type:f},stringifier:Ai(f)}],[])];function s0(S){return pr.reduce((f,x)=>f||(Ln(x.format,S)?x.stringifier:null),null)}const fd=w("apl");class Z1{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),this.value=x.value,this.value.emitter.on("change",this.onValueChange_),this.element=f.createElement("div"),this.element.classList.add(fd()),x.viewProps.bindTabIndex(this.element);const A=f.createElement("div");A.classList.add(fd("b")),this.element.appendChild(A);const F=f.createElement("div");F.classList.add(fd("c")),A.appendChild(F),this.colorElem_=F;const ce=f.createElement("div");ce.classList.add(fd("m")),this.element.appendChild(ce),this.markerElem_=ce;const xe=f.createElement("div");xe.classList.add(fd("p")),this.markerElem_.appendChild(xe),this.previewElem_=xe,this.update_()}update_(){const f=this.value.rawValue,x=f.getComponents("rgb"),A=new pe([x[0],x[1],x[2],0],"rgb"),F=new pe([x[0],x[1],x[2],255],"rgb"),ce=["to right",eu(A),eu(F)];this.colorElem_.style.background=`linear-gradient(${ce.join(",")})`,this.previewElem_.style.backgroundColor=eu(f);const xe=Gn(x[3],0,1,0,100);this.markerElem_.style.left=`${xe}%`}onValueChange_(){this.update_()}}class kE{constructor(f,x){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.view=new Z1(f,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kl(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(f,x){if(!f.point)return;const A=f.point.x/f.bounds.width,F=this.value.rawValue,[ce,xe,Je]=F.getComponents("hsv");this.value.setRawValue(new pe([ce,xe,Je,A],"hsv"),x)}onPointerDown_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerMove_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerUp_(f){this.handlePointerEvent_(f.data,{forceEmit:!0,last:!0})}onKeyDown_(f){const x=hr(Kt(!0),dr(f));if(x===0)return;const A=this.value.rawValue,[F,ce,xe,Je]=A.getComponents("hsv");this.value.setRawValue(new pe([F,ce,xe,Je+x],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(f){hr(Kt(!0),dr(f))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const el=w("coltxt");function md(S){const f=S.createElement("select"),x=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return f.appendChild(x.reduce((A,F)=>{const ce=S.createElement("option");return ce.textContent=F.text,ce.value=F.value,A.appendChild(ce),A},S.createDocumentFragment())),f}class a0{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(el());const A=f.createElement("div");A.classList.add(el("m")),this.modeElem_=md(f),this.modeElem_.classList.add(el("ms")),A.appendChild(this.modeSelectElement);const F=f.createElement("div");F.classList.add(el("mm")),F.appendChild(mt(f,"dropdown")),A.appendChild(F),this.element.appendChild(A);const ce=f.createElement("div");ce.classList.add(el("w")),this.element.appendChild(ce),this.textsElem_=ce,this.textViews_=x.textViews,this.applyTextViews_(),P(x.colorMode,xe=>{this.modeElem_.value=xe})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(f){this.textViews_=f,this.applyTextViews_()}applyTextViews_(){Ce(this.textsElem_);const f=this.element.ownerDocument;this.textViews_.forEach(x=>{const A=f.createElement("div");A.classList.add(el("c")),A.appendChild(x.element),this.textsElem_.appendChild(A)})}}function xc(S){return Fi(S==="float"?2:0)}function vd(S,f,x){const A=yf(S,f)[x];return new Xl({min:0,max:A})}function tu(S,f,x){return new mc(S,{arrayPosition:x===0?"fst":x===3-1?"lst":"mid",baseStep:Kt(!1),parser:f.parser,props:Z.fromObject({draggingScale:f.colorType==="float"?.01:1,formatter:xc(f.colorType)}),value:Q(0,{constraint:vd(f.colorMode,f.colorType,x)}),viewProps:f.viewProps})}class Sf{constructor(f,x){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=x.colorType,this.parser_=x.parser,this.value=x.value,this.viewProps=x.viewProps,this.colorMode=Q(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(f),this.view=new a0(f,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(f){const x={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},A=[tu(f,x,0),tu(f,x,1),tu(f,x,2)];return A.forEach((F,ce)=>{Ja({primary:this.value,secondary:F.value,forward:xe=>xe.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[ce],backward:(xe,Je)=>{const Et=this.colorMode.rawValue,At=xe.rawValue.getComponents(Et,this.colorType_);return At[ce]=Je.rawValue,new pe(e0(Ji(At),At[3]),Et,this.colorType_)}})}),A}onModeSelectChange_(f){const x=f.currentTarget;this.colorMode.rawValue=x.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const tl=w("hpl");class IE{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),this.value=x.value,this.value.emitter.on("change",this.onValueChange_),this.element=f.createElement("div"),this.element.classList.add(tl()),x.viewProps.bindTabIndex(this.element);const A=f.createElement("div");A.classList.add(tl("c")),this.element.appendChild(A);const F=f.createElement("div");F.classList.add(tl("m")),this.element.appendChild(F),this.markerElem_=F,this.update_()}update_(){const f=this.value.rawValue,[x]=f.getComponents("hsv");this.markerElem_.style.backgroundColor=Y1(new pe([x,100,100],"hsv"));const A=Gn(x,0,360,0,100);this.markerElem_.style.left=`${A}%`}onValueChange_(){this.update_()}}class NE{constructor(f,x){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.view=new IE(f,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kl(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(f,x){if(!f.point)return;const A=Gn(vi(f.point.x,0,f.bounds.width),0,f.bounds.width,0,359),F=this.value.rawValue,[,ce,xe,Je]=F.getComponents("hsv");this.value.setRawValue(new pe([A,ce,xe,Je],"hsv"),x)}onPointerDown_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerMove_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerUp_(f){this.handlePointerEvent_(f.data,{forceEmit:!0,last:!0})}onKeyDown_(f){const x=hr(Kt(!1),dr(f));if(x===0)return;const A=this.value.rawValue,[F,ce,xe,Je]=A.getComponents("hsv");this.value.setRawValue(new pe([F+x,ce,xe,Je],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(f){hr(Kt(!1),dr(f))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const l0=w("svp"),J1=64;class zE{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),this.value=x.value,this.value.emitter.on("change",this.onValueChange_),this.element=f.createElement("div"),this.element.classList.add(l0()),x.viewProps.bindTabIndex(this.element);const A=f.createElement("canvas");A.height=J1,A.width=J1,A.classList.add(l0("c")),this.element.appendChild(A),this.canvasElement=A;const F=f.createElement("div");F.classList.add(l0("m")),this.element.appendChild(F),this.markerElem_=F,this.update_()}update_(){const f=Ke(this.canvasElement);if(!f)return;const x=this.value.rawValue.getComponents("hsv"),A=this.canvasElement.width,F=this.canvasElement.height,ce=f.getImageData(0,0,A,F),xe=ce.data;for(let At=0;At<F;At++)for(let an=0;an<A;an++){const Ht=Gn(an,0,A,0,100),Or=Gn(At,0,F,100,0),fa=U1(x[0],Ht,Or),su=(At*A+an)*4;xe[su]=fa[0],xe[su+1]=fa[1],xe[su+2]=fa[2],xe[su+3]=255}f.putImageData(ce,0,0);const Je=Gn(x[1],0,100,0,100);this.markerElem_.style.left=`${Je}%`;const Et=Gn(x[2],0,100,100,0);this.markerElem_.style.top=`${Et}%`}onValueChange_(){this.update_()}}class Mf{constructor(f,x){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.view=new zE(f,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kl(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(f,x){if(!f.point)return;const A=Gn(f.point.x,0,f.bounds.width,0,100),F=Gn(f.point.y,0,f.bounds.height,100,0),[ce,,,xe]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new pe([ce,A,F,xe],"hsv"),x)}onPointerDown_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerMove_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerUp_(f){this.handlePointerEvent_(f.data,{forceEmit:!0,last:!0})}onKeyDown_(f){z1(f.key)&&f.preventDefault();const[x,A,F,ce]=this.value.rawValue.getComponents("hsv"),xe=Kt(!1),Je=hr(xe,dr(f)),Et=hr(xe,En(f));Je===0&&Et===0||this.value.setRawValue(new pe([x,A+Je,F+Et,ce],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(f){const x=Kt(!1),A=hr(x,dr(f)),F=hr(x,En(f));A===0&&F===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class gd{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.hPaletteC_=new NE(f,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Mf(f,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=x.supportsAlpha?{palette:new kE(f,{value:this.value,viewProps:this.viewProps}),text:new mc(f,{parser:ks,baseStep:.1,props:Z.fromObject({draggingScale:.01,formatter:Fi(2)}),value:Q(0,{constraint:new Xl({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ja({primary:this.value,secondary:this.alphaIcs_.text.value,forward:A=>A.rawValue.getComponents()[3],backward:(A,F)=>{const ce=A.rawValue.getComponents();return ce[3]=F.rawValue,new pe(ce,A.rawValue.mode)}}),this.textC_=new Sf(f,{colorType:x.colorType,parser:ks,value:this.value,viewProps:this.viewProps}),this.view=new Le(f,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:x.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const Cf=w("colsw");class G{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),x.value.emitter.on("change",this.onValueChange_),this.value=x.value,this.element=f.createElement("div"),this.element.classList.add(Cf()),x.viewProps.bindClassModifiers(this.element);const A=f.createElement("div");A.classList.add(Cf("sw")),this.element.appendChild(A),this.swatchElem_=A;const F=f.createElement("button");F.classList.add(Cf("b")),x.viewProps.bindDisabled(F),this.element.appendChild(F),this.buttonElement=F,this.update_()}update_(){const f=this.value.rawValue;this.swatchElem_.style.backgroundColor=i0(f)}onValueChange_(){this.update_()}}class bc{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.view=new G(f,{value:this.value,viewProps:this.viewProps})}}class wc{constructor(f,x){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.foldable_=Fe.create(x.expanded),this.swatchC_=new bc(f,{value:this.value,viewProps:this.viewProps});const A=this.swatchC_.view.buttonElement;A.addEventListener("blur",this.onButtonBlur_),A.addEventListener("click",this.onButtonClick_),this.textC_=new ed(f,{parser:x.parser,props:Z.fromObject({formatter:x.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new B1(f,{foldable:this.foldable_,pickerLayout:x.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=x.pickerLayout==="popup"?new af(f,{viewProps:this.viewProps}):null;const F=new gd(f,{colorType:x.colorType,supportsAlpha:x.supportsAlpha,value:this.value,viewProps:this.viewProps});F.view.allFocusableElements.forEach(ce=>{ce.addEventListener("blur",this.onPopupChildBlur_),ce.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=F,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(F.view.element),Ja({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:ce=>ce.rawValue,backward:(ce,xe)=>xe.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Ie(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(f){if(!this.popC_)return;const x=this.view.element,A=f.relatedTarget;(!A||!x.contains(A))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(f){if(!this.popC_)return;const x=this.popC_.view.element,A=k(f);A&&x.contains(A)||A&&A===this.swatchC_.view.buttonElement&&!Te(x.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(f){this.popC_?f.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&f.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function Io(S,f){return pe.isColorObject(S)?pe.fromObject(S,f):pe.black(f)}function $t(S){return Ji(S.getComponents("rgb")).reduce((f,x)=>f<<8|Math.floor(x)&255,0)}function VE(S){return S.getComponents("rgb").reduce((f,x,A)=>{const F=Math.floor(A===3?x*255:x)&255;return f<<8|F},0)>>>0}function FE(S){return new pe([S>>16&255,S>>8&255,S&255],"rgb")}function BE(S){return new pe([S>>24&255,S>>16&255,S>>8&255,Gn(S&255,0,255,0,1)],"rgb")}function nu(S){return typeof S!="number"?pe.black():FE(S)}function UE(S){return typeof S!="number"?pe.black():BE(S)}function jE(S){const f=s0(S);return f?(x,A)=>{Zl(x,f(A))}:null}function HE(S){const f=S?VE:$t;return(x,A)=>{Zl(x,f(A))}}function WE(S,f,x){const A=f.toRgbaObject(x);S.writeProperty("r",A.r),S.writeProperty("g",A.g),S.writeProperty("b",A.b),S.writeProperty("a",A.a)}function GE(S,f,x){const A=f.toRgbaObject(x);S.writeProperty("r",A.r),S.writeProperty("g",A.g),S.writeProperty("b",A.b)}function ca(S,f){return(x,A)=>{S?WE(x,A,f):GE(x,A,f)}}function u0(S){var f;return!!((S==null?void 0:S.alpha)||((f=S==null?void 0:S.color)===null||f===void 0?void 0:f.alpha))}function XE(S){return S?f=>i0(f,"0x"):f=>pd(f,"0x")}function qE(S){return"color"in S||"view"in S&&S.view==="color"}const YE={id:"input-color-number",type:"input",accept:(S,f)=>{if(typeof S!="number"||!qE(f))return null;const x=Nt(f);return x?{initialValue:S,params:x}:null},binding:{reader:S=>u0(S.params)?UE:nu,equals:pe.equals,writer:S=>HE(u0(S.params))},controller:S=>{const f=u0(S.params),x="expanded"in S.params?S.params.expanded:void 0,A="picker"in S.params?S.params.picker:void 0;return new wc(S.document,{colorType:"int",expanded:x!=null?x:!1,formatter:XE(f),parser:$l("int"),pickerLayout:A!=null?A:"popup",supportsAlpha:f,value:S.value,viewProps:S.viewProps})}};function KE(S){return pe.isRgbaColorObject(S)}function ha(S){return f=>Io(f,S)}function ZE(S,f){return x=>S?K1(x,f):o0(x,f)}const JE={id:"input-color-object",type:"input",accept:(S,f)=>{if(!pe.isColorObject(S))return null;const x=Nt(f);return x?{initialValue:S,params:x}:null},binding:{reader:S=>ha(jn(S.params)),equals:pe.equals,writer:S=>ca(KE(S.initialValue),jn(S.params))},controller:S=>{var f;const x=pe.isRgbaColorObject(S.initialValue),A="expanded"in S.params?S.params.expanded:void 0,F="picker"in S.params?S.params.picker:void 0,ce=(f=jn(S.params))!==null&&f!==void 0?f:"int";return new wc(S.document,{colorType:ce,expanded:A!=null?A:!1,formatter:ZE(x,ce),parser:$l(ce),pickerLayout:F!=null?F:"popup",supportsAlpha:x,value:S.value,viewProps:S.viewProps})}},QE={id:"input-color-string",type:"input",accept:(S,f)=>{if(typeof S!="string"||"view"in f&&f.view==="text")return null;const x=bf(S,jn(f));if(!x||!s0(x))return null;const A=Nt(f);return A?{initialValue:S,params:A}:null},binding:{reader:S=>{var f;return q1((f=jn(S.params))!==null&&f!==void 0?f:"int")},equals:pe.equals,writer:S=>{const f=bf(S.initialValue,jn(S.params));if(!f)throw m.shouldNeverHappen();const x=jE(f);if(!x)throw m.notBindable();return x}},controller:S=>{const f=bf(S.initialValue,jn(S.params));if(!f)throw m.shouldNeverHappen();const x=s0(f);if(!x)throw m.shouldNeverHappen();const A="expanded"in S.params?S.params.expanded:void 0,F="picker"in S.params?S.params.picker:void 0;return new wc(S.document,{colorType:f.type,expanded:A!=null?A:!1,formatter:x,parser:$l(f.type),pickerLayout:F!=null?F:"popup",supportsAlpha:f.alpha,value:S.value,viewProps:S.viewProps})}};class nl{constructor(f){this.components=f.components,this.asm_=f.assembly}constrain(f){const x=this.asm_.toComponents(f).map((A,F)=>{var ce,xe;return(xe=(ce=this.components[F])===null||ce===void 0?void 0:ce.constrain(A))!==null&&xe!==void 0?xe:A});return this.asm_.fromComponents(x)}}const Q1=w("pndtxt");class iu{constructor(f,x){this.textViews=x.textViews,this.element=f.createElement("div"),this.element.classList.add(Q1()),this.textViews.forEach(A=>{const F=f.createElement("div");F.classList.add(Q1("a")),F.appendChild(A.element),this.element.appendChild(F)})}}function $E(S,f,x){return new mc(S,{arrayPosition:x===0?"fst":x===f.axes.length-1?"lst":"mid",baseStep:f.axes[x].baseStep,parser:f.parser,props:f.axes[x].textProps,value:Q(0,{constraint:f.axes[x].constraint}),viewProps:f.viewProps})}class c0{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.acs_=x.axes.map((A,F)=>$E(f,x,F)),this.acs_.forEach((A,F)=>{Ja({primary:this.value,secondary:A.value,forward:ce=>x.assembly.toComponents(ce.rawValue)[F],backward:(ce,xe)=>{const Je=x.assembly.toComponents(ce.rawValue);return Je[F]=xe.rawValue,x.assembly.fromComponents(Je)}})}),this.view=new iu(f,{textViews:this.acs_.map(A=>A.view)})}}function No(S,f){return"step"in S&&!c(S.step)?new of(S.step,f):null}function $1(S){return"max"in S&&!c(S.max)||"min"in S&&!c(S.min)?new Xl({max:S.max,min:S.min}):null}function eT(S,f){const x=[],A=No(S,f);A&&x.push(A);const F=$1(S);F&&x.push(F);const ce=Jl(S.options);return ce&&x.push(ce),new $h(x)}function tT(S){const f=S?ns(S,Xl):null;return f?[f.minValue,f.maxValue]:[void 0,void 0]}function nT(S){const[f,x]=tT(S);return[f!=null?f:0,x!=null?x:100]}const iT={id:"input-number",type:"input",accept:(S,f)=>{if(typeof S!="number")return null;const x=ne,A=fe(f,{format:x.optional.function,max:x.optional.number,min:x.optional.number,options:x.optional.custom(pf),step:x.optional.number});return A?{initialValue:S,params:A}:null},binding:{reader:S=>Yg,constraint:S=>eT(S.params,S.initialValue),writer:S=>Zl},controller:S=>{var f,x;const A=S.value,F=S.constraint;if(F&&ns(F,Ka))return new ql(S.document,{props:Z.fromObject({options:(f=mf(F))!==null&&f!==void 0?f:[]}),value:A,viewProps:S.viewProps});const ce=(x="format"in S.params?S.params.format:void 0)!==null&&x!==void 0?x:Fi(vf(F,A.rawValue));if(F&&ns(F,Xl)){const[xe,Je]=nT(F);return new od(S.document,{baseStep:vc(F),parser:ks,sliderProps:Z.fromObject({maxValue:Je,minValue:xe}),textProps:Z.fromObject({draggingScale:gc(F,A.rawValue),formatter:ce}),value:A,viewProps:S.viewProps})}return new mc(S.document,{baseStep:vc(F),parser:ks,props:Z.fromObject({draggingScale:gc(F,A.rawValue),formatter:ce}),value:A,viewProps:S.viewProps})}};class da{constructor(f=0,x=0){this.x=f,this.y=x}getComponents(){return[this.x,this.y]}static isObject(f){if(c(f))return!1;const x=f.x,A=f.y;return!(typeof x!="number"||typeof A!="number")}static equals(f,x){return f.x===x.x&&f.y===x.y}toObject(){return{x:this.x,y:this.y}}}const h0={toComponents:S=>S.getComponents(),fromComponents:S=>new da(...S)},Sc=w("p2d");class rT{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(Sc()),x.viewProps.bindClassModifiers(this.element),P(x.expanded,E(this.element,Sc(void 0,"expanded")));const A=f.createElement("div");A.classList.add(Sc("h")),this.element.appendChild(A);const F=f.createElement("button");F.classList.add(Sc("b")),F.appendChild(mt(f,"p2dpad")),x.viewProps.bindDisabled(F),A.appendChild(F),this.buttonElement=F;const ce=f.createElement("div");if(ce.classList.add(Sc("t")),A.appendChild(ce),this.textElement=ce,x.pickerLayout==="inline"){const xe=f.createElement("div");xe.classList.add(Sc("p")),this.element.appendChild(xe),this.pickerElement=xe}else this.pickerElement=null}}const Is=w("p2dp");class _d{constructor(f,x){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=x.invertsY,this.maxValue_=x.maxValue,this.element=f.createElement("div"),this.element.classList.add(Is()),x.layout==="popup"&&this.element.classList.add(Is(void 0,"p"));const A=f.createElement("div");A.classList.add(Is("p")),x.viewProps.bindTabIndex(A),this.element.appendChild(A),this.padElement=A;const F=f.createElementNS(Ve,"svg");F.classList.add(Is("g")),this.padElement.appendChild(F),this.svgElem_=F;const ce=f.createElementNS(Ve,"line");ce.classList.add(Is("ax")),ce.setAttributeNS(null,"x1","0"),ce.setAttributeNS(null,"y1","50%"),ce.setAttributeNS(null,"x2","100%"),ce.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(ce);const xe=f.createElementNS(Ve,"line");xe.classList.add(Is("ax")),xe.setAttributeNS(null,"x1","50%"),xe.setAttributeNS(null,"y1","0"),xe.setAttributeNS(null,"x2","50%"),xe.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(xe);const Je=f.createElementNS(Ve,"line");Je.classList.add(Is("l")),Je.setAttributeNS(null,"x1","50%"),Je.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(Je),this.lineElem_=Je;const Et=f.createElement("div");Et.classList.add(Is("m")),this.padElement.appendChild(Et),this.markerElem_=Et,x.value.emitter.on("change",this.onValueChange_),this.value=x.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[f,x]=this.value.rawValue.getComponents(),A=this.maxValue_,F=Gn(f,-A,+A,0,100),ce=Gn(x,-A,+A,0,100),xe=this.invertsY_?100-ce:ce;this.lineElem_.setAttributeNS(null,"x2",`${F}%`),this.lineElem_.setAttributeNS(null,"y2",`${xe}%`),this.markerElem_.style.left=`${F}%`,this.markerElem_.style.top=`${xe}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function yd(S,f,x){return[hr(f[0],dr(S)),hr(f[1],En(S))*(x?1:-1)]}class oT{constructor(f,x){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.baseSteps_=x.baseSteps,this.maxValue_=x.maxValue,this.invertsY_=x.invertsY,this.view=new _d(f,{invertsY:this.invertsY_,layout:x.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kl(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(f,x){if(!f.point)return;const A=this.maxValue_,F=Gn(f.point.x,0,f.bounds.width,-A,+A),ce=Gn(this.invertsY_?f.bounds.height-f.point.y:f.point.y,0,f.bounds.height,-A,+A);this.value.setRawValue(new da(F,ce),x)}onPointerDown_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerMove_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerUp_(f){this.handlePointerEvent_(f.data,{forceEmit:!0,last:!0})}onPadKeyDown_(f){z1(f.key)&&f.preventDefault();const[x,A]=yd(f,this.baseSteps_,this.invertsY_);x===0&&A===0||this.value.setRawValue(new da(this.value.rawValue.x+x,this.value.rawValue.y+A),{forceEmit:!1,last:!1})}onPadKeyUp_(f){const[x,A]=yd(f,this.baseSteps_,this.invertsY_);x===0&&A===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class eb{constructor(f,x){var A,F;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.foldable_=Fe.create(x.expanded),this.popC_=x.pickerLayout==="popup"?new af(f,{viewProps:this.viewProps}):null;const ce=new oT(f,{baseSteps:[x.axes[0].baseStep,x.axes[1].baseStep],invertsY:x.invertsY,layout:x.pickerLayout,maxValue:x.maxValue,value:this.value,viewProps:this.viewProps});ce.view.allFocusableElements.forEach(xe=>{xe.addEventListener("blur",this.onPopupChildBlur_),xe.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=ce,this.textC_=new c0(f,{assembly:h0,axes:x.axes,parser:x.parser,value:this.value,viewProps:this.viewProps}),this.view=new rT(f,{expanded:this.foldable_.value("expanded"),pickerLayout:x.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(A=this.view.buttonElement)===null||A===void 0||A.addEventListener("blur",this.onPadButtonBlur_),(F=this.view.buttonElement)===null||F===void 0||F.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ja({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:xe=>xe.rawValue,backward:(xe,Je)=>Je.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Ie(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(f){if(!this.popC_)return;const x=this.view.element,A=f.relatedTarget;(!A||!x.contains(A))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(f){if(!this.popC_)return;const x=this.popC_.view.element,A=k(f);A&&x.contains(A)||A&&A===this.view.buttonElement&&!Te(x.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(f){this.popC_?f.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&f.key==="Escape"&&this.view.buttonElement.focus()}}function sT(S){return da.isObject(S)?new da(S.x,S.y):new da}function pa(S,f){S.writeProperty("x",f.x),S.writeProperty("y",f.y)}function is(S,f){if(!S)return;const x=[],A=No(S,f);A&&x.push(A);const F=$1(S);return F&&x.push(F),new $h(x)}function ru(S,f){return new nl({assembly:h0,components:[is("x"in S?S.x:void 0,f.x),is("y"in S?S.y:void 0,f.y)]})}function po(S,f){var x,A;const F=S&&ns(S,Xl);if(F)return Math.max(Math.abs((x=F.minValue)!==null&&x!==void 0?x:0),Math.abs((A=F.maxValue)!==null&&A!==void 0?A:0));const ce=vc(S);return Math.max(Math.abs(ce)*10,Math.abs(f)*10)}function aT(S,f){const x=f instanceof nl?f.components[0]:void 0,A=f instanceof nl?f.components[1]:void 0,F=po(x,S.x),ce=po(A,S.y);return Math.max(F,ce)}function d0(S,f){return{baseStep:vc(f),constraint:f,textProps:Z.fromObject({draggingScale:gc(f,S),formatter:Fi(vf(f,S))})}}function tb(S){if(!("y"in S))return!1;const f=S.y;return f&&"inverted"in f?!!f.inverted:!1}const xd={id:"input-point2d",type:"input",accept:(S,f)=>{if(!da.isObject(S))return null;const x=ne,A=fe(f,{expanded:x.optional.boolean,picker:x.optional.custom($g),x:x.optional.custom(gi),y:x.optional.object({inverted:x.optional.boolean,max:x.optional.number,min:x.optional.number,step:x.optional.number})});return A?{initialValue:S,params:A}:null},binding:{reader:S=>sT,constraint:S=>ru(S.params,S.initialValue),equals:da.equals,writer:S=>pa},controller:S=>{const f=S.document,x=S.value,A=S.constraint;if(!(A instanceof nl))throw m.shouldNeverHappen();const F="expanded"in S.params?S.params.expanded:void 0,ce="picker"in S.params?S.params.picker:void 0;return new eb(f,{axes:[d0(x.rawValue.x,A.components[0]),d0(x.rawValue.y,A.components[1])],expanded:F!=null?F:!1,invertsY:tb(S.params),maxValue:aT(x.rawValue,A),parser:ks,pickerLayout:ce!=null?ce:"popup",value:x,viewProps:S.viewProps})}};class fo{constructor(f=0,x=0,A=0){this.x=f,this.y=x,this.z=A}getComponents(){return[this.x,this.y,this.z]}static isObject(f){if(c(f))return!1;const x=f.x,A=f.y,F=f.z;return!(typeof x!="number"||typeof A!="number"||typeof F!="number")}static equals(f,x){return f.x===x.x&&f.y===x.y&&f.z===x.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const p0={toComponents:S=>S.getComponents(),fromComponents:S=>new fo(...S)};function lT(S){return fo.isObject(S)?new fo(S.x,S.y,S.z):new fo}function Ef(S,f){S.writeProperty("x",f.x),S.writeProperty("y",f.y),S.writeProperty("z",f.z)}function uT(S,f){return new nl({assembly:p0,components:[is("x"in S?S.x:void 0,f.x),is("y"in S?S.y:void 0,f.y),is("z"in S?S.z:void 0,f.z)]})}function Tf(S,f){return{baseStep:vc(f),constraint:f,textProps:Z.fromObject({draggingScale:gc(f,S),formatter:Fi(vf(f,S))})}}const Qi={id:"input-point3d",type:"input",accept:(S,f)=>{if(!fo.isObject(S))return null;const x=ne,A=fe(f,{x:x.optional.custom(gi),y:x.optional.custom(gi),z:x.optional.custom(gi)});return A?{initialValue:S,params:A}:null},binding:{reader:S=>lT,constraint:S=>uT(S.params,S.initialValue),equals:fo.equals,writer:S=>Ef},controller:S=>{const f=S.value,x=S.constraint;if(!(x instanceof nl))throw m.shouldNeverHappen();return new c0(S.document,{assembly:p0,axes:[Tf(f.rawValue.x,x.components[0]),Tf(f.rawValue.y,x.components[1]),Tf(f.rawValue.z,x.components[2])],parser:ks,value:f,viewProps:S.viewProps})}};class il{constructor(f=0,x=0,A=0,F=0){this.x=f,this.y=x,this.z=A,this.w=F}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(f){if(c(f))return!1;const x=f.x,A=f.y,F=f.z,ce=f.w;return!(typeof x!="number"||typeof A!="number"||typeof F!="number"||typeof ce!="number")}static equals(f,x){return f.x===x.x&&f.y===x.y&&f.z===x.z&&f.w===x.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const f0={toComponents:S=>S.getComponents(),fromComponents:S=>new il(...S)};function Ns(S){return il.isObject(S)?new il(S.x,S.y,S.z,S.w):new il}function m0(S,f){S.writeProperty("x",f.x),S.writeProperty("y",f.y),S.writeProperty("z",f.z),S.writeProperty("w",f.w)}function Pf(S,f){return new nl({assembly:f0,components:[is("x"in S?S.x:void 0,f.x),is("y"in S?S.y:void 0,f.y),is("z"in S?S.z:void 0,f.z),is("w"in S?S.w:void 0,f.w)]})}function ou(S,f){return{baseStep:vc(f),constraint:f,textProps:Z.fromObject({draggingScale:gc(f,S),formatter:Fi(vf(f,S))})}}const nb={id:"input-point4d",type:"input",accept:(S,f)=>{if(!il.isObject(S))return null;const x=ne,A=fe(f,{x:x.optional.custom(gi),y:x.optional.custom(gi),z:x.optional.custom(gi),w:x.optional.custom(gi)});return A?{initialValue:S,params:A}:null},binding:{reader:S=>Ns,constraint:S=>Pf(S.params,S.initialValue),equals:il.equals,writer:S=>m0},controller:S=>{const f=S.value,x=S.constraint;if(!(x instanceof nl))throw m.shouldNeverHappen();return new c0(S.document,{assembly:f0,axes:f.rawValue.getComponents().map((A,F)=>ou(A,x.components[F])),parser:ks,value:f,viewProps:S.viewProps})}};function Rr(S){const f=[],x=Jl(S.options);return x&&f.push(x),new $h(f)}const v0={id:"input-string",type:"input",accept:(S,f)=>{if(typeof S!="string")return null;const x=fe(f,{options:ne.optional.custom(pf)});return x?{initialValue:S,params:x}:null},binding:{reader:S=>Gr,constraint:S=>Rr(S.params),writer:S=>Zl},controller:S=>{var f;const x=S.document,A=S.value,F=S.constraint;return F&&ns(F,Ka)?new ql(x,{props:Z.fromObject({options:(f=mf(F))!==null&&f!==void 0?f:[]}),value:A,viewProps:S.viewProps}):new ed(x,{parser:ce=>ce,props:Z.fromObject({formatter:Kg}),value:A,viewProps:S.viewProps})}},bd={monitor:{defaultInterval:200,defaultLineCount:3}},ib=w("mll");class cT{constructor(f,x){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=x.formatter,this.element=f.createElement("div"),this.element.classList.add(ib()),x.viewProps.bindClassModifiers(this.element);const A=f.createElement("textarea");A.classList.add(ib("i")),A.style.height=`calc(var(--bld-us) * ${x.lineCount})`,A.readOnly=!0,x.viewProps.bindDisabled(A),this.element.appendChild(A),this.textareaElem_=A,x.value.emitter.on("change",this.onValueUpdate_),this.value=x.value,this.update_()}update_(){const f=this.textareaElem_,x=f.scrollTop===f.scrollHeight-f.clientHeight,A=[];this.value.rawValue.forEach(F=>{F!==void 0&&A.push(this.formatter_(F))}),f.textContent=A.join(`
`),x&&(f.scrollTop=f.scrollHeight)}onValueUpdate_(){this.update_()}}class wd{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.view=new cT(f,{formatter:x.formatter,lineCount:x.lineCount,value:this.value,viewProps:this.viewProps})}}const rb=w("sgl");class Sd{constructor(f,x){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=x.formatter,this.element=f.createElement("div"),this.element.classList.add(rb()),x.viewProps.bindClassModifiers(this.element);const A=f.createElement("input");A.classList.add(rb("i")),A.readOnly=!0,A.type="text",x.viewProps.bindDisabled(A),this.element.appendChild(A),this.inputElement=A,x.value.emitter.on("change",this.onValueUpdate_),this.value=x.value,this.update_()}update_(){const f=this.value.rawValue,x=f[f.length-1];this.inputElement.value=x!==void 0?this.formatter_(x):""}onValueUpdate_(){this.update_()}}class Af{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.view=new Sd(f,{formatter:x.formatter,value:this.value,viewProps:this.viewProps})}}const hT={id:"monitor-bool",type:"monitor",accept:(S,f)=>{if(typeof S!="boolean")return null;const x=fe(f,{lineCount:ne.optional.number});return x?{initialValue:S,params:x}:null},binding:{reader:S=>P1},controller:S=>{var f;return S.value.rawValue.length===1?new Af(S.document,{formatter:Wg,value:S.value,viewProps:S.viewProps}):new wd(S.document,{formatter:Wg,lineCount:(f=S.params.lineCount)!==null&&f!==void 0?f:bd.monitor.defaultLineCount,value:S.value,viewProps:S.viewProps})}},rl=w("grl");class Md{constructor(f,x){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=f.createElement("div"),this.element.classList.add(rl()),x.viewProps.bindClassModifiers(this.element),this.formatter_=x.formatter,this.props_=x.props,this.cursor_=x.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const A=f.createElementNS(Ve,"svg");A.classList.add(rl("g")),A.style.height=`calc(var(--bld-us) * ${x.lineCount})`,this.element.appendChild(A),this.svgElem_=A;const F=f.createElementNS(Ve,"polyline");this.svgElem_.appendChild(F),this.lineElem_=F;const ce=f.createElement("div");ce.classList.add(rl("t"),w("tt")()),this.element.appendChild(ce),this.tooltipElem_=ce,x.value.emitter.on("change",this.onValueUpdate_),this.value=x.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const f=this.svgElem_.getBoundingClientRect(),x=this.value.rawValue.length-1,A=this.props_.get("minValue"),F=this.props_.get("maxValue"),ce=[];this.value.rawValue.forEach((an,Ht)=>{if(an===void 0)return;const Or=Gn(Ht,0,x,0,f.width),fa=Gn(an,A,F,f.height,0);ce.push([Or,fa].join(","))}),this.lineElem_.setAttributeNS(null,"points",ce.join(" "));const xe=this.tooltipElem_,Je=this.value.rawValue[this.cursor_.rawValue];if(Je===void 0){xe.classList.remove(rl("t","a"));return}const Et=Gn(this.cursor_.rawValue,0,x,0,f.width),At=Gn(Je,A,F,f.height,0);xe.style.left=`${Et}px`,xe.style.top=`${At}px`,xe.textContent=`${this.formatter_(Je)}`,xe.classList.contains(rl("t","a"))||(xe.classList.add(rl("t","a"),rl("t","in")),Ae(xe),xe.classList.remove(rl("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class dT{constructor(f,x){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=x.props,this.value=x.value,this.viewProps=x.viewProps,this.cursor_=Q(-1),this.view=new Md(f,{cursor:this.cursor_,formatter:x.formatter,lineCount:x.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!Te(f))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const A=new Kl(this.view.element);A.emitter.on("down",this.onGraphPointerDown_),A.emitter.on("move",this.onGraphPointerMove_),A.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(f){const x=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(Gn(f.offsetX,0,x.width,0,this.value.rawValue.length))}onGraphPointerDown_(f){this.onGraphPointerMove_(f)}onGraphPointerMove_(f){if(!f.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(Gn(f.data.point.x,0,f.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function g0(S){return"format"in S&&!c(S.format)?S.format:Fi(2)}function _0(S){var f;return S.value.rawValue.length===1?new Af(S.document,{formatter:g0(S.params),value:S.value,viewProps:S.viewProps}):new wd(S.document,{formatter:g0(S.params),lineCount:(f=S.params.lineCount)!==null&&f!==void 0?f:bd.monitor.defaultLineCount,value:S.value,viewProps:S.viewProps})}function ob(S){var f,x,A;return new dT(S.document,{formatter:g0(S.params),lineCount:(f=S.params.lineCount)!==null&&f!==void 0?f:bd.monitor.defaultLineCount,props:Z.fromObject({maxValue:(x="max"in S.params?S.params.max:null)!==null&&x!==void 0?x:100,minValue:(A="min"in S.params?S.params.min:null)!==null&&A!==void 0?A:0}),value:S.value,viewProps:S.viewProps})}function sb(S){return"view"in S&&S.view==="graph"}const pT={id:"monitor-number",type:"monitor",accept:(S,f)=>{if(typeof S!="number")return null;const x=ne,A=fe(f,{format:x.optional.function,lineCount:x.optional.number,max:x.optional.number,min:x.optional.number,view:x.optional.string});return A?{initialValue:S,params:A}:null},binding:{defaultBufferSize:S=>sb(S)?64:1,reader:S=>Yg},controller:S=>sb(S.params)?ob(S):_0(S)},fT={id:"monitor-string",type:"monitor",accept:(S,f)=>{if(typeof S!="string")return null;const x=ne,A=fe(f,{lineCount:x.optional.number,multiline:x.optional.boolean});return A?{initialValue:S,params:A}:null},binding:{reader:S=>Gr},controller:S=>{var f;const x=S.value;return x.rawValue.length>1||"multiline"in S.params&&S.params.multiline?new wd(S.document,{formatter:Kg,lineCount:(f=S.params.lineCount)!==null&&f!==void 0?f:bd.monitor.defaultLineCount,value:x,viewProps:S.viewProps}):new Af(S.document,{formatter:Kg,value:x,viewProps:S.viewProps})}};class ab{constructor(f){this.onValueChange_=this.onValueChange_.bind(this),this.reader=f.reader,this.writer=f.writer,this.emitter=new g,this.value=f.value,this.value.emitter.on("change",this.onValueChange_),this.target=f.target,this.read()}read(){const f=this.target.read();f!==void 0&&(this.value.rawValue=this.reader(f))}write_(f){this.writer(this.target,f)}onValueChange_(f){this.write_(f.rawValue),this.emitter.emit("change",{options:f.options,rawValue:f.rawValue,sender:this})}}function y0(S,f){const x=S.accept(f.target.read(),f.params);if(c(x))return null;const A=ne,F={target:f.target,initialValue:x.initialValue,params:x.params},ce=S.binding.reader(F),xe=S.binding.constraint?S.binding.constraint(F):void 0,Je=Q(ce(x.initialValue),{constraint:xe,equals:S.binding.equals}),Et=new ab({reader:ce,target:f.target,value:Je,writer:S.binding.writer(F)}),At=A.optional.boolean(f.params.disabled).value,an=A.optional.boolean(f.params.hidden).value,Ht=S.controller({constraint:xe,document:f.document,initialValue:x.initialValue,params:x.params,value:Et.value,viewProps:ti.create({disabled:At,hidden:an})}),Or=A.optional.string(f.params.label).value;return new Me(f.document,{binding:Et,blade:re(),props:Z.fromObject({label:Or!=null?Or:f.target.key}),valueController:Ht})}class mT{constructor(f){this.onTick_=this.onTick_.bind(this),this.reader_=f.reader,this.target=f.target,this.emitter=new g,this.value=f.value,this.ticker=f.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const f=this.target.read();if(f===void 0)return;const x=this.value.rawValue,A=this.reader_(f);this.value.rawValue=Za(x,A),this.emitter.emit("update",{rawValue:A,sender:this})}onTick_(f){this.read()}}function x0(S,f){return f===0?new dc:new sa(S,f!=null?f:bd.monitor.defaultInterval)}function lb(S,f){var x,A,F;const ce=ne,xe=S.accept(f.target.read(),f.params);if(c(xe))return null;const Je={target:f.target,initialValue:xe.initialValue,params:xe.params},Et=S.binding.reader(Je),At=(A=(x=ce.optional.number(f.params.bufferSize).value)!==null&&x!==void 0?x:S.binding.defaultBufferSize&&S.binding.defaultBufferSize(xe.params))!==null&&A!==void 0?A:1,an=ce.optional.number(f.params.interval).value,Ht=new mT({reader:Et,target:f.target,ticker:x0(f.document,an),value:gE(At)}),Or=ce.optional.boolean(f.params.disabled).value,fa=ce.optional.boolean(f.params.hidden).value,su=S.controller({document:f.document,params:xe.params,value:Ht.value,viewProps:ti.create({disabled:Or,hidden:fa})}),Df=(F=ce.optional.string(f.params.label).value)!==null&&F!==void 0?F:f.target.key;return new It(f.document,{binding:Ht,blade:re(),props:Z.fromObject({label:Df}),valueController:su})}class ub{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(f){f.type==="blade"?this.pluginsMap_.blades.unshift(f):f.type==="input"?this.pluginsMap_.inputs.unshift(f):f.type==="monitor"&&this.pluginsMap_.monitors.unshift(f)}createInput(f,x,A){const F=x.read();if(c(F))throw new m({context:{key:x.key},type:"nomatchingcontroller"});const ce=this.pluginsMap_.inputs.reduce((xe,Je)=>xe!=null?xe:y0(Je,{document:f,target:x,params:A}),null);if(ce)return ce;throw new m({context:{key:x.key},type:"nomatchingcontroller"})}createMonitor(f,x,A){const F=this.pluginsMap_.monitors.reduce((ce,xe)=>ce!=null?ce:lb(xe,{document:f,params:A,target:x}),null);if(F)return F;throw new m({context:{key:x.key},type:"nomatchingcontroller"})}createBlade(f,x){const A=this.pluginsMap_.blades.reduce((F,ce)=>F!=null?F:Os(ce,{document:f,params:x}),null);if(!A)throw new m({type:"nomatchingview",context:{params:x}});return A}createBladeApi(f){if(f instanceof Me)return new Re(f);if(f instanceof It)return new bt(f);if(f instanceof se)return new Bn(f,this);const x=this.pluginsMap_.blades.reduce((A,F)=>A!=null?A:F.api({controller:f,pool:this}),null);if(!x)throw m.shouldNeverHappen();return x}}function cb(){const S=new ub;return[xd,Qi,nb,v0,iT,QE,JE,YE,wE,hT,fT,pT,Pe,et,Ft,fn].forEach(f=>{S.register(f)}),S}class Cd extends r{constructor(f){super(f),this.emitter_=new g,this.controller_.valueController.value.emitter.on("change",x=>{this.emitter_.emit("change",{event:new s(this,x.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}get options(){return this.controller_.valueController.props.get("options")}set options(f){this.controller_.valueController.props.set("options",f)}get value(){return this.controller_.valueController.value.rawValue}set value(f){this.controller_.valueController.value.rawValue=f}on(f,x){const A=x.bind(this);return this.emitter_.on(f,F=>{A(F.event)}),this}}class hb extends r{constructor(f){super(f),this.emitter_=new g,this.controller_.valueController.value.emitter.on("change",x=>{this.emitter_.emit("change",{event:new s(this,x.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(f){this.controller_.valueController.sliderController.props.set("maxValue",f)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(f){this.controller_.valueController.sliderController.props.set("minValue",f)}get value(){return this.controller_.valueController.value.rawValue}set value(f){this.controller_.valueController.value.rawValue=f}on(f,x){const A=x.bind(this);return this.emitter_.on(f,F=>{A(F.event)}),this}}class b0 extends r{constructor(f){super(f),this.emitter_=new g,this.controller_.valueController.value.emitter.on("change",x=>{this.emitter_.emit("change",{event:new s(this,x.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(f){this.controller_.valueController.props.set("formatter",f)}get value(){return this.controller_.valueController.value.rawValue}set value(f){this.controller_.valueController.value.rawValue=f}on(f,x){const A=x.bind(this);return this.emitter_.on(f,F=>{A(F.event)}),this}}const db=function(){return{id:"list",type:"blade",accept(S){const f=ne,x=fe(S,{options:f.required.custom(pf),value:f.required.raw,view:f.required.constant("list"),label:f.optional.string});return x?{params:x}:null},controller(S){const f=new ql(S.document,{props:Z.fromObject({options:ff(S.params.options)}),value:Q(S.params.value),viewProps:S.viewProps});return new $e(S.document,{blade:S.blade,props:Z.fromObject({label:S.params.label}),valueController:f})},api(S){return!(S.controller instanceof $e)||!(S.controller.valueController instanceof ql)?null:new Cd(S.controller)}}}();function vT(S){return S.reduce((f,x)=>Object.assign(f,{[x.presetKey]:x.read()}),{})}function pb(S,f){S.forEach(x=>{const A=f[x.presetKey];A!==void 0&&x.write(A)})}class gT extends yn{constructor(f,x){super(f,x)}get element(){return this.controller_.view.element}importPreset(f){const x=this.controller_.rackController.rack.find(Me).map(A=>A.binding.target);pb(x,f),this.refresh()}exportPreset(){const f=this.controller_.rackController.rack.find(Me).map(x=>x.binding.target);return vT(f)}refresh(){this.controller_.rackController.rack.find(Me).forEach(f=>{f.binding.read()}),this.controller_.rackController.rack.find(It).forEach(f=>{f.binding.read()})}}class w0 extends Ge{constructor(f,x){super(f,{expanded:x.expanded,blade:x.blade,props:x.props,root:!0,viewProps:x.viewProps})}}const fb={id:"slider",type:"blade",accept(S){const f=ne,x=fe(S,{max:f.required.number,min:f.required.number,view:f.required.constant("slider"),format:f.optional.function,label:f.optional.string,value:f.optional.number});return x?{params:x}:null},controller(S){var f,x;const A=(f=S.params.value)!==null&&f!==void 0?f:0,F=new od(S.document,{baseStep:1,parser:ks,sliderProps:Z.fromObject({maxValue:S.params.max,minValue:S.params.min}),textProps:Z.fromObject({draggingScale:gc(void 0,A),formatter:(x=S.params.format)!==null&&x!==void 0?x:k1}),value:Q(A),viewProps:S.viewProps});return new $e(S.document,{blade:S.blade,props:Z.fromObject({label:S.params.label}),valueController:F})},api(S){return!(S.controller instanceof $e)||!(S.controller.valueController instanceof od)?null:new hb(S.controller)}},S0=function(){return{id:"text",type:"blade",accept(S){const f=ne,x=fe(S,{parse:f.required.function,value:f.required.raw,view:f.required.constant("text"),format:f.optional.function,label:f.optional.string});return x?{params:x}:null},controller(S){var f;const x=new ed(S.document,{parser:S.params.parse,props:Z.fromObject({formatter:(f=S.params.format)!==null&&f!==void 0?f:A=>String(A)}),value:Q(S.params.value),viewProps:S.viewProps});return new $e(S.document,{blade:S.blade,props:Z.fromObject({label:S.params.label}),valueController:x})},api(S){return!(S.controller instanceof $e)||!(S.controller.valueController instanceof ed)?null:new b0(S.controller)}}}();function _T(S){const f=S.createElement("div");return f.classList.add(w("dfw")()),S.body&&S.body.appendChild(f),f}function Lf(S,f,x){if(S.querySelector(`style[data-tp-style=${f}]`))return;const A=S.createElement("style");A.dataset.tpStyle=f,A.textContent=x,S.head.appendChild(A)}class Wt extends gT{constructor(f){var x,A;const F=f!=null?f:{},ce=(x=F.document)!==null&&x!==void 0?x:Ye(),xe=cb(),Je=new w0(ce,{expanded:F.expanded,blade:re(),props:Z.fromObject({title:F.title}),viewProps:ti.create()});super(Je,xe),this.pool_=xe,this.containerElem_=(A=F.container)!==null&&A!==void 0?A:_T(ce),this.containerElem_.appendChild(this.element),this.doc_=ce,this.usesDefaultWrapper_=!F.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw m.alreadyDisposed();return this.doc_}dispose(){const f=this.containerElem_;if(!f)throw m.alreadyDisposed();if(this.usesDefaultWrapper_){const x=f.parentElement;x&&x.removeChild(f)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(f){("plugin"in f?[f.plugin]:"plugins"in f?f.plugins:[]).forEach(x=>{this.pool_.register(x),this.embedPluginStyle_(x)})}embedPluginStyle_(f){f.css&&Lf(this.document,`plugin-${f.id}`,f.css)}setUpDefaultPlugins_(){Lf(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(f=>{this.embedPluginStyle_(f)}),this.registerPlugin({plugins:[fb,db,fn,S0]})}}const yT=new i("3.1.0");t.BladeApi=r,t.ButtonApi=_,t.FolderApi=yn,t.InputBindingApi=Re,t.ListApi=Cd,t.MonitorBindingApi=bt,t.Pane=Wt,t.SeparatorApi=rt,t.SliderApi=hb,t.TabApi=ii,t.TabPageApi=bn,t.TextApi=b0,t.TpChangeEvent=s,t.VERSION=yT,Object.defineProperty(t,"__esModule",{value:!0})})})(b4,b4.exports);const Pq=()=>{if(na())return;const n=Ti(),e=Wa();n==null||n.dispose();for(const t of e)t.dispose()},Aq=n=>n.name||ro.exports.upperFirst(n.constructor.componentName),jCe=j3(`
    <div>
        <svg t="1656447640895" class="icon" viewBox="0 0 1084 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1297" width="10" height="10"><path d="M788.804292 977.500541a503.543363 503.543363 0 0 0 162.507176-119.862595 509.687074 509.687074 0 0 0 103.780528-174.312738 515.047762 515.047762 0 0 0 28.550186-194.068985 514.385205 514.385205 0 0 0-45.53574-190.816432 508.663122 508.663122 0 0 0-118.657945-164.193685A501.676156 501.676156 0 0 0 554.921651 0.530046 503.904757 503.904757 0 0 0 203.585714 166.530704a509.807538 509.807538 0 0 0-94.564962 150.159522L0 290.187944l45.174345 154.014399 45.234577 154.0144 109.382147-116.610042L309.173215 365.056891l-103.057738-24.936238a411.387699 411.387699 0 0 1 69.990118-106.611453 405.846313 405.846313 0 0 1 576.906499-25.960191c166.181356 153.592772 177.625524 415.001647 25.659027 582.869512a406.087243 406.087243 0 0 1-577.026963 25.899958l-66.315938 73.302904a502.097784 502.097784 0 0 0 364.707543 133.836525 499.387323 499.387323 0 0 0 188.768529-45.957367z" p-id="1298" fill="#ffffff"></path></svg>
    </div>
`);let Lq=!1,lL=!0;const HCe=qa(()=>{Lq=lL,lL=!lL},100,"both"),bU=n=>n&&typeof n=="object"&&"x"in n&&"y"in n,wU=n=>n===!0||n==="true",SU=n=>n===!1||n==="false",WCe=(n,e)=>bU(n)&&bU(e)?n.x===e.x&&n.y===e.y&&n.z===e.z:wU(n)&&wU(e)||SU(n)&&SU(e)?!0:n===e,vr=(n,e,t,i,r={...t})=>{const o=n.addFolder({title:e});for(const[s,a]of Object.entries(r))switch(typeof a){case"undefined":r[s]="";break;case"number":r[s]=Tm(s,a);break;case"object":if(Array.isArray(a)){r[s]=JSON.stringify(a);break}typeof(a==null?void 0:a.x)=="number"&&(a.x=Tm("x",a.x)),typeof(a==null?void 0:a.y)=="number"&&(a.y=Tm("y",a.y)),typeof(a==null?void 0:a.z)=="number"&&(a.z=Tm("z",a.z));break}return Object.fromEntries(Object.keys(r).map(s=>{const a=o.addInput(r,s),l=jCe.cloneNode(!0);a.element.prepend(l),l.style.opacity="0.1";const u=H3(i,s,!0),c=qa(()=>{const h=WCe(r[s],u);l.style.opacity=h?"0.1":"0.5",l.style.cursor=h?"auto":"pointer"},100,"trailing");return c(),l.onclick=()=>{r[s]=JSON.parse(JSON.stringify(u)),a.refresh()},a.on("change",({value:h})=>{if(c(),!Lq){if(typeof h=="string"){if(h==="true"||h==="false"){t[s]=h==="true";return}const p=parseFloat(h);if(!Number.isNaN(p)){t[s]=p;return}}t[s]=typeof h=="number"?Tm(s,h):h}}),[s,a]}))},MU=(n,e,t)=>{const i={};for(const[r,o]of Object.entries(n)){if(WH.has(r))continue;let s=t[r];o===Function||typeof s=="function"||(o===Object||typeof s=="object"&&!Array.isArray(s))&&(!s||typeof s.x!="number"||typeof s.y!="number")||(s!=null||(s=H3(e,r,!0)),s===1/0?s=999999999:s===-1/0?s=-999999999:Array.isArray(s)&&(s=JSON.stringify(s)),i[r]=s)}return i},_o=(n,e)=>{let t;for(const o of e)o in n&&((t!=null?t:t={})[o]=n[o]);const i=new Set(e),r={};for(const[o,s]of Object.entries(n))!i.has(o)&&(r[o]=s);return[t,r]},GCe=(n,e,t)=>{for(const i of t)i in n&&(n[i]=e[i])},[XCe,qCe]=lo();Object.assign(PG,{stride:{x:0,y:0}});const YCe=()=>{const n=g1(),[e]=pCe(),t=Rv(e);Ts(()=>{Xo.activate(),bV(!0),OR(!0);const c=m=>{(m.key==="Shift"||m.key==="Meta"||m.key==="Control")&&mA(!0)},h=m=>{(m.key==="Shift"||m.key==="Meta"||m.key==="Control")&&mA(!1)};document.addEventListener("keydown",c),document.addEventListener("keyup",h);const p=$C(()=>mA(!1));return WC(),()=>{bV(!1),OR(!1),document.removeEventListener("keydown",c),document.removeEventListener("keyup",h),p.cancel(),GC()}},[]);const[i]=v1(),[r]=TI(),[o]=dCe(),[s,a]=Es(),[l,u]=Es();return mq(()=>{var c;if(!s||!l)return;const h="editor camera",p=o.reduce((g,b,w)=>(g[w===0?h:Aq(b.userData.manager)]=w,g),{}),m=s.addInput({camera:o.indexOf(t)},"camera",{options:p});l.add(m),m.on("change",({value:g})=>{o[g].userData.manager.activate()});const y={none:0,...ro.exports.omit(p,h)},_=s.addInput({"secondary camera":o.indexOf((c=b2())!=null?c:di)},"secondary camera",{options:y});return l.add(_),_.on("change",({value:g})=>hhe(g===0?void 0:o[g])),()=>{m.dispose(),_.dispose()}},[s,l,o,t]),Ts(()=>{const c=n.current;if(!c)return;const h=new b4.exports.Pane({container:c});if(a(h),u(h.addFolder({title:"camera"})),!i){const[_,g]=_o(ro.exports.omit(MU(t3,hl,fs),OMe),["gridHelper","gridHelperSize"]);vr(h,"editor",fs,hl,_);const[b,w]=_o(g,["antiAlias","pixelRatio","fps","logarithmicDepth","pbr"]);vr(h,"renderer",fs,hl,b);const[M,C]=_o(w,["exposure","defaultLight","shadowDistance","shadowResolution","shadowBias","skybox","texture","color"]);vr(h,"lighting & environment",fs,hl,M);const[P,L]=_o(C,["ambientOcclusion","bloom","bloomStrength","bloomRadius","bloomThreshold","bokeh","bokehAperture","bokehFocus","bokehMaxBlur","lensDistortion","lensIor","lensBand","motionBlur","motionBlurStrength"]);vr(h,"effects",fs,hl,P);const[R,E]=_o(L,["outlineColor","outlineHiddenColor","outlinePattern","outlinePulse","outlineStrength","outlineThickness"]);vr(h,"outline effect",fs,hl,R);const[D,N]=_o(E,["gravity","repulsion","centripetal"]);return vr(h,"physics",fs,hl,D),Object.keys(N).length&&vr(h,"settings",fs,hl,N),()=>{h.dispose()}}const p=_=>{if(_.key==="Backspace"||_.key==="Delete"){_.preventDefault(),!Dk()&&Pq();return}const g=Ti();if(g)if(_.metaKey||_.ctrlKey)if(_.key.toLocaleLowerCase()==="c"){if(!Wa().length){const[b]=FX(W3(g));g.parent&&b&&(g.parent.attach(b),Ei(b))}}else _.key==="ArrowUp"&&Rh()&&(DG(g),AR("local"));else _.key.toLowerCase()==="c"&&Pp(g)&&dde(g)};document.addEventListener("keydown",p);const m=i,y=new Cn;if(!r.length){const{schema:_,defaults:g,componentName:b}=m.constructor,[w,M]=_o(ro.exports.omit(MU(_,g,m),["rotation","innerRotation","frustumCulled","minAzimuthAngle","maxAzimuthAngle"]),["name","id","physics","gravity"]);if(w){const{name:X}=vr(h,"general",m,g,w);X==null||X.on("change",()=>XCe())}const[C,P]=_o(M,["x","y","z","rotationX","rotationY","rotationZ","scale","scaleX","scaleY","scaleZ","innerX","innerY","innerZ","innerRotationX","innerRotationY","innerRotationZ","width","height","depth"]);if(C){const[X,B]=_o(C,["innerX","innerY","innerZ","innerRotationX","innerRotationY","innerRotationZ","width","height","depth"]);vr(h,"transform",m,g,B),X&&vr(h,"inner transform",m,g,X),y.watch(jW(()=>{HCe(),GCe(B,m,["x","y","z","rotationX","rotationY","rotationZ","scaleX","scaleY","scaleZ"]),h.refresh()}))}const[L,R]=_o(P,["visible","innerVisible"]);L&&vr(h,"display",m,g,L);const[E,D]=_o(R,["bloom","outline"]);E&&vr(h,"effects",m,g,E);const[N,j]=_o(D,["animation","animationPaused","animationRepeat"]);N&&vr(h,"animation",m,g,N);const[te,ee]=_o(j,["metalnessFactor","roughnessFactor","opacityFactor","adjustColor","toon"]);te&&vr(h,"adjust material",m,g,te);const[H,Q]=_o(ee,["fog","opacity","color","texture","textureRepeat","textureFlipY","videoTexture","wireframe"]);H&&vr(h,"material",m,g,H);const[Z,de]=_o(Q,["metalnessMap","metalness","roughnessMap","roughness","normalMap","normalScale","normalMapType","bumpMap","bumpScale","displacementMap","displacementScale","displacementBias","aoMap","aoMapIntensity","lightMap","lightMapIntensity","emissiveMap","emissiveIntensity","emissiveColor","envMap","alphaMap"]);if(Z&&vr(h,"pbr material",m,g,Z),b==="dummy"){de.stride={x:m.strideRight,y:-m.strideForward};const{stride:X}=vr(h,b,m,g,de);X.on("change",({value:B})=>{Object.assign(de,{strideForward:-B.y,strideRight:B.x}),h.refresh()})}else Object.keys(de).length&&vr(h,b,m,g,de)}return()=>{y.cancel(),h.dispose(),document.removeEventListener("keydown",p)}},[i,r]),Se("div",{ref:n,className:"lingo3d-ui lingo3d-bg",style:{width:300,height:"100%"}})},Dq=()=>{const[n]=PI();return n?null:Se(YCe,{})};rf(Dq,"lingo3d-editor");const KCe=()=>Se("div",{className:"lingo3d-ui",style:{overflow:"hidden",width:500,height:"100%",background:"rgb(40, 41, 46)"},children:"hello world"}),Rq=()=>{const[n]=PI();return n?Se(KCe,{}):null};rf(Rq,"lingo3d-node-editor");const ZCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",style:{margin:2,opacity:.25,flexShrink:0},children:Se("path",{fill:"#fff",d:"M838.4 325.12L554.24 479.36C528 493.44 512 521.6 512 552.96V851.2c0 32 31.36 53.12 57.6 38.4l284.16-154.24c25.6-14.08 42.24-42.24 42.24-73.6v-297.6c0-32.64-31.36-53.12-57.6-39.04zm-432.64 153.6L121.6 325.12c-26.24-14.08-57.6 6.4-57.6 38.4v299.52c0 31.36 16 59.52 42.24 73.6l284.16 153.6c26.24 14.08 57.6-7.04 57.6-39.04V552.32c0-31.36-16-59.52-42.24-73.6zm406.4-223.36c13.44-7.04 19.84-19.2 18.56-30.72 1.28-12.16-5.12-23.68-18.56-30.72L522.88 42.88c-12.8-7.04-28.16-10.24-43.52-10.24-15.36 0-30.72 3.2-43.52 10.24l-289.28 150.4c-13.44 7.04-19.2 19.2-18.56 30.72-.64 12.16 5.12 24.32 18.56 31.36l289.28 150.4C448.64 412.8 464 416 479.36 416c15.36 0 30.72-3.2 43.52-10.24l289.28-150.4z"})}),Oq=({style:n,onClick:e})=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",style:{margin:2,flexShrink:0,...n},onMouseDown:t=>t.stopPropagation(),onClick:t=>(t.stopPropagation(),e==null?void 0:e()),children:Se("path",{fill:"#fff",d:"M928.1 928.2H98v-830h830.1v830zm-104.8-415c0-24.6-19.9-44.5-44.5-44.5H556.5V246.4c0-24.6-19.9-44.5-44.5-44.5s-44.5 19.9-44.5 44.5v222.3H245.2c-24.6 0-44.5 19.9-44.5 44.5s19.9 44.5 44.5 44.5h222.3V780c0 24.6 19.9 44.5 44.5 44.5s44.5-19.9 44.5-44.5V557.7h222.3c24.6 0 44.5-20 44.5-44.5z"})}),kq=({style:n,onClick:e})=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",style:{margin:2,flexShrink:0,...n},onMouseDown:t=>t.stopPropagation(),onClick:t=>(t.stopPropagation(),e==null?void 0:e()),children:Se("path",{fill:"#fff",d:"M752 240H144c-17.7 0-32 14.3-32 32v608c0 17.7 14.3 32 32 32h608c17.7 0 32-14.3 32-32V272c0-17.7-14.3-32-32-32zM596 606c0 4.4-3.6 8-8 8H308c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h280c4.4 0 8 3.6 8 8v48zm284-494H264c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h576v576c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V144c0-17.7-14.3-32-32-32z"})}),Iq=()=>Se("path",{fill:"#fff",d:"M914.5 653.5c-5.5 0-11 1.1-16 3.3l-.2.1h-.2L510.2 822.2 122.2 657h-.2l-.2-.1c-5-2.1-10.3-3.3-16-3.3-23.1 0-41.8 19.3-41.8 43.1 0 18 10.7 33.3 25.8 39.8l403.9 172.1.4.1c10.2 4.4 21.8 4.4 32 0l.2-.1c.1 0 .1-.1.2-.1l403.9-172.1c15.1-6.5 25.8-21.8 25.8-39.8.1-23.8-18.6-43.1-41.7-43.1zm0-186.5c-7.9-.2-16 3.2-16 3.2L510.2 635.6 121.8 470.2s-10.3-3.2-16-3.2C82.7 467 64 486.2 64 510c0 17.9 10.7 33.3 25.8 39.7l403.9 172c.1 0 .1.1.2.1l.1.1c5 2.1 10.3 3.3 16 3.3 5.7 0 11.1-1.2 16-3.3l.2-.1c.1 0 .1 0 .2-.1l403.9-172c15.1-6.4 25.8-21.8 25.9-39.7.1-23.8-18.6-43-41.7-43zM89.8 363.2l403.9 172.1c.1 0 .1 0 .2.1l.1.1c5 2.1 10.3 3.2 16 3.2 5.5 0 10.9-1.1 16-3.2l.2-.1.2-.1 403.9-172c15.1-6.5 25.8-21.8 25.9-39.7 0-18-10.7-33.3-25.8-39.8L526.5 111.6c-.1 0-.1 0-.2-.1l-.2-.1c-10.2-4.4-21.8-4.4-32 0l-.1.1L89.8 283.7C74.7 290.1 64 305.5 64 323.5c0 17.9 10.7 33.2 25.8 39.7z"}),JCe=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",style:{margin:2,opacity:.25,flexShrink:0},children:Se(Iq,{})});document.addEventListener("mouseup",()=>EI(!1));const Nq=({appendable:n,object3d:e,level:t})=>{const i={opacity:e.children.length?.5:.05,cursor:"pointer"},[r,o]=Es(!1),[s]=_q(),{setClickEl:a,handleClick:l}=Vq(e,n),[u,c]=yq();Ts(()=>{!u||u.has(e)&&o(!0)},[u]);const h=og(null),p=og(null),m=s===e,y=Ky(()=>{if(!m||!h.current||!p.current)return;const b=h.current.getBoundingClientRect();return p.current.getBoundingClientRect().right-b.left+4},[m,r]),_=()=>{o(!1),c(void 0)},g=()=>o(!0);return Se("div",{ref:a,onClick:l,onDblClick:b=>{b.stopPropagation(),r?_():g()},onMouseDown:()=>EI(!0),style:{color:"rgba(255, 255, 255, 0.75)",marginLeft:8,borderLeft:"1px solid rgba(255, 255, 255, 0.05)"},children:[Se("div",{ref:h,style:{display:"flex",alignItems:"center",border:m?"1px solid rgba(255, 255, 255, 0.5)":void 0,width:y,minWidth:"100%",cursor:"default"},children:[r?Se(kq,{style:i,onClick:_}):Se(Oq,{style:i,onClick:g}),Se(JCe,{}),Se("div",{ref:p,children:e.name})]}),r&&e.children.map(b=>Se(Nq,{object3d:b,appendable:n,level:t+1},b.uuid))]})},zq=({appendable:n,level:e})=>{const[t,i]=Es(),{loaded:r}=n;return Ts(()=>{i(void 0);const o=r.then(()=>{i(n.loadedGroup.children[0])});return()=>{o.cancel()}},[r]),Se(AI,{appendable:n,level:e,children:t&&Se(Nq,{appendable:n,level:e+1,object3d:t})})},QCe=n=>{const[e,t]=Es(null);return Ts(()=>{if(!e)return;let i=0,r=0,o=0;const s=l=>{i=Date.now(),r=l.clientX,o=l.clientY},a=l=>{const u=Date.now(),c=u-i,h=Math.abs(l.clientX-r),p=Math.abs(l.clientY-o);i=u,r=l.clientX,o=l.clientY,c<300&&h<5&&p<5&&n(l)};return e.addEventListener("mousedown",s),e.addEventListener("mouseup",a),()=>{e.removeEventListener("mousedown",s),e.removeEventListener("mouseup",a)}},[e]),t},Vq=(n,e)=>({setClickEl:QCe(t=>{t.stopPropagation(),!ao()&&$c("translate"),Pp(e)&&Ti()!==e&&Ei(e),n instanceof An?queueMicrotask(()=>Y3(n)):Ei(n)}),handleClick:t=>t.stopPropagation()}),yo=[void 0],AI=({appendable:n,level:e,children:t})=>{var i;const r=Aq(n),o=Ky(()=>n.children?[...n.children].filter(E=>!jC.has(E)):void 0,[(i=n.children)==null?void 0:i.size]),s={opacity:(o==null?void 0:o.length)||t?.5:.05,cursor:"pointer"},[a,l]=Es(!1),[u,c]=Es(!1),[h]=v1(),[p]=TI(),m=h===n||p.includes(n),{setClickEl:y,handleClick:_}=Vq(n),[g,b]=yq();Ts(()=>{!g||g.has(n.outerObject3d)&&c(!0)},[g]);const w=og(null),M=og(null),C=Ky(()=>{if(!m||!w.current||!M.current)return;const E=w.current.getBoundingClientRect();return M.current.getBoundingClientRect().right-E.left+4},[m,u]),[P]=gCe(),L=()=>{c(!1),b(void 0)},R=()=>c(!0);return Se("div",{ref:y,onClick:_,onDblClick:E=>{E.stopPropagation(),u?L():R()},draggable:!P,onDragStart:E=>(E.stopPropagation(),yo[0]=n),onDragEnd:E=>(E.stopPropagation(),yo[0]=void 0),onDragOver:E=>{E.stopPropagation(),E.preventDefault(),!(!yo[0]||yo[0]===n)&&l(!0)},onDragEnter:E=>{E.stopPropagation(),E.preventDefault(),!(!yo[0]||yo[0]===n)&&l(!0)},onDragLeave:E=>{E.stopPropagation(),!(!yo[0]||yo[0]===n)&&l(!1)},onDrop:E=>{E.stopPropagation(),!(!yo[0]||yo[0]===n)&&(l(!1),n.attach(yo[0]))},style:{color:"rgba(255, 255, 255, 0.75)",marginLeft:8,borderLeft:"1px solid rgba(255, 255, 255, 0.05)",background:a?"rgba(255, 255, 255, 0.5)":"none"},children:[Se("div",{ref:w,style:{display:"flex",alignItems:"center",backgroundColor:m?"rgba(255, 255, 255, 0.1)":void 0,width:C,minWidth:"100%",cursor:"default"},children:[u?Se(kq,{style:s,onClick:L}):Se(Oq,{style:s,onClick:R}),Se(ZCe,{}),Se("div",{ref:M,children:r})]}),u&&(o==null?void 0:o.map(E=>E instanceof Tl?Se(zq,{appendable:E,level:e+1},E.uuid):Se(AI,{appendable:E,level:e+1},E.uuid))),u&&t]})},$Ce=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 1024 1024",children:Se("path",{fill:"#fff",d:"M640 384h224a32 32 0 0132 32v384h-96v96H416a32 32 0 01-32-32V640H160a32 32 0 01-32-32V224h96v-96h384a32 32 0 0132 32v224zm0 32v192a32 32 0 01-32 32H416v224h352v-96h96V416H640zM96 96h96v96H96V96zm736 0h96v96h-96V96zM96 832h96v96H96v-96zm736 0h96v96h-96v-96z"})}),e3e=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",children:Se("path",{fill:"#fff",d:"M630.09 151.91V62.16H361.84v89.74H93.6v134.62h89.41v673.11h625.93v-673.1h89.42V151.91H630.09zM361.84 869.89h-89.43V286.53h89.43v583.36zm178.84 0h-89.43V286.53h89.43v583.36zm178.84 0h-89.43V286.53h89.43v583.36z"})}),uL=({children:n,onClick:e,active:t})=>Se("div",{onClick:t?e:void 0,style:{width:24,height:24,display:"flex",justifyContent:"center",alignItems:"center",marginRight:2,opacity:t?1:.1,cursor:t?"pointer":"default"},children:n}),t3e=()=>{const[n,e]=Es(!1);return Se("div",{onDragOver:t=>{t.stopPropagation(),t.preventDefault(),yo[0]&&e(!0)},onDragEnter:t=>{t.stopPropagation(),t.preventDefault(),yo[0]&&e(!0)},onDragLeave:t=>{t.stopPropagation(),yo[0]&&e(!1)},onDrop:t=>{var i,r;t.stopPropagation(),e(!1);const o=yo[0];!o||(vM(),Ii.add(o),St.attach(o.outerObject3d),(r=(i=o.parent)==null?void 0:i.children)==null||r.delete(o),o.parent=void 0)},style:{background:n?"rgba(255, 255, 255, 0.5)":"none",width:"100%",height:18}})},n3e=()=>Se("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 1024 1024",children:Se(Iq,{})});function i3e(n,e){for(var t in e)n[t]=e[t];return n}function CU(n,e){for(var t in n)if(t!=="__source"&&!(t in e))return!0;for(var i in e)if(i!=="__source"&&n[i]!==e[i])return!0;return!1}function EU(n){this.props=n}(EU.prototype=new Xu).isPureReactComponent=!0,EU.prototype.shouldComponentUpdate=function(n,e){return CU(this.props,n)||CU(this.state,e)};var TU=Tt.__b;Tt.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),TU&&TU(n)};var r3e=Tt.__e;Tt.__e=function(n,e,t,i){if(n.then){for(var r,o=e;o=o.__;)if((r=o.__c)&&r.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),r.__c(n,e)}r3e(n,e,t,i)};var PU=Tt.unmount;function cL(){this.__u=0,this.t=null,this.__b=null}function Fq(n){var e=n.__.__c;return e&&e.__a&&e.__a(n)}function PS(){this.u=null,this.o=null}Tt.unmount=function(n){var e=n.__c;e&&e.__R&&e.__R(),e&&n.__h===!0&&(n.type=null),PU&&PU(n)},(cL.prototype=new Xu).__c=function(n,e){var t=e.__c,i=this;i.t==null&&(i.t=[]),i.t.push(t);var r=Fq(i.__v),o=!1,s=function(){o||(o=!0,t.__R=null,r?r(a):a())};t.__R=s;var a=function(){if(!--i.__u){if(i.state.__a){var u=i.state.__a;i.__v.__k[0]=function h(p,m,y){return p&&(p.__v=null,p.__k=p.__k&&p.__k.map(function(_){return h(_,m,y)}),p.__c&&p.__c.__P===m&&(p.__e&&y.insertBefore(p.__e,p.__d),p.__c.__e=!0,p.__c.__P=y)),p}(u,u.__c.__P,u.__c.__O)}var c;for(i.setState({__a:i.__b=null});c=i.t.pop();)c.forceUpdate()}},l=e.__h===!0;i.__u++||l||i.setState({__a:i.__b=i.__v.__k[0]}),n.then(s,s)},cL.prototype.componentWillUnmount=function(){this.t=[]},cL.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=function o(s,a,l){return s&&(s.__c&&s.__c.__H&&(s.__c.__H.__.forEach(function(u){typeof u.__c=="function"&&u.__c()}),s.__c.__H=null),(s=i3e({},s)).__c!=null&&(s.__c.__P===l&&(s.__c.__P=a),s.__c=null),s.__k=s.__k&&s.__k.map(function(u){return o(u,a,l)})),s}(this.__b,t,i.__O=i.__P)}this.__b=null}var r=e.__a&&bl(Nl,null,n.fallback);return r&&(r.__h=null),[bl(Nl,null,e.__a?null:n.children),r]};var AU=function(n,e,t){if(++t[1]===t[0]&&n.o.delete(e),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.o.size))for(t=n.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;n.u=t=t[2]}};function o3e(n){return this.getChildContext=function(){return n.context},n.children}function s3e(n){var e=this,t=n.i;e.componentWillUnmount=function(){rg(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),n.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(i){this.childNodes.push(i),e.i.appendChild(i)},insertBefore:function(i,r){this.childNodes.push(i),e.i.appendChild(i)},removeChild:function(i){this.childNodes.splice(this.childNodes.indexOf(i)>>>1,1),e.i.removeChild(i)}}),rg(bl(o3e,{context:e.context},n.__v),e.l)):e.l&&e.componentWillUnmount()}function Bq(n,e){var t=bl(s3e,{__v:n,i:e});return t.containerInfo=e,t}(PS.prototype=new Xu).__a=function(n){var e=this,t=Fq(e.__v),i=e.o.get(n);return i[0]++,function(r){var o=function(){e.props.revealOrder?(i.push(r),AU(e,n,i)):r()};t?t(o):o()}},PS.prototype.render=function(n){this.u=null,this.o=new Map;var e=Z2(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return n.children},PS.prototype.componentDidUpdate=PS.prototype.componentDidMount=function(){var n=this;this.o.forEach(function(e,t){AU(n,t,e)})};var a3e=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,l3e=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,u3e=typeof document<"u",c3e=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(n)};Xu.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(Xu.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(e){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:e})}})});var LU=Tt.event;function h3e(){}function d3e(){return this.cancelBubble}function p3e(){return this.defaultPrevented}Tt.event=function(n){return LU&&(n=LU(n)),n.persist=h3e,n.isPropagationStopped=d3e,n.isDefaultPrevented=p3e,n.nativeEvent=n};var DU={configurable:!0,get:function(){return this.class}},RU=Tt.vnode;Tt.vnode=function(n){var e=n.type,t=n.props,i=t;if(typeof e=="string"){var r=e.indexOf("-")===-1;for(var o in i={},t){var s=t[o];u3e&&o==="children"&&e==="noscript"||o==="value"&&"defaultValue"in t&&s==null||(o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&s===!0?s="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+e)&&!c3e(t.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():r&&l3e.test(o)?o=o.replace(/[A-Z0-9]/g,"-$&").toLowerCase():s===null&&(s=void 0),/^oninput$/i.test(o)&&(o=o.toLowerCase(),i[o]&&(o="oninputCapture")),i[o]=s)}e=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=Z2(t.children).forEach(function(a){a.props.selected=i.value.indexOf(a.props.value)!=-1})),e=="select"&&i.defaultValue!=null&&(i.value=Z2(t.children).forEach(function(a){a.props.selected=i.multiple?i.defaultValue.indexOf(a.props.value)!=-1:i.defaultValue==a.props.value})),n.props=i,t.class!=t.className&&(DU.enumerable="className"in t,t.className!=null&&(i.class=t.className),Object.defineProperty(i,"className",DU))}n.$$typeof=a3e,RU&&RU(n)};var OU=Tt.__r;Tt.__r=function(n){OU&&OU(n),n.__c};const f3e=({data:n,setData:e,children:t})=>{const i=g1();return n?Bq(Se("div",{ref:i,className:"lingo3d-ui",style:{zIndex:2,position:"absolute",left:0,top:0,width:"100%",height:"100%",overflow:"hidden"},children:[Se("div",{onMouseDown:()=>e(void 0),style:{position:"absolute",left:0,top:0,width:"100%",height:"100%"}}),Se("div",{className:"lingo3d-bg",style:{position:"absolute",left:n.x,top:n.y,padding:6},children:t})]}),document.body):null},AS=({disabled:n,onClick:e,setData:t,children:i})=>{const[r,o]=Es(!1);return Se("div",{style:{padding:6,whiteSpace:"nowrap",background:!n&&r?"rgba(255, 255, 255, 0.1)":void 0,opacity:n?.5:1},onClick:n?void 0:()=>{t==null||t(void 0),e==null||e()},onMouseEnter:n?void 0:()=>o(!0),onMouseLeave:n?void 0:()=>o(!1),children:i})},Uq=(n,e)=>{var t,i,r;e.add(n);const o=(r=(i=(t=n.userData.manager)==null?void 0:t.parent)==null?void 0:i.outerObject3d)!=null?r:n.parent;o&&Uq(o,e)},m3e=(n,e)=>{const t=n.toLowerCase();let i;if(e instanceof dx?e.loadedGroup.traverse(o=>{i||o.name.toLowerCase().includes(t)&&(i=o)}):e.outerObject3d.traverse(o=>{i||o.name.toLowerCase().includes(t)&&(i=o)}),!i)return;const r=new Set;Uq(i,r),gq(r),Y3(i)},v3e=()=>{const[n,e]=Es(void 0),[t,i]=Es(!1),[r]=v1(),[[o]]=hCe();return Ts(()=>{let[s,a]=[0,0];const l=c=>[s,a]=[c.clientX,c.clientY];document.addEventListener("mousemove",l);const u=Hh(({target:c,rightClick:h})=>{h&&e({x:s,y:a,target:c})});return()=>{u.cancel(),document.removeEventListener("mousemove",l)}},[]),Ts(()=>{!n&&i(!1)},[n]),n?Se(f3e,{data:n,setData:e,children:t?Se("input",{ref:s=>s==null?void 0:s.focus(),style:{all:"unset",padding:6},onKeyDown:s=>{s.stopPropagation(),!(s.key!=="Enter"&&s.key!=="Escape")&&(s.key==="Enter"&&r&&m3e(s.target.value,r),e(void 0))}}):Se(Nl,{children:[n.target&&Se(Nl,{children:[Se(AS,{setData:void 0,onClick:()=>i(!0),children:"Search children"}),Se(AS,{setData:e,onClick:()=>BW(r)&&Nhe(r),children:"Freeze selection"}),r instanceof dv&&tp.has(r)&&Se(AS,{setData:e,onClick:async()=>{const s=tp.get(r)==="dummy"?Gm:Sk+"readyplayerme/reference.fbx",a=await fetch(s);BX("model.fbx",await a.blob())},children:"Download for Mixamo"})]}),Se(AS,{setData:e,disabled:!o.size,onClick:()=>zhe(),children:"Unfreeze all"})]})}):null},[mRe,kU]=Qe(void 0);Vt(()=>{const n=kU();if(!n)return;const e=new Cn;return e.watch(n.loaded.then(t=>{t.getObjectByProperty("type","Bone").traverse(i=>i.name="mixamorig"+i.name)})),()=>{e.cancel()}},[kU]);const jq=()=>{const[n,e]=Es({}),t=g1();mq(()=>{const l=()=>e({}),u=Mg(l),c=qCe(l);return WC(),()=>{u.cancel(),c.cancel(),GC()}},[]);const i=Ky(()=>[...Ii].filter(l=>!BH.has(l)&&!jC.has(l)),[n]),[r]=TI(),[o]=v1(),[s]=_q(),a=()=>{(s==null?void 0:s.name)&&o instanceof ia&&setTimeout(()=>Ei(o.find(s.name)))};return Se("div",{ref:t,className:"lingo3d-ui lingo3d-bg",onClick:()=>Ei(),style:{width:200,height:"100%",padding:4,paddingTop:0,display:"flex",flexDirection:"column",overflow:"hidden"},children:[Se("div",{style:{height:24,borderBottom:"1px solid rgb(255,255,255,0.1)",opacity:.5,display:"flex",alignItems:"center",paddingLeft:12},children:[Se("div",{children:"scenegraph"}),Se("div",{style:{flexGrow:1}}),Se(uL,{active:!!s,onClick:a,children:Se(n3e,{})}),Se(uL,{active:!!r.length,onClick:Kfe,children:Se($Ce,{})}),Se(uL,{active:!!o,onClick:Pq,children:Se(e3e,{})})]}),Se("div",{style:{overflow:"scroll"},className:"lingo3d-ui",children:[i.map(l=>l instanceof Tl?Se(zq,{appendable:l,level:0},l.uuid):Se(AI,{appendable:l,level:0},l.uuid)),Se(t3e,{})]}),Se(v3e,{})]})};rf(jq,"lingo3d-scenegraph");let $2;Vn.addEventListener("dragover",n=>n.preventDefault());Vn.addEventListener("dragenter",n=>n.preventDefault());document.addEventListener("drop",n=>n.preventDefault());Vn.addEventListener("drop",n=>{if(!$2)return;const e=zX($2);e.outerObject3d.position.copy(vk(FMe(n.clientX,n.clientY))),Ei(e)});const IU=({name:n,iconName:e=n})=>Se("div",{onDragStart:()=>$2=n,onDragEnd:()=>$2=void 0,style:{width:"50%",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:20,paddingBottom:20},children:[Se("img",{style:{width:50,height:50},src:`https://unpkg.com/lingo3d-editor@1.0.2/assets/${e}.png`}),Se("div",{style:{marginTop:6,opacity:.75,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:ro.exports.upperFirst(n)})]}),NU=n=>typeof n=="string"?n.endsWith("Camera")?"camera":n.endsWith("Light")?"light":n:Object.values(n)[0],zU=n=>typeof n=="string"?n:Object.keys(n)[0],g3e=({names:n})=>{const e=[];let t=[],i=0;for(const r of n)i===0&&e.push(t=[]),t.push(r),++i===2&&(i=0);return Se(Nl,{children:e.map(([r,o],s)=>Se("div",{style:{display:"flex"},children:[Se(IU,{name:zU(r),iconName:NU(r)}),o&&Se(IU,{name:zU(o),iconName:NU(o)})]},s))})},Hq=()=>{const n=g1(),[e]=PI(),[t]=_Ce();return Ts(()=>(WC(),()=>{GC()}),[]),e?null:Se("div",{ref:n,className:"lingo3d-ui lingo3d-bg",style:{width:200,height:"100%",padding:10},children:Se(g3e,{names:["model","dummy",...t?[{building:"cube"},{tree:"cylinder"}]:[],"svgMesh",{sprite:"plane"},"trigger",{spawnPoint:"circle"},"audio","reflector",{water:"reflector"},"cube","sphere","cone","cylinder","octahedron","tetrahedron","torus","plane","circle","areaLight","ambientLight","skyLight","directionalLight","pointLight","spotLight",{environment:"light"},"camera","thirdPersonCamera","firstPersonCamera","orbitCamera"]})})};rf(Hq,"lingo3d-library");const jc=({hotkey:n,hotkeyFunction:e})=>Se("div",{style:{display:"flex",alignItems:"center",marginTop:4,whiteSpace:"nowrap"},children:[Se("div",{style:{border:"1px solid white",borderRadius:"4px",padding:"2px 4px 2px 4px"},children:Se("div",{style:{minWidth:10,display:"flex",justifyContent:"center",alignItems:"center"},children:n})}),Se("div",{style:{padding:"0 1px 0 1px"},children:"\xA0-\xA0"}),Se("div",{style:{padding:"2px 0px 2px 0px"},children:e})]}),Wq=()=>{const[n]=yCe(),[e]=fCe();return Bq(Se("div",{className:"lingo3d-ui",style:{position:"absolute",width:"100%",height:"100%",pointerEvents:"none",padding:10},children:!!n&&e===di&&Se("div",{style:{opacity:.5},children:[Se(jc,{hotkey:"W",hotkeyFunction:"move forward"}),Se(jc,{hotkey:"S",hotkeyFunction:"move backwards"}),Se(jc,{hotkey:"A",hotkeyFunction:"move left"}),Se(jc,{hotkey:"D",hotkeyFunction:"move right"}),Se(jc,{hotkey:"\u2191",hotkeyFunction:"move up"}),Se(jc,{hotkey:"\u2193",hotkeyFunction:"move down"}),Se(jc,{hotkey:"C",hotkeyFunction:"center selected"}),Se(jc,{hotkey:"SHIFT",hotkeyFunction:"Accelerate"})]})}),Vn)};rf(Wq,"lingo3d-hud");const _3e=()=>{const n=og(null);return Ts(()=>{const e=n.current;!e||(fs.autoMount=e)},[]),Se("div",{className:"lingo3d-ui",style:{width:"100%",height:"100%",position:"absolute",left:0,top:0,display:"flex"},children:[Se(Tq,{}),Se("div",{children:Se("div",{style:{height:"100%"},children:[Se(jq,{}),Se(Dq,{}),Se(Rq,{}),Se(Hq,{})]})}),Se(Wq,{}),Se("div",{ref:n,style:{height:"100%",flexGrow:1,position:"relative"}})]})};rf(_3e,"lingo3d-lingoeditor");const y3e=j3(`
    <style>
        .lingo3d-ui * {
            user-select: none;
            -webkit-user-select: none;
            position: relative;
            box-sizing: border-box;
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji" !important;
        }
        .lingo3d-ui {
            position: relative;
            box-sizing: border-box;
            overflow-x: hidden;
            overflow-y: scroll;
            float: left;
            color: white;
            font-size: 11px;
            max-height: 100%;
        }
        .lingo3d-ui::-webkit-scrollbar {
            display: none;
        }
        .lingo3d-bg {
            background: rgb(40, 41, 46);
        }
        .tp-lblv_l {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .tp-rotv {
            box-shadow: none !important;
            background-color: transparent !important;
        }
        .tp-brkv {
            border-left: none !important;
        }
    </style>
`);document.head.appendChild(y3e);qa(()=>{},100,"both");var Gq={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(it,function(){var t=function(){function i(m){return s.appendChild(m.dom),m}function r(m){for(var y=0;y<s.children.length;y++)s.children[y].style.display=y===m?"block":"none";o=m}var o=0,s=document.createElement("div");s.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",s.addEventListener("click",function(m){m.preventDefault(),r(++o%s.children.length)},!1);var a=(performance||Date).now(),l=a,u=0,c=i(new t.Panel("FPS","#0ff","#002")),h=i(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var p=i(new t.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:s,addPanel:i,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){u++;var m=(performance||Date).now();if(h.update(m-a,200),m>l+1e3&&(c.update(1e3*u/(m-l),100),l=m,u=0,p)){var y=performance.memory;p.update(y.usedJSHeapSize/1048576,y.jsHeapSizeLimit/1048576)}return m},update:function(){a=this.end()},domElement:s,setMode:r}};return t.Panel=function(i,r,o){var s=1/0,a=0,l=Math.round,u=l(window.devicePixelRatio||1),c=80*u,h=48*u,p=3*u,m=2*u,y=3*u,_=15*u,g=74*u,b=30*u,w=document.createElement("canvas");w.width=c,w.height=h,w.style.cssText="width:80px;height:48px";var M=w.getContext("2d");return M.font="bold "+9*u+"px Helvetica,Arial,sans-serif",M.textBaseline="top",M.fillStyle=o,M.fillRect(0,0,c,h),M.fillStyle=r,M.fillText(i,p,m),M.fillRect(y,_,g,b),M.fillStyle=o,M.globalAlpha=.9,M.fillRect(y,_,g,b),{dom:w,update:function(C,P){s=Math.min(s,C),a=Math.max(a,C),M.fillStyle=o,M.globalAlpha=1,M.fillRect(0,0,c,_),M.fillStyle=r,M.fillText(l(C)+" "+i+" ("+l(s)+"-"+l(a)+")",p,m),M.drawImage(w,y+u,_,g-u,b,y,_,g-u,b),M.fillRect(y+g-u,_,u,b),M.fillStyle=o,M.globalAlpha=.9,M.fillRect(y+g-u,_,u,l((1-C/P)*b))}}},t})})(Gq);Gq.exports;_t.forwardRef((n,e)=>{const t=sn(n,e,yv);return qt(Yt.Provider,{value:t})});_t.forwardRef((n,e)=>{const t=sn(n,e,W_);return qt(Yt.Provider,{value:t})});_t.forwardRef((n,e)=>{const t=sn(n,e,fv);return qt(Yt.Provider,{value:t,children:n.children})});const x3e=_t.forwardRef((n,e)=>{const t=sn(n,e,Tl);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,dv);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,pv);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,K_);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,Z_);return qt(Yt.Provider,{value:t,children:n.children})});const b3e=_t.forwardRef((n,e)=>{const t=sn(n,e,uv);return qt(Yt.Provider,{value:t})});_t.forwardRef((n,e)=>{const t=sn(n,e,lv);return qt(Yt.Provider,{value:t})});_t.forwardRef((n,e)=>{const t=sn(n,e,Wu);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,J_);return qt(Yt.Provider,{value:t})});_t.forwardRef((n,e)=>{const t=sn(n,e,Q_);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,$_);return qt(Yt.Provider,{value:t})});_t.forwardRef((n,e)=>{const t=sn(n,e,ey);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,sv);return qt(Yt.Provider,{value:t,children:n.children})});const w3e=_t.forwardRef((n,e)=>{const t=sn(n,e,ty);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,hI);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,ny);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,iy);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,gv);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,ry);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,_v);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,oy);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,q_);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,Jk);return qt(Yt.Provider,{value:t,children:n.children})});const VU=_t.forwardRef((n,e)=>{const t=sn(n,e,qC);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,fx);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,Qk);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,cv);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,px);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,$k);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,eI);return qt(Yt.Provider,{value:t,children:n.children})});_t.forwardRef((n,e)=>{const t=sn(n,e,RM);return qt(Yt.Provider,{value:t})});_t.forwardRef((n,e)=>{const t=sn(n,e,LM);return qt(Yt.Provider,{value:t})});_t.forwardRef(({name:n,onLoad:e,...t},i)=>{const r=hn.exports.useContext(Yt),[o,s]=hn.exports.useState();hn.exports.useLayoutEffect(()=>{if(!(!r||!n)){if("loaded"in r){const u=r.loaded.then(()=>{s(r.find(n))});return()=>{u.cancel()}}s(r.find(n))}},[r,n]);const[a,l]=bI(t,!o);return o&&wI(o,a,l),hn.exports.useLayoutEffect(()=>{!i||!o||(typeof i=="function"?i(o):i.current=o)},[i,o]),hn.exports.useLayoutEffect(()=>{o&&(e==null||e(o))},[o]),qt(Yt.Provider,{value:o,children:t.children})});_t.forwardRef(({name:n,onLoad:e,...t},i)=>{const r=hn.exports.useContext(Yt),[o,s]=hn.exports.useState();hn.exports.useLayoutEffect(()=>{if(!(!r||!n)){if("loaded"in r){const u=r.loaded.then(()=>{s(r.findAll(n))});return()=>{u.cancel()}}s(r.findAll(n))}},[r]);const[a,l]=bI(t,!o);if(o)for(const u of o)wI(u,a,l);return hn.exports.useLayoutEffect(()=>{!i||!o||(typeof i=="function"?i(o):i.current=o)},[i,o]),hn.exports.useLayoutEffect(()=>{o&&(e==null||e(o))},[o]),null});const Xq=(n,e)=>t=>Math.max(Math.min(t,e),n);function S3e(n){return typeof n=="string"}const LI={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n};Object.assign(Object.assign({},LI),{transform:Xq(0,1)});Object.assign(Object.assign({},LI),{default:1});const M3e=n=>({test:e=>S3e(e)&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),hL=M3e("%");Object.assign(Object.assign({},hL),{parse:n=>hL.parse(n)/100,transform:n=>hL.transform(n*100)});const C3e=Xq(0,255);Object.assign(Object.assign({},LI),{transform:n=>Math.round(C3e(n))});const qq=1/60*1e3,E3e=typeof performance<"u"?()=>performance.now():()=>Date.now(),Yq=typeof window<"u"?n=>window.requestAnimationFrame(n):n=>setTimeout(()=>n(E3e()),qq);function T3e(n){let e=[],t=[],i=0,r=!1,o=!1;const s=new WeakSet,a={schedule:(l,u=!1,c=!1)=>{const h=c&&r,p=h?e:t;return u&&s.add(l),p.indexOf(l)===-1&&(p.push(l),h&&r&&(i=e.length)),l},cancel:l=>{const u=t.indexOf(l);u!==-1&&t.splice(u,1),s.delete(l)},process:l=>{if(r){o=!0;return}if(r=!0,[e,t]=[t,e],t.length=0,i=e.length,i)for(let u=0;u<i;u++){const c=e[u];c(l),s.has(c)&&(a.schedule(c),n())}r=!1,o&&(o=!1,a.process(l))}};return a}const P3e=40;let w4=!0,Zy=!1,S4=!1;const ly={delta:0,timestamp:0},_1=["read","update","preRender","render","postRender"],Z3=_1.reduce((n,e)=>(n[e]=T3e(()=>Zy=!0),n),{});_1.reduce((n,e)=>{const t=Z3[e];return n[e]=(i,r=!1,o=!1)=>(Zy||L3e(),t.schedule(i,r,o)),n},{});_1.reduce((n,e)=>(n[e]=Z3[e].cancel,n),{});_1.reduce((n,e)=>(n[e]=()=>Z3[e].process(ly),n),{});const A3e=n=>Z3[n].process(ly),Kq=n=>{Zy=!1,ly.delta=w4?qq:Math.max(Math.min(n-ly.timestamp,P3e),1),ly.timestamp=n,S4=!0,_1.forEach(A3e),S4=!1,Zy&&(w4=!1,Yq(Kq))},L3e=()=>{Zy=!0,w4=!0,S4||Yq(Kq)},D3e=(n,e=!0)=>{const t=YX(n);hn.exports.useLayoutEffect(()=>{if(!e)return;const i=x_(()=>t.current());return()=>{i.cancel()}},[e])},R3e=n=>{const[e,t]=hn.exports.useState(""),i=YX(n);return hn.exports.useLayoutEffect(()=>{const r=new yv;let o="";return r.onKeyDown=s=>{o!==s&&(o=s,t([...bo].join(" ")))},r.onKeyUp=()=>{o="",t([...bo].join(" "))},r.onKeyPress=s=>{var a;return(a=i.current)==null?void 0:a.call(i,s)},()=>{r.dispose()}},[]),e};function O3e(){let[n,e]=hn.exports.useState({x:0,y:0,z:0}),[t,i]=hn.exports.useState(!1),r=hn.exports.useRef();const o=R3e(),s=o==="w"?"walking":"idle",a=u=>{};return D3e(()=>{r.current.moveForward(-1),i(!0)},o==="w"),Dj(H2e,{children:[xr("div",{style:{position:"absolute",top:0,zIndex:"9999"},children:"NOIR"}),xr(b3e,{texture:"5.jpg",textureRepeat:30,physics:"map"}),xr(VU,{width:9999,depth:9999,y:-100,onClick:a,texture:"ground.jpg",textureRepeat:30}),xr(w3e,{active:!0,mouseControl:!0,children:xr(x3e,{ref:r,src:"sbs1.fbx",physics:"character",animations:{dancing:"dancing.fbx",idle:"idle.fbx",walking:"Walking.fbx"},animation:s,intersectIds:["orangeBox"],onIntersect:()=>{i(!1)}})}),xr(VU,{id:"orangeBox",scale:.2,color:"orange",x:n.x,y:n.y,z:n.z,visible:!1})]})}/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const DI="144",k3e=0,FU=1,I3e=2,Zq=1,N3e=2,P_=3,sg=0,Ss=1,hh=2,Eh=0,bv=1,BU=2,UU=3,jU=4,z3e=5,Pm=100,V3e=101,F3e=102,HU=103,WU=104,B3e=200,U3e=201,j3e=202,H3e=203,Jq=204,Qq=205,W3e=206,G3e=207,X3e=208,q3e=209,Y3e=210,K3e=0,Z3e=1,J3e=2,M4=3,Q3e=4,$3e=5,eEe=6,tEe=7,$q=0,nEe=1,iEe=2,qu=0,rEe=1,oEe=2,sEe=3,aEe=4,lEe=5,eY=300,ag=301,lg=302,C4=303,E4=304,J3=306,T4=1e3,ka=1001,P4=1002,Ho=1003,GU=1004,XU=1005,Gs=1006,uEe=1007,Q3=1008,Ip=1009,cEe=1010,hEe=1011,tY=1012,dEe=1013,up=1014,cp=1015,Jy=1016,pEe=1017,fEe=1018,wv=1020,mEe=1021,vEe=1022,wl=1023,gEe=1024,_Ee=1025,yp=1026,ug=1027,yEe=1028,xEe=1029,bEe=1030,wEe=1031,SEe=1033,dL=33776,pL=33777,fL=33778,mL=33779,qU=35840,YU=35841,KU=35842,ZU=35843,MEe=36196,JU=37492,QU=37496,$U=37808,e8=37809,t8=37810,n8=37811,i8=37812,r8=37813,o8=37814,s8=37815,a8=37816,l8=37817,u8=37818,c8=37819,h8=37820,d8=37821,p8=36492,Np=3e3,bi=3001,CEe=3200,EEe=3201,TEe=0,PEe=1,Du="srgb",hp="srgb-linear",vL=7680,AEe=519,f8=35044,m8="300 es",A4=1035;class Ug{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const o=r.indexOf(t);o!==-1&&r.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let o=0,s=r.length;o<s;o++)r[o].call(this,e);e.target=null}}}const Qr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],gL=Math.PI/180,v8=180/Math.PI;function y1(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Qr[n&255]+Qr[n>>8&255]+Qr[n>>16&255]+Qr[n>>24&255]+"-"+Qr[e&255]+Qr[e>>8&255]+"-"+Qr[e>>16&15|64]+Qr[e>>24&255]+"-"+Qr[t&63|128]+Qr[t>>8&255]+"-"+Qr[t>>16&255]+Qr[t>>24&255]+Qr[i&255]+Qr[i>>8&255]+Qr[i>>16&255]+Qr[i>>24&255]).toLowerCase()}function ms(n,e,t){return Math.max(e,Math.min(t,n))}function LEe(n,e){return(n%e+e)%e}function _L(n,e,t){return(1-t)*n+t*e}function g8(n){return(n&n-1)===0&&n!==0}function L4(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function LS(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function cs(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}class zn{constructor(e=0,t=0){zn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),o=this.x-e.x,s=this.y-e.y;return this.x=o*i-s*r+e.x,this.y=o*r+s*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ks{constructor(){Ks.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,o,s,a,l,u){const c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=o,c[5]=l,c[6]=i,c[7]=s,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[3],l=i[6],u=i[1],c=i[4],h=i[7],p=i[2],m=i[5],y=i[8],_=r[0],g=r[3],b=r[6],w=r[1],M=r[4],C=r[7],P=r[2],L=r[5],R=r[8];return o[0]=s*_+a*w+l*P,o[3]=s*g+a*M+l*L,o[6]=s*b+a*C+l*R,o[1]=u*_+c*w+h*P,o[4]=u*g+c*M+h*L,o[7]=u*b+c*C+h*R,o[2]=p*_+m*w+y*P,o[5]=p*g+m*M+y*L,o[8]=p*b+m*C+y*R,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t*s*c-t*a*u-i*o*c+i*a*l+r*o*u-r*s*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*s-a*u,p=a*l-c*o,m=u*o-s*l,y=t*h+i*p+r*m;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/y;return e[0]=h*_,e[1]=(r*u-c*i)*_,e[2]=(a*i-r*s)*_,e[3]=p*_,e[4]=(c*t-r*l)*_,e[5]=(r*o-a*t)*_,e[6]=m*_,e[7]=(i*l-u*t)*_,e[8]=(s*t-i*o)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,o,s,a){const l=Math.cos(o),u=Math.sin(o);return this.set(i*l,i*u,-i*(l*s+u*a)+s+e,-r*u,r*l,-r*(-u*s+l*a)+a+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,o=r[0],s=r[3],a=r[6],l=r[1],u=r[4],c=r[7];return r[0]=t*o+i*l,r[3]=t*s+i*u,r[6]=t*a+i*c,r[1]=-i*o+t*l,r[4]=-i*s+t*u,r[7]=-i*a+t*c,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}function nY(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function eC(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function xp(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function VM(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const yL={[Du]:{[hp]:xp},[hp]:{[Du]:VM}},Ca={legacyMode:!0,get workingColorSpace(){return hp},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(yL[e]&&yL[e][t]!==void 0){const i=yL[e][t];return n.r=i(n.r),n.g=i(n.g),n.b=i(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},iY={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},tr={r:0,g:0,b:0},Ea={h:0,s:0,l:0},DS={h:0,s:0,l:0};function xL(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}function RS(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}class Rn{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Du){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ca.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=hp){return this.r=e,this.g=t,this.b=i,Ca.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=hp){if(e=LEe(e,1),t=ms(t,0,1),i=ms(i,0,1),t===0)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+t):i+t-i*t,s=2*i-o;this.r=xL(s,o,e+1/3),this.g=xL(s,o,e),this.b=xL(s,o,e-1/3)}return Ca.toWorkingColorSpace(this,r),this}setStyle(e,t=Du){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let o;const s=r[1],a=r[2];switch(s){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,Ca.toWorkingColorSpace(this,t),i(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,Ca.toWorkingColorSpace(this,t),i(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(o[1])/360,u=parseFloat(o[2])/100,c=parseFloat(o[3])/100;return i(o[4]),this.setHSL(l,u,c,t)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=r[1],s=o.length;if(s===3)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,Ca.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,Ca.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Du){const i=iY[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=xp(e.r),this.g=xp(e.g),this.b=xp(e.b),this}copyLinearToSRGB(e){return this.r=VM(e.r),this.g=VM(e.g),this.b=VM(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Du){return Ca.fromWorkingColorSpace(RS(this,tr),e),ms(tr.r*255,0,255)<<16^ms(tr.g*255,0,255)<<8^ms(tr.b*255,0,255)<<0}getHexString(e=Du){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=hp){Ca.fromWorkingColorSpace(RS(this,tr),t);const i=tr.r,r=tr.g,o=tr.b,s=Math.max(i,r,o),a=Math.min(i,r,o);let l,u;const c=(a+s)/2;if(a===s)l=0,u=0;else{const h=s-a;switch(u=c<=.5?h/(s+a):h/(2-s-a),s){case i:l=(r-o)/h+(r<o?6:0);break;case r:l=(o-i)/h+2;break;case o:l=(i-r)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=hp){return Ca.fromWorkingColorSpace(RS(this,tr),t),e.r=tr.r,e.g=tr.g,e.b=tr.b,e}getStyle(e=Du){return Ca.fromWorkingColorSpace(RS(this,tr),e),e!==Du?`color(${e} ${tr.r} ${tr.g} ${tr.b})`:`rgb(${tr.r*255|0},${tr.g*255|0},${tr.b*255|0})`}offsetHSL(e,t,i){return this.getHSL(Ea),Ea.h+=e,Ea.s+=t,Ea.l+=i,this.setHSL(Ea.h,Ea.s,Ea.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Ea),e.getHSL(DS);const i=_L(Ea.h,DS.h,t),r=_L(Ea.s,DS.s,t),o=_L(Ea.l,DS.l,t);return this.setHSL(i,r,o),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}Rn.NAMES=iY;let dm;class rY{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{dm===void 0&&(dm=eC("canvas")),dm.width=e.width,dm.height=e.height;const i=dm.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=dm}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=eC("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),o=r.data;for(let s=0;s<o.length;s++)o[s]=xp(o[s]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(xp(t[i]/255)*255):t[i]=xp(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class oY{constructor(e=null){this.isSource=!0,this.uuid=y1(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let o;if(Array.isArray(r)){o=[];for(let s=0,a=r.length;s<a;s++)r[s].isDataTexture?o.push(bL(r[s].image)):o.push(bL(r[s]))}else o=bL(r);i.url=o}return t||(e.images[this.uuid]=i),i}}function bL(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?rY.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let DEe=0;class Xa extends Ug{constructor(e=Xa.DEFAULT_IMAGE,t=Xa.DEFAULT_MAPPING,i=ka,r=ka,o=Gs,s=Q3,a=wl,l=Ip,u=1,c=Np){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:DEe++}),this.uuid=y1(),this.name="",this.source=new oY(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=r,this.magFilter=o,this.minFilter=s,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new zn(0,0),this.repeat=new zn(1,1),this.center=new zn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ks,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==eY)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case T4:e.x=e.x-Math.floor(e.x);break;case ka:e.x=e.x<0?0:1;break;case P4:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case T4:e.y=e.y-Math.floor(e.y);break;case ka:e.y=e.y<0?0:1;break;case P4:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}Xa.DEFAULT_IMAGE=null;Xa.DEFAULT_MAPPING=eY;class Mr{constructor(e=0,t=0,i=0,r=1){Mr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r+s[12]*o,this.y=s[1]*t+s[5]*i+s[9]*r+s[13]*o,this.z=s[2]*t+s[6]*i+s[10]*r+s[14]*o,this.w=s[3]*t+s[7]*i+s[11]*r+s[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,o;const l=e.elements,u=l[0],c=l[4],h=l[8],p=l[1],m=l[5],y=l[9],_=l[2],g=l[6],b=l[10];if(Math.abs(c-p)<.01&&Math.abs(h-_)<.01&&Math.abs(y-g)<.01){if(Math.abs(c+p)<.1&&Math.abs(h+_)<.1&&Math.abs(y+g)<.1&&Math.abs(u+m+b-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const M=(u+1)/2,C=(m+1)/2,P=(b+1)/2,L=(c+p)/4,R=(h+_)/4,E=(y+g)/4;return M>C&&M>P?M<.01?(i=0,r=.707106781,o=.707106781):(i=Math.sqrt(M),r=L/i,o=R/i):C>P?C<.01?(i=.707106781,r=0,o=.707106781):(r=Math.sqrt(C),i=L/r,o=E/r):P<.01?(i=.707106781,r=.707106781,o=0):(o=Math.sqrt(P),i=R/o,r=E/o),this.set(i,r,o,t),this}let w=Math.sqrt((g-y)*(g-y)+(h-_)*(h-_)+(p-c)*(p-c));return Math.abs(w)<.001&&(w=1),this.x=(g-y)/w,this.y=(h-_)/w,this.z=(p-c)/w,this.w=Math.acos((u+m+b-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class zp extends Ug{constructor(e,t,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Mr(0,0,e,t),this.scissorTest=!1,this.viewport=new Mr(0,0,e,t);const r={width:e,height:t,depth:1};this.texture=new Xa(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Gs,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new oY(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class sY extends Xa{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ho,this.minFilter=Ho,this.wrapR=ka,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class REe extends Xa{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ho,this.minFilter=Ho,this.wrapR=ka,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class jg{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,o,s,a){let l=i[r+0],u=i[r+1],c=i[r+2],h=i[r+3];const p=o[s+0],m=o[s+1],y=o[s+2],_=o[s+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h;return}if(a===1){e[t+0]=p,e[t+1]=m,e[t+2]=y,e[t+3]=_;return}if(h!==_||l!==p||u!==m||c!==y){let g=1-a;const b=l*p+u*m+c*y+h*_,w=b>=0?1:-1,M=1-b*b;if(M>Number.EPSILON){const P=Math.sqrt(M),L=Math.atan2(P,b*w);g=Math.sin(g*L)/P,a=Math.sin(a*L)/P}const C=a*w;if(l=l*g+p*C,u=u*g+m*C,c=c*g+y*C,h=h*g+_*C,g===1-a){const P=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=P,u*=P,c*=P,h*=P}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,o,s){const a=i[r],l=i[r+1],u=i[r+2],c=i[r+3],h=o[s],p=o[s+1],m=o[s+2],y=o[s+3];return e[t]=a*y+c*h+l*m-u*p,e[t+1]=l*y+c*p+u*h-a*m,e[t+2]=u*y+c*m+a*p-l*h,e[t+3]=c*y-a*h-l*p-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,o=e._z,s=e._order,a=Math.cos,l=Math.sin,u=a(i/2),c=a(r/2),h=a(o/2),p=l(i/2),m=l(r/2),y=l(o/2);switch(s){case"XYZ":this._x=p*c*h+u*m*y,this._y=u*m*h-p*c*y,this._z=u*c*y+p*m*h,this._w=u*c*h-p*m*y;break;case"YXZ":this._x=p*c*h+u*m*y,this._y=u*m*h-p*c*y,this._z=u*c*y-p*m*h,this._w=u*c*h+p*m*y;break;case"ZXY":this._x=p*c*h-u*m*y,this._y=u*m*h+p*c*y,this._z=u*c*y+p*m*h,this._w=u*c*h-p*m*y;break;case"ZYX":this._x=p*c*h-u*m*y,this._y=u*m*h+p*c*y,this._z=u*c*y-p*m*h,this._w=u*c*h+p*m*y;break;case"YZX":this._x=p*c*h+u*m*y,this._y=u*m*h+p*c*y,this._z=u*c*y-p*m*h,this._w=u*c*h-p*m*y;break;case"XZY":this._x=p*c*h-u*m*y,this._y=u*m*h-p*c*y,this._z=u*c*y+p*m*h,this._w=u*c*h+p*m*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],o=t[8],s=t[1],a=t[5],l=t[9],u=t[2],c=t[6],h=t[10],p=i+a+h;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(c-l)*m,this._y=(o-u)*m,this._z=(s-r)*m}else if(i>a&&i>h){const m=2*Math.sqrt(1+i-a-h);this._w=(c-l)/m,this._x=.25*m,this._y=(r+s)/m,this._z=(o+u)/m}else if(a>h){const m=2*Math.sqrt(1+a-i-h);this._w=(o-u)/m,this._x=(r+s)/m,this._y=.25*m,this._z=(l+c)/m}else{const m=2*Math.sqrt(1+h-i-a);this._w=(s-r)/m,this._x=(o+u)/m,this._y=(l+c)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ms(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,o=e._z,s=e._w,a=t._x,l=t._y,u=t._z,c=t._w;return this._x=i*c+s*a+r*u-o*l,this._y=r*c+s*l+o*a-i*u,this._z=o*c+s*u+i*l-r*a,this._w=s*c-i*a-r*l-o*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,o=this._z,s=this._w;let a=s*e._w+i*e._x+r*e._y+o*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=i,this._y=r,this._z=o,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*s+t*this._w,this._x=m*i+t*this._x,this._y=m*r+t*this._y,this._z=m*o+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),h=Math.sin((1-t)*c)/u,p=Math.sin(t*c)/u;return this._w=s*h+this._w*p,this._x=i*h+this._x*p,this._y=r*h+this._y*p,this._z=o*h+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(o),i*Math.cos(o),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ee{constructor(e=0,t=0,i=0){Ee.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(_8.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(_8.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*r,this.y=o[1]*t+o[4]*i+o[7]*r,this.z=o[2]*t+o[5]*i+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=e.elements,s=1/(o[3]*t+o[7]*i+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*r+o[12])*s,this.y=(o[1]*t+o[5]*i+o[9]*r+o[13])*s,this.z=(o[2]*t+o[6]*i+o[10]*r+o[14])*s,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,o=e.x,s=e.y,a=e.z,l=e.w,u=l*t+s*r-a*i,c=l*i+a*t-o*r,h=l*r+o*i-s*t,p=-o*t-s*i-a*r;return this.x=u*l+p*-o+c*-a-h*-s,this.y=c*l+p*-s+h*-o-u*-a,this.z=h*l+p*-a+u*-s-c*-o,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r,this.y=o[1]*t+o[5]*i+o[9]*r,this.z=o[2]*t+o[6]*i+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,o=e.z,s=t.x,a=t.y,l=t.z;return this.x=r*l-o*a,this.y=o*s-i*l,this.z=i*a-r*s,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return wL.copy(this).projectOnVector(e),this.sub(wL)}reflect(e){return this.sub(wL.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(ms(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const wL=new Ee,_8=new jg;class x1{constructor(e=new Ee(1/0,1/0,1/0),t=new Ee(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,u=e.length;l<u;l+=3){const c=e[l],h=e[l+1],p=e[l+2];c<t&&(t=c),h<i&&(i=h),p<r&&(r=p),c>o&&(o=c),h>s&&(s=h),p>a&&(a=p)}return this.min.set(t,i,r),this.max.set(o,s,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,u=e.count;l<u;l++){const c=e.getX(l),h=e.getY(l),p=e.getZ(l);c<t&&(t=c),h<i&&(i=h),p<r&&(r=p),c>o&&(o=c),h>s&&(s=h),p>a&&(a=p)}return this.min.set(t,i,r),this.max.set(o,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Hd.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){const o=i.attributes.position;for(let s=0,a=o.count;s<a;s++)Hd.fromBufferAttribute(o,s).applyMatrix4(e.matrixWorld),this.expandByPoint(Hd)}else i.boundingBox===null&&i.computeBoundingBox(),SL.copy(i.boundingBox),SL.applyMatrix4(e.matrixWorld),this.union(SL);const r=e.children;for(let o=0,s=r.length;o<s;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Hd),Hd.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(u_),OS.subVectors(this.max,u_),pm.subVectors(e.a,u_),fm.subVectors(e.b,u_),mm.subVectors(e.c,u_),Hc.subVectors(fm,pm),Wc.subVectors(mm,fm),Wd.subVectors(pm,mm);let t=[0,-Hc.z,Hc.y,0,-Wc.z,Wc.y,0,-Wd.z,Wd.y,Hc.z,0,-Hc.x,Wc.z,0,-Wc.x,Wd.z,0,-Wd.x,-Hc.y,Hc.x,0,-Wc.y,Wc.x,0,-Wd.y,Wd.x,0];return!ML(t,pm,fm,mm,OS)||(t=[1,0,0,0,1,0,0,0,1],!ML(t,pm,fm,mm,OS))?!1:(kS.crossVectors(Hc,Wc),t=[kS.x,kS.y,kS.z],ML(t,pm,fm,mm,OS))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Hd.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Hd).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Su[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Su[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Su[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Su[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Su[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Su[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Su[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Su[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Su),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Su=[new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee],Hd=new Ee,SL=new x1,pm=new Ee,fm=new Ee,mm=new Ee,Hc=new Ee,Wc=new Ee,Wd=new Ee,u_=new Ee,OS=new Ee,kS=new Ee,Gd=new Ee;function ML(n,e,t,i,r){for(let o=0,s=n.length-3;o<=s;o+=3){Gd.fromArray(n,o);const a=r.x*Math.abs(Gd.x)+r.y*Math.abs(Gd.y)+r.z*Math.abs(Gd.z),l=e.dot(Gd),u=t.dot(Gd),c=i.dot(Gd);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}const OEe=new x1,y8=new Ee,IS=new Ee,CL=new Ee;class $3{constructor(e=new Ee,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):OEe.setFromPoints(e).getCenter(i);let r=0;for(let o=0,s=e.length;o<s;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){CL.subVectors(e,this.center);const t=CL.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.add(CL.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return this.center.equals(e.center)===!0?IS.set(0,0,1).multiplyScalar(e.radius):IS.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(y8.copy(e.center).add(IS)),this.expandByPoint(y8.copy(e.center).sub(IS)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Mu=new Ee,EL=new Ee,NS=new Ee,Gc=new Ee,TL=new Ee,zS=new Ee,PL=new Ee;class aY{constructor(e=new Ee,t=new Ee(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Mu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Mu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Mu.copy(this.direction).multiplyScalar(t).add(this.origin),Mu.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){EL.copy(e).add(t).multiplyScalar(.5),NS.copy(t).sub(e).normalize(),Gc.copy(this.origin).sub(EL);const o=e.distanceTo(t)*.5,s=-this.direction.dot(NS),a=Gc.dot(this.direction),l=-Gc.dot(NS),u=Gc.lengthSq(),c=Math.abs(1-s*s);let h,p,m,y;if(c>0)if(h=s*l-a,p=s*a-l,y=o*c,h>=0)if(p>=-y)if(p<=y){const _=1/c;h*=_,p*=_,m=h*(h+s*p+2*a)+p*(s*h+p+2*l)+u}else p=o,h=Math.max(0,-(s*p+a)),m=-h*h+p*(p+2*l)+u;else p=-o,h=Math.max(0,-(s*p+a)),m=-h*h+p*(p+2*l)+u;else p<=-y?(h=Math.max(0,-(-s*o+a)),p=h>0?-o:Math.min(Math.max(-o,-l),o),m=-h*h+p*(p+2*l)+u):p<=y?(h=0,p=Math.min(Math.max(-o,-l),o),m=p*(p+2*l)+u):(h=Math.max(0,-(s*o+a)),p=h>0?o:Math.min(Math.max(-o,-l),o),m=-h*h+p*(p+2*l)+u);else p=s>0?-o:o,h=Math.max(0,-(s*p+a)),m=-h*h+p*(p+2*l)+u;return i&&i.copy(this.direction).multiplyScalar(h).add(this.origin),r&&r.copy(NS).multiplyScalar(p).add(EL),m}intersectSphere(e,t){Mu.subVectors(e.center,this.origin);const i=Mu.dot(this.direction),r=Mu.dot(Mu)-i*i,o=e.radius*e.radius;if(r>o)return null;const s=Math.sqrt(o-r),a=i-s,l=i+s;return a<0&&l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,o,s,a,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,p=this.origin;return u>=0?(i=(e.min.x-p.x)*u,r=(e.max.x-p.x)*u):(i=(e.max.x-p.x)*u,r=(e.min.x-p.x)*u),c>=0?(o=(e.min.y-p.y)*c,s=(e.max.y-p.y)*c):(o=(e.max.y-p.y)*c,s=(e.min.y-p.y)*c),i>s||o>r||((o>i||i!==i)&&(i=o),(s<r||r!==r)&&(r=s),h>=0?(a=(e.min.z-p.z)*h,l=(e.max.z-p.z)*h):(a=(e.max.z-p.z)*h,l=(e.min.z-p.z)*h),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,Mu)!==null}intersectTriangle(e,t,i,r,o){TL.subVectors(t,e),zS.subVectors(i,e),PL.crossVectors(TL,zS);let s=this.direction.dot(PL),a;if(s>0){if(r)return null;a=1}else if(s<0)a=-1,s=-s;else return null;Gc.subVectors(this.origin,e);const l=a*this.direction.dot(zS.crossVectors(Gc,zS));if(l<0)return null;const u=a*this.direction.dot(TL.cross(Gc));if(u<0||l+u>s)return null;const c=-a*Gc.dot(PL);return c<0?null:this.at(c/s,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class qi{constructor(){qi.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,r,o,s,a,l,u,c,h,p,m,y,_,g){const b=this.elements;return b[0]=e,b[4]=t,b[8]=i,b[12]=r,b[1]=o,b[5]=s,b[9]=a,b[13]=l,b[2]=u,b[6]=c,b[10]=h,b[14]=p,b[3]=m,b[7]=y,b[11]=_,b[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new qi().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/vm.setFromMatrixColumn(e,0).length(),o=1/vm.setFromMatrixColumn(e,1).length(),s=1/vm.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,o=e.z,s=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),c=Math.cos(o),h=Math.sin(o);if(e.order==="XYZ"){const p=s*c,m=s*h,y=a*c,_=a*h;t[0]=l*c,t[4]=-l*h,t[8]=u,t[1]=m+y*u,t[5]=p-_*u,t[9]=-a*l,t[2]=_-p*u,t[6]=y+m*u,t[10]=s*l}else if(e.order==="YXZ"){const p=l*c,m=l*h,y=u*c,_=u*h;t[0]=p+_*a,t[4]=y*a-m,t[8]=s*u,t[1]=s*h,t[5]=s*c,t[9]=-a,t[2]=m*a-y,t[6]=_+p*a,t[10]=s*l}else if(e.order==="ZXY"){const p=l*c,m=l*h,y=u*c,_=u*h;t[0]=p-_*a,t[4]=-s*h,t[8]=y+m*a,t[1]=m+y*a,t[5]=s*c,t[9]=_-p*a,t[2]=-s*u,t[6]=a,t[10]=s*l}else if(e.order==="ZYX"){const p=s*c,m=s*h,y=a*c,_=a*h;t[0]=l*c,t[4]=y*u-m,t[8]=p*u+_,t[1]=l*h,t[5]=_*u+p,t[9]=m*u-y,t[2]=-u,t[6]=a*l,t[10]=s*l}else if(e.order==="YZX"){const p=s*l,m=s*u,y=a*l,_=a*u;t[0]=l*c,t[4]=_-p*h,t[8]=y*h+m,t[1]=h,t[5]=s*c,t[9]=-a*c,t[2]=-u*c,t[6]=m*h+y,t[10]=p-_*h}else if(e.order==="XZY"){const p=s*l,m=s*u,y=a*l,_=a*u;t[0]=l*c,t[4]=-h,t[8]=u*c,t[1]=p*h+_,t[5]=s*c,t[9]=m*h-y,t[2]=y*h-m,t[6]=a*c,t[10]=_*h+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(kEe,e,IEe)}lookAt(e,t,i){const r=this.elements;return hs.subVectors(e,t),hs.lengthSq()===0&&(hs.z=1),hs.normalize(),Xc.crossVectors(i,hs),Xc.lengthSq()===0&&(Math.abs(i.z)===1?hs.x+=1e-4:hs.z+=1e-4,hs.normalize(),Xc.crossVectors(i,hs)),Xc.normalize(),VS.crossVectors(hs,Xc),r[0]=Xc.x,r[4]=VS.x,r[8]=hs.x,r[1]=Xc.y,r[5]=VS.y,r[9]=hs.y,r[2]=Xc.z,r[6]=VS.z,r[10]=hs.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[4],l=i[8],u=i[12],c=i[1],h=i[5],p=i[9],m=i[13],y=i[2],_=i[6],g=i[10],b=i[14],w=i[3],M=i[7],C=i[11],P=i[15],L=r[0],R=r[4],E=r[8],D=r[12],N=r[1],j=r[5],te=r[9],ee=r[13],H=r[2],Q=r[6],Z=r[10],de=r[14],X=r[3],B=r[7],U=r[11],le=r[15];return o[0]=s*L+a*N+l*H+u*X,o[4]=s*R+a*j+l*Q+u*B,o[8]=s*E+a*te+l*Z+u*U,o[12]=s*D+a*ee+l*de+u*le,o[1]=c*L+h*N+p*H+m*X,o[5]=c*R+h*j+p*Q+m*B,o[9]=c*E+h*te+p*Z+m*U,o[13]=c*D+h*ee+p*de+m*le,o[2]=y*L+_*N+g*H+b*X,o[6]=y*R+_*j+g*Q+b*B,o[10]=y*E+_*te+g*Z+b*U,o[14]=y*D+_*ee+g*de+b*le,o[3]=w*L+M*N+C*H+P*X,o[7]=w*R+M*j+C*Q+P*B,o[11]=w*E+M*te+C*Z+P*U,o[15]=w*D+M*ee+C*de+P*le,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],o=e[12],s=e[1],a=e[5],l=e[9],u=e[13],c=e[2],h=e[6],p=e[10],m=e[14],y=e[3],_=e[7],g=e[11],b=e[15];return y*(+o*l*h-r*u*h-o*a*p+i*u*p+r*a*m-i*l*m)+_*(+t*l*m-t*u*p+o*s*p-r*s*m+r*u*c-o*l*c)+g*(+t*u*h-t*a*m-o*s*h+i*s*m+o*a*c-i*u*c)+b*(-r*a*c-t*l*h+t*a*p+r*s*h-i*s*p+i*l*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],m=e[11],y=e[12],_=e[13],g=e[14],b=e[15],w=h*g*u-_*p*u+_*l*m-a*g*m-h*l*b+a*p*b,M=y*p*u-c*g*u-y*l*m+s*g*m+c*l*b-s*p*b,C=c*_*u-y*h*u+y*a*m-s*_*m-c*a*b+s*h*b,P=y*h*l-c*_*l-y*a*p+s*_*p+c*a*g-s*h*g,L=t*w+i*M+r*C+o*P;if(L===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const R=1/L;return e[0]=w*R,e[1]=(_*p*o-h*g*o-_*r*m+i*g*m+h*r*b-i*p*b)*R,e[2]=(a*g*o-_*l*o+_*r*u-i*g*u-a*r*b+i*l*b)*R,e[3]=(h*l*o-a*p*o-h*r*u+i*p*u+a*r*m-i*l*m)*R,e[4]=M*R,e[5]=(c*g*o-y*p*o+y*r*m-t*g*m-c*r*b+t*p*b)*R,e[6]=(y*l*o-s*g*o-y*r*u+t*g*u+s*r*b-t*l*b)*R,e[7]=(s*p*o-c*l*o+c*r*u-t*p*u-s*r*m+t*l*m)*R,e[8]=C*R,e[9]=(y*h*o-c*_*o-y*i*m+t*_*m+c*i*b-t*h*b)*R,e[10]=(s*_*o-y*a*o+y*i*u-t*_*u-s*i*b+t*a*b)*R,e[11]=(c*a*o-s*h*o-c*i*u+t*h*u+s*i*m-t*a*m)*R,e[12]=P*R,e[13]=(c*_*r-y*h*r+y*i*p-t*_*p-c*i*g+t*h*g)*R,e[14]=(y*a*r-s*_*r-y*i*l+t*_*l+s*i*g-t*a*g)*R,e[15]=(s*h*r-c*a*r+c*i*l-t*h*l-s*i*p+t*a*p)*R,this}scale(e){const t=this.elements,i=e.x,r=e.y,o=e.z;return t[0]*=i,t[4]*=r,t[8]*=o,t[1]*=i,t[5]*=r,t[9]*=o,t[2]*=i,t[6]*=r,t[10]*=o,t[3]*=i,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),o=1-i,s=e.x,a=e.y,l=e.z,u=o*s,c=o*a;return this.set(u*s+i,u*a-r*l,u*l+r*a,0,u*a+r*l,c*a+i,c*l-r*s,0,u*l-r*a,c*l+r*s,o*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,o,s){return this.set(1,i,o,0,e,1,s,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,o=t._x,s=t._y,a=t._z,l=t._w,u=o+o,c=s+s,h=a+a,p=o*u,m=o*c,y=o*h,_=s*c,g=s*h,b=a*h,w=l*u,M=l*c,C=l*h,P=i.x,L=i.y,R=i.z;return r[0]=(1-(_+b))*P,r[1]=(m+C)*P,r[2]=(y-M)*P,r[3]=0,r[4]=(m-C)*L,r[5]=(1-(p+b))*L,r[6]=(g+w)*L,r[7]=0,r[8]=(y+M)*R,r[9]=(g-w)*R,r[10]=(1-(p+_))*R,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let o=vm.set(r[0],r[1],r[2]).length();const s=vm.set(r[4],r[5],r[6]).length(),a=vm.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],Ta.copy(this);const u=1/o,c=1/s,h=1/a;return Ta.elements[0]*=u,Ta.elements[1]*=u,Ta.elements[2]*=u,Ta.elements[4]*=c,Ta.elements[5]*=c,Ta.elements[6]*=c,Ta.elements[8]*=h,Ta.elements[9]*=h,Ta.elements[10]*=h,t.setFromRotationMatrix(Ta),i.x=o,i.y=s,i.z=a,this}makePerspective(e,t,i,r,o,s){const a=this.elements,l=2*o/(t-e),u=2*o/(i-r),c=(t+e)/(t-e),h=(i+r)/(i-r),p=-(s+o)/(s-o),m=-2*s*o/(s-o);return a[0]=l,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=m,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,o,s){const a=this.elements,l=1/(t-e),u=1/(i-r),c=1/(s-o),h=(t+e)*l,p=(i+r)*u,m=(s+o)*c;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-m,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const vm=new Ee,Ta=new qi,kEe=new Ee(0,0,0),IEe=new Ee(1,1,1),Xc=new Ee,VS=new Ee,hs=new Ee,x8=new qi,b8=new jg;class b1{constructor(e=0,t=0,i=0,r=b1.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,o=r[0],s=r[4],a=r[8],l=r[1],u=r[5],c=r[9],h=r[2],p=r[6],m=r[10];switch(t){case"XYZ":this._y=Math.asin(ms(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,m),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(p,u),this._z=0);break;case"YXZ":this._x=Math.asin(-ms(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(ms(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-ms(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,u));break;case"YZX":this._z=Math.asin(ms(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-ms(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(p,u),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-c,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return x8.makeRotationFromQuaternion(e),this.setFromRotationMatrix(x8,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return b8.setFromEuler(this),this.setFromQuaternion(b8,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}b1.DefaultOrder="XYZ";b1.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class lY{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let NEe=0;const w8=new Ee,gm=new jg,Cu=new qi,FS=new Ee,c_=new Ee,zEe=new Ee,VEe=new jg,S8=new Ee(1,0,0),M8=new Ee(0,1,0),C8=new Ee(0,0,1),FEe={type:"added"},E8={type:"removed"};class Er extends Ug{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:NEe++}),this.uuid=y1(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Er.DefaultUp.clone();const e=new Ee,t=new b1,i=new jg,r=new Ee(1,1,1);function o(){i.setFromEuler(t,!1)}function s(){t.setFromQuaternion(i,void 0,!1)}t._onChange(o),i._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new qi},normalMatrix:{value:new Ks}}),this.matrix=new qi,this.matrixWorld=new qi,this.matrixAutoUpdate=Er.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Er.DefaultMatrixWorldAutoUpdate,this.layers=new lY,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return gm.setFromAxisAngle(e,t),this.quaternion.multiply(gm),this}rotateOnWorldAxis(e,t){return gm.setFromAxisAngle(e,t),this.quaternion.premultiply(gm),this}rotateX(e){return this.rotateOnAxis(S8,e)}rotateY(e){return this.rotateOnAxis(M8,e)}rotateZ(e){return this.rotateOnAxis(C8,e)}translateOnAxis(e,t){return w8.copy(e).applyQuaternion(this.quaternion),this.position.add(w8.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(S8,e)}translateY(e){return this.translateOnAxis(M8,e)}translateZ(e){return this.translateOnAxis(C8,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Cu.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?FS.copy(e):FS.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),c_.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Cu.lookAt(c_,FS,this.up):Cu.lookAt(FS,c_,this.up),this.quaternion.setFromRotationMatrix(Cu),r&&(Cu.extractRotation(r.matrixWorld),gm.setFromRotationMatrix(Cu),this.quaternion.premultiply(gm.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(FEe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(E8)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(E8)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Cu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Cu.multiply(e.parent.matrixWorld)),e.applyMatrix4(Cu),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const s=this.children[i].getObjectByProperty(e,t);if(s!==void 0)return s}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(c_,e,zEe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(c_,VEe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++){const o=t[i];(o.matrixWorldAutoUpdate===!0||e===!0)&&o.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let o=0,s=r.length;o<s;o++){const a=r[o];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function o(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];o(e.shapes,h)}else o(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(o(e.materials,this.material[l]));r.material=a}else r.material=o(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(o(e.animations,l))}}if(t){const a=s(e.geometries),l=s(e.materials),u=s(e.textures),c=s(e.images),h=s(e.shapes),p=s(e.skeletons),m=s(e.animations),y=s(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),c.length>0&&(i.images=c),h.length>0&&(i.shapes=h),p.length>0&&(i.skeletons=p),m.length>0&&(i.animations=m),y.length>0&&(i.nodes=y)}return i.object=r,i;function s(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Er.DefaultUp=new Ee(0,1,0);Er.DefaultMatrixAutoUpdate=!0;Er.DefaultMatrixWorldAutoUpdate=!0;const Pa=new Ee,Eu=new Ee,AL=new Ee,Tu=new Ee,_m=new Ee,ym=new Ee,T8=new Ee,LL=new Ee,DL=new Ee,RL=new Ee;class zu{constructor(e=new Ee,t=new Ee,i=new Ee){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Pa.subVectors(e,t),r.cross(Pa);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,i,r,o){Pa.subVectors(r,t),Eu.subVectors(i,t),AL.subVectors(e,t);const s=Pa.dot(Pa),a=Pa.dot(Eu),l=Pa.dot(AL),u=Eu.dot(Eu),c=Eu.dot(AL),h=s*u-a*a;if(h===0)return o.set(-2,-1,-1);const p=1/h,m=(u*l-a*c)*p,y=(s*c-a*l)*p;return o.set(1-m-y,y,m)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Tu),Tu.x>=0&&Tu.y>=0&&Tu.x+Tu.y<=1}static getUV(e,t,i,r,o,s,a,l){return this.getBarycoord(e,t,i,r,Tu),l.set(0,0),l.addScaledVector(o,Tu.x),l.addScaledVector(s,Tu.y),l.addScaledVector(a,Tu.z),l}static isFrontFacing(e,t,i,r){return Pa.subVectors(i,t),Eu.subVectors(e,t),Pa.cross(Eu).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Pa.subVectors(this.c,this.b),Eu.subVectors(this.a,this.b),Pa.cross(Eu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return zu.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return zu.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,o){return zu.getUV(e,this.a,this.b,this.c,t,i,r,o)}containsPoint(e){return zu.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return zu.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,o=this.c;let s,a;_m.subVectors(r,i),ym.subVectors(o,i),LL.subVectors(e,i);const l=_m.dot(LL),u=ym.dot(LL);if(l<=0&&u<=0)return t.copy(i);DL.subVectors(e,r);const c=_m.dot(DL),h=ym.dot(DL);if(c>=0&&h<=c)return t.copy(r);const p=l*h-c*u;if(p<=0&&l>=0&&c<=0)return s=l/(l-c),t.copy(i).addScaledVector(_m,s);RL.subVectors(e,o);const m=_m.dot(RL),y=ym.dot(RL);if(y>=0&&m<=y)return t.copy(o);const _=m*u-l*y;if(_<=0&&u>=0&&y<=0)return a=u/(u-y),t.copy(i).addScaledVector(ym,a);const g=c*y-m*h;if(g<=0&&h-c>=0&&m-y>=0)return T8.subVectors(o,r),a=(h-c)/(h-c+(m-y)),t.copy(r).addScaledVector(T8,a);const b=1/(g+_+p);return s=_*b,a=p*b,t.copy(i).addScaledVector(_m,s).addScaledVector(ym,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let BEe=0;class w1 extends Ug{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:BEe++}),this.uuid=y1(),this.name="",this.type="Material",this.blending=bv,this.side=sg,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Jq,this.blendDst=Qq,this.blendEquation=Pm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=M4,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AEe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=vL,this.stencilZFail=vL,this.stencilZPass=vL,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];if(r===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==bv&&(i.blending=this.blending),this.side!==sg&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData);function r(o){const s=[];for(const a in o){const l=o[a];delete l.metadata,s.push(l)}return s}if(t){const o=r(e.textures),s=r(e.images);o.length>0&&(i.textures=o),s.length>0&&(i.images=s)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let o=0;o!==r;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class uY extends w1{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Rn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=$q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ui=new Ee,BS=new zn;class Ll{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i===!0,this.usage=f8,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)BS.fromBufferAttribute(this,t),BS.applyMatrix3(e),this.setXY(t,BS.x,BS.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Ui.fromBufferAttribute(this,t),Ui.applyMatrix3(e),this.setXYZ(t,Ui.x,Ui.y,Ui.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Ui.fromBufferAttribute(this,t),Ui.applyMatrix4(e),this.setXYZ(t,Ui.x,Ui.y,Ui.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ui.fromBufferAttribute(this,t),Ui.applyNormalMatrix(e),this.setXYZ(t,Ui.x,Ui.y,Ui.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ui.fromBufferAttribute(this,t),Ui.transformDirection(e),this.setXYZ(t,Ui.x,Ui.y,Ui.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=LS(t,this.array)),t}setX(e,t){return this.normalized&&(t=cs(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=LS(t,this.array)),t}setY(e,t){return this.normalized&&(t=cs(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=LS(t,this.array)),t}setZ(e,t){return this.normalized&&(t=cs(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=LS(t,this.array)),t}setW(e,t){return this.normalized&&(t=cs(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=cs(t,this.array),i=cs(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=cs(t,this.array),i=cs(i,this.array),r=cs(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,o){return e*=this.itemSize,this.normalized&&(t=cs(t,this.array),i=cs(i,this.array),r=cs(r,this.array),o=cs(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==f8&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class cY extends Ll{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class hY extends Ll{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class ja extends Ll{constructor(e,t,i){super(new Float32Array(e),t,i)}}let UEe=0;const js=new qi,OL=new Er,xm=new Ee,ds=new x1,h_=new x1,gr=new Ee;class hc extends Ug{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:UEe++}),this.uuid=y1(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(nY(e)?hY:cY)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const o=new Ks().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return js.makeRotationFromQuaternion(e),this.applyMatrix4(js),this}rotateX(e){return js.makeRotationX(e),this.applyMatrix4(js),this}rotateY(e){return js.makeRotationY(e),this.applyMatrix4(js),this}rotateZ(e){return js.makeRotationZ(e),this.applyMatrix4(js),this}translate(e,t,i){return js.makeTranslation(e,t,i),this.applyMatrix4(js),this}scale(e,t,i){return js.makeScale(e,t,i),this.applyMatrix4(js),this}lookAt(e){return OL.lookAt(e),OL.updateMatrix(),this.applyMatrix4(OL.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(xm).negate(),this.translate(xm.x,xm.y,xm.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const o=e[i];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new ja(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new x1);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Ee(-1/0,-1/0,-1/0),new Ee(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const o=t[i];ds.setFromBufferAttribute(o),this.morphTargetsRelative?(gr.addVectors(this.boundingBox.min,ds.min),this.boundingBox.expandByPoint(gr),gr.addVectors(this.boundingBox.max,ds.max),this.boundingBox.expandByPoint(gr)):(this.boundingBox.expandByPoint(ds.min),this.boundingBox.expandByPoint(ds.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new $3);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Ee,1/0);return}if(e){const i=this.boundingSphere.center;if(ds.setFromBufferAttribute(e),t)for(let o=0,s=t.length;o<s;o++){const a=t[o];h_.setFromBufferAttribute(a),this.morphTargetsRelative?(gr.addVectors(ds.min,h_.min),ds.expandByPoint(gr),gr.addVectors(ds.max,h_.max),ds.expandByPoint(gr)):(ds.expandByPoint(h_.min),ds.expandByPoint(h_.max))}ds.getCenter(i);let r=0;for(let o=0,s=e.count;o<s;o++)gr.fromBufferAttribute(e,o),r=Math.max(r,i.distanceToSquared(gr));if(t)for(let o=0,s=t.length;o<s;o++){const a=t[o],l=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)gr.fromBufferAttribute(a,u),l&&(xm.fromBufferAttribute(e,u),gr.add(xm)),r=Math.max(r,i.distanceToSquared(gr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,o=t.normal.array,s=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ll(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,u=[],c=[];for(let N=0;N<a;N++)u[N]=new Ee,c[N]=new Ee;const h=new Ee,p=new Ee,m=new Ee,y=new zn,_=new zn,g=new zn,b=new Ee,w=new Ee;function M(N,j,te){h.fromArray(r,N*3),p.fromArray(r,j*3),m.fromArray(r,te*3),y.fromArray(s,N*2),_.fromArray(s,j*2),g.fromArray(s,te*2),p.sub(h),m.sub(h),_.sub(y),g.sub(y);const ee=1/(_.x*g.y-g.x*_.y);!isFinite(ee)||(b.copy(p).multiplyScalar(g.y).addScaledVector(m,-_.y).multiplyScalar(ee),w.copy(m).multiplyScalar(_.x).addScaledVector(p,-g.x).multiplyScalar(ee),u[N].add(b),u[j].add(b),u[te].add(b),c[N].add(w),c[j].add(w),c[te].add(w))}let C=this.groups;C.length===0&&(C=[{start:0,count:i.length}]);for(let N=0,j=C.length;N<j;++N){const te=C[N],ee=te.start,H=te.count;for(let Q=ee,Z=ee+H;Q<Z;Q+=3)M(i[Q+0],i[Q+1],i[Q+2])}const P=new Ee,L=new Ee,R=new Ee,E=new Ee;function D(N){R.fromArray(o,N*3),E.copy(R);const j=u[N];P.copy(j),P.sub(R.multiplyScalar(R.dot(j))).normalize(),L.crossVectors(E,j);const ee=L.dot(c[N])<0?-1:1;l[N*4]=P.x,l[N*4+1]=P.y,l[N*4+2]=P.z,l[N*4+3]=ee}for(let N=0,j=C.length;N<j;++N){const te=C[N],ee=te.start,H=te.count;for(let Q=ee,Z=ee+H;Q<Z;Q+=3)D(i[Q+0]),D(i[Q+1]),D(i[Q+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Ll(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let p=0,m=i.count;p<m;p++)i.setXYZ(p,0,0,0);const r=new Ee,o=new Ee,s=new Ee,a=new Ee,l=new Ee,u=new Ee,c=new Ee,h=new Ee;if(e)for(let p=0,m=e.count;p<m;p+=3){const y=e.getX(p+0),_=e.getX(p+1),g=e.getX(p+2);r.fromBufferAttribute(t,y),o.fromBufferAttribute(t,_),s.fromBufferAttribute(t,g),c.subVectors(s,o),h.subVectors(r,o),c.cross(h),a.fromBufferAttribute(i,y),l.fromBufferAttribute(i,_),u.fromBufferAttribute(i,g),a.add(c),l.add(c),u.add(c),i.setXYZ(y,a.x,a.y,a.z),i.setXYZ(_,l.x,l.y,l.z),i.setXYZ(g,u.x,u.y,u.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),o.fromBufferAttribute(t,p+1),s.fromBufferAttribute(t,p+2),c.subVectors(s,o),h.subVectors(r,o),c.cross(h),i.setXYZ(p+0,c.x,c.y,c.z),i.setXYZ(p+1,c.x,c.y,c.z),i.setXYZ(p+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)gr.fromBufferAttribute(e,t),gr.normalize(),e.setXYZ(t,gr.x,gr.y,gr.z)}toNonIndexed(){function e(a,l){const u=a.array,c=a.itemSize,h=a.normalized,p=new u.constructor(l.length*c);let m=0,y=0;for(let _=0,g=l.length;_<g;_++){a.isInterleavedBufferAttribute?m=l[_]*a.data.stride+a.offset:m=l[_]*c;for(let b=0;b<c;b++)p[y++]=u[m++]}return new Ll(p,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new hc,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);t.setAttribute(a,u)}const o=this.morphAttributes;for(const a in o){const l=[],u=o[a];for(let c=0,h=u.length;c<h;c++){const p=u[c],m=e(p,i);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,l=s.length;a<l;a++){const u=s[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let o=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,p=u.length;h<p;h++){const m=u[h];c.push(m.toJSON(e.data))}c.length>0&&(r[l]=c,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const u in r){const c=r[u];this.setAttribute(u,c.clone(t))}const o=e.morphAttributes;for(const u in o){const c=[],h=o[u];for(let p=0,m=h.length;p<m;p++)c.push(h[p].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let u=0,c=s.length;u<c;u++){const h=s[u];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const P8=new qi,bm=new aY,kL=new $3,qc=new Ee,Yc=new Ee,Kc=new Ee,IL=new Ee,NL=new Ee,zL=new Ee,US=new Ee,jS=new Ee,HS=new Ee,WS=new zn,GS=new zn,XS=new zn,VL=new Ee,qS=new Ee;class dh extends Er{constructor(e=new hc,t=new uY){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}raycast(e,t){const i=this.geometry,r=this.material,o=this.matrixWorld;if(r===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),kL.copy(i.boundingSphere),kL.applyMatrix4(o),e.ray.intersectsSphere(kL)===!1)||(P8.copy(o).invert(),bm.copy(e.ray).applyMatrix4(P8),i.boundingBox!==null&&bm.intersectsBox(i.boundingBox)===!1))return;let s;const a=i.index,l=i.attributes.position,u=i.morphAttributes.position,c=i.morphTargetsRelative,h=i.attributes.uv,p=i.attributes.uv2,m=i.groups,y=i.drawRange;if(a!==null)if(Array.isArray(r))for(let _=0,g=m.length;_<g;_++){const b=m[_],w=r[b.materialIndex],M=Math.max(b.start,y.start),C=Math.min(a.count,Math.min(b.start+b.count,y.start+y.count));for(let P=M,L=C;P<L;P+=3){const R=a.getX(P),E=a.getX(P+1),D=a.getX(P+2);s=YS(this,w,e,bm,l,u,c,h,p,R,E,D),s&&(s.faceIndex=Math.floor(P/3),s.face.materialIndex=b.materialIndex,t.push(s))}}else{const _=Math.max(0,y.start),g=Math.min(a.count,y.start+y.count);for(let b=_,w=g;b<w;b+=3){const M=a.getX(b),C=a.getX(b+1),P=a.getX(b+2);s=YS(this,r,e,bm,l,u,c,h,p,M,C,P),s&&(s.faceIndex=Math.floor(b/3),t.push(s))}}else if(l!==void 0)if(Array.isArray(r))for(let _=0,g=m.length;_<g;_++){const b=m[_],w=r[b.materialIndex],M=Math.max(b.start,y.start),C=Math.min(l.count,Math.min(b.start+b.count,y.start+y.count));for(let P=M,L=C;P<L;P+=3){const R=P,E=P+1,D=P+2;s=YS(this,w,e,bm,l,u,c,h,p,R,E,D),s&&(s.faceIndex=Math.floor(P/3),s.face.materialIndex=b.materialIndex,t.push(s))}}else{const _=Math.max(0,y.start),g=Math.min(l.count,y.start+y.count);for(let b=_,w=g;b<w;b+=3){const M=b,C=b+1,P=b+2;s=YS(this,r,e,bm,l,u,c,h,p,M,C,P),s&&(s.faceIndex=Math.floor(b/3),t.push(s))}}}}function jEe(n,e,t,i,r,o,s,a){let l;if(e.side===Ss?l=i.intersectTriangle(s,o,r,!0,a):l=i.intersectTriangle(r,o,s,e.side!==hh,a),l===null)return null;qS.copy(a),qS.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(qS);return u<t.near||u>t.far?null:{distance:u,point:qS.clone(),object:n}}function YS(n,e,t,i,r,o,s,a,l,u,c,h){qc.fromBufferAttribute(r,u),Yc.fromBufferAttribute(r,c),Kc.fromBufferAttribute(r,h);const p=n.morphTargetInfluences;if(o&&p){US.set(0,0,0),jS.set(0,0,0),HS.set(0,0,0);for(let y=0,_=o.length;y<_;y++){const g=p[y],b=o[y];g!==0&&(IL.fromBufferAttribute(b,u),NL.fromBufferAttribute(b,c),zL.fromBufferAttribute(b,h),s?(US.addScaledVector(IL,g),jS.addScaledVector(NL,g),HS.addScaledVector(zL,g)):(US.addScaledVector(IL.sub(qc),g),jS.addScaledVector(NL.sub(Yc),g),HS.addScaledVector(zL.sub(Kc),g)))}qc.add(US),Yc.add(jS),Kc.add(HS)}n.isSkinnedMesh&&(n.boneTransform(u,qc),n.boneTransform(c,Yc),n.boneTransform(h,Kc));const m=jEe(n,e,t,i,qc,Yc,Kc,VL);if(m){a&&(WS.fromBufferAttribute(a,u),GS.fromBufferAttribute(a,c),XS.fromBufferAttribute(a,h),m.uv=zu.getUV(VL,qc,Yc,Kc,WS,GS,XS,new zn)),l&&(WS.fromBufferAttribute(l,u),GS.fromBufferAttribute(l,c),XS.fromBufferAttribute(l,h),m.uv2=zu.getUV(VL,qc,Yc,Kc,WS,GS,XS,new zn));const y={a:u,b:c,c:h,normal:new Ee,materialIndex:0};zu.getNormal(qc,Yc,Kc,y.normal),m.face=y}return m}class S1 extends hc{constructor(e=1,t=1,i=1,r=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:o,depthSegments:s};const a=this;r=Math.floor(r),o=Math.floor(o),s=Math.floor(s);const l=[],u=[],c=[],h=[];let p=0,m=0;y("z","y","x",-1,-1,i,t,e,s,o,0),y("z","y","x",1,-1,i,t,-e,s,o,1),y("x","z","y",1,1,e,i,t,r,s,2),y("x","z","y",1,-1,e,i,-t,r,s,3),y("x","y","z",1,-1,e,t,i,r,o,4),y("x","y","z",-1,-1,e,t,-i,r,o,5),this.setIndex(l),this.setAttribute("position",new ja(u,3)),this.setAttribute("normal",new ja(c,3)),this.setAttribute("uv",new ja(h,2));function y(_,g,b,w,M,C,P,L,R,E,D){const N=C/R,j=P/E,te=C/2,ee=P/2,H=L/2,Q=R+1,Z=E+1;let de=0,X=0;const B=new Ee;for(let U=0;U<Z;U++){const le=U*j-ee;for(let ne=0;ne<Q;ne++){const fe=ne*N-te;B[_]=fe*w,B[g]=le*M,B[b]=H,u.push(B.x,B.y,B.z),B[_]=0,B[g]=0,B[b]=L>0?1:-1,c.push(B.x,B.y,B.z),h.push(ne/R),h.push(1-U/E),de+=1}}for(let U=0;U<E;U++)for(let le=0;le<R;le++){const ne=p+le+Q*U,fe=p+le+Q*(U+1),we=p+(le+1)+Q*(U+1),Be=p+(le+1)+Q*U;l.push(ne,fe,Be),l.push(fe,we,Be),X+=6}a.addGroup(m,X,D),m+=X,p+=de}}static fromJSON(e){return new S1(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function cg(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function eo(n){const e={};for(let t=0;t<n.length;t++){const i=cg(n[t]);for(const r in i)e[r]=i[r]}return e}function HEe(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}const dY={clone:cg,merge:eo};var WEe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,GEe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class zh extends w1{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=WEe,this.fragmentShader=GEe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cg(e.uniforms),this.uniformsGroups=HEe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const s=this.uniforms[r].value;s&&s.isTexture?t.uniforms[r]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[r]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[r]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[r]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[r]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[r]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[r]={type:"m4",value:s.toArray()}:t.uniforms[r]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class pY extends Er{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new qi,this.projectionMatrix=new qi,this.projectionMatrixInverse=new qi}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Xs extends pY{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=v8*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(gL*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return v8*2*Math.atan(Math.tan(gL*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,o,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(gL*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,o=-.5*r;const s=this.view;if(this.view!==null&&this.view.enabled){const l=s.fullWidth,u=s.fullHeight;o+=s.offsetX*r/l,t-=s.offsetY*i/u,r*=s.width/l,i*=s.height/u}const a=this.filmOffset;a!==0&&(o+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const wm=90,Sm=1;class XEe extends Er{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;const r=new Xs(wm,Sm,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Ee(1,0,0)),this.add(r);const o=new Xs(wm,Sm,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new Ee(-1,0,0)),this.add(o);const s=new Xs(wm,Sm,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new Ee(0,1,0)),this.add(s);const a=new Xs(wm,Sm,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new Ee(0,-1,0)),this.add(a);const l=new Xs(wm,Sm,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Ee(0,0,1)),this.add(l);const u=new Xs(wm,Sm,e,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new Ee(0,0,-1)),this.add(u)}update(e,t){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[r,o,s,a,l,u]=this.children,c=e.getRenderTarget(),h=e.toneMapping,p=e.xr.enabled;e.toneMapping=qu,e.xr.enabled=!1;const m=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,o),e.setRenderTarget(i,2),e.render(t,s),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=m,e.setRenderTarget(i,5),e.render(t,u),e.setRenderTarget(c),e.toneMapping=h,e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class fY extends Xa{constructor(e,t,i,r,o,s,a,l,u,c){e=e!==void 0?e:[],t=t!==void 0?t:ag,super(e,t,i,r,o,s,a,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class qEe extends zp{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new fY(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Gs}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new S1(5,5,5),o=new zh({name:"CubemapFromEquirect",uniforms:cg(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Ss,blending:Eh});o.uniforms.tEquirect.value=t;const s=new dh(r,o),a=t.minFilter;return t.minFilter===Q3&&(t.minFilter=Gs),new XEe(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,i,r){const o=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,i,r);e.setRenderTarget(o)}}const FL=new Ee,YEe=new Ee,KEe=new Ks;class Qd{constructor(e=new Ee(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=FL.subVectors(i,t).cross(YEe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(FL),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:t.copy(i).multiplyScalar(o).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||KEe.getNormalMatrix(e),r=this.coplanarPoint(FL).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Mm=new $3,KS=new Ee;class RI{constructor(e=new Qd,t=new Qd,i=new Qd,r=new Qd,o=new Qd,s=new Qd){this.planes=[e,t,i,r,o,s]}set(e,t,i,r,o,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(o),a[5].copy(s),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],o=i[1],s=i[2],a=i[3],l=i[4],u=i[5],c=i[6],h=i[7],p=i[8],m=i[9],y=i[10],_=i[11],g=i[12],b=i[13],w=i[14],M=i[15];return t[0].setComponents(a-r,h-l,_-p,M-g).normalize(),t[1].setComponents(a+r,h+l,_+p,M+g).normalize(),t[2].setComponents(a+o,h+u,_+m,M+b).normalize(),t[3].setComponents(a-o,h-u,_-m,M-b).normalize(),t[4].setComponents(a-s,h-c,_-y,M-w).normalize(),t[5].setComponents(a+s,h+c,_+y,M+w).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Mm.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Mm)}intersectsSprite(e){return Mm.center.set(0,0,0),Mm.radius=.7071067811865476,Mm.applyMatrix4(e.matrixWorld),this.intersectsSphere(Mm)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(KS.x=r.normal.x>0?e.max.x:e.min.x,KS.y=r.normal.y>0?e.max.y:e.min.y,KS.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(KS)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function mY(){let n=null,e=!1,t=null,i=null;function r(o,s){t(o,s),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function ZEe(n,e){const t=e.isWebGL2,i=new WeakMap;function r(u,c){const h=u.array,p=u.usage,m=n.createBuffer();n.bindBuffer(c,m),n.bufferData(c,h,p),u.onUploadCallback();let y;if(h instanceof Float32Array)y=5126;else if(h instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)y=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else y=5123;else if(h instanceof Int16Array)y=5122;else if(h instanceof Uint32Array)y=5125;else if(h instanceof Int32Array)y=5124;else if(h instanceof Int8Array)y=5120;else if(h instanceof Uint8Array)y=5121;else if(h instanceof Uint8ClampedArray)y=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:m,type:y,bytesPerElement:h.BYTES_PER_ELEMENT,version:u.version}}function o(u,c,h){const p=c.array,m=c.updateRange;n.bindBuffer(h,u),m.count===-1?n.bufferSubData(h,0,p):(t?n.bufferSubData(h,m.offset*p.BYTES_PER_ELEMENT,p,m.offset,m.count):n.bufferSubData(h,m.offset*p.BYTES_PER_ELEMENT,p.subarray(m.offset,m.offset+m.count)),m.count=-1)}function s(u){return u.isInterleavedBufferAttribute&&(u=u.data),i.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const c=i.get(u);c&&(n.deleteBuffer(c.buffer),i.delete(u))}function l(u,c){if(u.isGLBufferAttribute){const p=i.get(u);(!p||p.version<u.version)&&i.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const h=i.get(u);h===void 0?i.set(u,r(u,c)):h.version<u.version&&(o(h.buffer,u,c),h.version=u.version)}return{get:s,remove:a,update:l}}class OI extends hc{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const o=e/2,s=t/2,a=Math.floor(i),l=Math.floor(r),u=a+1,c=l+1,h=e/a,p=t/l,m=[],y=[],_=[],g=[];for(let b=0;b<c;b++){const w=b*p-s;for(let M=0;M<u;M++){const C=M*h-o;y.push(C,-w,0),_.push(0,0,1),g.push(M/a),g.push(1-b/l)}}for(let b=0;b<l;b++)for(let w=0;w<a;w++){const M=w+u*b,C=w+u*(b+1),P=w+1+u*(b+1),L=w+1+u*b;m.push(M,C,L),m.push(C,P,L)}this.setIndex(m),this.setAttribute("position",new ja(y,3)),this.setAttribute("normal",new ja(_,3)),this.setAttribute("uv",new ja(g,2))}static fromJSON(e){return new OI(e.width,e.height,e.widthSegments,e.heightSegments)}}var JEe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,QEe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,$Ee=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,eTe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,tTe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,nTe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,iTe="vec3 transformed = vec3( position );",rTe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,oTe=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,sTe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,aTe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,lTe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,uTe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,cTe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,hTe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,dTe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,pTe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,fTe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,mTe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,vTe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,gTe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,_Te=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,yTe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,xTe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,bTe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,wTe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,STe="gl_FragColor = linearToOutputTexel( gl_FragColor );",MTe=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,CTe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,ETe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,TTe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,PTe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,ATe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,LTe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,DTe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,RTe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,OTe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,kTe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,ITe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,NTe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,zTe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,VTe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert
#define Material_LightProbeLOD( material )	(0)`,FTe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,BTe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,UTe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,jTe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,HTe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,WTe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,GTe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,XTe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,qTe=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,YTe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,KTe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,ZTe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,JTe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,QTe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,$Te=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,ePe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,tPe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,nPe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,iPe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,rPe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,oPe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,sPe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,aPe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,lPe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,uPe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,cPe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,hPe=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,dPe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,pPe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,fPe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,mPe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,vPe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,gPe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,_Pe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,yPe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,xPe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,bPe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,wPe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,SPe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,MPe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,CPe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,EPe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,TPe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,PPe=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,APe=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,LPe=`#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,DPe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,RPe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,OPe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,kPe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,IPe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,NPe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,zPe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,VPe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,FPe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,BPe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,UPe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,jPe=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,HPe=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,WPe=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,GPe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,XPe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,qPe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,YPe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const KPe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,ZPe=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,JPe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,QPe=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,$Pe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,eAe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,tAe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,nAe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,iAe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,rAe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,oAe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sAe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,aAe=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,lAe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uAe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cAe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hAe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,dAe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pAe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fAe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,mAe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vAe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gAe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,_Ae=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yAe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xAe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bAe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,wAe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,SAe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,MAe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,CAe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,EAe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,nn={alphamap_fragment:JEe,alphamap_pars_fragment:QEe,alphatest_fragment:$Ee,alphatest_pars_fragment:eTe,aomap_fragment:tTe,aomap_pars_fragment:nTe,begin_vertex:iTe,beginnormal_vertex:rTe,bsdfs:oTe,iridescence_fragment:sTe,bumpmap_pars_fragment:aTe,clipping_planes_fragment:lTe,clipping_planes_pars_fragment:uTe,clipping_planes_pars_vertex:cTe,clipping_planes_vertex:hTe,color_fragment:dTe,color_pars_fragment:pTe,color_pars_vertex:fTe,color_vertex:mTe,common:vTe,cube_uv_reflection_fragment:gTe,defaultnormal_vertex:_Te,displacementmap_pars_vertex:yTe,displacementmap_vertex:xTe,emissivemap_fragment:bTe,emissivemap_pars_fragment:wTe,encodings_fragment:STe,encodings_pars_fragment:MTe,envmap_fragment:CTe,envmap_common_pars_fragment:ETe,envmap_pars_fragment:TTe,envmap_pars_vertex:PTe,envmap_physical_pars_fragment:BTe,envmap_vertex:ATe,fog_vertex:LTe,fog_pars_vertex:DTe,fog_fragment:RTe,fog_pars_fragment:OTe,gradientmap_pars_fragment:kTe,lightmap_fragment:ITe,lightmap_pars_fragment:NTe,lights_lambert_fragment:zTe,lights_lambert_pars_fragment:VTe,lights_pars_begin:FTe,lights_toon_fragment:UTe,lights_toon_pars_fragment:jTe,lights_phong_fragment:HTe,lights_phong_pars_fragment:WTe,lights_physical_fragment:GTe,lights_physical_pars_fragment:XTe,lights_fragment_begin:qTe,lights_fragment_maps:YTe,lights_fragment_end:KTe,logdepthbuf_fragment:ZTe,logdepthbuf_pars_fragment:JTe,logdepthbuf_pars_vertex:QTe,logdepthbuf_vertex:$Te,map_fragment:ePe,map_pars_fragment:tPe,map_particle_fragment:nPe,map_particle_pars_fragment:iPe,metalnessmap_fragment:rPe,metalnessmap_pars_fragment:oPe,morphcolor_vertex:sPe,morphnormal_vertex:aPe,morphtarget_pars_vertex:lPe,morphtarget_vertex:uPe,normal_fragment_begin:cPe,normal_fragment_maps:hPe,normal_pars_fragment:dPe,normal_pars_vertex:pPe,normal_vertex:fPe,normalmap_pars_fragment:mPe,clearcoat_normal_fragment_begin:vPe,clearcoat_normal_fragment_maps:gPe,clearcoat_pars_fragment:_Pe,iridescence_pars_fragment:yPe,output_fragment:xPe,packing:bPe,premultiplied_alpha_fragment:wPe,project_vertex:SPe,dithering_fragment:MPe,dithering_pars_fragment:CPe,roughnessmap_fragment:EPe,roughnessmap_pars_fragment:TPe,shadowmap_pars_fragment:PPe,shadowmap_pars_vertex:APe,shadowmap_vertex:LPe,shadowmask_pars_fragment:DPe,skinbase_vertex:RPe,skinning_pars_vertex:OPe,skinning_vertex:kPe,skinnormal_vertex:IPe,specularmap_fragment:NPe,specularmap_pars_fragment:zPe,tonemapping_fragment:VPe,tonemapping_pars_fragment:FPe,transmission_fragment:BPe,transmission_pars_fragment:UPe,uv_pars_fragment:jPe,uv_pars_vertex:HPe,uv_vertex:WPe,uv2_pars_fragment:GPe,uv2_pars_vertex:XPe,uv2_vertex:qPe,worldpos_vertex:YPe,background_vert:KPe,background_frag:ZPe,cube_vert:JPe,cube_frag:QPe,depth_vert:$Pe,depth_frag:eAe,distanceRGBA_vert:tAe,distanceRGBA_frag:nAe,equirect_vert:iAe,equirect_frag:rAe,linedashed_vert:oAe,linedashed_frag:sAe,meshbasic_vert:aAe,meshbasic_frag:lAe,meshlambert_vert:uAe,meshlambert_frag:cAe,meshmatcap_vert:hAe,meshmatcap_frag:dAe,meshnormal_vert:pAe,meshnormal_frag:fAe,meshphong_vert:mAe,meshphong_frag:vAe,meshphysical_vert:gAe,meshphysical_frag:_Ae,meshtoon_vert:yAe,meshtoon_frag:xAe,points_vert:bAe,points_frag:wAe,shadow_vert:SAe,shadow_frag:MAe,sprite_vert:CAe,sprite_frag:EAe},ot={common:{diffuse:{value:new Rn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ks},uv2Transform:{value:new Ks},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new zn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Rn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Rn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ks}},sprite:{diffuse:{value:new Rn(16777215)},opacity:{value:1},center:{value:new zn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ks}}},vl={basic:{uniforms:eo([ot.common,ot.specularmap,ot.envmap,ot.aomap,ot.lightmap,ot.fog]),vertexShader:nn.meshbasic_vert,fragmentShader:nn.meshbasic_frag},lambert:{uniforms:eo([ot.common,ot.specularmap,ot.envmap,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.fog,ot.lights,{emissive:{value:new Rn(0)}}]),vertexShader:nn.meshlambert_vert,fragmentShader:nn.meshlambert_frag},phong:{uniforms:eo([ot.common,ot.specularmap,ot.envmap,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.fog,ot.lights,{emissive:{value:new Rn(0)},specular:{value:new Rn(1118481)},shininess:{value:30}}]),vertexShader:nn.meshphong_vert,fragmentShader:nn.meshphong_frag},standard:{uniforms:eo([ot.common,ot.envmap,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.roughnessmap,ot.metalnessmap,ot.fog,ot.lights,{emissive:{value:new Rn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:nn.meshphysical_vert,fragmentShader:nn.meshphysical_frag},toon:{uniforms:eo([ot.common,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.gradientmap,ot.fog,ot.lights,{emissive:{value:new Rn(0)}}]),vertexShader:nn.meshtoon_vert,fragmentShader:nn.meshtoon_frag},matcap:{uniforms:eo([ot.common,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.fog,{matcap:{value:null}}]),vertexShader:nn.meshmatcap_vert,fragmentShader:nn.meshmatcap_frag},points:{uniforms:eo([ot.points,ot.fog]),vertexShader:nn.points_vert,fragmentShader:nn.points_frag},dashed:{uniforms:eo([ot.common,ot.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:nn.linedashed_vert,fragmentShader:nn.linedashed_frag},depth:{uniforms:eo([ot.common,ot.displacementmap]),vertexShader:nn.depth_vert,fragmentShader:nn.depth_frag},normal:{uniforms:eo([ot.common,ot.bumpmap,ot.normalmap,ot.displacementmap,{opacity:{value:1}}]),vertexShader:nn.meshnormal_vert,fragmentShader:nn.meshnormal_frag},sprite:{uniforms:eo([ot.sprite,ot.fog]),vertexShader:nn.sprite_vert,fragmentShader:nn.sprite_frag},background:{uniforms:{uvTransform:{value:new Ks},t2D:{value:null}},vertexShader:nn.background_vert,fragmentShader:nn.background_frag},cube:{uniforms:eo([ot.envmap,{opacity:{value:1}}]),vertexShader:nn.cube_vert,fragmentShader:nn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:nn.equirect_vert,fragmentShader:nn.equirect_frag},distanceRGBA:{uniforms:eo([ot.common,ot.displacementmap,{referencePosition:{value:new Ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:nn.distanceRGBA_vert,fragmentShader:nn.distanceRGBA_frag},shadow:{uniforms:eo([ot.lights,ot.fog,{color:{value:new Rn(0)},opacity:{value:1}}]),vertexShader:nn.shadow_vert,fragmentShader:nn.shadow_frag}};vl.physical={uniforms:eo([vl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new zn(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Rn(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new zn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Rn(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Rn(1,1,1)},specularColorMap:{value:null}}]),vertexShader:nn.meshphysical_vert,fragmentShader:nn.meshphysical_frag};function TAe(n,e,t,i,r,o){const s=new Rn(0);let a=r===!0?0:1,l,u,c=null,h=0,p=null;function m(_,g){let b=!1,w=g.isScene===!0?g.background:null;w&&w.isTexture&&(w=e.get(w));const M=n.xr,C=M.getSession&&M.getSession();C&&C.environmentBlendMode==="additive"&&(w=null),w===null?y(s,a):w&&w.isColor&&(y(w,1),b=!0),(n.autoClear||b)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),w&&(w.isCubeTexture||w.mapping===J3)?(u===void 0&&(u=new dh(new S1(1,1,1),new zh({name:"BackgroundCubeMaterial",uniforms:cg(vl.cube.uniforms),vertexShader:vl.cube.vertexShader,fragmentShader:vl.cube.fragmentShader,side:Ss,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(P,L,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),u.material.uniforms.envMap.value=w,u.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,(c!==w||h!==w.version||p!==n.toneMapping)&&(u.material.needsUpdate=!0,c=w,h=w.version,p=n.toneMapping),u.layers.enableAll(),_.unshift(u,u.geometry,u.material,0,0,null)):w&&w.isTexture&&(l===void 0&&(l=new dh(new OI(2,2),new zh({name:"BackgroundMaterial",uniforms:cg(vl.background.uniforms),vertexShader:vl.background.vertexShader,fragmentShader:vl.background.fragmentShader,side:sg,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=w,w.matrixAutoUpdate===!0&&w.updateMatrix(),l.material.uniforms.uvTransform.value.copy(w.matrix),(c!==w||h!==w.version||p!==n.toneMapping)&&(l.material.needsUpdate=!0,c=w,h=w.version,p=n.toneMapping),l.layers.enableAll(),_.unshift(l,l.geometry,l.material,0,0,null))}function y(_,g){t.buffers.color.setClear(_.r,_.g,_.b,g,o)}return{getClearColor:function(){return s},setClearColor:function(_,g=1){s.set(_),a=g,y(s,a)},getClearAlpha:function(){return a},setClearAlpha:function(_){a=_,y(s,a)},render:m}}function PAe(n,e,t,i){const r=n.getParameter(34921),o=i.isWebGL2?null:e.get("OES_vertex_array_object"),s=i.isWebGL2||o!==null,a={},l=g(null);let u=l,c=!1;function h(H,Q,Z,de,X){let B=!1;if(s){const U=_(de,Z,Q);u!==U&&(u=U,m(u.object)),B=b(H,de,Z,X),B&&w(H,de,Z,X)}else{const U=Q.wireframe===!0;(u.geometry!==de.id||u.program!==Z.id||u.wireframe!==U)&&(u.geometry=de.id,u.program=Z.id,u.wireframe=U,B=!0)}X!==null&&t.update(X,34963),(B||c)&&(c=!1,E(H,Q,Z,de),X!==null&&n.bindBuffer(34963,t.get(X).buffer))}function p(){return i.isWebGL2?n.createVertexArray():o.createVertexArrayOES()}function m(H){return i.isWebGL2?n.bindVertexArray(H):o.bindVertexArrayOES(H)}function y(H){return i.isWebGL2?n.deleteVertexArray(H):o.deleteVertexArrayOES(H)}function _(H,Q,Z){const de=Z.wireframe===!0;let X=a[H.id];X===void 0&&(X={},a[H.id]=X);let B=X[Q.id];B===void 0&&(B={},X[Q.id]=B);let U=B[de];return U===void 0&&(U=g(p()),B[de]=U),U}function g(H){const Q=[],Z=[],de=[];for(let X=0;X<r;X++)Q[X]=0,Z[X]=0,de[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Q,enabledAttributes:Z,attributeDivisors:de,object:H,attributes:{},index:null}}function b(H,Q,Z,de){const X=u.attributes,B=Q.attributes;let U=0;const le=Z.getAttributes();for(const ne in le)if(le[ne].location>=0){const we=X[ne];let Be=B[ne];if(Be===void 0&&(ne==="instanceMatrix"&&H.instanceMatrix&&(Be=H.instanceMatrix),ne==="instanceColor"&&H.instanceColor&&(Be=H.instanceColor)),we===void 0||we.attribute!==Be||Be&&we.data!==Be.data)return!0;U++}return u.attributesNum!==U||u.index!==de}function w(H,Q,Z,de){const X={},B=Q.attributes;let U=0;const le=Z.getAttributes();for(const ne in le)if(le[ne].location>=0){let we=B[ne];we===void 0&&(ne==="instanceMatrix"&&H.instanceMatrix&&(we=H.instanceMatrix),ne==="instanceColor"&&H.instanceColor&&(we=H.instanceColor));const Be={};Be.attribute=we,we&&we.data&&(Be.data=we.data),X[ne]=Be,U++}u.attributes=X,u.attributesNum=U,u.index=de}function M(){const H=u.newAttributes;for(let Q=0,Z=H.length;Q<Z;Q++)H[Q]=0}function C(H){P(H,0)}function P(H,Q){const Z=u.newAttributes,de=u.enabledAttributes,X=u.attributeDivisors;Z[H]=1,de[H]===0&&(n.enableVertexAttribArray(H),de[H]=1),X[H]!==Q&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](H,Q),X[H]=Q)}function L(){const H=u.newAttributes,Q=u.enabledAttributes;for(let Z=0,de=Q.length;Z<de;Z++)Q[Z]!==H[Z]&&(n.disableVertexAttribArray(Z),Q[Z]=0)}function R(H,Q,Z,de,X,B){i.isWebGL2===!0&&(Z===5124||Z===5125)?n.vertexAttribIPointer(H,Q,Z,X,B):n.vertexAttribPointer(H,Q,Z,de,X,B)}function E(H,Q,Z,de){if(i.isWebGL2===!1&&(H.isInstancedMesh||de.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;M();const X=de.attributes,B=Z.getAttributes(),U=Q.defaultAttributeValues;for(const le in B){const ne=B[le];if(ne.location>=0){let fe=X[le];if(fe===void 0&&(le==="instanceMatrix"&&H.instanceMatrix&&(fe=H.instanceMatrix),le==="instanceColor"&&H.instanceColor&&(fe=H.instanceColor)),fe!==void 0){const we=fe.normalized,Be=fe.itemSize,oe=t.get(fe);if(oe===void 0)continue;const tt=oe.buffer,Ue=oe.type,Ve=oe.bytesPerElement;if(fe.isInterleavedBufferAttribute){const Ae=fe.data,Oe=Ae.stride,Te=fe.offset;if(Ae.isInstancedInterleavedBuffer){for(let be=0;be<ne.locationSize;be++)P(ne.location+be,Ae.meshPerAttribute);H.isInstancedMesh!==!0&&de._maxInstanceCount===void 0&&(de._maxInstanceCount=Ae.meshPerAttribute*Ae.count)}else for(let be=0;be<ne.locationSize;be++)C(ne.location+be);n.bindBuffer(34962,tt);for(let be=0;be<ne.locationSize;be++)R(ne.location+be,Be/ne.locationSize,Ue,we,Oe*Ve,(Te+Be/ne.locationSize*be)*Ve)}else{if(fe.isInstancedBufferAttribute){for(let Ae=0;Ae<ne.locationSize;Ae++)P(ne.location+Ae,fe.meshPerAttribute);H.isInstancedMesh!==!0&&de._maxInstanceCount===void 0&&(de._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let Ae=0;Ae<ne.locationSize;Ae++)C(ne.location+Ae);n.bindBuffer(34962,tt);for(let Ae=0;Ae<ne.locationSize;Ae++)R(ne.location+Ae,Be/ne.locationSize,Ue,we,Be*Ve,Be/ne.locationSize*Ae*Ve)}}else if(U!==void 0){const we=U[le];if(we!==void 0)switch(we.length){case 2:n.vertexAttrib2fv(ne.location,we);break;case 3:n.vertexAttrib3fv(ne.location,we);break;case 4:n.vertexAttrib4fv(ne.location,we);break;default:n.vertexAttrib1fv(ne.location,we)}}}}L()}function D(){te();for(const H in a){const Q=a[H];for(const Z in Q){const de=Q[Z];for(const X in de)y(de[X].object),delete de[X];delete Q[Z]}delete a[H]}}function N(H){if(a[H.id]===void 0)return;const Q=a[H.id];for(const Z in Q){const de=Q[Z];for(const X in de)y(de[X].object),delete de[X];delete Q[Z]}delete a[H.id]}function j(H){for(const Q in a){const Z=a[Q];if(Z[H.id]===void 0)continue;const de=Z[H.id];for(const X in de)y(de[X].object),delete de[X];delete Z[H.id]}}function te(){ee(),c=!0,u!==l&&(u=l,m(u.object))}function ee(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:te,resetDefaultState:ee,dispose:D,releaseStatesOfGeometry:N,releaseStatesOfProgram:j,initAttributes:M,enableAttribute:C,disableUnusedAttributes:L}}function AAe(n,e,t,i){const r=i.isWebGL2;let o;function s(u){o=u}function a(u,c){n.drawArrays(o,u,c),t.update(c,o,1)}function l(u,c,h){if(h===0)return;let p,m;if(r)p=n,m="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[m](o,u,c,h),t.update(c,o,h)}this.setMode=s,this.render=a,this.renderInstances=l}function LAe(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const R=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(R.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(R){if(R==="highp"){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";R="mediump"}return R==="mediump"&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&n instanceof WebGL2ComputeRenderingContext;let a=t.precision!==void 0?t.precision:"highp";const l=o(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=s||e.has("WEBGL_draw_buffers"),c=t.logarithmicDepthBuffer===!0,h=n.getParameter(34930),p=n.getParameter(35660),m=n.getParameter(3379),y=n.getParameter(34076),_=n.getParameter(34921),g=n.getParameter(36347),b=n.getParameter(36348),w=n.getParameter(36349),M=p>0,C=s||e.has("OES_texture_float"),P=M&&C,L=s?n.getParameter(36183):0;return{isWebGL2:s,drawBuffers:u,getMaxAnisotropy:r,getMaxPrecision:o,precision:a,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:y,maxAttributes:_,maxVertexUniforms:g,maxVaryings:b,maxFragmentUniforms:w,vertexTextures:M,floatFragmentTextures:C,floatVertexTextures:P,maxSamples:L}}function DAe(n){const e=this;let t=null,i=0,r=!1,o=!1;const s=new Qd,a=new Ks,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,p,m){const y=h.length!==0||p||i!==0||r;return r=p,t=c(h,m,0),i=h.length,y},this.beginShadows=function(){o=!0,c(null)},this.endShadows=function(){o=!1,u()},this.setState=function(h,p,m){const y=h.clippingPlanes,_=h.clipIntersection,g=h.clipShadows,b=n.get(h);if(!r||y===null||y.length===0||o&&!g)o?c(null):u();else{const w=o?0:i,M=w*4;let C=b.clippingState||null;l.value=C,C=c(y,p,M,m);for(let P=0;P!==M;++P)C[P]=t[P];b.clippingState=C,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=w}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function c(h,p,m,y){const _=h!==null?h.length:0;let g=null;if(_!==0){if(g=l.value,y!==!0||g===null){const b=m+_*4,w=p.matrixWorldInverse;a.getNormalMatrix(w),(g===null||g.length<b)&&(g=new Float32Array(b));for(let M=0,C=m;M!==_;++M,C+=4)s.copy(h[M]).applyMatrix4(w,a),s.normal.toArray(g,C),g[C+3]=s.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,g}}function RAe(n){let e=new WeakMap;function t(s,a){return a===C4?s.mapping=ag:a===E4&&(s.mapping=lg),s}function i(s){if(s&&s.isTexture&&s.isRenderTargetTexture===!1){const a=s.mapping;if(a===C4||a===E4)if(e.has(s)){const l=e.get(s).texture;return t(l,s.mapping)}else{const l=s.image;if(l&&l.height>0){const u=new qEe(l.height/2);return u.fromEquirectangularTexture(n,s),e.set(s,u),s.addEventListener("dispose",r),t(u.texture,s.mapping)}else return null}}return s}function r(s){const a=s.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}class vY extends pY{constructor(e=-1,t=1,i=1,r=-1,o=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,o,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=i-e,s=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=u*this.view.offsetX,s=o+u*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Ym=4,A8=[.125,.215,.35,.446,.526,.582],np=20,BL=new vY,L8=new Rn;let UL=null;const $d=(1+Math.sqrt(5))/2,Cm=1/$d,D8=[new Ee(1,1,1),new Ee(-1,1,1),new Ee(1,1,-1),new Ee(-1,1,-1),new Ee(0,$d,Cm),new Ee(0,$d,-Cm),new Ee(Cm,0,$d),new Ee(-Cm,0,$d),new Ee($d,Cm,0),new Ee(-$d,Cm,0)];class R8{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){UL=this._renderer.getRenderTarget(),this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,i,r,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=I8(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=k8(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(UL),e.scissorTest=!1,ZS(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ag||e.mapping===lg?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),UL=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Gs,minFilter:Gs,generateMipmaps:!1,type:Jy,format:wl,encoding:Np,depthBuffer:!1},r=O8(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=O8(e,t,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=OAe(o)),this._blurMaterial=kAe(o,e,t)}return r}_compileMaterial(e){const t=new dh(this._lodPlanes[0],e);this._renderer.compile(t,BL)}_sceneToCubeUV(e,t,i,r){const a=new Xs(90,1,t,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],c=this._renderer,h=c.autoClear,p=c.toneMapping;c.getClearColor(L8),c.toneMapping=qu,c.autoClear=!1;const m=new uY({name:"PMREM.Background",side:Ss,depthWrite:!1,depthTest:!1}),y=new dh(new S1,m);let _=!1;const g=e.background;g?g.isColor&&(m.color.copy(g),e.background=null,_=!0):(m.color.copy(L8),_=!0);for(let b=0;b<6;b++){const w=b%3;w===0?(a.up.set(0,l[b],0),a.lookAt(u[b],0,0)):w===1?(a.up.set(0,0,l[b]),a.lookAt(0,u[b],0)):(a.up.set(0,l[b],0),a.lookAt(0,0,u[b]));const M=this._cubeSize;ZS(r,w*M,b>2?M:0,M,M),c.setRenderTarget(r),_&&c.render(y,a),c.render(e,a)}y.geometry.dispose(),y.material.dispose(),c.toneMapping=p,c.autoClear=h,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===ag||e.mapping===lg;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=I8()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=k8());const o=r?this._cubemapMaterial:this._equirectMaterial,s=new dh(this._lodPlanes[0],o),a=o.uniforms;a.envMap.value=e;const l=this._cubeSize;ZS(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(s,BL)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),s=D8[(r-1)%D8.length];this._blur(e,r-1,r,o,s)}t.autoClear=i}_blur(e,t,i,r,o){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,r,"latitudinal",o),this._halfBlur(s,e,i,i,r,"longitudinal",o)}_halfBlur(e,t,i,r,o,s,a){const l=this._renderer,u=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,h=new dh(this._lodPlanes[r],u),p=u.uniforms,m=this._sizeLods[i]-1,y=isFinite(o)?Math.PI/(2*m):2*Math.PI/(2*np-1),_=o/y,g=isFinite(o)?1+Math.floor(c*_):np;g>np&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${np}`);const b=[];let w=0;for(let R=0;R<np;++R){const E=R/_,D=Math.exp(-E*E/2);b.push(D),R===0?w+=D:R<g&&(w+=2*D)}for(let R=0;R<b.length;R++)b[R]=b[R]/w;p.envMap.value=e.texture,p.samples.value=g,p.weights.value=b,p.latitudinal.value=s==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:M}=this;p.dTheta.value=y,p.mipInt.value=M-i;const C=this._sizeLods[r],P=3*C*(r>M-Ym?r-M+Ym:0),L=4*(this._cubeSize-C);ZS(t,P,L,3*C,2*C),l.setRenderTarget(t),l.render(h,BL)}}function OAe(n){const e=[],t=[],i=[];let r=n;const o=n-Ym+1+A8.length;for(let s=0;s<o;s++){const a=Math.pow(2,r);t.push(a);let l=1/a;s>n-Ym?l=A8[s-n+Ym-1]:s===0&&(l=0),i.push(l);const u=1/(a-2),c=-u,h=1+u,p=[c,c,h,c,h,h,c,c,h,h,c,h],m=6,y=6,_=3,g=2,b=1,w=new Float32Array(_*y*m),M=new Float32Array(g*y*m),C=new Float32Array(b*y*m);for(let L=0;L<m;L++){const R=L%3*2/3-1,E=L>2?0:-1,D=[R,E,0,R+2/3,E,0,R+2/3,E+1,0,R,E,0,R+2/3,E+1,0,R,E+1,0];w.set(D,_*y*L),M.set(p,g*y*L);const N=[L,L,L,L,L,L];C.set(N,b*y*L)}const P=new hc;P.setAttribute("position",new Ll(w,_)),P.setAttribute("uv",new Ll(M,g)),P.setAttribute("faceIndex",new Ll(C,b)),e.push(P),r>Ym&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function O8(n,e,t){const i=new zp(n,e,t);return i.texture.mapping=J3,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function ZS(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function kAe(n,e,t){const i=new Float32Array(np),r=new Ee(0,1,0);return new zh({name:"SphericalGaussianBlur",defines:{n:np,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:kI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Eh,depthTest:!1,depthWrite:!1})}function k8(){return new zh({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:kI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Eh,depthTest:!1,depthWrite:!1})}function I8(){return new zh({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:kI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Eh,depthTest:!1,depthWrite:!1})}function kI(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function IAe(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,u=l===C4||l===E4,c=l===ag||l===lg;if(u||c)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=e.get(a);return t===null&&(t=new R8(n)),h=u?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}else{if(e.has(a))return e.get(a).texture;{const h=a.image;if(u&&h&&h.height>0||c&&h&&r(h)){t===null&&(t=new R8(n));const p=u?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",o),p.texture}else return null}}}return a}function r(a){let l=0;const u=6;for(let c=0;c<u;c++)a[c]!==void 0&&l++;return l===u}function o(a){const l=a.target;l.removeEventListener("dispose",o);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function s(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:s}}function NAe(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function zAe(n,e,t,i){const r={},o=new WeakMap;function s(h){const p=h.target;p.index!==null&&e.remove(p.index);for(const y in p.attributes)e.remove(p.attributes[y]);p.removeEventListener("dispose",s),delete r[p.id];const m=o.get(p);m&&(e.remove(m),o.delete(p)),i.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function a(h,p){return r[p.id]===!0||(p.addEventListener("dispose",s),r[p.id]=!0,t.memory.geometries++),p}function l(h){const p=h.attributes;for(const y in p)e.update(p[y],34962);const m=h.morphAttributes;for(const y in m){const _=m[y];for(let g=0,b=_.length;g<b;g++)e.update(_[g],34962)}}function u(h){const p=[],m=h.index,y=h.attributes.position;let _=0;if(m!==null){const w=m.array;_=m.version;for(let M=0,C=w.length;M<C;M+=3){const P=w[M+0],L=w[M+1],R=w[M+2];p.push(P,L,L,R,R,P)}}else{const w=y.array;_=y.version;for(let M=0,C=w.length/3-1;M<C;M+=3){const P=M+0,L=M+1,R=M+2;p.push(P,L,L,R,R,P)}}const g=new(nY(p)?hY:cY)(p,1);g.version=_;const b=o.get(h);b&&e.remove(b),o.set(h,g)}function c(h){const p=o.get(h);if(p){const m=h.index;m!==null&&p.version<m.version&&u(h)}else u(h);return o.get(h)}return{get:a,update:l,getWireframeAttribute:c}}function VAe(n,e,t,i){const r=i.isWebGL2;let o;function s(p){o=p}let a,l;function u(p){a=p.type,l=p.bytesPerElement}function c(p,m){n.drawElements(o,m,a,p*l),t.update(m,o,1)}function h(p,m,y){if(y===0)return;let _,g;if(r)_=n,g="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",_===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}_[g](o,m,a,p*l,y),t.update(m,o,y)}this.setMode=s,this.setIndex=u,this.render=c,this.renderInstances=h}function FAe(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,s,a){switch(t.calls++,s){case 4:t.triangles+=a*(o/3);break;case 1:t.lines+=a*(o/2);break;case 3:t.lines+=a*(o-1);break;case 2:t.lines+=a*o;break;case 0:t.points+=a*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s);break}}function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function BAe(n,e){return n[0]-e[0]}function UAe(n,e){return Math.abs(e[1])-Math.abs(n[1])}function jAe(n,e,t){const i={},r=new Float32Array(8),o=new WeakMap,s=new Mr,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,c,h,p){const m=u.morphTargetInfluences;if(e.isWebGL2===!0){const y=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,_=y!==void 0?y.length:0;let g=o.get(c);if(g===void 0||g.count!==_){let Q=function(){ee.dispose(),o.delete(c),c.removeEventListener("dispose",Q)};g!==void 0&&g.texture.dispose();const M=c.morphAttributes.position!==void 0,C=c.morphAttributes.normal!==void 0,P=c.morphAttributes.color!==void 0,L=c.morphAttributes.position||[],R=c.morphAttributes.normal||[],E=c.morphAttributes.color||[];let D=0;M===!0&&(D=1),C===!0&&(D=2),P===!0&&(D=3);let N=c.attributes.position.count*D,j=1;N>e.maxTextureSize&&(j=Math.ceil(N/e.maxTextureSize),N=e.maxTextureSize);const te=new Float32Array(N*j*4*_),ee=new sY(te,N,j,_);ee.type=cp,ee.needsUpdate=!0;const H=D*4;for(let Z=0;Z<_;Z++){const de=L[Z],X=R[Z],B=E[Z],U=N*j*4*Z;for(let le=0;le<de.count;le++){const ne=le*H;M===!0&&(s.fromBufferAttribute(de,le),te[U+ne+0]=s.x,te[U+ne+1]=s.y,te[U+ne+2]=s.z,te[U+ne+3]=0),C===!0&&(s.fromBufferAttribute(X,le),te[U+ne+4]=s.x,te[U+ne+5]=s.y,te[U+ne+6]=s.z,te[U+ne+7]=0),P===!0&&(s.fromBufferAttribute(B,le),te[U+ne+8]=s.x,te[U+ne+9]=s.y,te[U+ne+10]=s.z,te[U+ne+11]=B.itemSize===4?s.w:1)}}g={count:_,texture:ee,size:new zn(N,j)},o.set(c,g),c.addEventListener("dispose",Q)}let b=0;for(let M=0;M<m.length;M++)b+=m[M];const w=c.morphTargetsRelative?1:1-b;p.getUniforms().setValue(n,"morphTargetBaseInfluence",w),p.getUniforms().setValue(n,"morphTargetInfluences",m),p.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),p.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}else{const y=m===void 0?0:m.length;let _=i[c.id];if(_===void 0||_.length!==y){_=[];for(let C=0;C<y;C++)_[C]=[C,0];i[c.id]=_}for(let C=0;C<y;C++){const P=_[C];P[0]=C,P[1]=m[C]}_.sort(UAe);for(let C=0;C<8;C++)C<y&&_[C][1]?(a[C][0]=_[C][0],a[C][1]=_[C][1]):(a[C][0]=Number.MAX_SAFE_INTEGER,a[C][1]=0);a.sort(BAe);const g=c.morphAttributes.position,b=c.morphAttributes.normal;let w=0;for(let C=0;C<8;C++){const P=a[C],L=P[0],R=P[1];L!==Number.MAX_SAFE_INTEGER&&R?(g&&c.getAttribute("morphTarget"+C)!==g[L]&&c.setAttribute("morphTarget"+C,g[L]),b&&c.getAttribute("morphNormal"+C)!==b[L]&&c.setAttribute("morphNormal"+C,b[L]),r[C]=R,w+=R):(g&&c.hasAttribute("morphTarget"+C)===!0&&c.deleteAttribute("morphTarget"+C),b&&c.hasAttribute("morphNormal"+C)===!0&&c.deleteAttribute("morphNormal"+C),r[C]=0)}const M=c.morphTargetsRelative?1:1-w;p.getUniforms().setValue(n,"morphTargetBaseInfluence",M),p.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:l}}function HAe(n,e,t,i){let r=new WeakMap;function o(l){const u=i.render.frame,c=l.geometry,h=e.get(l,c);return r.get(h)!==u&&(e.update(h),r.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),l.instanceColor!==null&&t.update(l.instanceColor,34962)),h}function s(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:o,dispose:s}}const gY=new Xa,_Y=new sY,yY=new REe,xY=new fY,N8=[],z8=[],V8=new Float32Array(16),F8=new Float32Array(9),B8=new Float32Array(4);function Hg(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let o=N8[r];if(o===void 0&&(o=new Float32Array(r),N8[r]=o),e!==0){i.toArray(o,0);for(let s=1,a=0;s!==e;++s)a+=t,n[s].toArray(o,a)}return o}function Ao(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Lo(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function eE(n,e){let t=z8[e];t===void 0&&(t=new Int32Array(e),z8[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function WAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function GAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ao(t,e))return;n.uniform2fv(this.addr,e),Lo(t,e)}}function XAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ao(t,e))return;n.uniform3fv(this.addr,e),Lo(t,e)}}function qAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ao(t,e))return;n.uniform4fv(this.addr,e),Lo(t,e)}}function YAe(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ao(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Lo(t,e)}else{if(Ao(t,i))return;B8.set(i),n.uniformMatrix2fv(this.addr,!1,B8),Lo(t,i)}}function KAe(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ao(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Lo(t,e)}else{if(Ao(t,i))return;F8.set(i),n.uniformMatrix3fv(this.addr,!1,F8),Lo(t,i)}}function ZAe(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ao(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Lo(t,e)}else{if(Ao(t,i))return;V8.set(i),n.uniformMatrix4fv(this.addr,!1,V8),Lo(t,i)}}function JAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function QAe(n,e){const t=this.cache;Ao(t,e)||(n.uniform2iv(this.addr,e),Lo(t,e))}function $Ae(n,e){const t=this.cache;Ao(t,e)||(n.uniform3iv(this.addr,e),Lo(t,e))}function eLe(n,e){const t=this.cache;Ao(t,e)||(n.uniform4iv(this.addr,e),Lo(t,e))}function tLe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function nLe(n,e){const t=this.cache;Ao(t,e)||(n.uniform2uiv(this.addr,e),Lo(t,e))}function iLe(n,e){const t=this.cache;Ao(t,e)||(n.uniform3uiv(this.addr,e),Lo(t,e))}function rLe(n,e){const t=this.cache;Ao(t,e)||(n.uniform4uiv(this.addr,e),Lo(t,e))}function oLe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||gY,r)}function sLe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||yY,r)}function aLe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||xY,r)}function lLe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||_Y,r)}function uLe(n){switch(n){case 5126:return WAe;case 35664:return GAe;case 35665:return XAe;case 35666:return qAe;case 35674:return YAe;case 35675:return KAe;case 35676:return ZAe;case 5124:case 35670:return JAe;case 35667:case 35671:return QAe;case 35668:case 35672:return $Ae;case 35669:case 35673:return eLe;case 5125:return tLe;case 36294:return nLe;case 36295:return iLe;case 36296:return rLe;case 35678:case 36198:case 36298:case 36306:case 35682:return oLe;case 35679:case 36299:case 36307:return sLe;case 35680:case 36300:case 36308:case 36293:return aLe;case 36289:case 36303:case 36311:case 36292:return lLe}}function cLe(n,e){n.uniform1fv(this.addr,e)}function hLe(n,e){const t=Hg(e,this.size,2);n.uniform2fv(this.addr,t)}function dLe(n,e){const t=Hg(e,this.size,3);n.uniform3fv(this.addr,t)}function pLe(n,e){const t=Hg(e,this.size,4);n.uniform4fv(this.addr,t)}function fLe(n,e){const t=Hg(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function mLe(n,e){const t=Hg(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function vLe(n,e){const t=Hg(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function gLe(n,e){n.uniform1iv(this.addr,e)}function _Le(n,e){n.uniform2iv(this.addr,e)}function yLe(n,e){n.uniform3iv(this.addr,e)}function xLe(n,e){n.uniform4iv(this.addr,e)}function bLe(n,e){n.uniform1uiv(this.addr,e)}function wLe(n,e){n.uniform2uiv(this.addr,e)}function SLe(n,e){n.uniform3uiv(this.addr,e)}function MLe(n,e){n.uniform4uiv(this.addr,e)}function CLe(n,e,t){const i=e.length,r=eE(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture2D(e[o]||gY,r[o])}function ELe(n,e,t){const i=e.length,r=eE(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture3D(e[o]||yY,r[o])}function TLe(n,e,t){const i=e.length,r=eE(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTextureCube(e[o]||xY,r[o])}function PLe(n,e,t){const i=e.length,r=eE(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||_Y,r[o])}function ALe(n){switch(n){case 5126:return cLe;case 35664:return hLe;case 35665:return dLe;case 35666:return pLe;case 35674:return fLe;case 35675:return mLe;case 35676:return vLe;case 5124:case 35670:return gLe;case 35667:case 35671:return _Le;case 35668:case 35672:return yLe;case 35669:case 35673:return xLe;case 5125:return bLe;case 36294:return wLe;case 36295:return SLe;case 36296:return MLe;case 35678:case 36198:case 36298:case 36306:case 35682:return CLe;case 35679:case 36299:case 36307:return ELe;case 35680:case 36300:case 36308:case 36293:return TLe;case 36289:case 36303:case 36311:case 36292:return PLe}}class LLe{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=uLe(t.type)}}class DLe{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=ALe(t.type)}}class RLe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let o=0,s=r.length;o!==s;++o){const a=r[o];a.setValue(e,t[a.id],i)}}}const jL=/(\w+)(\])?(\[|\.)?/g;function U8(n,e){n.seq.push(e),n.map[e.id]=e}function OLe(n,e,t){const i=n.name,r=i.length;for(jL.lastIndex=0;;){const o=jL.exec(i),s=jL.lastIndex;let a=o[1];const l=o[2]==="]",u=o[3];if(l&&(a=a|0),u===void 0||u==="["&&s+2===r){U8(t,u===void 0?new LLe(a,n,e):new DLe(a,n,e));break}else{let h=t.map[a];h===void 0&&(h=new RLe(a),U8(t,h)),t=h}}}class FM{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const o=e.getActiveUniform(t,r),s=e.getUniformLocation(t,o.name);OLe(o,s,this)}}setValue(e,t,i,r){const o=this.map[t];o!==void 0&&o.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let o=0,s=t.length;o!==s;++o){const a=t[o],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,o=e.length;r!==o;++r){const s=e[r];s.id in t&&i.push(s)}return i}}function j8(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let kLe=0;function ILe(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let s=r;s<o;s++){const a=s+1;i.push(`${a===e?">":" "} ${a}: ${t[s]}`)}return i.join(`
`)}function NLe(n){switch(n){case Np:return["Linear","( value )"];case bi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function H8(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const s=parseInt(o[1]);return t.toUpperCase()+`

`+r+`

`+ILe(n.getShaderSource(e),s)}else return r}function zLe(n,e){const t=NLe(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function VLe(n,e){let t;switch(e){case rEe:t="Linear";break;case oEe:t="Reinhard";break;case sEe:t="OptimizedCineon";break;case aEe:t="ACESFilmic";break;case lEe:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function FLe(n){return[n.extensionDerivatives||!!n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(A_).join(`
`)}function BLe(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function ULe(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const o=n.getActiveAttrib(e,r),s=o.name;let a=1;o.type===35674&&(a=2),o.type===35675&&(a=3),o.type===35676&&(a=4),t[s]={type:o.type,location:n.getAttribLocation(e,s),locationSize:a}}return t}function A_(n){return n!==""}function W8(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function G8(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const jLe=/^[ \t]*#include +<([\w\d./]+)>/gm;function D4(n){return n.replace(jLe,HLe)}function HLe(n,e){const t=nn[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return D4(t)}const WLe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function X8(n){return n.replace(WLe,GLe)}function GLe(n,e,t,i){let r="";for(let o=parseInt(e);o<parseInt(t);o++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function q8(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function XLe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===Zq?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===N3e?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===P_&&(e="SHADOWMAP_TYPE_VSM"),e}function qLe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case ag:case lg:e="ENVMAP_TYPE_CUBE";break;case J3:e="ENVMAP_TYPE_CUBE_UV";break}return e}function YLe(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case lg:e="ENVMAP_MODE_REFRACTION";break}return e}function KLe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case $q:e="ENVMAP_BLENDING_MULTIPLY";break;case nEe:e="ENVMAP_BLENDING_MIX";break;case iEe:e="ENVMAP_BLENDING_ADD";break}return e}function ZLe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function JLe(n,e,t,i){const r=n.getContext(),o=t.defines;let s=t.vertexShader,a=t.fragmentShader;const l=XLe(t),u=qLe(t),c=YLe(t),h=KLe(t),p=ZLe(t),m=t.isWebGL2?"":FLe(t),y=BLe(o),_=r.createProgram();let g,b,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(g=[y].filter(A_).join(`
`),g.length>0&&(g+=`
`),b=[m,y].filter(A_).join(`
`),b.length>0&&(b+=`
`)):(g=[q8(t),"#define SHADER_NAME "+t.shaderName,y,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(A_).join(`
`),b=[m,q8(t),"#define SHADER_NAME "+t.shaderName,y,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==qu?"#define TONE_MAPPING":"",t.toneMapping!==qu?nn.tonemapping_pars_fragment:"",t.toneMapping!==qu?VLe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",nn.encodings_pars_fragment,zLe("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(A_).join(`
`)),s=D4(s),s=W8(s,t),s=G8(s,t),a=D4(a),a=W8(a,t),a=G8(a,t),s=X8(s),a=X8(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,b=["#define varying in",t.glslVersion===m8?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===m8?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+b);const M=w+g+s,C=w+b+a,P=j8(r,35633,M),L=j8(r,35632,C);if(r.attachShader(_,P),r.attachShader(_,L),t.index0AttributeName!==void 0?r.bindAttribLocation(_,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),n.debug.checkShaderErrors){const D=r.getProgramInfoLog(_).trim(),N=r.getShaderInfoLog(P).trim(),j=r.getShaderInfoLog(L).trim();let te=!0,ee=!0;if(r.getProgramParameter(_,35714)===!1){te=!1;const H=H8(r,P,"vertex"),Q=H8(r,L,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,35715)+`

Program Info Log: `+D+`
`+H+`
`+Q)}else D!==""?console.warn("THREE.WebGLProgram: Program Info Log:",D):(N===""||j==="")&&(ee=!1);ee&&(this.diagnostics={runnable:te,programLog:D,vertexShader:{log:N,prefix:g},fragmentShader:{log:j,prefix:b}})}r.deleteShader(P),r.deleteShader(L);let R;this.getUniforms=function(){return R===void 0&&(R=new FM(r,_)),R};let E;return this.getAttributes=function(){return E===void 0&&(E=ULe(r,_)),E},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.name=t.shaderName,this.id=kLe++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=P,this.fragmentShader=L,this}let QLe=0;class $Le{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),o=this._getShaderStage(i),s=this._getShaderCacheForMaterial(e);return s.has(r)===!1&&(s.add(r),r.usedTimes++),s.has(o)===!1&&(s.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new eDe(e),t.set(e,i)),i}}class eDe{constructor(e){this.id=QLe++,this.code=e,this.usedTimes=0}}function tDe(n,e,t,i,r,o,s){const a=new lY,l=new $Le,u=[],c=r.isWebGL2,h=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(E,D,N,j,te){const ee=j.fog,H=te.geometry,Q=E.isMeshStandardMaterial?j.environment:null,Z=(E.isMeshStandardMaterial?t:e).get(E.envMap||Q),de=!!Z&&Z.mapping===J3?Z.image.height:null,X=y[E.type];E.precision!==null&&(m=r.getMaxPrecision(E.precision),m!==E.precision&&console.warn("THREE.WebGLProgram.getParameters:",E.precision,"not supported, using",m,"instead."));const B=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,U=B!==void 0?B.length:0;let le=0;H.morphAttributes.position!==void 0&&(le=1),H.morphAttributes.normal!==void 0&&(le=2),H.morphAttributes.color!==void 0&&(le=3);let ne,fe,we,Be;if(X){const Oe=vl[X];ne=Oe.vertexShader,fe=Oe.fragmentShader}else ne=E.vertexShader,fe=E.fragmentShader,l.update(E),we=l.getVertexShaderID(E),Be=l.getFragmentShaderID(E);const oe=n.getRenderTarget(),tt=E.alphaTest>0,Ue=E.clearcoat>0,Ve=E.iridescence>0;return{isWebGL2:c,shaderID:X,shaderName:E.type,vertexShader:ne,fragmentShader:fe,defines:E.defines,customVertexShaderID:we,customFragmentShaderID:Be,isRawShaderMaterial:E.isRawShaderMaterial===!0,glslVersion:E.glslVersion,precision:m,instancing:te.isInstancedMesh===!0,instancingColor:te.isInstancedMesh===!0&&te.instanceColor!==null,supportsVertexTextures:p,outputEncoding:oe===null?n.outputEncoding:oe.isXRRenderTarget===!0?oe.texture.encoding:Np,map:!!E.map,matcap:!!E.matcap,envMap:!!Z,envMapMode:Z&&Z.mapping,envMapCubeUVHeight:de,lightMap:!!E.lightMap,aoMap:!!E.aoMap,emissiveMap:!!E.emissiveMap,bumpMap:!!E.bumpMap,normalMap:!!E.normalMap,objectSpaceNormalMap:E.normalMapType===PEe,tangentSpaceNormalMap:E.normalMapType===TEe,decodeVideoTexture:!!E.map&&E.map.isVideoTexture===!0&&E.map.encoding===bi,clearcoat:Ue,clearcoatMap:Ue&&!!E.clearcoatMap,clearcoatRoughnessMap:Ue&&!!E.clearcoatRoughnessMap,clearcoatNormalMap:Ue&&!!E.clearcoatNormalMap,iridescence:Ve,iridescenceMap:Ve&&!!E.iridescenceMap,iridescenceThicknessMap:Ve&&!!E.iridescenceThicknessMap,displacementMap:!!E.displacementMap,roughnessMap:!!E.roughnessMap,metalnessMap:!!E.metalnessMap,specularMap:!!E.specularMap,specularIntensityMap:!!E.specularIntensityMap,specularColorMap:!!E.specularColorMap,opaque:E.transparent===!1&&E.blending===bv,alphaMap:!!E.alphaMap,alphaTest:tt,gradientMap:!!E.gradientMap,sheen:E.sheen>0,sheenColorMap:!!E.sheenColorMap,sheenRoughnessMap:!!E.sheenRoughnessMap,transmission:E.transmission>0,transmissionMap:!!E.transmissionMap,thicknessMap:!!E.thicknessMap,combine:E.combine,vertexTangents:!!E.normalMap&&!!H.attributes.tangent,vertexColors:E.vertexColors,vertexAlphas:E.vertexColors===!0&&!!H.attributes.color&&H.attributes.color.itemSize===4,vertexUvs:!!E.map||!!E.bumpMap||!!E.normalMap||!!E.specularMap||!!E.alphaMap||!!E.emissiveMap||!!E.roughnessMap||!!E.metalnessMap||!!E.clearcoatMap||!!E.clearcoatRoughnessMap||!!E.clearcoatNormalMap||!!E.iridescenceMap||!!E.iridescenceThicknessMap||!!E.displacementMap||!!E.transmissionMap||!!E.thicknessMap||!!E.specularIntensityMap||!!E.specularColorMap||!!E.sheenColorMap||!!E.sheenRoughnessMap,uvsVertexOnly:!(!!E.map||!!E.bumpMap||!!E.normalMap||!!E.specularMap||!!E.alphaMap||!!E.emissiveMap||!!E.roughnessMap||!!E.metalnessMap||!!E.clearcoatNormalMap||!!E.iridescenceMap||!!E.iridescenceThicknessMap||E.transmission>0||!!E.transmissionMap||!!E.thicknessMap||!!E.specularIntensityMap||!!E.specularColorMap||E.sheen>0||!!E.sheenColorMap||!!E.sheenRoughnessMap)&&!!E.displacementMap,fog:!!ee,useFog:E.fog===!0,fogExp2:ee&&ee.isFogExp2,flatShading:!!E.flatShading,sizeAttenuation:E.sizeAttenuation,logarithmicDepthBuffer:h,skinning:te.isSkinnedMesh===!0,morphTargets:H.morphAttributes.position!==void 0,morphNormals:H.morphAttributes.normal!==void 0,morphColors:H.morphAttributes.color!==void 0,morphTargetsCount:U,morphTextureStride:le,numDirLights:D.directional.length,numPointLights:D.point.length,numSpotLights:D.spot.length,numSpotLightMaps:D.spotLightMap.length,numRectAreaLights:D.rectArea.length,numHemiLights:D.hemi.length,numDirLightShadows:D.directionalShadowMap.length,numPointLightShadows:D.pointShadowMap.length,numSpotLightShadows:D.spotShadowMap.length,numSpotLightShadowsWithMaps:D.numSpotLightShadowsWithMaps,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:E.dithering,shadowMapEnabled:n.shadowMap.enabled&&N.length>0,shadowMapType:n.shadowMap.type,toneMapping:E.toneMapped?n.toneMapping:qu,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:E.premultipliedAlpha,doubleSided:E.side===hh,flipSided:E.side===Ss,useDepthPacking:!!E.depthPacking,depthPacking:E.depthPacking||0,index0AttributeName:E.index0AttributeName,extensionDerivatives:E.extensions&&E.extensions.derivatives,extensionFragDepth:E.extensions&&E.extensions.fragDepth,extensionDrawBuffers:E.extensions&&E.extensions.drawBuffers,extensionShaderTextureLOD:E.extensions&&E.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||i.has("EXT_shader_texture_lod"),customProgramCacheKey:E.customProgramCacheKey()}}function g(E){const D=[];if(E.shaderID?D.push(E.shaderID):(D.push(E.customVertexShaderID),D.push(E.customFragmentShaderID)),E.defines!==void 0)for(const N in E.defines)D.push(N),D.push(E.defines[N]);return E.isRawShaderMaterial===!1&&(b(D,E),w(D,E),D.push(n.outputEncoding)),D.push(E.customProgramCacheKey),D.join()}function b(E,D){E.push(D.precision),E.push(D.outputEncoding),E.push(D.envMapMode),E.push(D.envMapCubeUVHeight),E.push(D.combine),E.push(D.vertexUvs),E.push(D.fogExp2),E.push(D.sizeAttenuation),E.push(D.morphTargetsCount),E.push(D.morphAttributeCount),E.push(D.numDirLights),E.push(D.numPointLights),E.push(D.numSpotLights),E.push(D.numSpotLightMaps),E.push(D.numHemiLights),E.push(D.numRectAreaLights),E.push(D.numDirLightShadows),E.push(D.numPointLightShadows),E.push(D.numSpotLightShadows),E.push(D.numSpotLightShadowsWithMaps),E.push(D.shadowMapType),E.push(D.toneMapping),E.push(D.numClippingPlanes),E.push(D.numClipIntersection),E.push(D.depthPacking)}function w(E,D){a.disableAll(),D.isWebGL2&&a.enable(0),D.supportsVertexTextures&&a.enable(1),D.instancing&&a.enable(2),D.instancingColor&&a.enable(3),D.map&&a.enable(4),D.matcap&&a.enable(5),D.envMap&&a.enable(6),D.lightMap&&a.enable(7),D.aoMap&&a.enable(8),D.emissiveMap&&a.enable(9),D.bumpMap&&a.enable(10),D.normalMap&&a.enable(11),D.objectSpaceNormalMap&&a.enable(12),D.tangentSpaceNormalMap&&a.enable(13),D.clearcoat&&a.enable(14),D.clearcoatMap&&a.enable(15),D.clearcoatRoughnessMap&&a.enable(16),D.clearcoatNormalMap&&a.enable(17),D.iridescence&&a.enable(18),D.iridescenceMap&&a.enable(19),D.iridescenceThicknessMap&&a.enable(20),D.displacementMap&&a.enable(21),D.specularMap&&a.enable(22),D.roughnessMap&&a.enable(23),D.metalnessMap&&a.enable(24),D.gradientMap&&a.enable(25),D.alphaMap&&a.enable(26),D.alphaTest&&a.enable(27),D.vertexColors&&a.enable(28),D.vertexAlphas&&a.enable(29),D.vertexUvs&&a.enable(30),D.vertexTangents&&a.enable(31),D.uvsVertexOnly&&a.enable(32),E.push(a.mask),a.disableAll(),D.fog&&a.enable(0),D.useFog&&a.enable(1),D.flatShading&&a.enable(2),D.logarithmicDepthBuffer&&a.enable(3),D.skinning&&a.enable(4),D.morphTargets&&a.enable(5),D.morphNormals&&a.enable(6),D.morphColors&&a.enable(7),D.premultipliedAlpha&&a.enable(8),D.shadowMapEnabled&&a.enable(9),D.physicallyCorrectLights&&a.enable(10),D.doubleSided&&a.enable(11),D.flipSided&&a.enable(12),D.useDepthPacking&&a.enable(13),D.dithering&&a.enable(14),D.specularIntensityMap&&a.enable(15),D.specularColorMap&&a.enable(16),D.transmission&&a.enable(17),D.transmissionMap&&a.enable(18),D.thicknessMap&&a.enable(19),D.sheen&&a.enable(20),D.sheenColorMap&&a.enable(21),D.sheenRoughnessMap&&a.enable(22),D.decodeVideoTexture&&a.enable(23),D.opaque&&a.enable(24),E.push(a.mask)}function M(E){const D=y[E.type];let N;if(D){const j=vl[D];N=dY.clone(j.uniforms)}else N=E.uniforms;return N}function C(E,D){let N;for(let j=0,te=u.length;j<te;j++){const ee=u[j];if(ee.cacheKey===D){N=ee,++N.usedTimes;break}}return N===void 0&&(N=new JLe(n,D,E,o),u.push(N)),N}function P(E){if(--E.usedTimes===0){const D=u.indexOf(E);u[D]=u[u.length-1],u.pop(),E.destroy()}}function L(E){l.remove(E)}function R(){l.dispose()}return{getParameters:_,getProgramCacheKey:g,getUniforms:M,acquireProgram:C,releaseProgram:P,releaseShaderCache:L,programs:u,dispose:R}}function nDe(){let n=new WeakMap;function e(o){let s=n.get(o);return s===void 0&&(s={},n.set(o,s)),s}function t(o){n.delete(o)}function i(o,s,a){n.get(o)[s]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function iDe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function Y8(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function K8(){const n=[];let e=0;const t=[],i=[],r=[];function o(){e=0,t.length=0,i.length=0,r.length=0}function s(h,p,m,y,_,g){let b=n[e];return b===void 0?(b={id:h.id,object:h,geometry:p,material:m,groupOrder:y,renderOrder:h.renderOrder,z:_,group:g},n[e]=b):(b.id=h.id,b.object=h,b.geometry=p,b.material=m,b.groupOrder=y,b.renderOrder=h.renderOrder,b.z=_,b.group=g),e++,b}function a(h,p,m,y,_,g){const b=s(h,p,m,y,_,g);m.transmission>0?i.push(b):m.transparent===!0?r.push(b):t.push(b)}function l(h,p,m,y,_,g){const b=s(h,p,m,y,_,g);m.transmission>0?i.unshift(b):m.transparent===!0?r.unshift(b):t.unshift(b)}function u(h,p){t.length>1&&t.sort(h||iDe),i.length>1&&i.sort(p||Y8),r.length>1&&r.sort(p||Y8)}function c(){for(let h=e,p=n.length;h<p;h++){const m=n[h];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:i,transparent:r,init:o,push:a,unshift:l,finish:c,sort:u}}function rDe(){let n=new WeakMap;function e(i,r){const o=n.get(i);let s;return o===void 0?(s=new K8,n.set(i,[s])):r>=o.length?(s=new K8,o.push(s)):s=o[r],s}function t(){n=new WeakMap}return{get:e,dispose:t}}function oDe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Ee,color:new Rn};break;case"SpotLight":t={position:new Ee,direction:new Ee,color:new Rn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Ee,color:new Rn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Ee,skyColor:new Rn,groundColor:new Rn};break;case"RectAreaLight":t={color:new Rn,position:new Ee,halfWidth:new Ee,halfHeight:new Ee};break}return n[e.id]=t,t}}}function sDe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let aDe=0;function lDe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function uDe(n,e){const t=new oDe,i=sDe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let c=0;c<9;c++)r.probe.push(new Ee);const o=new Ee,s=new qi,a=new qi;function l(c,h){let p=0,m=0,y=0;for(let j=0;j<9;j++)r.probe[j].set(0,0,0);let _=0,g=0,b=0,w=0,M=0,C=0,P=0,L=0,R=0,E=0;c.sort(lDe);const D=h!==!0?Math.PI:1;for(let j=0,te=c.length;j<te;j++){const ee=c[j],H=ee.color,Q=ee.intensity,Z=ee.distance,de=ee.shadow&&ee.shadow.map?ee.shadow.map.texture:null;if(ee.isAmbientLight)p+=H.r*Q*D,m+=H.g*Q*D,y+=H.b*Q*D;else if(ee.isLightProbe)for(let X=0;X<9;X++)r.probe[X].addScaledVector(ee.sh.coefficients[X],Q);else if(ee.isDirectionalLight){const X=t.get(ee);if(X.color.copy(ee.color).multiplyScalar(ee.intensity*D),ee.castShadow){const B=ee.shadow,U=i.get(ee);U.shadowBias=B.bias,U.shadowNormalBias=B.normalBias,U.shadowRadius=B.radius,U.shadowMapSize=B.mapSize,r.directionalShadow[_]=U,r.directionalShadowMap[_]=de,r.directionalShadowMatrix[_]=ee.shadow.matrix,C++}r.directional[_]=X,_++}else if(ee.isSpotLight){const X=t.get(ee);X.position.setFromMatrixPosition(ee.matrixWorld),X.color.copy(H).multiplyScalar(Q*D),X.distance=Z,X.coneCos=Math.cos(ee.angle),X.penumbraCos=Math.cos(ee.angle*(1-ee.penumbra)),X.decay=ee.decay,r.spot[b]=X;const B=ee.shadow;if(ee.map&&(r.spotLightMap[R]=ee.map,R++,B.updateMatrices(ee),ee.castShadow&&E++),r.spotLightMatrix[b]=B.matrix,ee.castShadow){const U=i.get(ee);U.shadowBias=B.bias,U.shadowNormalBias=B.normalBias,U.shadowRadius=B.radius,U.shadowMapSize=B.mapSize,r.spotShadow[b]=U,r.spotShadowMap[b]=de,L++}b++}else if(ee.isRectAreaLight){const X=t.get(ee);X.color.copy(H).multiplyScalar(Q),X.halfWidth.set(ee.width*.5,0,0),X.halfHeight.set(0,ee.height*.5,0),r.rectArea[w]=X,w++}else if(ee.isPointLight){const X=t.get(ee);if(X.color.copy(ee.color).multiplyScalar(ee.intensity*D),X.distance=ee.distance,X.decay=ee.decay,ee.castShadow){const B=ee.shadow,U=i.get(ee);U.shadowBias=B.bias,U.shadowNormalBias=B.normalBias,U.shadowRadius=B.radius,U.shadowMapSize=B.mapSize,U.shadowCameraNear=B.camera.near,U.shadowCameraFar=B.camera.far,r.pointShadow[g]=U,r.pointShadowMap[g]=de,r.pointShadowMatrix[g]=ee.shadow.matrix,P++}r.point[g]=X,g++}else if(ee.isHemisphereLight){const X=t.get(ee);X.skyColor.copy(ee.color).multiplyScalar(Q*D),X.groundColor.copy(ee.groundColor).multiplyScalar(Q*D),r.hemi[M]=X,M++}}w>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=ot.LTC_FLOAT_1,r.rectAreaLTC2=ot.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=ot.LTC_HALF_1,r.rectAreaLTC2=ot.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=m,r.ambient[2]=y;const N=r.hash;(N.directionalLength!==_||N.pointLength!==g||N.spotLength!==b||N.rectAreaLength!==w||N.hemiLength!==M||N.numDirectionalShadows!==C||N.numPointShadows!==P||N.numSpotShadows!==L||N.numSpotMaps!==R)&&(r.directional.length=_,r.spot.length=b,r.rectArea.length=w,r.point.length=g,r.hemi.length=M,r.directionalShadow.length=C,r.directionalShadowMap.length=C,r.pointShadow.length=P,r.pointShadowMap.length=P,r.spotShadow.length=L,r.spotShadowMap.length=L,r.directionalShadowMatrix.length=C,r.pointShadowMatrix.length=P,r.spotLightMatrix.length=L+R-E,r.spotLightMap.length=R,r.numSpotLightShadowsWithMaps=E,N.directionalLength=_,N.pointLength=g,N.spotLength=b,N.rectAreaLength=w,N.hemiLength=M,N.numDirectionalShadows=C,N.numPointShadows=P,N.numSpotShadows=L,N.numSpotMaps=R,r.version=aDe++)}function u(c,h){let p=0,m=0,y=0,_=0,g=0;const b=h.matrixWorldInverse;for(let w=0,M=c.length;w<M;w++){const C=c[w];if(C.isDirectionalLight){const P=r.directional[p];P.direction.setFromMatrixPosition(C.matrixWorld),o.setFromMatrixPosition(C.target.matrixWorld),P.direction.sub(o),P.direction.transformDirection(b),p++}else if(C.isSpotLight){const P=r.spot[y];P.position.setFromMatrixPosition(C.matrixWorld),P.position.applyMatrix4(b),P.direction.setFromMatrixPosition(C.matrixWorld),o.setFromMatrixPosition(C.target.matrixWorld),P.direction.sub(o),P.direction.transformDirection(b),y++}else if(C.isRectAreaLight){const P=r.rectArea[_];P.position.setFromMatrixPosition(C.matrixWorld),P.position.applyMatrix4(b),a.identity(),s.copy(C.matrixWorld),s.premultiply(b),a.extractRotation(s),P.halfWidth.set(C.width*.5,0,0),P.halfHeight.set(0,C.height*.5,0),P.halfWidth.applyMatrix4(a),P.halfHeight.applyMatrix4(a),_++}else if(C.isPointLight){const P=r.point[m];P.position.setFromMatrixPosition(C.matrixWorld),P.position.applyMatrix4(b),m++}else if(C.isHemisphereLight){const P=r.hemi[g];P.direction.setFromMatrixPosition(C.matrixWorld),P.direction.transformDirection(b),g++}}}return{setup:l,setupView:u,state:r}}function Z8(n,e){const t=new uDe(n,e),i=[],r=[];function o(){i.length=0,r.length=0}function s(h){i.push(h)}function a(h){r.push(h)}function l(h){t.setup(i,h)}function u(h){t.setupView(i,h)}return{init:o,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:l,setupLightsView:u,pushLight:s,pushShadow:a}}function cDe(n,e){let t=new WeakMap;function i(o,s=0){const a=t.get(o);let l;return a===void 0?(l=new Z8(n,e),t.set(o,[l])):s>=a.length?(l=new Z8(n,e),a.push(l)):l=a[s],l}function r(){t=new WeakMap}return{get:i,dispose:r}}class hDe extends w1{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=CEe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class dDe extends w1{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Ee,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const pDe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fDe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function mDe(n,e,t){let i=new RI;const r=new zn,o=new zn,s=new Mr,a=new hDe({depthPacking:EEe}),l=new dDe,u={},c=t.maxTextureSize,h={0:Ss,1:sg,2:hh},p=new zh({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new zn},radius:{value:4}},vertexShader:pDe,fragmentShader:fDe}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const y=new hc;y.setAttribute("position",new Ll(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new dh(y,p),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Zq,this.render=function(C,P,L){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||C.length===0)return;const R=n.getRenderTarget(),E=n.getActiveCubeFace(),D=n.getActiveMipmapLevel(),N=n.state;N.setBlending(Eh),N.buffers.color.setClear(1,1,1,1),N.buffers.depth.setTest(!0),N.setScissorTest(!1);for(let j=0,te=C.length;j<te;j++){const ee=C[j],H=ee.shadow;if(H===void 0){console.warn("THREE.WebGLShadowMap:",ee,"has no shadow.");continue}if(H.autoUpdate===!1&&H.needsUpdate===!1)continue;r.copy(H.mapSize);const Q=H.getFrameExtents();if(r.multiply(Q),o.copy(H.mapSize),(r.x>c||r.y>c)&&(r.x>c&&(o.x=Math.floor(c/Q.x),r.x=o.x*Q.x,H.mapSize.x=o.x),r.y>c&&(o.y=Math.floor(c/Q.y),r.y=o.y*Q.y,H.mapSize.y=o.y)),H.map===null){const de=this.type!==P_?{minFilter:Ho,magFilter:Ho}:{};H.map=new zp(r.x,r.y,de),H.map.texture.name=ee.name+".shadowMap",H.camera.updateProjectionMatrix()}n.setRenderTarget(H.map),n.clear();const Z=H.getViewportCount();for(let de=0;de<Z;de++){const X=H.getViewport(de);s.set(o.x*X.x,o.y*X.y,o.x*X.z,o.y*X.w),N.viewport(s),H.updateMatrices(ee,de),i=H.getFrustum(),M(P,L,H.camera,ee,this.type)}H.isPointLightShadow!==!0&&this.type===P_&&b(H,L),H.needsUpdate=!1}g.needsUpdate=!1,n.setRenderTarget(R,E,D)};function b(C,P){const L=e.update(_);p.defines.VSM_SAMPLES!==C.blurSamples&&(p.defines.VSM_SAMPLES=C.blurSamples,m.defines.VSM_SAMPLES=C.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),C.mapPass===null&&(C.mapPass=new zp(r.x,r.y)),p.uniforms.shadow_pass.value=C.map.texture,p.uniforms.resolution.value=C.mapSize,p.uniforms.radius.value=C.radius,n.setRenderTarget(C.mapPass),n.clear(),n.renderBufferDirect(P,null,L,p,_,null),m.uniforms.shadow_pass.value=C.mapPass.texture,m.uniforms.resolution.value=C.mapSize,m.uniforms.radius.value=C.radius,n.setRenderTarget(C.map),n.clear(),n.renderBufferDirect(P,null,L,m,_,null)}function w(C,P,L,R,E,D){let N=null;const j=L.isPointLight===!0?C.customDistanceMaterial:C.customDepthMaterial;if(j!==void 0?N=j:N=L.isPointLight===!0?l:a,n.localClippingEnabled&&P.clipShadows===!0&&Array.isArray(P.clippingPlanes)&&P.clippingPlanes.length!==0||P.displacementMap&&P.displacementScale!==0||P.alphaMap&&P.alphaTest>0){const te=N.uuid,ee=P.uuid;let H=u[te];H===void 0&&(H={},u[te]=H);let Q=H[ee];Q===void 0&&(Q=N.clone(),H[ee]=Q),N=Q}return N.visible=P.visible,N.wireframe=P.wireframe,D===P_?N.side=P.shadowSide!==null?P.shadowSide:P.side:N.side=P.shadowSide!==null?P.shadowSide:h[P.side],N.alphaMap=P.alphaMap,N.alphaTest=P.alphaTest,N.clipShadows=P.clipShadows,N.clippingPlanes=P.clippingPlanes,N.clipIntersection=P.clipIntersection,N.displacementMap=P.displacementMap,N.displacementScale=P.displacementScale,N.displacementBias=P.displacementBias,N.wireframeLinewidth=P.wireframeLinewidth,N.linewidth=P.linewidth,L.isPointLight===!0&&N.isMeshDistanceMaterial===!0&&(N.referencePosition.setFromMatrixPosition(L.matrixWorld),N.nearDistance=R,N.farDistance=E),N}function M(C,P,L,R,E){if(C.visible===!1)return;if(C.layers.test(P.layers)&&(C.isMesh||C.isLine||C.isPoints)&&(C.castShadow||C.receiveShadow&&E===P_)&&(!C.frustumCulled||i.intersectsObject(C))){C.modelViewMatrix.multiplyMatrices(L.matrixWorldInverse,C.matrixWorld);const j=e.update(C),te=C.material;if(Array.isArray(te)){const ee=j.groups;for(let H=0,Q=ee.length;H<Q;H++){const Z=ee[H],de=te[Z.materialIndex];if(de&&de.visible){const X=w(C,de,R,L.near,L.far,E);n.renderBufferDirect(L,null,j,X,C,Z)}}}else if(te.visible){const ee=w(C,te,R,L.near,L.far,E);n.renderBufferDirect(L,null,j,ee,C,null)}}const N=C.children;for(let j=0,te=N.length;j<te;j++)M(N[j],P,L,R,E)}}function vDe(n,e,t){const i=t.isWebGL2;function r(){let W=!1;const De=new Mr;let ae=null;const Re=new Mr(0,0,0,0);return{setMask:function(Me){ae!==Me&&!W&&(n.colorMask(Me,Me,Me,Me),ae=Me)},setLocked:function(Me){W=Me},setClear:function(Me,bt,It,zt,Kn){Kn===!0&&(Me*=zt,bt*=zt,It*=zt),De.set(Me,bt,It,zt),Re.equals(De)===!1&&(n.clearColor(Me,bt,It,zt),Re.copy(De))},reset:function(){W=!1,ae=null,Re.set(-1,0,0,0)}}}function o(){let W=!1,De=null,ae=null,Re=null;return{setTest:function(Me){Me?tt(2929):Ue(2929)},setMask:function(Me){De!==Me&&!W&&(n.depthMask(Me),De=Me)},setFunc:function(Me){if(ae!==Me){if(Me)switch(Me){case K3e:n.depthFunc(512);break;case Z3e:n.depthFunc(519);break;case J3e:n.depthFunc(513);break;case M4:n.depthFunc(515);break;case Q3e:n.depthFunc(514);break;case $3e:n.depthFunc(518);break;case eEe:n.depthFunc(516);break;case tEe:n.depthFunc(517);break;default:n.depthFunc(515)}else n.depthFunc(515);ae=Me}},setLocked:function(Me){W=Me},setClear:function(Me){Re!==Me&&(n.clearDepth(Me),Re=Me)},reset:function(){W=!1,De=null,ae=null,Re=null}}}function s(){let W=!1,De=null,ae=null,Re=null,Me=null,bt=null,It=null,zt=null,Kn=null;return{setTest:function(Dt){W||(Dt?tt(2960):Ue(2960))},setMask:function(Dt){De!==Dt&&!W&&(n.stencilMask(Dt),De=Dt)},setFunc:function(Dt,Bn,yn){(ae!==Dt||Re!==Bn||Me!==yn)&&(n.stencilFunc(Dt,Bn,yn),ae=Dt,Re=Bn,Me=yn)},setOp:function(Dt,Bn,yn){(bt!==Dt||It!==Bn||zt!==yn)&&(n.stencilOp(Dt,Bn,yn),bt=Dt,It=Bn,zt=yn)},setLocked:function(Dt){W=Dt},setClear:function(Dt){Kn!==Dt&&(n.clearStencil(Dt),Kn=Dt)},reset:function(){W=!1,De=null,ae=null,Re=null,Me=null,bt=null,It=null,zt=null,Kn=null}}}const a=new r,l=new o,u=new s,c=new WeakMap,h=new WeakMap;let p={},m={},y=new WeakMap,_=[],g=null,b=!1,w=null,M=null,C=null,P=null,L=null,R=null,E=null,D=!1,N=null,j=null,te=null,ee=null,H=null;const Q=n.getParameter(35661);let Z=!1,de=0;const X=n.getParameter(7938);X.indexOf("WebGL")!==-1?(de=parseFloat(/^WebGL (\d)/.exec(X)[1]),Z=de>=1):X.indexOf("OpenGL ES")!==-1&&(de=parseFloat(/^OpenGL ES (\d)/.exec(X)[1]),Z=de>=2);let B=null,U={};const le=n.getParameter(3088),ne=n.getParameter(2978),fe=new Mr().fromArray(le),we=new Mr().fromArray(ne);function Be(W,De,ae){const Re=new Uint8Array(4),Me=n.createTexture();n.bindTexture(W,Me),n.texParameteri(W,10241,9728),n.texParameteri(W,10240,9728);for(let bt=0;bt<ae;bt++)n.texImage2D(De+bt,0,6408,1,1,0,6408,5121,Re);return Me}const oe={};oe[3553]=Be(3553,3553,1),oe[34067]=Be(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),tt(2929),l.setFunc(M4),ft(!1),mt(FU),tt(2884),Ye(Eh);function tt(W){p[W]!==!0&&(n.enable(W),p[W]=!0)}function Ue(W){p[W]!==!1&&(n.disable(W),p[W]=!1)}function Ve(W,De){return m[W]!==De?(n.bindFramebuffer(W,De),m[W]=De,i&&(W===36009&&(m[36160]=De),W===36160&&(m[36009]=De)),!0):!1}function Ae(W,De){let ae=_,Re=!1;if(W)if(ae=y.get(De),ae===void 0&&(ae=[],y.set(De,ae)),W.isWebGLMultipleRenderTargets){const Me=W.texture;if(ae.length!==Me.length||ae[0]!==36064){for(let bt=0,It=Me.length;bt<It;bt++)ae[bt]=36064+bt;ae.length=Me.length,Re=!0}}else ae[0]!==36064&&(ae[0]=36064,Re=!0);else ae[0]!==1029&&(ae[0]=1029,Re=!0);Re&&(t.isWebGL2?n.drawBuffers(ae):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ae))}function Oe(W){return g!==W?(n.useProgram(W),g=W,!0):!1}const Te={[Pm]:32774,[V3e]:32778,[F3e]:32779};if(i)Te[HU]=32775,Te[WU]=32776;else{const W=e.get("EXT_blend_minmax");W!==null&&(Te[HU]=W.MIN_EXT,Te[WU]=W.MAX_EXT)}const be={[B3e]:0,[U3e]:1,[j3e]:768,[Jq]:770,[Y3e]:776,[X3e]:774,[W3e]:772,[H3e]:769,[Qq]:771,[q3e]:775,[G3e]:773};function Ye(W,De,ae,Re,Me,bt,It,zt){if(W===Eh){b===!0&&(Ue(3042),b=!1);return}if(b===!1&&(tt(3042),b=!0),W!==z3e){if(W!==w||zt!==D){if((M!==Pm||L!==Pm)&&(n.blendEquation(32774),M=Pm,L=Pm),zt)switch(W){case bv:n.blendFuncSeparate(1,771,1,771);break;case BU:n.blendFunc(1,1);break;case UU:n.blendFuncSeparate(0,769,0,1);break;case jU:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",W);break}else switch(W){case bv:n.blendFuncSeparate(770,771,1,771);break;case BU:n.blendFunc(770,1);break;case UU:n.blendFuncSeparate(0,769,0,1);break;case jU:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",W);break}C=null,P=null,R=null,E=null,w=W,D=zt}return}Me=Me||De,bt=bt||ae,It=It||Re,(De!==M||Me!==L)&&(n.blendEquationSeparate(Te[De],Te[Me]),M=De,L=Me),(ae!==C||Re!==P||bt!==R||It!==E)&&(n.blendFuncSeparate(be[ae],be[Re],be[bt],be[It]),C=ae,P=Re,R=bt,E=It),w=W,D=null}function Ke(W,De){W.side===hh?Ue(2884):tt(2884);let ae=W.side===Ss;De&&(ae=!ae),ft(ae),W.blending===bv&&W.transparent===!1?Ye(Eh):Ye(W.blending,W.blendEquation,W.blendSrc,W.blendDst,W.blendEquationAlpha,W.blendSrcAlpha,W.blendDstAlpha,W.premultipliedAlpha),l.setFunc(W.depthFunc),l.setTest(W.depthTest),l.setMask(W.depthWrite),a.setMask(W.colorWrite);const Re=W.stencilWrite;u.setTest(Re),Re&&(u.setMask(W.stencilWriteMask),u.setFunc(W.stencilFunc,W.stencilRef,W.stencilFuncMask),u.setOp(W.stencilFail,W.stencilZFail,W.stencilZPass)),st(W.polygonOffset,W.polygonOffsetFactor,W.polygonOffsetUnits),W.alphaToCoverage===!0?tt(32926):Ue(32926)}function ft(W){N!==W&&(W?n.frontFace(2304):n.frontFace(2305),N=W)}function mt(W){W!==k3e?(tt(2884),W!==j&&(W===FU?n.cullFace(1029):W===I3e?n.cullFace(1028):n.cullFace(1032))):Ue(2884),j=W}function yt(W){W!==te&&(Z&&n.lineWidth(W),te=W)}function st(W,De,ae){W?(tt(32823),(ee!==De||H!==ae)&&(n.polygonOffset(De,ae),ee=De,H=ae)):Ue(32823)}function Ce(W){W?tt(3089):Ue(3089)}function ve(W){W===void 0&&(W=33984+Q-1),B!==W&&(n.activeTexture(W),B=W)}function k(W,De){B===null&&ve();let ae=U[B];ae===void 0&&(ae={type:void 0,texture:void 0},U[B]=ae),(ae.type!==W||ae.texture!==De)&&(n.bindTexture(W,De||oe[W]),ae.type=W,ae.texture=De)}function O(){const W=U[B];W!==void 0&&W.type!==void 0&&(n.bindTexture(W.type,null),W.type=void 0,W.texture=void 0)}function ie(){try{n.compressedTexImage2D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function ge(){try{n.texSubImage2D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function ye(){try{n.texSubImage3D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Pe(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Xe(){try{n.texStorage2D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function re(){try{n.texStorage3D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Fe(){try{n.texImage2D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Ne(){try{n.texImage3D.apply(n,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function He(W){fe.equals(W)===!1&&(n.scissor(W.x,W.y,W.z,W.w),fe.copy(W))}function Ie(W){we.equals(W)===!1&&(n.viewport(W.x,W.y,W.z,W.w),we.copy(W))}function nt(W,De){let ae=h.get(De);ae===void 0&&(ae=new WeakMap,h.set(De,ae));let Re=ae.get(W);Re===void 0&&(Re=n.getUniformBlockIndex(De,W.name),ae.set(W,Re))}function gt(W,De){const Re=h.get(De).get(W);c.get(W)!==Re&&(n.uniformBlockBinding(De,Re,W.__bindingPointIndex),c.set(W,Re))}function kt(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),i===!0&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},B=null,U={},m={},y=new WeakMap,_=[],g=null,b=!1,w=null,M=null,C=null,P=null,L=null,R=null,E=null,D=!1,N=null,j=null,te=null,ee=null,H=null,fe.set(0,0,n.canvas.width,n.canvas.height),we.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:tt,disable:Ue,bindFramebuffer:Ve,drawBuffers:Ae,useProgram:Oe,setBlending:Ye,setMaterial:Ke,setFlipSided:ft,setCullFace:mt,setLineWidth:yt,setPolygonOffset:st,setScissorTest:Ce,activeTexture:ve,bindTexture:k,unbindTexture:O,compressedTexImage2D:ie,texImage2D:Fe,texImage3D:Ne,updateUBOMapping:nt,uniformBlockBinding:gt,texStorage2D:Xe,texStorage3D:re,texSubImage2D:ge,texSubImage3D:ye,compressedTexSubImage2D:Pe,scissor:He,viewport:Ie,reset:kt}}function gDe(n,e,t,i,r,o,s){const a=r.isWebGL2,l=r.maxTextures,u=r.maxCubemapSize,c=r.maxTextureSize,h=r.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=/OculusBrowser/g.test(navigator.userAgent),y=new WeakMap;let _;const g=new WeakMap;let b=!1;try{b=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function w(k,O){return b?new OffscreenCanvas(k,O):eC("canvas")}function M(k,O,ie,ge){let ye=1;if((k.width>ge||k.height>ge)&&(ye=ge/Math.max(k.width,k.height)),ye<1||O===!0)if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap){const Pe=O?L4:Math.floor,Xe=Pe(ye*k.width),re=Pe(ye*k.height);_===void 0&&(_=w(Xe,re));const Fe=ie?w(Xe,re):_;return Fe.width=Xe,Fe.height=re,Fe.getContext("2d").drawImage(k,0,0,Xe,re),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+Xe+"x"+re+")."),Fe}else return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k;return k}function C(k){return g8(k.width)&&g8(k.height)}function P(k){return a?!1:k.wrapS!==ka||k.wrapT!==ka||k.minFilter!==Ho&&k.minFilter!==Gs}function L(k,O){return k.generateMipmaps&&O&&k.minFilter!==Ho&&k.minFilter!==Gs}function R(k){n.generateMipmap(k)}function E(k,O,ie,ge,ye=!1){if(a===!1)return O;if(k!==null){if(n[k]!==void 0)return n[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let Pe=O;return O===6403&&(ie===5126&&(Pe=33326),ie===5131&&(Pe=33325),ie===5121&&(Pe=33321)),O===33319&&(ie===5126&&(Pe=33328),ie===5131&&(Pe=33327),ie===5121&&(Pe=33323)),O===6408&&(ie===5126&&(Pe=34836),ie===5131&&(Pe=34842),ie===5121&&(Pe=ge===bi&&ye===!1?35907:32856),ie===32819&&(Pe=32854),ie===32820&&(Pe=32855)),(Pe===33325||Pe===33326||Pe===33327||Pe===33328||Pe===34842||Pe===34836)&&e.get("EXT_color_buffer_float"),Pe}function D(k,O,ie){return L(k,ie)===!0||k.isFramebufferTexture&&k.minFilter!==Ho&&k.minFilter!==Gs?Math.log2(Math.max(O.width,O.height))+1:k.mipmaps!==void 0&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?O.mipmaps.length:1}function N(k){return k===Ho||k===GU||k===XU?9728:9729}function j(k){const O=k.target;O.removeEventListener("dispose",j),ee(O),O.isVideoTexture&&y.delete(O)}function te(k){const O=k.target;O.removeEventListener("dispose",te),Q(O)}function ee(k){const O=i.get(k);if(O.__webglInit===void 0)return;const ie=k.source,ge=g.get(ie);if(ge){const ye=ge[O.__cacheKey];ye.usedTimes--,ye.usedTimes===0&&H(k),Object.keys(ge).length===0&&g.delete(ie)}i.remove(k)}function H(k){const O=i.get(k);n.deleteTexture(O.__webglTexture);const ie=k.source,ge=g.get(ie);delete ge[O.__cacheKey],s.memory.textures--}function Q(k){const O=k.texture,ie=i.get(k),ge=i.get(O);if(ge.__webglTexture!==void 0&&(n.deleteTexture(ge.__webglTexture),s.memory.textures--),k.depthTexture&&k.depthTexture.dispose(),k.isWebGLCubeRenderTarget)for(let ye=0;ye<6;ye++)n.deleteFramebuffer(ie.__webglFramebuffer[ye]),ie.__webglDepthbuffer&&n.deleteRenderbuffer(ie.__webglDepthbuffer[ye]);else{if(n.deleteFramebuffer(ie.__webglFramebuffer),ie.__webglDepthbuffer&&n.deleteRenderbuffer(ie.__webglDepthbuffer),ie.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ie.__webglMultisampledFramebuffer),ie.__webglColorRenderbuffer)for(let ye=0;ye<ie.__webglColorRenderbuffer.length;ye++)ie.__webglColorRenderbuffer[ye]&&n.deleteRenderbuffer(ie.__webglColorRenderbuffer[ye]);ie.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ie.__webglDepthRenderbuffer)}if(k.isWebGLMultipleRenderTargets)for(let ye=0,Pe=O.length;ye<Pe;ye++){const Xe=i.get(O[ye]);Xe.__webglTexture&&(n.deleteTexture(Xe.__webglTexture),s.memory.textures--),i.remove(O[ye])}i.remove(O),i.remove(k)}let Z=0;function de(){Z=0}function X(){const k=Z;return k>=l&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+l),Z+=1,k}function B(k){const O=[];return O.push(k.wrapS),O.push(k.wrapT),O.push(k.magFilter),O.push(k.minFilter),O.push(k.anisotropy),O.push(k.internalFormat),O.push(k.format),O.push(k.type),O.push(k.generateMipmaps),O.push(k.premultiplyAlpha),O.push(k.flipY),O.push(k.unpackAlignment),O.push(k.encoding),O.join()}function U(k,O){const ie=i.get(k);if(k.isVideoTexture&&Ce(k),k.isRenderTargetTexture===!1&&k.version>0&&ie.__version!==k.version){const ge=k.image;if(ge===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ge.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ue(ie,k,O);return}}t.activeTexture(33984+O),t.bindTexture(3553,ie.__webglTexture)}function le(k,O){const ie=i.get(k);if(k.version>0&&ie.__version!==k.version){Ue(ie,k,O);return}t.activeTexture(33984+O),t.bindTexture(35866,ie.__webglTexture)}function ne(k,O){const ie=i.get(k);if(k.version>0&&ie.__version!==k.version){Ue(ie,k,O);return}t.activeTexture(33984+O),t.bindTexture(32879,ie.__webglTexture)}function fe(k,O){const ie=i.get(k);if(k.version>0&&ie.__version!==k.version){Ve(ie,k,O);return}t.activeTexture(33984+O),t.bindTexture(34067,ie.__webglTexture)}const we={[T4]:10497,[ka]:33071,[P4]:33648},Be={[Ho]:9728,[GU]:9984,[XU]:9986,[Gs]:9729,[uEe]:9985,[Q3]:9987};function oe(k,O,ie){if(ie?(n.texParameteri(k,10242,we[O.wrapS]),n.texParameteri(k,10243,we[O.wrapT]),(k===32879||k===35866)&&n.texParameteri(k,32882,we[O.wrapR]),n.texParameteri(k,10240,Be[O.magFilter]),n.texParameteri(k,10241,Be[O.minFilter])):(n.texParameteri(k,10242,33071),n.texParameteri(k,10243,33071),(k===32879||k===35866)&&n.texParameteri(k,32882,33071),(O.wrapS!==ka||O.wrapT!==ka)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(k,10240,N(O.magFilter)),n.texParameteri(k,10241,N(O.minFilter)),O.minFilter!==Ho&&O.minFilter!==Gs&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const ge=e.get("EXT_texture_filter_anisotropic");if(O.type===cp&&e.has("OES_texture_float_linear")===!1||a===!1&&O.type===Jy&&e.has("OES_texture_half_float_linear")===!1)return;(O.anisotropy>1||i.get(O).__currentAnisotropy)&&(n.texParameterf(k,ge.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(O.anisotropy,r.getMaxAnisotropy())),i.get(O).__currentAnisotropy=O.anisotropy)}}function tt(k,O){let ie=!1;k.__webglInit===void 0&&(k.__webglInit=!0,O.addEventListener("dispose",j));const ge=O.source;let ye=g.get(ge);ye===void 0&&(ye={},g.set(ge,ye));const Pe=B(O);if(Pe!==k.__cacheKey){ye[Pe]===void 0&&(ye[Pe]={texture:n.createTexture(),usedTimes:0},s.memory.textures++,ie=!0),ye[Pe].usedTimes++;const Xe=ye[k.__cacheKey];Xe!==void 0&&(ye[k.__cacheKey].usedTimes--,Xe.usedTimes===0&&H(O)),k.__cacheKey=Pe,k.__webglTexture=ye[Pe].texture}return ie}function Ue(k,O,ie){let ge=3553;O.isDataArrayTexture&&(ge=35866),O.isData3DTexture&&(ge=32879);const ye=tt(k,O),Pe=O.source;if(t.activeTexture(33984+ie),t.bindTexture(ge,k.__webglTexture),Pe.version!==Pe.__currentVersion||ye===!0){n.pixelStorei(37440,O.flipY),n.pixelStorei(37441,O.premultiplyAlpha),n.pixelStorei(3317,O.unpackAlignment),n.pixelStorei(37443,0);const Xe=P(O)&&C(O.image)===!1;let re=M(O.image,Xe,!1,c);re=ve(O,re);const Fe=C(re)||a,Ne=o.convert(O.format,O.encoding);let He=o.convert(O.type),Ie=E(O.internalFormat,Ne,He,O.encoding,O.isVideoTexture);oe(ge,O,Fe);let nt;const gt=O.mipmaps,kt=a&&O.isVideoTexture!==!0,W=Pe.__currentVersion===void 0||ye===!0,De=D(O,re,Fe);if(O.isDepthTexture)Ie=6402,a?O.type===cp?Ie=36012:O.type===up?Ie=33190:O.type===wv?Ie=35056:Ie=33189:O.type===cp&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),O.format===yp&&Ie===6402&&O.type!==tY&&O.type!==up&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),O.type=up,He=o.convert(O.type)),O.format===ug&&Ie===6402&&(Ie=34041,O.type!==wv&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),O.type=wv,He=o.convert(O.type))),W&&(kt?t.texStorage2D(3553,1,Ie,re.width,re.height):t.texImage2D(3553,0,Ie,re.width,re.height,0,Ne,He,null));else if(O.isDataTexture)if(gt.length>0&&Fe){kt&&W&&t.texStorage2D(3553,De,Ie,gt[0].width,gt[0].height);for(let ae=0,Re=gt.length;ae<Re;ae++)nt=gt[ae],kt?t.texSubImage2D(3553,ae,0,0,nt.width,nt.height,Ne,He,nt.data):t.texImage2D(3553,ae,Ie,nt.width,nt.height,0,Ne,He,nt.data);O.generateMipmaps=!1}else kt?(W&&t.texStorage2D(3553,De,Ie,re.width,re.height),t.texSubImage2D(3553,0,0,0,re.width,re.height,Ne,He,re.data)):t.texImage2D(3553,0,Ie,re.width,re.height,0,Ne,He,re.data);else if(O.isCompressedTexture){kt&&W&&t.texStorage2D(3553,De,Ie,gt[0].width,gt[0].height);for(let ae=0,Re=gt.length;ae<Re;ae++)nt=gt[ae],O.format!==wl?Ne!==null?kt?t.compressedTexSubImage2D(3553,ae,0,0,nt.width,nt.height,Ne,nt.data):t.compressedTexImage2D(3553,ae,Ie,nt.width,nt.height,0,nt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kt?t.texSubImage2D(3553,ae,0,0,nt.width,nt.height,Ne,He,nt.data):t.texImage2D(3553,ae,Ie,nt.width,nt.height,0,Ne,He,nt.data)}else if(O.isDataArrayTexture)kt?(W&&t.texStorage3D(35866,De,Ie,re.width,re.height,re.depth),t.texSubImage3D(35866,0,0,0,0,re.width,re.height,re.depth,Ne,He,re.data)):t.texImage3D(35866,0,Ie,re.width,re.height,re.depth,0,Ne,He,re.data);else if(O.isData3DTexture)kt?(W&&t.texStorage3D(32879,De,Ie,re.width,re.height,re.depth),t.texSubImage3D(32879,0,0,0,0,re.width,re.height,re.depth,Ne,He,re.data)):t.texImage3D(32879,0,Ie,re.width,re.height,re.depth,0,Ne,He,re.data);else if(O.isFramebufferTexture){if(W)if(kt)t.texStorage2D(3553,De,Ie,re.width,re.height);else{let ae=re.width,Re=re.height;for(let Me=0;Me<De;Me++)t.texImage2D(3553,Me,Ie,ae,Re,0,Ne,He,null),ae>>=1,Re>>=1}}else if(gt.length>0&&Fe){kt&&W&&t.texStorage2D(3553,De,Ie,gt[0].width,gt[0].height);for(let ae=0,Re=gt.length;ae<Re;ae++)nt=gt[ae],kt?t.texSubImage2D(3553,ae,0,0,Ne,He,nt):t.texImage2D(3553,ae,Ie,Ne,He,nt);O.generateMipmaps=!1}else kt?(W&&t.texStorage2D(3553,De,Ie,re.width,re.height),t.texSubImage2D(3553,0,0,0,Ne,He,re)):t.texImage2D(3553,0,Ie,Ne,He,re);L(O,Fe)&&R(ge),Pe.__currentVersion=Pe.version,O.onUpdate&&O.onUpdate(O)}k.__version=O.version}function Ve(k,O,ie){if(O.image.length!==6)return;const ge=tt(k,O),ye=O.source;if(t.activeTexture(33984+ie),t.bindTexture(34067,k.__webglTexture),ye.version!==ye.__currentVersion||ge===!0){n.pixelStorei(37440,O.flipY),n.pixelStorei(37441,O.premultiplyAlpha),n.pixelStorei(3317,O.unpackAlignment),n.pixelStorei(37443,0);const Pe=O.isCompressedTexture||O.image[0].isCompressedTexture,Xe=O.image[0]&&O.image[0].isDataTexture,re=[];for(let ae=0;ae<6;ae++)!Pe&&!Xe?re[ae]=M(O.image[ae],!1,!0,u):re[ae]=Xe?O.image[ae].image:O.image[ae],re[ae]=ve(O,re[ae]);const Fe=re[0],Ne=C(Fe)||a,He=o.convert(O.format,O.encoding),Ie=o.convert(O.type),nt=E(O.internalFormat,He,Ie,O.encoding),gt=a&&O.isVideoTexture!==!0,kt=ye.__currentVersion===void 0||ge===!0;let W=D(O,Fe,Ne);oe(34067,O,Ne);let De;if(Pe){gt&&kt&&t.texStorage2D(34067,W,nt,Fe.width,Fe.height);for(let ae=0;ae<6;ae++){De=re[ae].mipmaps;for(let Re=0;Re<De.length;Re++){const Me=De[Re];O.format!==wl?He!==null?gt?t.compressedTexSubImage2D(34069+ae,Re,0,0,Me.width,Me.height,He,Me.data):t.compressedTexImage2D(34069+ae,Re,nt,Me.width,Me.height,0,Me.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):gt?t.texSubImage2D(34069+ae,Re,0,0,Me.width,Me.height,He,Ie,Me.data):t.texImage2D(34069+ae,Re,nt,Me.width,Me.height,0,He,Ie,Me.data)}}}else{De=O.mipmaps,gt&&kt&&(De.length>0&&W++,t.texStorage2D(34067,W,nt,re[0].width,re[0].height));for(let ae=0;ae<6;ae++)if(Xe){gt?t.texSubImage2D(34069+ae,0,0,0,re[ae].width,re[ae].height,He,Ie,re[ae].data):t.texImage2D(34069+ae,0,nt,re[ae].width,re[ae].height,0,He,Ie,re[ae].data);for(let Re=0;Re<De.length;Re++){const bt=De[Re].image[ae].image;gt?t.texSubImage2D(34069+ae,Re+1,0,0,bt.width,bt.height,He,Ie,bt.data):t.texImage2D(34069+ae,Re+1,nt,bt.width,bt.height,0,He,Ie,bt.data)}}else{gt?t.texSubImage2D(34069+ae,0,0,0,He,Ie,re[ae]):t.texImage2D(34069+ae,0,nt,He,Ie,re[ae]);for(let Re=0;Re<De.length;Re++){const Me=De[Re];gt?t.texSubImage2D(34069+ae,Re+1,0,0,He,Ie,Me.image[ae]):t.texImage2D(34069+ae,Re+1,nt,He,Ie,Me.image[ae])}}}L(O,Ne)&&R(34067),ye.__currentVersion=ye.version,O.onUpdate&&O.onUpdate(O)}k.__version=O.version}function Ae(k,O,ie,ge,ye){const Pe=o.convert(ie.format,ie.encoding),Xe=o.convert(ie.type),re=E(ie.internalFormat,Pe,Xe,ie.encoding);i.get(O).__hasExternalTextures||(ye===32879||ye===35866?t.texImage3D(ye,0,re,O.width,O.height,O.depth,0,Pe,Xe,null):t.texImage2D(ye,0,re,O.width,O.height,0,Pe,Xe,null)),t.bindFramebuffer(36160,k),st(O)?p.framebufferTexture2DMultisampleEXT(36160,ge,ye,i.get(ie).__webglTexture,0,yt(O)):n.framebufferTexture2D(36160,ge,ye,i.get(ie).__webglTexture,0),t.bindFramebuffer(36160,null)}function Oe(k,O,ie){if(n.bindRenderbuffer(36161,k),O.depthBuffer&&!O.stencilBuffer){let ge=33189;if(ie||st(O)){const ye=O.depthTexture;ye&&ye.isDepthTexture&&(ye.type===cp?ge=36012:ye.type===up&&(ge=33190));const Pe=yt(O);st(O)?p.renderbufferStorageMultisampleEXT(36161,Pe,ge,O.width,O.height):n.renderbufferStorageMultisample(36161,Pe,ge,O.width,O.height)}else n.renderbufferStorage(36161,ge,O.width,O.height);n.framebufferRenderbuffer(36160,36096,36161,k)}else if(O.depthBuffer&&O.stencilBuffer){const ge=yt(O);ie&&st(O)===!1?n.renderbufferStorageMultisample(36161,ge,35056,O.width,O.height):st(O)?p.renderbufferStorageMultisampleEXT(36161,ge,35056,O.width,O.height):n.renderbufferStorage(36161,34041,O.width,O.height),n.framebufferRenderbuffer(36160,33306,36161,k)}else{const ge=O.isWebGLMultipleRenderTargets===!0?O.texture:[O.texture];for(let ye=0;ye<ge.length;ye++){const Pe=ge[ye],Xe=o.convert(Pe.format,Pe.encoding),re=o.convert(Pe.type),Fe=E(Pe.internalFormat,Xe,re,Pe.encoding),Ne=yt(O);ie&&st(O)===!1?n.renderbufferStorageMultisample(36161,Ne,Fe,O.width,O.height):st(O)?p.renderbufferStorageMultisampleEXT(36161,Ne,Fe,O.width,O.height):n.renderbufferStorage(36161,Fe,O.width,O.height)}}n.bindRenderbuffer(36161,null)}function Te(k,O){if(O&&O.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,k),!(O.depthTexture&&O.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(O.depthTexture).__webglTexture||O.depthTexture.image.width!==O.width||O.depthTexture.image.height!==O.height)&&(O.depthTexture.image.width=O.width,O.depthTexture.image.height=O.height,O.depthTexture.needsUpdate=!0),U(O.depthTexture,0);const ge=i.get(O.depthTexture).__webglTexture,ye=yt(O);if(O.depthTexture.format===yp)st(O)?p.framebufferTexture2DMultisampleEXT(36160,36096,3553,ge,0,ye):n.framebufferTexture2D(36160,36096,3553,ge,0);else if(O.depthTexture.format===ug)st(O)?p.framebufferTexture2DMultisampleEXT(36160,33306,3553,ge,0,ye):n.framebufferTexture2D(36160,33306,3553,ge,0);else throw new Error("Unknown depthTexture format")}function be(k){const O=i.get(k),ie=k.isWebGLCubeRenderTarget===!0;if(k.depthTexture&&!O.__autoAllocateDepthBuffer){if(ie)throw new Error("target.depthTexture not supported in Cube render targets");Te(O.__webglFramebuffer,k)}else if(ie){O.__webglDepthbuffer=[];for(let ge=0;ge<6;ge++)t.bindFramebuffer(36160,O.__webglFramebuffer[ge]),O.__webglDepthbuffer[ge]=n.createRenderbuffer(),Oe(O.__webglDepthbuffer[ge],k,!1)}else t.bindFramebuffer(36160,O.__webglFramebuffer),O.__webglDepthbuffer=n.createRenderbuffer(),Oe(O.__webglDepthbuffer,k,!1);t.bindFramebuffer(36160,null)}function Ye(k,O,ie){const ge=i.get(k);O!==void 0&&Ae(ge.__webglFramebuffer,k,k.texture,36064,3553),ie!==void 0&&be(k)}function Ke(k){const O=k.texture,ie=i.get(k),ge=i.get(O);k.addEventListener("dispose",te),k.isWebGLMultipleRenderTargets!==!0&&(ge.__webglTexture===void 0&&(ge.__webglTexture=n.createTexture()),ge.__version=O.version,s.memory.textures++);const ye=k.isWebGLCubeRenderTarget===!0,Pe=k.isWebGLMultipleRenderTargets===!0,Xe=C(k)||a;if(ye){ie.__webglFramebuffer=[];for(let re=0;re<6;re++)ie.__webglFramebuffer[re]=n.createFramebuffer()}else{if(ie.__webglFramebuffer=n.createFramebuffer(),Pe)if(r.drawBuffers){const re=k.texture;for(let Fe=0,Ne=re.length;Fe<Ne;Fe++){const He=i.get(re[Fe]);He.__webglTexture===void 0&&(He.__webglTexture=n.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&k.samples>0&&st(k)===!1){const re=Pe?O:[O];ie.__webglMultisampledFramebuffer=n.createFramebuffer(),ie.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,ie.__webglMultisampledFramebuffer);for(let Fe=0;Fe<re.length;Fe++){const Ne=re[Fe];ie.__webglColorRenderbuffer[Fe]=n.createRenderbuffer(),n.bindRenderbuffer(36161,ie.__webglColorRenderbuffer[Fe]);const He=o.convert(Ne.format,Ne.encoding),Ie=o.convert(Ne.type),nt=E(Ne.internalFormat,He,Ie,Ne.encoding),gt=yt(k);n.renderbufferStorageMultisample(36161,gt,nt,k.width,k.height),n.framebufferRenderbuffer(36160,36064+Fe,36161,ie.__webglColorRenderbuffer[Fe])}n.bindRenderbuffer(36161,null),k.depthBuffer&&(ie.__webglDepthRenderbuffer=n.createRenderbuffer(),Oe(ie.__webglDepthRenderbuffer,k,!0)),t.bindFramebuffer(36160,null)}}if(ye){t.bindTexture(34067,ge.__webglTexture),oe(34067,O,Xe);for(let re=0;re<6;re++)Ae(ie.__webglFramebuffer[re],k,O,36064,34069+re);L(O,Xe)&&R(34067),t.unbindTexture()}else if(Pe){const re=k.texture;for(let Fe=0,Ne=re.length;Fe<Ne;Fe++){const He=re[Fe],Ie=i.get(He);t.bindTexture(3553,Ie.__webglTexture),oe(3553,He,Xe),Ae(ie.__webglFramebuffer,k,He,36064+Fe,3553),L(He,Xe)&&R(3553)}t.unbindTexture()}else{let re=3553;(k.isWebGL3DRenderTarget||k.isWebGLArrayRenderTarget)&&(a?re=k.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(re,ge.__webglTexture),oe(re,O,Xe),Ae(ie.__webglFramebuffer,k,O,36064,re),L(O,Xe)&&R(re),t.unbindTexture()}k.depthBuffer&&be(k)}function ft(k){const O=C(k)||a,ie=k.isWebGLMultipleRenderTargets===!0?k.texture:[k.texture];for(let ge=0,ye=ie.length;ge<ye;ge++){const Pe=ie[ge];if(L(Pe,O)){const Xe=k.isWebGLCubeRenderTarget?34067:3553,re=i.get(Pe).__webglTexture;t.bindTexture(Xe,re),R(Xe),t.unbindTexture()}}}function mt(k){if(a&&k.samples>0&&st(k)===!1){const O=k.isWebGLMultipleRenderTargets?k.texture:[k.texture],ie=k.width,ge=k.height;let ye=16384;const Pe=[],Xe=k.stencilBuffer?33306:36096,re=i.get(k),Fe=k.isWebGLMultipleRenderTargets===!0;if(Fe)for(let Ne=0;Ne<O.length;Ne++)t.bindFramebuffer(36160,re.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Ne,36161,null),t.bindFramebuffer(36160,re.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Ne,3553,null,0);t.bindFramebuffer(36008,re.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,re.__webglFramebuffer);for(let Ne=0;Ne<O.length;Ne++){Pe.push(36064+Ne),k.depthBuffer&&Pe.push(Xe);const He=re.__ignoreDepthValues!==void 0?re.__ignoreDepthValues:!1;if(He===!1&&(k.depthBuffer&&(ye|=256),k.stencilBuffer&&(ye|=1024)),Fe&&n.framebufferRenderbuffer(36008,36064,36161,re.__webglColorRenderbuffer[Ne]),He===!0&&(n.invalidateFramebuffer(36008,[Xe]),n.invalidateFramebuffer(36009,[Xe])),Fe){const Ie=i.get(O[Ne]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,Ie,0)}n.blitFramebuffer(0,0,ie,ge,0,0,ie,ge,ye,9728),m&&n.invalidateFramebuffer(36008,Pe)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),Fe)for(let Ne=0;Ne<O.length;Ne++){t.bindFramebuffer(36160,re.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Ne,36161,re.__webglColorRenderbuffer[Ne]);const He=i.get(O[Ne]).__webglTexture;t.bindFramebuffer(36160,re.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Ne,3553,He,0)}t.bindFramebuffer(36009,re.__webglMultisampledFramebuffer)}}function yt(k){return Math.min(h,k.samples)}function st(k){const O=i.get(k);return a&&k.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&O.__useRenderToTexture!==!1}function Ce(k){const O=s.render.frame;y.get(k)!==O&&(y.set(k,O),k.update())}function ve(k,O){const ie=k.encoding,ge=k.format,ye=k.type;return k.isCompressedTexture===!0||k.isVideoTexture===!0||k.format===A4||ie!==Np&&(ie===bi?a===!1?e.has("EXT_sRGB")===!0&&ge===wl?(k.format=A4,k.minFilter=Gs,k.generateMipmaps=!1):O=rY.sRGBToLinear(O):(ge!==wl||ye!==Ip)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ie)),O}this.allocateTextureUnit=X,this.resetTextureUnits=de,this.setTexture2D=U,this.setTexture2DArray=le,this.setTexture3D=ne,this.setTextureCube=fe,this.rebindTextures=Ye,this.setupRenderTarget=Ke,this.updateRenderTargetMipmap=ft,this.updateMultisampleRenderTarget=mt,this.setupDepthRenderbuffer=be,this.setupFrameBufferTexture=Ae,this.useMultisampledRTT=st}function _De(n,e,t){const i=t.isWebGL2;function r(o,s=null){let a;if(o===Ip)return 5121;if(o===pEe)return 32819;if(o===fEe)return 32820;if(o===cEe)return 5120;if(o===hEe)return 5122;if(o===tY)return 5123;if(o===dEe)return 5124;if(o===up)return 5125;if(o===cp)return 5126;if(o===Jy)return i?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(o===mEe)return 6406;if(o===wl)return 6408;if(o===gEe)return 6409;if(o===_Ee)return 6410;if(o===yp)return 6402;if(o===ug)return 34041;if(o===yEe)return 6403;if(o===vEe)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(o===A4)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(o===xEe)return 36244;if(o===bEe)return 33319;if(o===wEe)return 33320;if(o===SEe)return 36249;if(o===dL||o===pL||o===fL||o===mL)if(s===bi)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(o===dL)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(o===pL)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(o===fL)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(o===mL)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(o===dL)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===pL)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===fL)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===mL)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===qU||o===YU||o===KU||o===ZU)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(o===qU)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===YU)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===KU)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===ZU)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===MEe)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(o===JU||o===QU)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(o===JU)return s===bi?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(o===QU)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(o===$U||o===e8||o===t8||o===n8||o===i8||o===r8||o===o8||o===s8||o===a8||o===l8||o===u8||o===c8||o===h8||o===d8)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(o===$U)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(o===e8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(o===t8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(o===n8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(o===i8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(o===r8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(o===o8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(o===s8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(o===a8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(o===l8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(o===u8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(o===c8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(o===h8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(o===d8)return s===bi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(o===p8)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(o===p8)return s===bi?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return o===wv?i?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[o]!==void 0?n[o]:null}return{convert:r}}class yDe extends Xs{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class JS extends Er{constructor(){super(),this.isGroup=!0,this.type="Group"}}const xDe={type:"move"};class HL{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new JS,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new JS,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ee,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ee),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new JS,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ee,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ee),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,o=null,s=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){s=!0;for(const _ of e.hand.values()){const g=t.getJointPose(_,i);if(u.joints[_.jointName]===void 0){const w=new JS;w.matrixAutoUpdate=!1,w.visible=!1,u.joints[_.jointName]=w,u.add(w)}const b=u.joints[_.jointName];g!==null&&(b.matrix.fromArray(g.transform.matrix),b.matrix.decompose(b.position,b.rotation,b.scale),b.jointRadius=g.radius),b.visible=g!==null}const c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],p=c.position.distanceTo(h.position),m=.02,y=.005;u.inputState.pinching&&p>m+y?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&p<=m-y&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),o!==null&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&o!==null&&(r=o),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(xDe)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=o!==null),u!==null&&(u.visible=s!==null),this}}class bDe extends Xa{constructor(e,t,i,r,o,s,a,l,u,c){if(c=c!==void 0?c:yp,c!==yp&&c!==ug)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&c===yp&&(i=up),i===void 0&&c===ug&&(i=wv),super(null,r,o,s,a,l,c,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Ho,this.minFilter=l!==void 0?l:Ho,this.flipY=!1,this.generateMipmaps=!1}}class wDe extends Ug{constructor(e,t){super();const i=this;let r=null,o=1,s=null,a="local-floor",l=null,u=null,c=null,h=null,p=null,m=null;const y=t.getContextAttributes();let _=null,g=null;const b=[],w=[],M=new Xs;M.layers.enable(1),M.viewport=new Mr;const C=new Xs;C.layers.enable(2),C.viewport=new Mr;const P=[M,C],L=new yDe;L.layers.enable(1),L.layers.enable(2);let R=null,E=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(B){let U=b[B];return U===void 0&&(U=new HL,b[B]=U),U.getTargetRaySpace()},this.getControllerGrip=function(B){let U=b[B];return U===void 0&&(U=new HL,b[B]=U),U.getGripSpace()},this.getHand=function(B){let U=b[B];return U===void 0&&(U=new HL,b[B]=U),U.getHandSpace()};function D(B){const U=w.indexOf(B.inputSource);if(U===-1)return;const le=b[U];le!==void 0&&le.dispatchEvent({type:B.type,data:B.inputSource})}function N(){r.removeEventListener("select",D),r.removeEventListener("selectstart",D),r.removeEventListener("selectend",D),r.removeEventListener("squeeze",D),r.removeEventListener("squeezestart",D),r.removeEventListener("squeezeend",D),r.removeEventListener("end",N),r.removeEventListener("inputsourceschange",j);for(let B=0;B<b.length;B++){const U=w[B];U!==null&&(w[B]=null,b[B].disconnect(U))}R=null,E=null,e.setRenderTarget(_),p=null,h=null,c=null,r=null,g=null,X.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(B){o=B,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(B){a=B,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(B){l=B},this.getBaseLayer=function(){return h!==null?h:p},this.getBinding=function(){return c},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=async function(B){if(r=B,r!==null){if(_=e.getRenderTarget(),r.addEventListener("select",D),r.addEventListener("selectstart",D),r.addEventListener("selectend",D),r.addEventListener("squeeze",D),r.addEventListener("squeezestart",D),r.addEventListener("squeezeend",D),r.addEventListener("end",N),r.addEventListener("inputsourceschange",j),y.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const U={antialias:r.renderState.layers===void 0?y.antialias:!0,alpha:y.alpha,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:o};p=new XRWebGLLayer(r,t,U),r.updateRenderState({baseLayer:p}),g=new zp(p.framebufferWidth,p.framebufferHeight,{format:wl,type:Ip,encoding:e.outputEncoding,stencilBuffer:y.stencil})}else{let U=null,le=null,ne=null;y.depth&&(ne=y.stencil?35056:33190,U=y.stencil?ug:yp,le=y.stencil?wv:up);const fe={colorFormat:32856,depthFormat:ne,scaleFactor:o};c=new XRWebGLBinding(r,t),h=c.createProjectionLayer(fe),r.updateRenderState({layers:[h]}),g=new zp(h.textureWidth,h.textureHeight,{format:wl,type:Ip,depthTexture:new bDe(h.textureWidth,h.textureHeight,le,void 0,void 0,void 0,void 0,void 0,void 0,U),stencilBuffer:y.stencil,encoding:e.outputEncoding,samples:y.antialias?4:0});const we=e.properties.get(g);we.__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(1),l=null,s=await r.requestReferenceSpace(a),X.setContext(r),X.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function j(B){for(let U=0;U<B.removed.length;U++){const le=B.removed[U],ne=w.indexOf(le);ne>=0&&(w[ne]=null,b[ne].dispatchEvent({type:"disconnected",data:le}))}for(let U=0;U<B.added.length;U++){const le=B.added[U];let ne=w.indexOf(le);if(ne===-1){for(let we=0;we<b.length;we++)if(we>=w.length){w.push(le),ne=we;break}else if(w[we]===null){w[we]=le,ne=we;break}if(ne===-1)break}const fe=b[ne];fe&&fe.dispatchEvent({type:"connected",data:le})}}const te=new Ee,ee=new Ee;function H(B,U,le){te.setFromMatrixPosition(U.matrixWorld),ee.setFromMatrixPosition(le.matrixWorld);const ne=te.distanceTo(ee),fe=U.projectionMatrix.elements,we=le.projectionMatrix.elements,Be=fe[14]/(fe[10]-1),oe=fe[14]/(fe[10]+1),tt=(fe[9]+1)/fe[5],Ue=(fe[9]-1)/fe[5],Ve=(fe[8]-1)/fe[0],Ae=(we[8]+1)/we[0],Oe=Be*Ve,Te=Be*Ae,be=ne/(-Ve+Ae),Ye=be*-Ve;U.matrixWorld.decompose(B.position,B.quaternion,B.scale),B.translateX(Ye),B.translateZ(be),B.matrixWorld.compose(B.position,B.quaternion,B.scale),B.matrixWorldInverse.copy(B.matrixWorld).invert();const Ke=Be+be,ft=oe+be,mt=Oe-Ye,yt=Te+(ne-Ye),st=tt*oe/ft*Ke,Ce=Ue*oe/ft*Ke;B.projectionMatrix.makePerspective(mt,yt,st,Ce,Ke,ft)}function Q(B,U){U===null?B.matrixWorld.copy(B.matrix):B.matrixWorld.multiplyMatrices(U.matrixWorld,B.matrix),B.matrixWorldInverse.copy(B.matrixWorld).invert()}this.updateCamera=function(B){if(r===null)return;L.near=C.near=M.near=B.near,L.far=C.far=M.far=B.far,(R!==L.near||E!==L.far)&&(r.updateRenderState({depthNear:L.near,depthFar:L.far}),R=L.near,E=L.far);const U=B.parent,le=L.cameras;Q(L,U);for(let fe=0;fe<le.length;fe++)Q(le[fe],U);L.matrixWorld.decompose(L.position,L.quaternion,L.scale),B.matrix.copy(L.matrix),B.matrix.decompose(B.position,B.quaternion,B.scale);const ne=B.children;for(let fe=0,we=ne.length;fe<we;fe++)ne[fe].updateMatrixWorld(!0);le.length===2?H(L,M,C):L.projectionMatrix.copy(M.projectionMatrix)},this.getCamera=function(){return L},this.getFoveation=function(){if(h!==null)return h.fixedFoveation;if(p!==null)return p.fixedFoveation},this.setFoveation=function(B){h!==null&&(h.fixedFoveation=B),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=B)};let Z=null;function de(B,U){if(u=U.getViewerPose(l||s),m=U,u!==null){const le=u.views;p!==null&&(e.setRenderTargetFramebuffer(g,p.framebuffer),e.setRenderTarget(g));let ne=!1;le.length!==L.cameras.length&&(L.cameras.length=0,ne=!0);for(let fe=0;fe<le.length;fe++){const we=le[fe];let Be=null;if(p!==null)Be=p.getViewport(we);else{const tt=c.getViewSubImage(h,we);Be=tt.viewport,fe===0&&(e.setRenderTargetTextures(g,tt.colorTexture,h.ignoreDepthValues?void 0:tt.depthStencilTexture),e.setRenderTarget(g))}let oe=P[fe];oe===void 0&&(oe=new Xs,oe.layers.enable(fe),oe.viewport=new Mr,P[fe]=oe),oe.matrix.fromArray(we.transform.matrix),oe.projectionMatrix.fromArray(we.projectionMatrix),oe.viewport.set(Be.x,Be.y,Be.width,Be.height),fe===0&&L.matrix.copy(oe.matrix),ne===!0&&L.cameras.push(oe)}}for(let le=0;le<b.length;le++){const ne=w[le],fe=b[le];ne!==null&&fe!==void 0&&fe.update(ne,U,l||s)}Z&&Z(B,U),m=null}const X=new mY;X.setAnimationLoop(de),this.setAnimationLoop=function(B){Z=B},this.dispose=function(){}}}function SDe(n,e){function t(_,g){_.fogColor.value.copy(g.color),g.isFog?(_.fogNear.value=g.near,_.fogFar.value=g.far):g.isFogExp2&&(_.fogDensity.value=g.density)}function i(_,g,b,w,M){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(_,g):g.isMeshToonMaterial?(r(_,g),c(_,g)):g.isMeshPhongMaterial?(r(_,g),u(_,g)):g.isMeshStandardMaterial?(r(_,g),h(_,g),g.isMeshPhysicalMaterial&&p(_,g,M)):g.isMeshMatcapMaterial?(r(_,g),m(_,g)):g.isMeshDepthMaterial?r(_,g):g.isMeshDistanceMaterial?(r(_,g),y(_,g)):g.isMeshNormalMaterial?r(_,g):g.isLineBasicMaterial?(o(_,g),g.isLineDashedMaterial&&s(_,g)):g.isPointsMaterial?a(_,g,b,w):g.isSpriteMaterial?l(_,g):g.isShadowMaterial?(_.color.value.copy(g.color),_.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function r(_,g){_.opacity.value=g.opacity,g.color&&_.diffuse.value.copy(g.color),g.emissive&&_.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Ss&&(_.bumpScale.value*=-1)),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias),g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Ss&&_.normalScale.value.negate()),g.specularMap&&(_.specularMap.value=g.specularMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);const b=e.get(g).envMap;if(b&&(_.envMap.value=b,_.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=g.reflectivity,_.ior.value=g.ior,_.refractionRatio.value=g.refractionRatio),g.lightMap){_.lightMap.value=g.lightMap;const C=n.physicallyCorrectLights!==!0?Math.PI:1;_.lightMapIntensity.value=g.lightMapIntensity*C}g.aoMap&&(_.aoMap.value=g.aoMap,_.aoMapIntensity.value=g.aoMapIntensity);let w;g.map?w=g.map:g.specularMap?w=g.specularMap:g.displacementMap?w=g.displacementMap:g.normalMap?w=g.normalMap:g.bumpMap?w=g.bumpMap:g.roughnessMap?w=g.roughnessMap:g.metalnessMap?w=g.metalnessMap:g.alphaMap?w=g.alphaMap:g.emissiveMap?w=g.emissiveMap:g.clearcoatMap?w=g.clearcoatMap:g.clearcoatNormalMap?w=g.clearcoatNormalMap:g.clearcoatRoughnessMap?w=g.clearcoatRoughnessMap:g.iridescenceMap?w=g.iridescenceMap:g.iridescenceThicknessMap?w=g.iridescenceThicknessMap:g.specularIntensityMap?w=g.specularIntensityMap:g.specularColorMap?w=g.specularColorMap:g.transmissionMap?w=g.transmissionMap:g.thicknessMap?w=g.thicknessMap:g.sheenColorMap?w=g.sheenColorMap:g.sheenRoughnessMap&&(w=g.sheenRoughnessMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),_.uvTransform.value.copy(w.matrix));let M;g.aoMap?M=g.aoMap:g.lightMap&&(M=g.lightMap),M!==void 0&&(M.isWebGLRenderTarget&&(M=M.texture),M.matrixAutoUpdate===!0&&M.updateMatrix(),_.uv2Transform.value.copy(M.matrix))}function o(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity}function s(_,g){_.dashSize.value=g.dashSize,_.totalSize.value=g.dashSize+g.gapSize,_.scale.value=g.scale}function a(_,g,b,w){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.size.value=g.size*b,_.scale.value=w*.5,g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);let M;g.map?M=g.map:g.alphaMap&&(M=g.alphaMap),M!==void 0&&(M.matrixAutoUpdate===!0&&M.updateMatrix(),_.uvTransform.value.copy(M.matrix))}function l(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.rotation.value=g.rotation,g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);let b;g.map?b=g.map:g.alphaMap&&(b=g.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),_.uvTransform.value.copy(b.matrix))}function u(_,g){_.specular.value.copy(g.specular),_.shininess.value=Math.max(g.shininess,1e-4)}function c(_,g){g.gradientMap&&(_.gradientMap.value=g.gradientMap)}function h(_,g){_.roughness.value=g.roughness,_.metalness.value=g.metalness,g.roughnessMap&&(_.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(_.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(_.envMapIntensity.value=g.envMapIntensity)}function p(_,g,b){_.ior.value=g.ior,g.sheen>0&&(_.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),_.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(_.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(_.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(_.clearcoat.value=g.clearcoat,_.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(_.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),_.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===Ss&&_.clearcoatNormalScale.value.negate())),g.iridescence>0&&(_.iridescence.value=g.iridescence,_.iridescenceIOR.value=g.iridescenceIOR,_.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(_.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(_.transmission.value=g.transmission,_.transmissionSamplerMap.value=b.texture,_.transmissionSamplerSize.value.set(b.width,b.height),g.transmissionMap&&(_.transmissionMap.value=g.transmissionMap),_.thickness.value=g.thickness,g.thicknessMap&&(_.thicknessMap.value=g.thicknessMap),_.attenuationDistance.value=g.attenuationDistance,_.attenuationColor.value.copy(g.attenuationColor)),_.specularIntensity.value=g.specularIntensity,_.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(_.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(_.specularColorMap.value=g.specularColorMap)}function m(_,g){g.matcap&&(_.matcap.value=g.matcap)}function y(_,g){_.referencePosition.value.copy(g.referencePosition),_.nearDistance.value=g.nearDistance,_.farDistance.value=g.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:i}}function MDe(n,e,t,i){let r={},o={},s=[];const a=t.isWebGL2?n.getParameter(35375):0;function l(w,M){const C=M.program;i.uniformBlockBinding(w,C)}function u(w,M){let C=r[w.id];C===void 0&&(y(w),C=c(w),r[w.id]=C,w.addEventListener("dispose",g));const P=M.program;i.updateUBOMapping(w,P);const L=e.render.frame;o[w.id]!==L&&(p(w),o[w.id]=L)}function c(w){const M=h();w.__bindingPointIndex=M;const C=n.createBuffer(),P=w.__size,L=w.usage;return n.bindBuffer(35345,C),n.bufferData(35345,P,L),n.bindBuffer(35345,null),n.bindBufferBase(35345,M,C),C}function h(){for(let w=0;w<a;w++)if(s.indexOf(w)===-1)return s.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(w){const M=r[w.id],C=w.uniforms,P=w.__cache;n.bindBuffer(35345,M);for(let L=0,R=C.length;L<R;L++){const E=C[L];if(m(E,L,P)===!0){const D=E.value,N=E.__offset;typeof D=="number"?(E.__data[0]=D,n.bufferSubData(35345,N,E.__data)):(E.value.isMatrix3?(E.__data[0]=E.value.elements[0],E.__data[1]=E.value.elements[1],E.__data[2]=E.value.elements[2],E.__data[3]=E.value.elements[0],E.__data[4]=E.value.elements[3],E.__data[5]=E.value.elements[4],E.__data[6]=E.value.elements[5],E.__data[7]=E.value.elements[0],E.__data[8]=E.value.elements[6],E.__data[9]=E.value.elements[7],E.__data[10]=E.value.elements[8],E.__data[11]=E.value.elements[0]):D.toArray(E.__data),n.bufferSubData(35345,N,E.__data))}}n.bindBuffer(35345,null)}function m(w,M,C){const P=w.value;if(C[M]===void 0)return typeof P=="number"?C[M]=P:C[M]=P.clone(),!0;if(typeof P=="number"){if(C[M]!==P)return C[M]=P,!0}else{const L=C[M];if(L.equals(P)===!1)return L.copy(P),!0}return!1}function y(w){const M=w.uniforms;let C=0;const P=16;let L=0;for(let R=0,E=M.length;R<E;R++){const D=M[R],N=_(D);if(D.__data=new Float32Array(N.storage/Float32Array.BYTES_PER_ELEMENT),D.__offset=C,R>0){L=C%P;const j=P-L;L!==0&&j-N.boundary<0&&(C+=P-L,D.__offset=C)}C+=N.storage}return L=C%P,L>0&&(C+=P-L),w.__size=C,w.__cache={},this}function _(w){const M=w.value,C={boundary:0,storage:0};return typeof M=="number"?(C.boundary=4,C.storage=4):M.isVector2?(C.boundary=8,C.storage=8):M.isVector3||M.isColor?(C.boundary=16,C.storage=12):M.isVector4?(C.boundary=16,C.storage=16):M.isMatrix3?(C.boundary=48,C.storage=48):M.isMatrix4?(C.boundary=64,C.storage=64):M.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",M),C}function g(w){const M=w.target;M.removeEventListener("dispose",g);const C=s.indexOf(M.__bindingPointIndex);s.splice(C,1),n.deleteBuffer(r[M.id]),delete r[M.id],delete o[M.id]}function b(){for(const w in r)n.deleteBuffer(r[w]);s=[],r={},o={}}return{bind:l,update:u,dispose:b}}function CDe(){const n=eC("canvas");return n.style.display="block",n}function bY(n={}){this.isWebGLRenderer=!0;const e=n.canvas!==void 0?n.canvas:CDe(),t=n.context!==void 0?n.context:null,i=n.depth!==void 0?n.depth:!0,r=n.stencil!==void 0?n.stencil:!0,o=n.antialias!==void 0?n.antialias:!1,s=n.premultipliedAlpha!==void 0?n.premultipliedAlpha:!0,a=n.preserveDrawingBuffer!==void 0?n.preserveDrawingBuffer:!1,l=n.powerPreference!==void 0?n.powerPreference:"default",u=n.failIfMajorPerformanceCaveat!==void 0?n.failIfMajorPerformanceCaveat:!1;let c;t!==null?c=t.getContextAttributes().alpha:c=n.alpha!==void 0?n.alpha:!1;let h=null,p=null;const m=[],y=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Np,this.physicallyCorrectLights=!1,this.toneMapping=qu,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const _=this;let g=!1,b=0,w=0,M=null,C=-1,P=null;const L=new Mr,R=new Mr;let E=null,D=e.width,N=e.height,j=1,te=null,ee=null;const H=new Mr(0,0,D,N),Q=new Mr(0,0,D,N);let Z=!1;const de=new RI;let X=!1,B=!1,U=null;const le=new qi,ne=new zn,fe=new Ee,we={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Be(){return M===null?j:1}let oe=t;function tt(z,$){for(let se=0;se<z.length;se++){const J=z[se],he=e.getContext(J,$);if(he!==null)return he}return null}try{const z={alpha:!0,depth:i,stencil:r,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${DI}`),e.addEventListener("webglcontextlost",nt,!1),e.addEventListener("webglcontextrestored",gt,!1),e.addEventListener("webglcontextcreationerror",kt,!1),oe===null){const $=["webgl2","webgl","experimental-webgl"];if(_.isWebGL1Renderer===!0&&$.shift(),oe=tt($,z),oe===null)throw tt($)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}oe.getShaderPrecisionFormat===void 0&&(oe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(z){throw console.error("THREE.WebGLRenderer: "+z.message),z}let Ue,Ve,Ae,Oe,Te,be,Ye,Ke,ft,mt,yt,st,Ce,ve,k,O,ie,ge,ye,Pe,Xe,re,Fe,Ne;function He(){Ue=new NAe(oe),Ve=new LAe(oe,Ue,n),Ue.init(Ve),re=new _De(oe,Ue,Ve),Ae=new vDe(oe,Ue,Ve),Oe=new FAe,Te=new nDe,be=new gDe(oe,Ue,Ae,Te,Ve,re,Oe),Ye=new RAe(_),Ke=new IAe(_),ft=new ZEe(oe,Ve),Fe=new PAe(oe,Ue,ft,Ve),mt=new zAe(oe,ft,Oe,Fe),yt=new HAe(oe,mt,ft,Oe),ye=new jAe(oe,Ve,be),O=new DAe(Te),st=new tDe(_,Ye,Ke,Ue,Ve,Fe,O),Ce=new SDe(_,Te),ve=new rDe,k=new cDe(Ue,Ve),ge=new TAe(_,Ye,Ae,yt,c,s),ie=new mDe(_,yt,Ve),Ne=new MDe(oe,Oe,Ve,Ae),Pe=new AAe(oe,Ue,Oe,Ve),Xe=new VAe(oe,Ue,Oe,Ve),Oe.programs=st.programs,_.capabilities=Ve,_.extensions=Ue,_.properties=Te,_.renderLists=ve,_.shadowMap=ie,_.state=Ae,_.info=Oe}He();const Ie=new wDe(_,oe);this.xr=Ie,this.getContext=function(){return oe},this.getContextAttributes=function(){return oe.getContextAttributes()},this.forceContextLoss=function(){const z=Ue.get("WEBGL_lose_context");z&&z.loseContext()},this.forceContextRestore=function(){const z=Ue.get("WEBGL_lose_context");z&&z.restoreContext()},this.getPixelRatio=function(){return j},this.setPixelRatio=function(z){z!==void 0&&(j=z,this.setSize(D,N,!1))},this.getSize=function(z){return z.set(D,N)},this.setSize=function(z,$,se){if(Ie.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}D=z,N=$,e.width=Math.floor(z*j),e.height=Math.floor($*j),se!==!1&&(e.style.width=z+"px",e.style.height=$+"px"),this.setViewport(0,0,z,$)},this.getDrawingBufferSize=function(z){return z.set(D*j,N*j).floor()},this.setDrawingBufferSize=function(z,$,se){D=z,N=$,j=se,e.width=Math.floor(z*se),e.height=Math.floor($*se),this.setViewport(0,0,z,$)},this.getCurrentViewport=function(z){return z.copy(L)},this.getViewport=function(z){return z.copy(H)},this.setViewport=function(z,$,se,J){z.isVector4?H.set(z.x,z.y,z.z,z.w):H.set(z,$,se,J),Ae.viewport(L.copy(H).multiplyScalar(j).floor())},this.getScissor=function(z){return z.copy(Q)},this.setScissor=function(z,$,se,J){z.isVector4?Q.set(z.x,z.y,z.z,z.w):Q.set(z,$,se,J),Ae.scissor(R.copy(Q).multiplyScalar(j).floor())},this.getScissorTest=function(){return Z},this.setScissorTest=function(z){Ae.setScissorTest(Z=z)},this.setOpaqueSort=function(z){te=z},this.setTransparentSort=function(z){ee=z},this.getClearColor=function(z){return z.copy(ge.getClearColor())},this.setClearColor=function(){ge.setClearColor.apply(ge,arguments)},this.getClearAlpha=function(){return ge.getClearAlpha()},this.setClearAlpha=function(){ge.setClearAlpha.apply(ge,arguments)},this.clear=function(z=!0,$=!0,se=!0){let J=0;z&&(J|=16384),$&&(J|=256),se&&(J|=1024),oe.clear(J)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",nt,!1),e.removeEventListener("webglcontextrestored",gt,!1),e.removeEventListener("webglcontextcreationerror",kt,!1),ve.dispose(),k.dispose(),Te.dispose(),Ye.dispose(),Ke.dispose(),yt.dispose(),Fe.dispose(),Ne.dispose(),st.dispose(),Ie.dispose(),Ie.removeEventListener("sessionstart",bt),Ie.removeEventListener("sessionend",It),U&&(U.dispose(),U=null),zt.stop()};function nt(z){z.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function gt(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const z=Oe.autoReset,$=ie.enabled,se=ie.autoUpdate,J=ie.needsUpdate,he=ie.type;He(),Oe.autoReset=z,ie.enabled=$,ie.autoUpdate=se,ie.needsUpdate=J,ie.type=he}function kt(z){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",z.statusMessage)}function W(z){const $=z.target;$.removeEventListener("dispose",W),De($)}function De(z){ae(z),Te.remove(z)}function ae(z){const $=Te.get(z).programs;$!==void 0&&($.forEach(function(se){st.releaseProgram(se)}),z.isShaderMaterial&&st.releaseShaderCache(z))}this.renderBufferDirect=function(z,$,se,J,he,Ge){$===null&&($=we);const et=he.isMesh&&he.matrixWorld.determinant()<0,$e=Qh(z,$,se,J,he);Ae.setMaterial(J,et);let rt=se.index;const Ct=se.attributes.position;if(rt===null){if(Ct===void 0||Ct.count===0)return}else if(rt.count===0)return;let ct=1;J.wireframe===!0&&(rt=mt.getWireframeAttribute(se),ct=2),Fe.setup(he,J,$e,se,rt);let ht,Ft=Pe;rt!==null&&(ht=ft.get(rt),Ft=Xe,Ft.setIndex(ht));const Ki=rt!==null?rt.count:Ct.count,Pi=se.drawRange.start*ct,ti=se.drawRange.count*ct,vn=Ge!==null?Ge.start*ct:0,wt=Ge!==null?Ge.count*ct:1/0,Ar=Math.max(Pi,vn),xn=Math.min(Ki,Pi+ti,vn+wt)-1,bn=Math.max(0,xn-Ar+1);if(bn!==0){if(he.isMesh)J.wireframe===!0?(Ae.setLineWidth(J.wireframeLinewidth*Be()),Ft.setMode(1)):Ft.setMode(4);else if(he.isLine){let ii=J.linewidth;ii===void 0&&(ii=1),Ae.setLineWidth(ii*Be()),he.isLineSegments?Ft.setMode(1):he.isLineLoop?Ft.setMode(2):Ft.setMode(3)}else he.isPoints?Ft.setMode(0):he.isSprite&&Ft.setMode(4);if(he.isInstancedMesh)Ft.renderInstances(Ar,bn,he.count);else if(se.isInstancedBufferGeometry){const ii=Math.min(se.instanceCount,se._maxInstanceCount);Ft.renderInstances(Ar,bn,ii)}else Ft.render(Ar,bn)}},this.compile=function(z,$){function se(J,he,Ge){J.transparent===!0&&J.side===hh?(J.side=Ss,J.needsUpdate=!0,Ds(J,he,Ge),J.side=sg,J.needsUpdate=!0,Ds(J,he,Ge),J.side=hh):Ds(J,he,Ge)}p=k.get(z),p.init(),y.push(p),z.traverseVisible(function(J){J.isLight&&J.layers.test($.layers)&&(p.pushLight(J),J.castShadow&&p.pushShadow(J))}),p.setupLights(_.physicallyCorrectLights),z.traverse(function(J){const he=J.material;if(he)if(Array.isArray(he))for(let Ge=0;Ge<he.length;Ge++){const et=he[Ge];se(et,z,J)}else se(he,z,J)}),y.pop(),p=null};let Re=null;function Me(z){Re&&Re(z)}function bt(){zt.stop()}function It(){zt.start()}const zt=new mY;zt.setAnimationLoop(Me),typeof self<"u"&&zt.setContext(self),this.setAnimationLoop=function(z){Re=z,Ie.setAnimationLoop(z),z===null?zt.stop():zt.start()},Ie.addEventListener("sessionstart",bt),Ie.addEventListener("sessionend",It),this.render=function(z,$){if($!==void 0&&$.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;z.matrixWorldAutoUpdate===!0&&z.updateMatrixWorld(),$.parent===null&&$.matrixWorldAutoUpdate===!0&&$.updateMatrixWorld(),Ie.enabled===!0&&Ie.isPresenting===!0&&(Ie.cameraAutoUpdate===!0&&Ie.updateCamera($),$=Ie.getCamera()),z.isScene===!0&&z.onBeforeRender(_,z,$,M),p=k.get(z,y.length),p.init(),y.push(p),le.multiplyMatrices($.projectionMatrix,$.matrixWorldInverse),de.setFromProjectionMatrix(le),B=this.localClippingEnabled,X=O.init(this.clippingPlanes,B,$),h=ve.get(z,m.length),h.init(),m.push(h),Kn(z,$,0,_.sortObjects),h.finish(),_.sortObjects===!0&&h.sort(te,ee),X===!0&&O.beginShadows();const se=p.state.shadowsArray;if(ie.render(se,z,$),X===!0&&O.endShadows(),this.info.autoReset===!0&&this.info.reset(),ge.render(h,z),p.setupLights(_.physicallyCorrectLights),$.isArrayCamera){const J=$.cameras;for(let he=0,Ge=J.length;he<Ge;he++){const et=J[he];Dt(h,z,et,et.viewport)}}else Dt(h,z,$);M!==null&&(be.updateMultisampleRenderTarget(M),be.updateRenderTargetMipmap(M)),z.isScene===!0&&z.onAfterRender(_,z,$),Fe.resetDefaultState(),C=-1,P=null,y.pop(),y.length>0?p=y[y.length-1]:p=null,m.pop(),m.length>0?h=m[m.length-1]:h=null};function Kn(z,$,se,J){if(z.visible===!1)return;if(z.layers.test($.layers)){if(z.isGroup)se=z.renderOrder;else if(z.isLOD)z.autoUpdate===!0&&z.update($);else if(z.isLight)p.pushLight(z),z.castShadow&&p.pushShadow(z);else if(z.isSprite){if(!z.frustumCulled||de.intersectsSprite(z)){J&&fe.setFromMatrixPosition(z.matrixWorld).applyMatrix4(le);const et=yt.update(z),$e=z.material;$e.visible&&h.push(z,et,$e,se,fe.z,null)}}else if((z.isMesh||z.isLine||z.isPoints)&&(z.isSkinnedMesh&&z.skeleton.frame!==Oe.render.frame&&(z.skeleton.update(),z.skeleton.frame=Oe.render.frame),!z.frustumCulled||de.intersectsObject(z))){J&&fe.setFromMatrixPosition(z.matrixWorld).applyMatrix4(le);const et=yt.update(z),$e=z.material;if(Array.isArray($e)){const rt=et.groups;for(let Ct=0,ct=rt.length;Ct<ct;Ct++){const ht=rt[Ct],Ft=$e[ht.materialIndex];Ft&&Ft.visible&&h.push(z,et,Ft,se,fe.z,ht)}}else $e.visible&&h.push(z,et,$e,se,fe.z,null)}}const Ge=z.children;for(let et=0,$e=Ge.length;et<$e;et++)Kn(Ge[et],$,se,J)}function Dt(z,$,se,J){const he=z.opaque,Ge=z.transmissive,et=z.transparent;p.setupLightsView(se),Ge.length>0&&Bn(he,$,se),J&&Ae.viewport(L.copy(J)),he.length>0&&yn(he,$,se),Ge.length>0&&yn(Ge,$,se),et.length>0&&yn(et,$,se),Ae.buffers.depth.setTest(!0),Ae.buffers.depth.setMask(!0),Ae.buffers.color.setMask(!0),Ae.setPolygonOffset(!1)}function Bn(z,$,se){const J=Ve.isWebGL2;U===null&&(U=new zp(1,1,{generateMipmaps:!0,type:Ue.has("EXT_color_buffer_half_float")?Jy:Ip,minFilter:Q3,samples:J&&o===!0?4:0})),_.getDrawingBufferSize(ne),J?U.setSize(ne.x,ne.y):U.setSize(L4(ne.x),L4(ne.y));const he=_.getRenderTarget();_.setRenderTarget(U),_.clear();const Ge=_.toneMapping;_.toneMapping=qu,yn(z,$,se),_.toneMapping=Ge,be.updateMultisampleRenderTarget(U),be.updateRenderTargetMipmap(U),_.setRenderTarget(he)}function yn(z,$,se){const J=$.isScene===!0?$.overrideMaterial:null;for(let he=0,Ge=z.length;he<Ge;he++){const et=z[he],$e=et.object,rt=et.geometry,Ct=J===null?et.material:J,ct=et.group;$e.layers.test(se.layers)&&Hl($e,$,se,rt,Ct,ct)}}function Hl(z,$,se,J,he,Ge){z.onBeforeRender(_,$,se,J,he,Ge),z.modelViewMatrix.multiplyMatrices(se.matrixWorldInverse,z.matrixWorld),z.normalMatrix.getNormalMatrix(z.modelViewMatrix),he.onBeforeRender(_,$,se,J,z,Ge),he.transparent===!0&&he.side===hh?(he.side=Ss,he.needsUpdate=!0,_.renderBufferDirect(se,$,J,he,z,Ge),he.side=sg,he.needsUpdate=!0,_.renderBufferDirect(se,$,J,he,z,Ge),he.side=hh):_.renderBufferDirect(se,$,J,he,z,Ge),z.onAfterRender(_,$,se,J,he,Ge)}function Ds(z,$,se){$.isScene!==!0&&($=we);const J=Te.get(z),he=p.state.lights,Ge=p.state.shadowsArray,et=he.state.version,$e=st.getParameters(z,he.state,Ge,$,se),rt=st.getProgramCacheKey($e);let Ct=J.programs;J.environment=z.isMeshStandardMaterial?$.environment:null,J.fog=$.fog,J.envMap=(z.isMeshStandardMaterial?Ke:Ye).get(z.envMap||J.environment),Ct===void 0&&(z.addEventListener("dispose",W),Ct=new Map,J.programs=Ct);let ct=Ct.get(rt);if(ct!==void 0){if(J.currentProgram===ct&&J.lightsStateVersion===et)return ra(z,$e),ct}else $e.uniforms=st.getUniforms(z),z.onBuild(se,$e,_),z.onBeforeCompile($e,_),ct=st.acquireProgram($e,rt),Ct.set(rt,ct),J.uniforms=$e.uniforms;const ht=J.uniforms;(!z.isShaderMaterial&&!z.isRawShaderMaterial||z.clipping===!0)&&(ht.clippingPlanes=O.uniform),ra(z,$e),J.needsLights=Gl(z),J.lightsStateVersion=et,J.needsLights&&(ht.ambientLightColor.value=he.state.ambient,ht.lightProbe.value=he.state.probe,ht.directionalLights.value=he.state.directional,ht.directionalLightShadows.value=he.state.directionalShadow,ht.spotLights.value=he.state.spot,ht.spotLightShadows.value=he.state.spotShadow,ht.rectAreaLights.value=he.state.rectArea,ht.ltc_1.value=he.state.rectAreaLTC1,ht.ltc_2.value=he.state.rectAreaLTC2,ht.pointLights.value=he.state.point,ht.pointLightShadows.value=he.state.pointShadow,ht.hemisphereLights.value=he.state.hemi,ht.directionalShadowMap.value=he.state.directionalShadowMap,ht.directionalShadowMatrix.value=he.state.directionalShadowMatrix,ht.spotShadowMap.value=he.state.spotShadowMap,ht.spotLightMatrix.value=he.state.spotLightMatrix,ht.spotLightMap.value=he.state.spotLightMap,ht.pointShadowMap.value=he.state.pointShadowMap,ht.pointShadowMatrix.value=he.state.pointShadowMatrix);const Ft=ct.getUniforms(),Ki=FM.seqWithValue(Ft.seq,ht);return J.currentProgram=ct,J.uniformsList=Ki,ct}function ra(z,$){const se=Te.get(z);se.outputEncoding=$.outputEncoding,se.instancing=$.instancing,se.skinning=$.skinning,se.morphTargets=$.morphTargets,se.morphNormals=$.morphNormals,se.morphColors=$.morphColors,se.morphTargetsCount=$.morphTargetsCount,se.numClippingPlanes=$.numClippingPlanes,se.numIntersection=$.numClipIntersection,se.vertexAlphas=$.vertexAlphas,se.vertexTangents=$.vertexTangents,se.toneMapping=$.toneMapping}function Qh(z,$,se,J,he){$.isScene!==!0&&($=we),be.resetTextureUnits();const Ge=$.fog,et=J.isMeshStandardMaterial?$.environment:null,$e=M===null?_.outputEncoding:M.isXRRenderTarget===!0?M.texture.encoding:Np,rt=(J.isMeshStandardMaterial?Ke:Ye).get(J.envMap||et),Ct=J.vertexColors===!0&&!!se.attributes.color&&se.attributes.color.itemSize===4,ct=!!J.normalMap&&!!se.attributes.tangent,ht=!!se.morphAttributes.position,Ft=!!se.morphAttributes.normal,Ki=!!se.morphAttributes.color,Pi=J.toneMapped?_.toneMapping:qu,ti=se.morphAttributes.position||se.morphAttributes.normal||se.morphAttributes.color,vn=ti!==void 0?ti.length:0,wt=Te.get(J),Ar=p.state.lights;if(X===!0&&(B===!0||z!==P)){const fn=z===P&&J.id===C;O.setState(J,z,fn)}let xn=!1;J.version===wt.__version?(wt.needsLights&&wt.lightsStateVersion!==Ar.state.version||wt.outputEncoding!==$e||he.isInstancedMesh&&wt.instancing===!1||!he.isInstancedMesh&&wt.instancing===!0||he.isSkinnedMesh&&wt.skinning===!1||!he.isSkinnedMesh&&wt.skinning===!0||wt.envMap!==rt||J.fog===!0&&wt.fog!==Ge||wt.numClippingPlanes!==void 0&&(wt.numClippingPlanes!==O.numPlanes||wt.numIntersection!==O.numIntersection)||wt.vertexAlphas!==Ct||wt.vertexTangents!==ct||wt.morphTargets!==ht||wt.morphNormals!==Ft||wt.morphColors!==Ki||wt.toneMapping!==Pi||Ve.isWebGL2===!0&&wt.morphTargetsCount!==vn)&&(xn=!0):(xn=!0,wt.__version=J.version);let bn=wt.currentProgram;xn===!0&&(bn=Ds(J,$,he));let ii=!1,Lr=!1,oa=!1;const Qt=bn.getUniforms(),Dr=wt.uniforms;if(Ae.useProgram(bn.program)&&(ii=!0,Lr=!0,oa=!0),J.id!==C&&(C=J.id,Lr=!0),ii||P!==z){if(Qt.setValue(oe,"projectionMatrix",z.projectionMatrix),Ve.logarithmicDepthBuffer&&Qt.setValue(oe,"logDepthBufFC",2/(Math.log(z.far+1)/Math.LN2)),P!==z&&(P=z,Lr=!0,oa=!0),J.isShaderMaterial||J.isMeshPhongMaterial||J.isMeshToonMaterial||J.isMeshStandardMaterial||J.envMap){const fn=Qt.map.cameraPosition;fn!==void 0&&fn.setValue(oe,fe.setFromMatrixPosition(z.matrixWorld))}(J.isMeshPhongMaterial||J.isMeshToonMaterial||J.isMeshLambertMaterial||J.isMeshBasicMaterial||J.isMeshStandardMaterial||J.isShaderMaterial)&&Qt.setValue(oe,"isOrthographic",z.isOrthographicCamera===!0),(J.isMeshPhongMaterial||J.isMeshToonMaterial||J.isMeshLambertMaterial||J.isMeshBasicMaterial||J.isMeshStandardMaterial||J.isShaderMaterial||J.isShadowMaterial||he.isSkinnedMesh)&&Qt.setValue(oe,"viewMatrix",z.matrixWorldInverse)}if(he.isSkinnedMesh){Qt.setOptional(oe,he,"bindMatrix"),Qt.setOptional(oe,he,"bindMatrixInverse");const fn=he.skeleton;fn&&(Ve.floatVertexTextures?(fn.boneTexture===null&&fn.computeBoneTexture(),Qt.setValue(oe,"boneTexture",fn.boneTexture,be),Qt.setValue(oe,"boneTextureSize",fn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Rs=se.morphAttributes;if((Rs.position!==void 0||Rs.normal!==void 0||Rs.color!==void 0&&Ve.isWebGL2===!0)&&ye.update(he,se,J,bn),(Lr||wt.receiveShadow!==he.receiveShadow)&&(wt.receiveShadow=he.receiveShadow,Qt.setValue(oe,"receiveShadow",he.receiveShadow)),J.isMeshGouraudMaterial&&J.envMap!==null&&(Dr.envMap.value=rt,Dr.flipEnvMap.value=rt.isCubeTexture&&rt.isRenderTargetTexture===!1?-1:1),Lr&&(Qt.setValue(oe,"toneMappingExposure",_.toneMappingExposure),wt.needsLights&&Wl(Dr,oa),Ge&&J.fog===!0&&Ce.refreshFogUniforms(Dr,Ge),Ce.refreshMaterialUniforms(Dr,J,j,N,U),FM.upload(oe,wt.uniformsList,Dr,be)),J.isShaderMaterial&&J.uniformsNeedUpdate===!0&&(FM.upload(oe,wt.uniformsList,Dr,be),J.uniformsNeedUpdate=!1),J.isSpriteMaterial&&Qt.setValue(oe,"center",he.center),Qt.setValue(oe,"modelViewMatrix",he.modelViewMatrix),Qt.setValue(oe,"normalMatrix",he.normalMatrix),Qt.setValue(oe,"modelMatrix",he.matrixWorld),J.isShaderMaterial||J.isRawShaderMaterial){const fn=J.uniformsGroups;for(let Os=0,dc=fn.length;Os<dc;Os++)if(Ve.isWebGL2){const sa=fn[Os];Ne.update(sa,bn),Ne.bind(sa,bn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return bn}function Wl(z,$){z.ambientLightColor.needsUpdate=$,z.lightProbe.needsUpdate=$,z.directionalLights.needsUpdate=$,z.directionalLightShadows.needsUpdate=$,z.pointLights.needsUpdate=$,z.pointLightShadows.needsUpdate=$,z.spotLights.needsUpdate=$,z.spotLightShadows.needsUpdate=$,z.rectAreaLights.needsUpdate=$,z.hemisphereLights.needsUpdate=$}function Gl(z){return z.isMeshLambertMaterial||z.isMeshToonMaterial||z.isMeshPhongMaterial||z.isMeshStandardMaterial||z.isShadowMaterial||z.isShaderMaterial&&z.lights===!0}this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return M},this.setRenderTargetTextures=function(z,$,se){Te.get(z.texture).__webglTexture=$,Te.get(z.depthTexture).__webglTexture=se;const J=Te.get(z);J.__hasExternalTextures=!0,J.__hasExternalTextures&&(J.__autoAllocateDepthBuffer=se===void 0,J.__autoAllocateDepthBuffer||Ue.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),J.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(z,$){const se=Te.get(z);se.__webglFramebuffer=$,se.__useDefaultFramebuffer=$===void 0},this.setRenderTarget=function(z,$=0,se=0){M=z,b=$,w=se;let J=!0;if(z){const rt=Te.get(z);rt.__useDefaultFramebuffer!==void 0?(Ae.bindFramebuffer(36160,null),J=!1):rt.__webglFramebuffer===void 0?be.setupRenderTarget(z):rt.__hasExternalTextures&&be.rebindTextures(z,Te.get(z.texture).__webglTexture,Te.get(z.depthTexture).__webglTexture)}let he=null,Ge=!1,et=!1;if(z){const rt=z.texture;(rt.isData3DTexture||rt.isDataArrayTexture)&&(et=!0);const Ct=Te.get(z).__webglFramebuffer;z.isWebGLCubeRenderTarget?(he=Ct[$],Ge=!0):Ve.isWebGL2&&z.samples>0&&be.useMultisampledRTT(z)===!1?he=Te.get(z).__webglMultisampledFramebuffer:he=Ct,L.copy(z.viewport),R.copy(z.scissor),E=z.scissorTest}else L.copy(H).multiplyScalar(j).floor(),R.copy(Q).multiplyScalar(j).floor(),E=Z;if(Ae.bindFramebuffer(36160,he)&&Ve.drawBuffers&&J&&Ae.drawBuffers(z,he),Ae.viewport(L),Ae.scissor(R),Ae.setScissorTest(E),Ge){const rt=Te.get(z.texture);oe.framebufferTexture2D(36160,36064,34069+$,rt.__webglTexture,se)}else if(et){const rt=Te.get(z.texture),Ct=$||0;oe.framebufferTextureLayer(36160,36064,rt.__webglTexture,se||0,Ct)}C=-1},this.readRenderTargetPixels=function(z,$,se,J,he,Ge,et){if(!(z&&z.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let $e=Te.get(z).__webglFramebuffer;if(z.isWebGLCubeRenderTarget&&et!==void 0&&($e=$e[et]),$e){Ae.bindFramebuffer(36160,$e);try{const rt=z.texture,Ct=rt.format,ct=rt.type;if(Ct!==wl&&re.convert(Ct)!==oe.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const ht=ct===Jy&&(Ue.has("EXT_color_buffer_half_float")||Ve.isWebGL2&&Ue.has("EXT_color_buffer_float"));if(ct!==Ip&&re.convert(ct)!==oe.getParameter(35738)&&!(ct===cp&&(Ve.isWebGL2||Ue.has("OES_texture_float")||Ue.has("WEBGL_color_buffer_float")))&&!ht){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}$>=0&&$<=z.width-J&&se>=0&&se<=z.height-he&&oe.readPixels($,se,J,he,re.convert(Ct),re.convert(ct),Ge)}finally{const rt=M!==null?Te.get(M).__webglFramebuffer:null;Ae.bindFramebuffer(36160,rt)}}},this.copyFramebufferToTexture=function(z,$,se=0){const J=Math.pow(2,-se),he=Math.floor($.image.width*J),Ge=Math.floor($.image.height*J);be.setTexture2D($,0),oe.copyTexSubImage2D(3553,se,0,0,z.x,z.y,he,Ge),Ae.unbindTexture()},this.copyTextureToTexture=function(z,$,se,J=0){const he=$.image.width,Ge=$.image.height,et=re.convert(se.format),$e=re.convert(se.type);be.setTexture2D(se,0),oe.pixelStorei(37440,se.flipY),oe.pixelStorei(37441,se.premultiplyAlpha),oe.pixelStorei(3317,se.unpackAlignment),$.isDataTexture?oe.texSubImage2D(3553,J,z.x,z.y,he,Ge,et,$e,$.image.data):$.isCompressedTexture?oe.compressedTexSubImage2D(3553,J,z.x,z.y,$.mipmaps[0].width,$.mipmaps[0].height,et,$.mipmaps[0].data):oe.texSubImage2D(3553,J,z.x,z.y,et,$e,$.image),J===0&&se.generateMipmaps&&oe.generateMipmap(3553),Ae.unbindTexture()},this.copyTextureToTexture3D=function(z,$,se,J,he=0){if(_.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ge=z.max.x-z.min.x+1,et=z.max.y-z.min.y+1,$e=z.max.z-z.min.z+1,rt=re.convert(J.format),Ct=re.convert(J.type);let ct;if(J.isData3DTexture)be.setTexture3D(J,0),ct=32879;else if(J.isDataArrayTexture)be.setTexture2DArray(J,0),ct=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}oe.pixelStorei(37440,J.flipY),oe.pixelStorei(37441,J.premultiplyAlpha),oe.pixelStorei(3317,J.unpackAlignment);const ht=oe.getParameter(3314),Ft=oe.getParameter(32878),Ki=oe.getParameter(3316),Pi=oe.getParameter(3315),ti=oe.getParameter(32877),vn=se.isCompressedTexture?se.mipmaps[0]:se.image;oe.pixelStorei(3314,vn.width),oe.pixelStorei(32878,vn.height),oe.pixelStorei(3316,z.min.x),oe.pixelStorei(3315,z.min.y),oe.pixelStorei(32877,z.min.z),se.isDataTexture||se.isData3DTexture?oe.texSubImage3D(ct,he,$.x,$.y,$.z,Ge,et,$e,rt,Ct,vn.data):se.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),oe.compressedTexSubImage3D(ct,he,$.x,$.y,$.z,Ge,et,$e,rt,vn.data)):oe.texSubImage3D(ct,he,$.x,$.y,$.z,Ge,et,$e,rt,Ct,vn),oe.pixelStorei(3314,ht),oe.pixelStorei(32878,Ft),oe.pixelStorei(3316,Ki),oe.pixelStorei(3315,Pi),oe.pixelStorei(32877,ti),he===0&&J.generateMipmaps&&oe.generateMipmap(ct),Ae.unbindTexture()},this.initTexture=function(z){z.isCubeTexture?be.setTextureCube(z,0):z.isData3DTexture?be.setTexture3D(z,0):z.isDataArrayTexture?be.setTexture2DArray(z,0):be.setTexture2D(z,0),Ae.unbindTexture()},this.resetState=function(){b=0,w=0,M=null,Ae.reset(),Fe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class EDe extends bY{}EDe.prototype.isWebGL1Renderer=!0;class TDe extends Er{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class wY extends w1{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Rn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const J8=new Ee,Q8=new Ee,$8=new qi,WL=new aY,QS=new $3;class PDe extends Er{constructor(e=new hc,t=new wY){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,o=t.count;r<o;r++)J8.fromBufferAttribute(t,r-1),Q8.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=J8.distanceTo(Q8);e.setAttribute("lineDistance",new ja(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),QS.copy(i.boundingSphere),QS.applyMatrix4(r),QS.radius+=o,e.ray.intersectsSphere(QS)===!1)return;$8.copy(r).invert(),WL.copy(e.ray).applyMatrix4($8);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=new Ee,c=new Ee,h=new Ee,p=new Ee,m=this.isLineSegments?2:1,y=i.index,g=i.attributes.position;if(y!==null){const b=Math.max(0,s.start),w=Math.min(y.count,s.start+s.count);for(let M=b,C=w-1;M<C;M+=m){const P=y.getX(M),L=y.getX(M+1);if(u.fromBufferAttribute(g,P),c.fromBufferAttribute(g,L),WL.distanceSqToSegment(u,c,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);const E=e.ray.origin.distanceTo(p);E<e.near||E>e.far||t.push({distance:E,point:h.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}else{const b=Math.max(0,s.start),w=Math.min(g.count,s.start+s.count);for(let M=b,C=w-1;M<C;M+=m){if(u.fromBufferAttribute(g,M),c.fromBufferAttribute(g,M+1),WL.distanceSqToSegment(u,c,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);const L=e.ray.origin.distanceTo(p);L<e.near||L>e.far||t.push({distance:L,point:h.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}}const e9=new Ee,t9=new Ee;class ADe extends PDe{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,o=t.count;r<o;r+=2)e9.fromBufferAttribute(t,r),t9.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+e9.distanceTo(t9);e.setAttribute("lineDistance",new ja(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class SY extends Er{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Rn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}const n9=new qi,i9=new Ee,r9=new Ee;class LDe{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new zn(512,512),this.map=null,this.mapPass=null,this.matrix=new qi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new RI,this._frameExtents=new zn(1,1),this._viewportCount=1,this._viewports=[new Mr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;i9.setFromMatrixPosition(e.matrixWorld),t.position.copy(i9),r9.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(r9),t.updateMatrixWorld(),n9.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n9),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class DDe extends LDe{constructor(){super(new vY(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class RDe extends SY{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Er.DefaultUp),this.updateMatrix(),this.target=new Er,this.shadow=new DDe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class ODe extends SY{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}let $S;const kDe={getContext:function(){return $S===void 0&&($S=new(window.AudioContext||window.webkitAudioContext)),$S},setContext:function(n){$S=n}};class IDe{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=o9(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=o9();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function o9(){return(typeof performance>"u"?Date:performance).now()}const Xd=new Ee,s9=new jg,NDe=new Ee,qd=new Ee;class zDe extends Er{constructor(){super(),this.type="AudioListener",this.context=kDe.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new IDe}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Xd,s9,NDe),qd.set(0,0,-1).applyQuaternion(s9),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Xd.x,r),t.positionY.linearRampToValueAtTime(Xd.y,r),t.positionZ.linearRampToValueAtTime(Xd.z,r),t.forwardX.linearRampToValueAtTime(qd.x,r),t.forwardY.linearRampToValueAtTime(qd.y,r),t.forwardZ.linearRampToValueAtTime(qd.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(Xd.x,Xd.y,Xd.z),t.setOrientation(qd.x,qd.y,qd.z,i.x,i.y,i.z)}}class VDe extends ADe{constructor(e=10,t=16,i=8,r=64,o=4473924,s=8947848){o=new Rn(o),s=new Rn(s);const a=[],l=[];if(t>1)for(let h=0;h<t;h++){const p=h/t*(Math.PI*2),m=Math.sin(p)*e,y=Math.cos(p)*e;a.push(0,0,0),a.push(m,0,y);const _=h&1?o:s;l.push(_.r,_.g,_.b),l.push(_.r,_.g,_.b)}for(let h=0;h<i;h++){const p=h&1?o:s,m=e-e/i*h;for(let y=0;y<r;y++){let _=y/r*(Math.PI*2),g=Math.sin(_)*m,b=Math.cos(_)*m;a.push(g,0,b),l.push(p.r,p.g,p.b),_=(y+1)/r*(Math.PI*2),g=Math.sin(_)*m,b=Math.cos(_)*m,a.push(g,0,b),l.push(p.r,p.g,p.b)}}const u=new hc;u.setAttribute("position",new ja(a,3)),u.setAttribute("color",new ja(l,3));const c=new wY({vertexColors:!0,toneMapped:!1});super(u,c),this.type="PolarGridHelper"}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:DI}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=DI);class FDe{constructor(e,t={}){this.enabled=!0;const i=t.defaultThickness!==void 0?t.defaultThickness:.003,r=new Rn().fromArray(t.defaultColor!==void 0?t.defaultColor:[0,0,0]),o=t.defaultAlpha!==void 0?t.defaultAlpha:1,s=t.defaultKeepAlive!==void 0?t.defaultKeepAlive:!1,a={},l=60,u={},c={},h={outlineThickness:{value:i},outlineColor:{value:r},outlineAlpha:{value:o}},p=["#include <common>","#include <uv_pars_vertex>","#include <displacementmap_pars_vertex>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","uniform float outlineThickness;","vec4 calculateOutline( vec4 pos, vec3 normal, vec4 skinned ) {","	float thickness = outlineThickness;","	const float ratio = 1.0;","	vec4 pos2 = projectionMatrix * modelViewMatrix * vec4( skinned.xyz + normal, 1.0 );","	vec4 norm = normalize( pos - pos2 );","	return pos + norm * thickness * pos.w * ratio;","}","void main() {","	#include <uv_vertex>","	#include <beginnormal_vertex>","	#include <morphnormal_vertex>","	#include <skinbase_vertex>","	#include <skinnormal_vertex>","	#include <begin_vertex>","	#include <morphtarget_vertex>","	#include <skinning_vertex>","	#include <displacementmap_vertex>","	#include <project_vertex>","	vec3 outlineNormal = - objectNormal;","	gl_Position = calculateOutline( gl_Position, outlineNormal, vec4( transformed, 1.0 ) );","	#include <logdepthbuf_vertex>","	#include <clipping_planes_vertex>","	#include <fog_vertex>","}"].join(`
`),m=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","uniform vec3 outlineColor;","uniform float outlineAlpha;","void main() {","	#include <clipping_planes_fragment>","	#include <logdepthbuf_fragment>","	gl_FragColor = vec4( outlineColor, outlineAlpha );","	#include <tonemapping_fragment>","	#include <encodings_fragment>","	#include <fog_fragment>","	#include <premultiplied_alpha_fragment>","}"].join(`
`);function y(){return new zh({type:"OutlineEffect",uniforms:dY.merge([ot.fog,ot.displacementmap,h]),vertexShader:p,fragmentShader:m,side:Ss})}function _(E){let D=a[E.uuid];return D===void 0&&(D={material:y(),used:!0,keepAlive:s,count:0},a[E.uuid]=D),D.used=!0,D.material}function g(E){const D=_(E);return u[D.uuid]=E,L(D,E),D}function b(E){const D=E.geometry;let N=!1;return E.geometry!==void 0&&(D.isBufferGeometry?N=D.attributes.normal!==void 0:N=!0),E.isMesh===!0&&E.material!==void 0&&N===!0}function w(E){if(b(E)!==!1){if(Array.isArray(E.material))for(let D=0,N=E.material.length;D<N;D++)E.material[D]=g(E.material[D]);else E.material=g(E.material);c[E.uuid]=E.onBeforeRender,E.onBeforeRender=C}}function M(E){if(b(E)!==!1){if(Array.isArray(E.material))for(let D=0,N=E.material.length;D<N;D++)E.material[D]=u[E.material[D].uuid];else E.material=u[E.material.uuid];E.onBeforeRender=c[E.uuid]}}function C(E,D,N,j,te){const ee=u[te.uuid];ee!==void 0&&P(te,ee)}function P(E,D){const N=D.userData.outlineParameters;E.uniforms.outlineAlpha.value=D.opacity,N!==void 0&&(N.thickness!==void 0&&(E.uniforms.outlineThickness.value=N.thickness),N.color!==void 0&&E.uniforms.outlineColor.value.fromArray(N.color),N.alpha!==void 0&&(E.uniforms.outlineAlpha.value=N.alpha)),D.displacementMap&&(E.uniforms.displacementMap.value=D.displacementMap,E.uniforms.displacementScale.value=D.displacementScale,E.uniforms.displacementBias.value=D.displacementBias)}function L(E,D){if(E.name==="invisible")return;const N=D.userData.outlineParameters;E.fog=D.fog,E.toneMapped=D.toneMapped,E.premultipliedAlpha=D.premultipliedAlpha,E.displacementMap=D.displacementMap,N!==void 0?(D.visible===!1?E.visible=!1:E.visible=N.visible!==void 0?N.visible:!0,E.transparent=N.alpha!==void 0&&N.alpha<1?!0:D.transparent,N.keepAlive!==void 0&&(a[D.uuid].keepAlive=N.keepAlive)):(E.transparent=D.transparent,E.visible=D.visible),(D.wireframe===!0||D.depthTest===!1)&&(E.visible=!1),D.clippingPlanes&&(E.clipping=!0,E.clippingPlanes=D.clippingPlanes,E.clipIntersection=D.clipIntersection,E.clipShadows=D.clipShadows),E.version=D.version}function R(){let E;E=Object.keys(u);for(let D=0,N=E.length;D<N;D++)u[E[D]]=void 0;E=Object.keys(c);for(let D=0,N=E.length;D<N;D++)c[E[D]]=void 0;E=Object.keys(a);for(let D=0,N=E.length;D<N;D++){const j=E[D];a[j].used===!1?(a[j].count++,a[j].keepAlive===!1&&a[j].count>l&&delete a[j]):(a[j].used=!1,a[j].count=0)}}this.render=function(E,D){if(this.enabled===!1){e.render(E,D);return}const N=e.autoClear;e.autoClear=this.autoClear,e.render(E,D),e.autoClear=N,this.renderOutline(E,D)},this.renderOutline=function(E,D){const N=e.autoClear,j=E.matrixWorldAutoUpdate,te=E.background,ee=e.shadowMap.enabled;E.matrixWorldAutoUpdate=!1,E.background=null,e.autoClear=!1,e.shadowMap.enabled=!1,E.traverse(w),e.render(E,D),E.traverse(M),R(),E.matrixWorldAutoUpdate=j,E.background=te,e.autoClear=N,e.shadowMap.enabled=ee},this.autoClear=e.autoClear,this.domElement=e.domElement,this.shadowMap=e.shadowMap,this.clear=function(E,D,N){e.clear(E,D,N)},this.getPixelRatio=function(){return e.getPixelRatio()},this.setPixelRatio=function(E){e.setPixelRatio(E)},this.getSize=function(E){return e.getSize(E)},this.setSize=function(E,D,N){e.setSize(E,D,N)},this.setViewport=function(E,D,N,j){e.setViewport(E,D,N,j)},this.setScissor=function(E,D,N,j){e.setScissor(E,D,N,j)},this.setScissorTest=function(E){e.setScissorTest(E)},this.setRenderTarget=function(E){e.setRenderTarget(E)}}}const BDe=()=>{hn.exports.useEffect(()=>{},[]);const n=()=>{Ammo().then(()=>{e()})},e=()=>{const t=new TDe;t.background=new Rn(16777215),t.add(new VDe(30,0));const i=new Xs(45,window.innerWidth/window.innerHeight,1,2e3),r=new zDe;i.add(r),t.add(i);const o=new ODe(6710886);t.add(o);const s=new RDe(8943462);s.position.set(-1,1,1).normalize(),t.add(s);let a=new bY({antialias:!0});a.setPixelRatio(window.devicePixelRatio),a.setSize(window.innerWidth,window.innerHeight),a.render(t,i),document.getElementById("cube").appendChild(a.domElement),new FDe(a)};return Dj("div",{children:[xr("div",{id:"cube"}),xr("button",{onClick:()=>n(),children:"start"})]})},UDe={routes:[{exact:!0,path:"/",component:O3e},{exact:!0,path:"/mesh",component:BDe}]};GL.createRoot(document.getElementById("root")).render(xr(_t.StrictMode,{children:xr(Ane,{children:xr(Pne,{children:UDe.routes.map(n=>xr(Cne,{...n},n.path))})})}));export{Hr as $,Vt as A,_V as B,Co as C,Phe as D,fRe as E,nc as F,Xce as G,Uce as H,Vn as I,Jle as J,br as K,QH as L,XO as M,Qe as N,iRe as O,vce as P,Ci as Q,Gp as R,cl as S,_l as T,Mo as U,ic as V,Hce as W,mg as X,vg as Y,vk as Z,Bt as _,Tg as a,qD as a$,kC as a0,Wp as a1,Zt as a2,QO as a3,$O as a4,tk as a5,sx as a6,Qu as a7,_g as a8,rRe as a9,Fl as aA,ax as aB,or as aC,Xue as aD,Wue as aE,Yue as aF,Sg as aG,pRe as aH,Ah as aI,YDe as aJ,ze as aK,ox as aL,ZDe as aM,Wle as aN,Hi as aO,rx as aP,Yle as aQ,Vl as aR,lx as aS,XDe as aT,qDe as aU,f2 as aV,WDe as aW,Mi as aX,b6 as aY,vie as aZ,w6 as a_,Xp as aa,KDe as ab,kH as ac,Uue as ad,Iv as ae,vs as af,so as ag,AH as ah,vt as ai,Ty as aj,yH as ak,Sn as al,GDe as am,bH as an,Kue as ao,oH as ap,Vr as aq,_n as ar,rR as as,y2 as at,OP as au,ux as av,Oy as aw,dk as ax,Bv as ay,pk as az,Zhe as b,p2 as b0,Ep as b1,g2 as b2,HDe as b3,Hp as b4,zC as b5,iv as b6,JDe as b7,mM as b8,tR as b9,jDe as bA,it as bB,QDe as ba,HO as bb,Ou as bc,Qn as bd,mH as be,fp as bf,FO as bg,Tp as bh,xi as bi,Mn as bj,zH as bk,ji as bl,Hle as bm,kie as bn,jp as bo,zr as bp,at as bq,cRe as br,JV as bs,mW as bt,xH as bu,Na as bv,Ia as bw,Jj as bx,Lw as by,Bu as bz,Fr as c,Ys as d,Ba as e,kj as f,yg as g,Rh as h,CW as i,Dn as j,ei as k,rv as l,An as m,eRe as n,p2e as o,tRe as p,zl as q,ipe as r,St as s,ia as t,ao as u,zj as v,Yn as w,hRe as x,K as y,dt as z};
